# Comparing `tmp/quicfire-tools-0.6.4.tar.gz` & `tmp/quicfire-tools-0.7.1.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "quicfire-tools-0.6.4.tar", last modified: Tue Feb 27 19:24:27 2024, max compression
+gzip compressed data, was "quicfire-tools-0.7.1.tar", last modified: Fri Apr 12 23:40:38 2024, max compression
```

## Comparing `quicfire-tools-0.6.4.tar` & `quicfire-tools-0.7.1.tar`

### file list

```diff
@@ -1,76 +1,76 @@
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-02-27 19:24:27.123227 quicfire-tools-0.6.4/
--rw-r--r--   0 runner    (1001) docker     (127)     1067 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/LICENSE
--rw-r--r--   0 runner    (1001) docker     (127)     2103 2024-02-27 19:24:27.123227 quicfire-tools-0.6.4/PKG-INFO
--rw-r--r--   0 runner    (1001) docker     (127)     1139 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/README.md
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-02-27 19:24:27.111227 quicfire-tools-0.6.4/quicfire_tools/
--rw-r--r--   0 runner    (1001) docker     (127)      157 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-02-27 19:24:27.107227 quicfire-tools-0.6.4/quicfire_tools/data/
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-02-27 19:24:27.115227 quicfire-tools-0.6.4/quicfire_tools/data/documentation/
--rw-r--r--   0 runner    (1001) docker     (127)     3670 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/documentation/IgnitionType.json
--rw-r--r--   0 runner    (1001) docker     (127)     4706 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/documentation/QFire_Advanced_User_Inputs.inp.json
--rw-r--r--   0 runner    (1001) docker     (127)     2580 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/documentation/QFire_Bldg_Advanced_User_Inputs.inp.json
--rw-r--r--   0 runner    (1001) docker     (127)     5377 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/documentation/QFire_Plume_Advanced_User_Inputs.inp.json
--rw-r--r--   0 runner    (1001) docker     (127)      301 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/documentation/QP_buildout.inp.json
--rw-r--r--   0 runner    (1001) docker     (127)    13745 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/documentation/QUIC_fire.inp.json
--rw-r--r--   0 runner    (1001) docker     (127)     2371 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/documentation/QU_TopoInputs.inp.json
--rw-r--r--   0 runner    (1001) docker     (127)      777 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/documentation/QU_buildings.inp.json
--rw-r--r--   0 runner    (1001) docker     (127)     1688 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/documentation/QU_fileoptions.inp.json
--rw-r--r--   0 runner    (1001) docker     (127)      421 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/documentation/QU_metparams.inp.json
--rw-r--r--   0 runner    (1001) docker     (127)      170 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/documentation/QU_movingcoords.inp.json
--rw-r--r--   0 runner    (1001) docker     (127)     4929 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/documentation/QU_simparams.inp.json
--rw-r--r--   0 runner    (1001) docker     (127)      492 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/documentation/Runtime_Advanced_User_Inputs.inp.json
--rw-r--r--   0 runner    (1001) docker     (127)     5199 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/documentation/TopoType.json
--rw-r--r--   0 runner    (1001) docker     (127)     1279 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/documentation/gridlist.json
--rw-r--r--   0 runner    (1001) docker     (127)      424 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/documentation/rasterorigin.txt.json
--rw-r--r--   0 runner    (1001) docker     (127)     1009 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/documentation/sensor1.inp.json
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-02-27 19:24:27.107227 quicfire-tools-0.6.4/quicfire_tools/data/templates/
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-02-27 19:24:27.115227 quicfire-tools-0.6.4/quicfire_tools/data/templates/v5/
--rwxr-xr-x   0 runner    (1001) docker     (127)     1189 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/templates/v5/QFire_Advanced_User_Inputs.inp
--rwxr-xr-x   0 runner    (1001) docker     (127)      812 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/templates/v5/QFire_Bldg_Advanced_User_Inputs.inp
--rwxr-xr-x   0 runner    (1001) docker     (127)     1459 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/templates/v5/QFire_Plume_Advanced_User_Inputs.inp
--rwxr-xr-x   0 runner    (1001) docker     (127)       94 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/templates/v5/QP_buildout.inp
--rw-r--r--   0 runner    (1001) docker     (127)     2535 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/templates/v5/QUIC_fire.inp
--rw-r--r--   0 runner    (1001) docker     (127)      587 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/templates/v5/QU_TopoInputs.inp
--rwxr-xr-x   0 runner    (1001) docker     (127)      167 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/templates/v5/QU_buildings.inp
--rwxr-xr-x   0 runner    (1001) docker     (127)      437 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/templates/v5/QU_fileoptions.inp
--rwxr-xr-x   0 runner    (1001) docker     (127)       20 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/templates/v5/QU_landuse.inp
--rw-r--r--   0 runner    (1001) docker     (127)      161 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/templates/v5/QU_metparams.inp
--rw-r--r--   0 runner    (1001) docker     (127)      494 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/templates/v5/QU_movingcoords.inp
--rwxr-xr-x   0 runner    (1001) docker     (127)     1567 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/templates/v5/QU_simparams.inp
--rwxr-xr-x   0 runner    (1001) docker     (127)      111 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/templates/v5/Runtime_Advanced_User_Inputs.inp
--rw-r--r--   0 runner    (1001) docker     (127)       45 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/templates/v5/gridlist
--rw-r--r--   0 runner    (1001) docker     (127)       88 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/templates/v5/rasterorigin.txt
--rw-r--r--   0 runner    (1001) docker     (127)      178 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/templates/v5/sensor.inp
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-02-27 19:24:27.119228 quicfire-tools-0.6.4/quicfire_tools/data/templates/v6/
--rwxr-xr-x   0 runner    (1001) docker     (127)     1189 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/templates/v6/QFire_Advanced_User_Inputs.inp
--rwxr-xr-x   0 runner    (1001) docker     (127)      812 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/templates/v6/QFire_Bldg_Advanced_User_Inputs.inp
--rwxr-xr-x   0 runner    (1001) docker     (127)     1459 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/templates/v6/QFire_Plume_Advanced_User_Inputs.inp
--rwxr-xr-x   0 runner    (1001) docker     (127)       94 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/templates/v6/QP_buildout.inp
--rw-r--r--   0 runner    (1001) docker     (127)     2574 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/templates/v6/QUIC_fire.inp
--rw-r--r--   0 runner    (1001) docker     (127)      587 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/templates/v6/QU_TopoInputs.inp
--rwxr-xr-x   0 runner    (1001) docker     (127)      167 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/templates/v6/QU_buildings.inp
--rwxr-xr-x   0 runner    (1001) docker     (127)      437 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/templates/v6/QU_fileoptions.inp
--rwxr-xr-x   0 runner    (1001) docker     (127)       20 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/templates/v6/QU_landuse.inp
--rw-r--r--   0 runner    (1001) docker     (127)      161 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/templates/v6/QU_metparams.inp
--rw-r--r--   0 runner    (1001) docker     (127)      494 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/templates/v6/QU_movingcoords.inp
--rwxr-xr-x   0 runner    (1001) docker     (127)     1567 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/templates/v6/QU_simparams.inp
--rwxr-xr-x   0 runner    (1001) docker     (127)      111 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/templates/v6/Runtime_Advanced_User_Inputs.inp
--rw-r--r--   0 runner    (1001) docker     (127)       45 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/templates/v6/gridlist
--rw-r--r--   0 runner    (1001) docker     (127)       88 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/templates/v6/rasterorigin.txt
--rw-r--r--   0 runner    (1001) docker     (127)      178 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/data/templates/v6/sensor.inp
--rw-r--r--   0 runner    (1001) docker     (127)     1075 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/examples.py
--rw-r--r--   0 runner    (1001) docker     (127)     4899 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/ignitions.py
--rw-r--r--   0 runner    (1001) docker     (127)   118902 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/inputs.py
--rw-r--r--   0 runner    (1001) docker     (127)    31175 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/outputs.py
--rw-r--r--   0 runner    (1001) docker     (127)     6744 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/topography.py
--rw-r--r--   0 runner    (1001) docker     (127)     4769 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/quicfire_tools/utils.py
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-02-27 19:24:27.119228 quicfire-tools-0.6.4/quicfire_tools.egg-info/
--rw-r--r--   0 runner    (1001) docker     (127)     2103 2024-02-27 19:24:27.000000 quicfire-tools-0.6.4/quicfire_tools.egg-info/PKG-INFO
--rw-r--r--   0 runner    (1001) docker     (127)     3248 2024-02-27 19:24:27.000000 quicfire-tools-0.6.4/quicfire_tools.egg-info/SOURCES.txt
--rw-r--r--   0 runner    (1001) docker     (127)        1 2024-02-27 19:24:27.000000 quicfire-tools-0.6.4/quicfire_tools.egg-info/dependency_links.txt
--rw-r--r--   0 runner    (1001) docker     (127)       41 2024-02-27 19:24:27.000000 quicfire-tools-0.6.4/quicfire_tools.egg-info/requires.txt
--rw-r--r--   0 runner    (1001) docker     (127)       15 2024-02-27 19:24:27.000000 quicfire-tools-0.6.4/quicfire_tools.egg-info/top_level.txt
--rw-r--r--   0 runner    (1001) docker     (127)       38 2024-02-27 19:24:27.123227 quicfire-tools-0.6.4/setup.cfg
--rw-r--r--   0 runner    (1001) docker     (127)     2142 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/setup.py
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-02-27 19:24:27.119228 quicfire-tools-0.6.4/tests/
--rw-r--r--   0 runner    (1001) docker     (127)   102367 2024-02-27 19:24:11.000000 quicfire-tools-0.6.4/tests/test_input_module.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-04-12 23:40:38.744594 quicfire-tools-0.7.1/
+-rw-r--r--   0 runner    (1001) docker     (127)     1067 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/LICENSE
+-rw-r--r--   0 runner    (1001) docker     (127)     2173 2024-04-12 23:40:38.744594 quicfire-tools-0.7.1/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (127)     1139 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/README.md
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-04-12 23:40:38.732594 quicfire-tools-0.7.1/quicfire_tools/
+-rw-r--r--   0 runner    (1001) docker     (127)      157 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-04-12 23:40:38.732594 quicfire-tools-0.7.1/quicfire_tools/data/
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-04-12 23:40:38.736594 quicfire-tools-0.7.1/quicfire_tools/data/documentation/
+-rw-r--r--   0 runner    (1001) docker     (127)     3670 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/documentation/IgnitionType.json
+-rw-r--r--   0 runner    (1001) docker     (127)     4706 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/documentation/QFire_Advanced_User_Inputs.inp.json
+-rw-r--r--   0 runner    (1001) docker     (127)     2580 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/documentation/QFire_Bldg_Advanced_User_Inputs.inp.json
+-rw-r--r--   0 runner    (1001) docker     (127)     5377 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/documentation/QFire_Plume_Advanced_User_Inputs.inp.json
+-rw-r--r--   0 runner    (1001) docker     (127)      301 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/documentation/QP_buildout.inp.json
+-rw-r--r--   0 runner    (1001) docker     (127)    13745 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/documentation/QUIC_fire.inp.json
+-rw-r--r--   0 runner    (1001) docker     (127)     2371 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/documentation/QU_TopoInputs.inp.json
+-rw-r--r--   0 runner    (1001) docker     (127)      777 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/documentation/QU_buildings.inp.json
+-rw-r--r--   0 runner    (1001) docker     (127)     1688 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/documentation/QU_fileoptions.inp.json
+-rw-r--r--   0 runner    (1001) docker     (127)      421 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/documentation/QU_metparams.inp.json
+-rw-r--r--   0 runner    (1001) docker     (127)      170 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/documentation/QU_movingcoords.inp.json
+-rw-r--r--   0 runner    (1001) docker     (127)     4929 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/documentation/QU_simparams.inp.json
+-rw-r--r--   0 runner    (1001) docker     (127)      492 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/documentation/Runtime_Advanced_User_Inputs.inp.json
+-rw-r--r--   0 runner    (1001) docker     (127)     5199 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/documentation/TopoType.json
+-rw-r--r--   0 runner    (1001) docker     (127)     1279 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/documentation/gridlist.json
+-rw-r--r--   0 runner    (1001) docker     (127)      424 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/documentation/rasterorigin.txt.json
+-rw-r--r--   0 runner    (1001) docker     (127)     1009 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/documentation/sensor1.inp.json
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-04-12 23:40:38.732594 quicfire-tools-0.7.1/quicfire_tools/data/templates/
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-04-12 23:40:38.740594 quicfire-tools-0.7.1/quicfire_tools/data/templates/v5/
+-rwxr-xr-x   0 runner    (1001) docker     (127)     1189 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/templates/v5/QFire_Advanced_User_Inputs.inp
+-rwxr-xr-x   0 runner    (1001) docker     (127)      812 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/templates/v5/QFire_Bldg_Advanced_User_Inputs.inp
+-rwxr-xr-x   0 runner    (1001) docker     (127)     1459 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/templates/v5/QFire_Plume_Advanced_User_Inputs.inp
+-rwxr-xr-x   0 runner    (1001) docker     (127)       94 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/templates/v5/QP_buildout.inp
+-rw-r--r--   0 runner    (1001) docker     (127)     2535 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/templates/v5/QUIC_fire.inp
+-rw-r--r--   0 runner    (1001) docker     (127)      587 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/templates/v5/QU_TopoInputs.inp
+-rwxr-xr-x   0 runner    (1001) docker     (127)      167 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/templates/v5/QU_buildings.inp
+-rwxr-xr-x   0 runner    (1001) docker     (127)      437 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/templates/v5/QU_fileoptions.inp
+-rwxr-xr-x   0 runner    (1001) docker     (127)       20 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/templates/v5/QU_landuse.inp
+-rw-r--r--   0 runner    (1001) docker     (127)      161 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/templates/v5/QU_metparams.inp
+-rw-r--r--   0 runner    (1001) docker     (127)      494 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/templates/v5/QU_movingcoords.inp
+-rwxr-xr-x   0 runner    (1001) docker     (127)     1567 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/templates/v5/QU_simparams.inp
+-rwxr-xr-x   0 runner    (1001) docker     (127)      111 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/templates/v5/Runtime_Advanced_User_Inputs.inp
+-rw-r--r--   0 runner    (1001) docker     (127)       45 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/templates/v5/gridlist
+-rw-r--r--   0 runner    (1001) docker     (127)       88 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/templates/v5/rasterorigin.txt
+-rw-r--r--   0 runner    (1001) docker     (127)      178 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/templates/v5/sensor.inp
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-04-12 23:40:38.744594 quicfire-tools-0.7.1/quicfire_tools/data/templates/v6/
+-rwxr-xr-x   0 runner    (1001) docker     (127)     1189 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/templates/v6/QFire_Advanced_User_Inputs.inp
+-rwxr-xr-x   0 runner    (1001) docker     (127)      812 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/templates/v6/QFire_Bldg_Advanced_User_Inputs.inp
+-rwxr-xr-x   0 runner    (1001) docker     (127)     1459 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/templates/v6/QFire_Plume_Advanced_User_Inputs.inp
+-rwxr-xr-x   0 runner    (1001) docker     (127)       94 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/templates/v6/QP_buildout.inp
+-rw-r--r--   0 runner    (1001) docker     (127)     2574 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/templates/v6/QUIC_fire.inp
+-rw-r--r--   0 runner    (1001) docker     (127)      587 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/templates/v6/QU_TopoInputs.inp
+-rwxr-xr-x   0 runner    (1001) docker     (127)      167 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/templates/v6/QU_buildings.inp
+-rwxr-xr-x   0 runner    (1001) docker     (127)      437 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/templates/v6/QU_fileoptions.inp
+-rwxr-xr-x   0 runner    (1001) docker     (127)       20 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/templates/v6/QU_landuse.inp
+-rw-r--r--   0 runner    (1001) docker     (127)      161 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/templates/v6/QU_metparams.inp
+-rw-r--r--   0 runner    (1001) docker     (127)      494 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/templates/v6/QU_movingcoords.inp
+-rwxr-xr-x   0 runner    (1001) docker     (127)     1567 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/templates/v6/QU_simparams.inp
+-rwxr-xr-x   0 runner    (1001) docker     (127)      111 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/templates/v6/Runtime_Advanced_User_Inputs.inp
+-rw-r--r--   0 runner    (1001) docker     (127)       45 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/templates/v6/gridlist
+-rw-r--r--   0 runner    (1001) docker     (127)       88 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/templates/v6/rasterorigin.txt
+-rw-r--r--   0 runner    (1001) docker     (127)      178 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/data/templates/v6/sensor.inp
+-rw-r--r--   0 runner    (1001) docker     (127)     5305 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/ignitions.py
+-rw-r--r--   0 runner    (1001) docker     (127)   124673 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/inputs.py
+-rw-r--r--   0 runner    (1001) docker     (127)    37375 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/outputs.py
+-rw-r--r--   0 runner    (1001) docker     (127)     7406 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/topography.py
+-rw-r--r--   0 runner    (1001) docker     (127)     3187 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/quicfire_tools/utils.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-04-12 23:40:38.744594 quicfire-tools-0.7.1/quicfire_tools.egg-info/
+-rw-r--r--   0 runner    (1001) docker     (127)     2173 2024-04-12 23:40:38.000000 quicfire-tools-0.7.1/quicfire_tools.egg-info/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (127)     3235 2024-04-12 23:40:38.000000 quicfire-tools-0.7.1/quicfire_tools.egg-info/SOURCES.txt
+-rw-r--r--   0 runner    (1001) docker     (127)        1 2024-04-12 23:40:38.000000 quicfire-tools-0.7.1/quicfire_tools.egg-info/dependency_links.txt
+-rw-r--r--   0 runner    (1001) docker     (127)       66 2024-04-12 23:40:38.000000 quicfire-tools-0.7.1/quicfire_tools.egg-info/requires.txt
+-rw-r--r--   0 runner    (1001) docker     (127)       15 2024-04-12 23:40:38.000000 quicfire-tools-0.7.1/quicfire_tools.egg-info/top_level.txt
+-rw-r--r--   0 runner    (1001) docker     (127)       38 2024-04-12 23:40:38.744594 quicfire-tools-0.7.1/setup.cfg
+-rw-r--r--   0 runner    (1001) docker     (127)     2142 2024-04-12 23:40:29.000000 quicfire-tools-0.7.1/setup.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-04-12 23:40:38.744594 quicfire-tools-0.7.1/tests/
+-rw-r--r--   0 runner    (1001) docker     (127)   111955 2024-04-12 23:40:30.000000 quicfire-tools-0.7.1/tests/test_inputs.py
+-rw-r--r--   0 runner    (1001) docker     (127)    38916 2024-04-12 23:40:30.000000 quicfire-tools-0.7.1/tests/test_outputs.py
```

### Comparing `quicfire-tools-0.6.4/LICENSE` & `quicfire-tools-0.7.1/LICENSE`

 * *Files identical despite different names*

### Comparing `quicfire-tools-0.6.4/PKG-INFO` & `quicfire-tools-0.7.1/PKG-INFO`

 * *Files 12% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: quicfire-tools
-Version: 0.6.4
+Version: 0.7.1
 Summary: Input and output management tools for the QUIC-Fire fire model
 Home-page: https://github.com/silvxlabs/quicfire-tools
 License: MIT
 Project-URL: Bug Tracker, https://github.com/silvxlabs/quicfire-tools/issues
 Classifier: Intended Audience :: Developers
 Classifier: Intended Audience :: Science/Research
 Classifier: License :: OSI Approved :: MIT License
@@ -15,17 +15,20 @@
 Classifier: Programming Language :: Python :: 3.11
 Classifier: Programming Language :: Python :: 3.12
 Classifier: Topic :: Scientific/Engineering
 Requires-Python: >=3.8
 Description-Content-Type: text/markdown
 License-File: LICENSE
 Requires-Dist: dask
+Requires-Dist: dask-expr
+Requires-Dist: netCDF4
 Requires-Dist: numpy<2
 Requires-Dist: pandera
 Requires-Dist: pydantic>=2
+Requires-Dist: pyproj
 Requires-Dist: zarr>=2
 
 # quicfire-tools
 
 ## Quick-Links
 
 [Documentation](https://silvxlabs.github.io/quicfire-tools/) - [PyPi Package](https://pypi.org/project/quicfire-tools/)
```

### Comparing `quicfire-tools-0.6.4/README.md` & `quicfire-tools-0.7.1/README.md`

 * *Files identical despite different names*

### Comparing `quicfire-tools-0.6.4/quicfire_tools/data/documentation/IgnitionType.json` & `quicfire-tools-0.7.1/quicfire_tools/data/documentation/IgnitionType.json`

 * *Files identical despite different names*

### Comparing `quicfire-tools-0.6.4/quicfire_tools/data/documentation/QFire_Advanced_User_Inputs.inp.json` & `quicfire-tools-0.7.1/quicfire_tools/data/documentation/QFire_Advanced_User_Inputs.inp.json`

 * *Files identical despite different names*

### Comparing `quicfire-tools-0.6.4/quicfire_tools/data/documentation/QFire_Bldg_Advanced_User_Inputs.inp.json` & `quicfire-tools-0.7.1/quicfire_tools/data/documentation/QFire_Bldg_Advanced_User_Inputs.inp.json`

 * *Files identical despite different names*

### Comparing `quicfire-tools-0.6.4/quicfire_tools/data/documentation/QFire_Plume_Advanced_User_Inputs.inp.json` & `quicfire-tools-0.7.1/quicfire_tools/data/documentation/QFire_Plume_Advanced_User_Inputs.inp.json`

 * *Files identical despite different names*

### Comparing `quicfire-tools-0.6.4/quicfire_tools/data/documentation/QUIC_fire.inp.json` & `quicfire-tools-0.7.1/quicfire_tools/data/documentation/QUIC_fire.inp.json`

 * *Files identical despite different names*

### Comparing `quicfire-tools-0.6.4/quicfire_tools/data/documentation/QU_TopoInputs.inp.json` & `quicfire-tools-0.7.1/quicfire_tools/data/documentation/QU_TopoInputs.inp.json`

 * *Files identical despite different names*

### Comparing `quicfire-tools-0.6.4/quicfire_tools/data/documentation/QU_buildings.inp.json` & `quicfire-tools-0.7.1/quicfire_tools/data/documentation/QU_buildings.inp.json`

 * *Files identical despite different names*

### Comparing `quicfire-tools-0.6.4/quicfire_tools/data/documentation/QU_fileoptions.inp.json` & `quicfire-tools-0.7.1/quicfire_tools/data/documentation/QU_fileoptions.inp.json`

 * *Files identical despite different names*

### Comparing `quicfire-tools-0.6.4/quicfire_tools/data/documentation/QU_simparams.inp.json` & `quicfire-tools-0.7.1/quicfire_tools/data/documentation/QU_simparams.inp.json`

 * *Files identical despite different names*

### Comparing `quicfire-tools-0.6.4/quicfire_tools/data/documentation/TopoType.json` & `quicfire-tools-0.7.1/quicfire_tools/data/documentation/TopoType.json`

 * *Files identical despite different names*

### Comparing `quicfire-tools-0.6.4/quicfire_tools/data/documentation/gridlist.json` & `quicfire-tools-0.7.1/quicfire_tools/data/documentation/gridlist.json`

 * *Files identical despite different names*

### Comparing `quicfire-tools-0.6.4/quicfire_tools/data/documentation/sensor1.inp.json` & `quicfire-tools-0.7.1/quicfire_tools/data/documentation/sensor1.inp.json`

 * *Files identical despite different names*

### Comparing `quicfire-tools-0.6.4/quicfire_tools/data/templates/v5/QFire_Advanced_User_Inputs.inp` & `quicfire-tools-0.7.1/quicfire_tools/data/templates/v5/QFire_Advanced_User_Inputs.inp`

 * *Files identical despite different names*

### Comparing `quicfire-tools-0.6.4/quicfire_tools/data/templates/v5/QFire_Bldg_Advanced_User_Inputs.inp` & `quicfire-tools-0.7.1/quicfire_tools/data/templates/v5/QFire_Bldg_Advanced_User_Inputs.inp`

 * *Files identical despite different names*

### Comparing `quicfire-tools-0.6.4/quicfire_tools/data/templates/v5/QFire_Plume_Advanced_User_Inputs.inp` & `quicfire-tools-0.7.1/quicfire_tools/data/templates/v5/QFire_Plume_Advanced_User_Inputs.inp`

 * *Files identical despite different names*

### Comparing `quicfire-tools-0.6.4/quicfire_tools/data/templates/v5/QUIC_fire.inp` & `quicfire-tools-0.7.1/quicfire_tools/data/templates/v5/QUIC_fire.inp`

 * *Files identical despite different names*

### Comparing `quicfire-tools-0.6.4/quicfire_tools/data/templates/v5/QU_TopoInputs.inp` & `quicfire-tools-0.7.1/quicfire_tools/data/templates/v5/QU_TopoInputs.inp`

 * *Files identical despite different names*

### Comparing `quicfire-tools-0.6.4/quicfire_tools/data/templates/v5/QU_simparams.inp` & `quicfire-tools-0.7.1/quicfire_tools/data/templates/v5/QU_simparams.inp`

 * *Files identical despite different names*

### Comparing `quicfire-tools-0.6.4/quicfire_tools/data/templates/v6/QFire_Advanced_User_Inputs.inp` & `quicfire-tools-0.7.1/quicfire_tools/data/templates/v6/QFire_Advanced_User_Inputs.inp`

 * *Files identical despite different names*

### Comparing `quicfire-tools-0.6.4/quicfire_tools/data/templates/v6/QFire_Bldg_Advanced_User_Inputs.inp` & `quicfire-tools-0.7.1/quicfire_tools/data/templates/v6/QFire_Bldg_Advanced_User_Inputs.inp`

 * *Files identical despite different names*

### Comparing `quicfire-tools-0.6.4/quicfire_tools/data/templates/v6/QFire_Plume_Advanced_User_Inputs.inp` & `quicfire-tools-0.7.1/quicfire_tools/data/templates/v6/QFire_Plume_Advanced_User_Inputs.inp`

 * *Files identical despite different names*

### Comparing `quicfire-tools-0.6.4/quicfire_tools/data/templates/v6/QUIC_fire.inp` & `quicfire-tools-0.7.1/quicfire_tools/data/templates/v6/QUIC_fire.inp`

 * *Files identical despite different names*

### Comparing `quicfire-tools-0.6.4/quicfire_tools/data/templates/v6/QU_TopoInputs.inp` & `quicfire-tools-0.7.1/quicfire_tools/data/templates/v6/QU_TopoInputs.inp`

 * *Files identical despite different names*

### Comparing `quicfire-tools-0.6.4/quicfire_tools/data/templates/v6/QU_simparams.inp` & `quicfire-tools-0.7.1/quicfire_tools/data/templates/v6/QU_simparams.inp`

 * *Files identical despite different names*

### Comparing `quicfire-tools-0.6.4/quicfire_tools/ignitions.py` & `quicfire-tools-0.7.1/quicfire_tools/ignitions.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,49 +1,50 @@
 """
 QUIC-Fire Tools Ignitions Module
 """
+
 from __future__ import annotations
 
 # Core Imports
 from enum import Enum
 
 # External Imports
 from pydantic import BaseModel
 
 
-class IgnitionSources(int, Enum):
+class IgnitionFlags(int, Enum):
     """
     Enum class for all valid ignition source options in QUIC-Fire.
     """
 
     rectangle = 1
     square_ring = 2
     circular_ring = 3
     ignite_dat_file = 7
 
 
-class IgnitionType(BaseModel):
+class Ignition(BaseModel):
     """
     Base class for all ignition types in QUIC-Fire. This class is used to
     provide a common string representation for all ignition types.
     """
 
-    ignition_flag: IgnitionSources
+    ignition_flag: IgnitionFlags
 
     def __str__(self):
         return (
             f"{self.ignition_flag.value}\t! 1 = rectangle, "
             f"2 = square ring, 3 = circular ring, "
             f"4 = file (QF_Ignitions.inp), "
             f"5 = time-dependent ignitions (QF_IgnitionPattern.inp), "
             f"7 = ignite.dat (firetech)"
         )
 
 
-class RectangleIgnition(IgnitionType):
+class RectangleIgnition(Ignition):
     """
     Represents a rectangle ignition source in QUIC-Fire.
 
     Attributes
     ----------
     x_min : float
         South-west corner in the x-direction [m]
@@ -51,15 +52,15 @@
         South-west corner in the y-direction [m]
     x_length : float
         Length in the x-direction [m]
     y_length : float
         Length in the y-direction [m]
     """
 
-    ignition_flag: IgnitionSources = IgnitionSources(1)
+    ignition_flag: IgnitionFlags = IgnitionFlags(1)
     x_min: float
     y_min: float
     x_length: float
     y_length: float
 
     def __str__(self):
         flag_line = super().__str__()
@@ -68,15 +69,15 @@
             f"{self.y_min}\t! South-west corner in the y-direction\n"
             f"{self.x_length}\t! Length in the x-direction\n"
             f"{self.y_length}\t! Length in the y-direction"
         )
         return flag_line + locations
 
 
-class SquareRingIgnition(IgnitionType):
+class SquareRingIgnition(Ignition):
     """
     Represents a square ring ignition source in QUIC-Fire.
 
     Attributes
     ----------
     x_min : float
         South-west corner in the x-direction [m]
@@ -88,15 +89,15 @@
         Length in the y-direction [m]
     x_width : float
         Width in the x-direction [m]
     y_width : float
         Width in the y-direction [m]
     """
 
-    ignition_flag: IgnitionSources = IgnitionSources(2)
+    ignition_flag: IgnitionFlags = IgnitionFlags(2)
     x_min: float
     y_min: float
     x_length: float
     y_length: float
     x_width: float
     y_width: float
 
@@ -109,15 +110,15 @@
             f"{self.y_length}\t! Length in the y-direction\n"
             f"{self.x_width}\t! Width in the x-direction\n"
             f"{self.y_width}\t! Width in the y-direction"
         )
         return flag_line + locations
 
 
-class CircularRingIgnition(IgnitionType):
+class CircularRingIgnition(Ignition):
     """
     Represents a circular ring ignition source in QUIC-Fire.
 
     Attributes
     ----------
     x_min : float
         South-west corner in the x-direction [m]
@@ -127,15 +128,15 @@
         Length in the x-direction [m]
     y_length : float
         Length in the y-direction [m]
     ring_width : float
         Width of the ring [m]
     """
 
-    ignition_flag: IgnitionSources = IgnitionSources(3)
+    ignition_flag: IgnitionFlags = IgnitionFlags(3)
     x_min: float
     y_min: float
     x_length: float
     y_length: float
     ring_width: float
 
     def __str__(self):
@@ -172,7 +173,19 @@
         y_min = (0.9 * (nx * 2)) - width
         x_length = 0.8 * (nx * 2)
         y_length = width
 
     return RectangleIgnition(
         x_min=x_min, y_min=y_min, x_length=x_length, y_length=y_length
     )
+
+
+def serialize_ignition(ignition_data: dict):
+    ignition_flag = ignition_data.get("ignition_flag")
+    if ignition_flag == IgnitionFlags(1):
+        return RectangleIgnition(**ignition_data)
+    elif ignition_flag == IgnitionFlags(2):
+        return SquareRingIgnition(**ignition_data)
+    elif ignition_flag == IgnitionFlags(3):
+        return CircularRingIgnition(**ignition_data)
+    else:
+        return Ignition(**ignition_data)
```

### Comparing `quicfire-tools-0.6.4/quicfire_tools/inputs.py` & `quicfire-tools-0.7.1/quicfire_tools/inputs.py`

 * *Files 4% similar despite different names*

```diff
@@ -35,7398 +35,7759 @@
 00000220: 5f66 6965 6c64 2c0a 2020 2020 6669 656c  _field,.    fiel
 00000230: 645f 7661 6c69 6461 746f 722c 0a20 2020  d_validator,.   
 00000240: 2053 6572 6961 6c69 7a65 4173 416e 792c   SerializeAsAny,
 00000250: 0a29 0a0a 2320 496e 7465 726e 616c 2069  .)..# Internal i
 00000260: 6d70 6f72 7473 0a66 726f 6d20 7175 6963  mports.from quic
 00000270: 6669 7265 5f74 6f6f 6c73 2e69 676e 6974  fire_tools.ignit
 00000280: 696f 6e73 2069 6d70 6f72 7420 280a 2020  ions import (.  
-00000290: 2020 4967 6e69 7469 6f6e 536f 7572 6365    IgnitionSource
-000002a0: 732c 0a20 2020 2043 6972 6375 6c61 7252  s,.    CircularR
-000002b0: 696e 6749 676e 6974 696f 6e2c 0a20 2020  ingIgnition,.   
-000002c0: 2049 676e 6974 696f 6e54 7970 652c 0a20   IgnitionType,. 
-000002d0: 2020 2052 6563 7461 6e67 6c65 4967 6e69     RectangleIgni
-000002e0: 7469 6f6e 2c0a 2020 2020 5371 7561 7265  tion,.    Square
-000002f0: 5269 6e67 4967 6e69 7469 6f6e 2c0a 2020  RingIgnition,.  
-00000300: 2020 6465 6661 756c 745f 6c69 6e65 5f69    default_line_i
-00000310: 676e 6974 696f 6e2c 0a29 0a66 726f 6d20  gnition,.).from 
-00000320: 7175 6963 6669 7265 5f74 6f6f 6c73 2e74  quicfire_tools.t
-00000330: 6f70 6f67 7261 7068 7920 696d 706f 7274  opography import
-00000340: 2028 0a20 2020 2054 6f70 6f53 6f75 7263   (.    TopoSourc
-00000350: 6573 2c0a 2020 2020 4361 6e79 6f6e 546f  es,.    CanyonTo
-00000360: 706f 2c0a 2020 2020 436f 7348 696c 6c54  po,.    CosHillT
-00000370: 6f70 6f2c 0a20 2020 2047 6175 7373 6961  opo,.    Gaussia
-00000380: 6e48 696c 6c54 6f70 6f2c 0a20 2020 2048  nHillTopo,.    H
-00000390: 616c 6643 6972 636c 6554 6f70 6f2c 0a20  alfCircleTopo,. 
-000003a0: 2020 2048 696c 6c50 6173 7354 6f70 6f2c     HillPassTopo,
-000003b0: 0a20 2020 2053 696e 7573 6f69 6454 6f70  .    SinusoidTop
-000003c0: 6f2c 0a20 2020 2053 6c6f 7065 4d65 7361  o,.    SlopeMesa
-000003d0: 546f 706f 2c0a 2020 2020 546f 706f 5479  Topo,.    TopoTy
-000003e0: 7065 2c0a 290a 6672 6f6d 2071 7569 6366  pe,.).from quicf
-000003f0: 6972 655f 746f 6f6c 732e 7574 696c 7320  ire_tools.utils 
-00000400: 696d 706f 7274 2063 6f6d 7075 7465 5f70  import compute_p
-00000410: 6172 6162 6f6c 6963 5f73 7472 6574 6368  arabolic_stretch
-00000420: 6564 5f67 7269 640a 0a0a 444f 4353 5f50  ed_grid...DOCS_P
-00000430: 4154 4820 3d20 280a 2020 2020 696d 706f  ATH = (.    impo
-00000440: 7274 6c69 622e 7265 736f 7572 6365 732e  rtlib.resources.
-00000450: 6669 6c65 7328 2271 7569 6366 6972 655f  files("quicfire_
-00000460: 746f 6f6c 7322 290a 2020 2020 2e6a 6f69  tools").    .joi
-00000470: 6e70 6174 6828 2264 6174 6122 290a 2020  npath("data").  
-00000480: 2020 2e6a 6f69 6e70 6174 6828 2264 6f63    .joinpath("doc
-00000490: 756d 656e 7461 7469 6f6e 2229 0a29 0a54  umentation").).T
-000004a0: 454d 504c 4154 4553 5f50 4154 4820 3d20  EMPLATES_PATH = 
-000004b0: 280a 2020 2020 696d 706f 7274 6c69 622e  (.    importlib.
-000004c0: 7265 736f 7572 6365 732e 6669 6c65 7328  resources.files(
-000004d0: 2271 7569 6366 6972 655f 746f 6f6c 7322  "quicfire_tools"
-000004e0: 292e 6a6f 696e 7061 7468 2822 6461 7461  ).joinpath("data
-000004f0: 2229 2e6a 6f69 6e70 6174 6828 2274 656d  ").joinpath("tem
-00000500: 706c 6174 6573 2229 0a29 0a0a 4c41 5445  plates").)..LATE
-00000510: 5354 5f56 4552 5349 4f4e 203d 2022 7636  ST_VERSION = "v6
-00000520: 220a 0a0a 636c 6173 7320 5369 6d75 6c61  "...class Simula
-00000530: 7469 6f6e 496e 7075 7473 3a0a 2020 2020  tionInputs:.    
-00000540: 2222 220a 2020 2020 436c 6173 7320 7265  """.    Class re
-00000550: 7072 6573 656e 7469 6e67 2061 2051 5549  presenting a QUI
-00000560: 432d 4669 7265 2069 6e70 7574 2066 696c  C-Fire input fil
-00000570: 6520 6465 636b 2e20 5468 6973 2063 6c61  e deck. This cla
-00000580: 7373 2069 7320 7468 6520 7072 696d 6172  ss is the primar
-00000590: 790a 2020 2020 696e 7465 7266 6163 6520  y.    interface 
-000005a0: 666f 7220 6275 696c 6469 6e67 2061 2051  for building a Q
-000005b0: 5549 432d 4669 7265 2069 6e70 7574 2066  UIC-Fire input f
-000005c0: 696c 6520 6465 636b 2061 6e64 2073 6176  ile deck and sav
-000005d0: 696e 6720 7468 6520 696e 7075 740a 2020  ing the input.  
-000005e0: 2020 6669 6c65 7320 746f 2061 2064 6972    files to a dir
-000005f0: 6563 746f 7279 2066 6f72 2072 756e 6e69  ectory for runni
-00000600: 6e67 2061 2073 696d 756c 6174 696f 6e2e  ng a simulation.
-00000610: 0a0a 2020 2020 4174 7472 6962 7574 6573  ..    Attributes
-00000620: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
-00000630: 2020 2020 7261 7374 6572 6f72 6967 696e      rasterorigin
-00000640: 3a20 5261 7374 6572 4f72 6967 696e 0a20  : RasterOrigin. 
-00000650: 2020 2020 2020 204f 626a 6563 7420 7265         Object re
-00000660: 7072 6573 656e 7469 6e67 2074 6865 2072  presenting the r
-00000670: 6173 7465 726f 7269 6769 6e2e 7478 7420  asterorigin.txt 
-00000680: 6669 6c65 2e0a 2020 2020 7175 5f62 7569  file..    qu_bui
-00000690: 6c64 696e 6773 3a20 5155 5f42 7569 6c64  ldings: QU_Build
-000006a0: 696e 6773 0a20 2020 2020 2020 204f 626a  ings.        Obj
-000006b0: 6563 7420 7265 7072 6573 656e 7469 6e67  ect representing
-000006c0: 2074 6865 2051 555f 6275 696c 6469 6e67   the QU_building
-000006d0: 732e 696e 7020 6669 6c65 2e0a 2020 2020  s.inp file..    
-000006e0: 7175 5f66 696c 656f 7074 696f 6e73 3a20  qu_fileoptions: 
-000006f0: 5155 5f46 696c 656f 7074 696f 6e73 0a20  QU_Fileoptions. 
-00000700: 2020 2020 2020 204f 626a 6563 7420 7265         Object re
-00000710: 7072 6573 656e 7469 6e67 2074 6865 2051  presenting the Q
-00000720: 555f 6669 6c65 6f70 7469 6f6e 732e 696e  U_fileoptions.in
-00000730: 7020 6669 6c65 2e0a 2020 2020 7166 6972  p file..    qfir
-00000740: 655f 6164 7661 6e63 6564 5f75 7365 725f  e_advanced_user_
-00000750: 696e 7075 7473 3a20 5146 6972 655f 4164  inputs: QFire_Ad
-00000760: 7661 6e63 6564 5f55 7365 725f 496e 7075  vanced_User_Inpu
-00000770: 7473 0a20 2020 2020 2020 204f 626a 6563  ts.        Objec
-00000780: 7420 7265 7072 6573 656e 7469 6e67 2074  t representing t
-00000790: 6865 2071 6669 7265 5f61 6476 616e 6365  he qfire_advance
-000007a0: 645f 7573 6572 5f69 6e70 7574 732e 696e  d_user_inputs.in
-000007b0: 7020 6669 6c65 2e0a 2020 2020 7166 6972  p file..    qfir
-000007c0: 655f 626c 6467 5f61 6476 616e 6365 645f  e_bldg_advanced_
-000007d0: 7573 6572 5f69 6e70 7574 733a 2051 4669  user_inputs: QFi
-000007e0: 7265 5f42 6c64 675f 4164 7661 6e63 6564  re_Bldg_Advanced
-000007f0: 5f55 7365 725f 496e 7075 7473 0a20 2020  _User_Inputs.   
-00000800: 2020 2020 204f 626a 6563 7420 7265 7072       Object repr
-00000810: 6573 656e 7469 6e67 2074 6865 2071 6669  esenting the qfi
-00000820: 7265 5f62 6c64 675f 6164 7661 6e63 6564  re_bldg_advanced
-00000830: 5f75 7365 725f 696e 7075 7473 2e69 6e70  _user_inputs.inp
-00000840: 2066 696c 652e 0a20 2020 2071 6669 7265   file..    qfire
-00000850: 5f70 6c75 6d65 5f61 6476 616e 6365 645f  _plume_advanced_
-00000860: 7573 6572 5f69 6e70 7574 733a 2051 4669  user_inputs: QFi
-00000870: 7265 5f50 6c75 6d65 5f41 6476 616e 6365  re_Plume_Advance
-00000880: 645f 5573 6572 5f49 6e70 7574 730a 2020  d_User_Inputs.  
-00000890: 2020 2020 2020 4f62 6a65 6374 2072 6570        Object rep
-000008a0: 7265 7365 6e74 696e 6720 7468 6520 7166  resenting the qf
-000008b0: 6972 655f 706c 756d 655f 6164 7661 6e63  ire_plume_advanc
-000008c0: 6564 5f75 7365 725f 696e 7075 7473 2e69  ed_user_inputs.i
-000008d0: 6e70 2066 696c 652e 0a20 2020 2072 756e  np file..    run
-000008e0: 7469 6d65 5f61 6476 616e 6365 645f 7573  time_advanced_us
-000008f0: 6572 5f69 6e70 7574 733a 2052 756e 7469  er_inputs: Runti
-00000900: 6d65 4164 7661 6e63 6564 5573 6572 496e  meAdvancedUserIn
-00000910: 7075 7473 0a20 2020 2020 2020 204f 626a  puts.        Obj
-00000920: 6563 7420 7265 7072 6573 656e 7469 6e67  ect representing
-00000930: 2074 6865 2072 756e 7469 6d65 5f61 6476   the runtime_adv
-00000940: 616e 6365 645f 7573 6572 5f69 6e70 7574  anced_user_input
-00000950: 732e 696e 7020 6669 6c65 2e0a 2020 2020  s.inp file..    
-00000960: 7175 5f6d 6f76 696e 6763 6f6f 7264 733a  qu_movingcoords:
-00000970: 2051 555f 6d6f 7669 6e67 636f 6f72 6473   QU_movingcoords
-00000980: 0a20 2020 2020 2020 204f 626a 6563 7420  .        Object 
-00000990: 7265 7072 6573 656e 7469 6e67 2074 6865  representing the
-000009a0: 2051 555f 6d6f 7669 6e67 636f 6f72 6473   QU_movingcoords
-000009b0: 2e69 6e70 2066 696c 652e 0a20 2020 2071  .inp file..    q
-000009c0: 705f 6275 696c 646f 7574 3a20 5150 5f62  p_buildout: QP_b
-000009d0: 7569 6c64 6f75 740a 2020 2020 2020 2020  uildout.        
-000009e0: 4f62 6a65 6374 2072 6570 7265 7365 6e74  Object represent
-000009f0: 696e 6720 7468 6520 7170 5f62 7569 6c64  ing the qp_build
-00000a00: 6f75 742e 696e 7020 6669 6c65 2e0a 2020  out.inp file..  
-00000a10: 2020 7175 5f6d 6574 7061 7261 6d73 3a20    qu_metparams: 
-00000a20: 5155 5f6d 6574 7061 7261 6d73 0a20 2020  QU_metparams.   
-00000a30: 2020 2020 204f 626a 6563 7420 7265 7072       Object repr
-00000a40: 6573 656e 7469 6e67 2074 6865 2051 555f  esenting the QU_
-00000a50: 6d65 7470 6172 616d 732e 696e 7020 6669  metparams.inp fi
-00000a60: 6c65 2e0a 2020 2020 7175 6963 5f66 6972  le..    quic_fir
-00000a70: 653a 2051 5549 435f 6669 7265 0a20 2020  e: QUIC_fire.   
-00000a80: 2020 2020 204f 626a 6563 7420 7265 7072       Object repr
-00000a90: 6573 656e 7469 6e67 2074 6865 2051 5549  esenting the QUI
-00000aa0: 435f 6669 7265 2e69 6e70 2066 696c 652e  C_fire.inp file.
-00000ab0: 0a20 2020 2067 7269 646c 6973 743a 2047  .    gridlist: G
-00000ac0: 7269 646c 6973 740a 2020 2020 2020 2020  ridlist.        
-00000ad0: 4f62 6a65 6374 2072 6570 7265 7365 6e74  Object represent
-00000ae0: 696e 6720 7468 6520 6772 6964 6c69 7374  ing the gridlist
-00000af0: 2e74 7874 2066 696c 652e 0a20 2020 2077  .txt file..    w
-00000b00: 696e 6473 656e 736f 723a 2064 6963 745b  indsensor: dict[
-00000b10: 7374 722c 2057 696e 6453 656e 736f 725d  str, WindSensor]
-00000b20: 0a20 2020 2020 2020 204f 626a 6563 7420  .        Object 
-00000b30: 7265 7072 6573 656e 7469 6e67 2074 6865  representing the
-00000b40: 2061 6c6c 2077 696e 6420 7365 6e73 6f72   all wind sensor
-00000b50: 2069 6e70 7574 2066 696c 6573 2c20 652e   input files, e.
-00000b60: 672e 2073 656e 736f 7231 2e69 6e70 2e0a  g. sensor1.inp..
-00000b70: 2020 2020 7175 5f74 6f70 6f69 6e70 7574      qu_topoinput
-00000b80: 733a 2051 555f 546f 706f 496e 7075 7473  s: QU_TopoInputs
-00000b90: 0a20 2020 2020 2020 204f 626a 6563 7420  .        Object 
-00000ba0: 7265 7072 6573 656e 7469 6e67 2074 6865  representing the
-00000bb0: 2051 555f 746f 706f 696e 7075 7473 2e69   QU_topoinputs.i
-00000bc0: 6e70 2066 696c 652e 0a20 2020 2071 755f  np file..    qu_
-00000bd0: 7369 6d70 6172 616d 733a 2051 555f 5369  simparams: QU_Si
-00000be0: 6d70 6172 616d 730a 2020 2020 2020 2020  mparams.        
-00000bf0: 4f62 6a65 6374 2072 6570 7265 7365 6e74  Object represent
-00000c00: 696e 6720 7468 6520 5155 5f73 696d 7061  ing the QU_simpa
-00000c10: 7261 6d73 2e69 6e70 2066 696c 652e 0a20  rams.inp file.. 
-00000c20: 2020 2022 2222 0a0a 2020 2020 6465 6620     """..    def 
-00000c30: 5f5f 696e 6974 5f5f 280a 2020 2020 2020  __init__(.      
-00000c40: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00000c50: 7261 7374 6572 6f72 6967 696e 3a20 5261  rasterorigin: Ra
-00000c60: 7374 6572 4f72 6967 696e 2c0a 2020 2020  sterOrigin,.    
-00000c70: 2020 2020 7175 5f62 7569 6c64 696e 6773      qu_buildings
-00000c80: 3a20 5155 5f42 7569 6c64 696e 6773 2c0a  : QU_Buildings,.
-00000c90: 2020 2020 2020 2020 7175 5f66 696c 656f          qu_fileo
-00000ca0: 7074 696f 6e73 3a20 5155 5f46 696c 656f  ptions: QU_Fileo
-00000cb0: 7074 696f 6e73 2c0a 2020 2020 2020 2020  ptions,.        
-00000cc0: 7166 6972 655f 6164 7661 6e63 6564 5f75  qfire_advanced_u
-00000cd0: 7365 725f 696e 7075 7473 3a20 5146 6972  ser_inputs: QFir
-00000ce0: 655f 4164 7661 6e63 6564 5f55 7365 725f  e_Advanced_User_
-00000cf0: 496e 7075 7473 2c0a 2020 2020 2020 2020  Inputs,.        
-00000d00: 7166 6972 655f 626c 6467 5f61 6476 616e  qfire_bldg_advan
-00000d10: 6365 645f 7573 6572 5f69 6e70 7574 733a  ced_user_inputs:
-00000d20: 2051 4669 7265 5f42 6c64 675f 4164 7661   QFire_Bldg_Adva
-00000d30: 6e63 6564 5f55 7365 725f 496e 7075 7473  nced_User_Inputs
-00000d40: 2c0a 2020 2020 2020 2020 7166 6972 655f  ,.        qfire_
-00000d50: 706c 756d 655f 6164 7661 6e63 6564 5f75  plume_advanced_u
-00000d60: 7365 725f 696e 7075 7473 3a20 5146 6972  ser_inputs: QFir
-00000d70: 655f 506c 756d 655f 4164 7661 6e63 6564  e_Plume_Advanced
-00000d80: 5f55 7365 725f 496e 7075 7473 2c0a 2020  _User_Inputs,.  
-00000d90: 2020 2020 2020 7275 6e74 696d 655f 6164        runtime_ad
-00000da0: 7661 6e63 6564 5f75 7365 725f 696e 7075  vanced_user_inpu
-00000db0: 7473 3a20 5275 6e74 696d 6541 6476 616e  ts: RuntimeAdvan
-00000dc0: 6365 6455 7365 7249 6e70 7574 732c 0a20  cedUserInputs,. 
-00000dd0: 2020 2020 2020 2071 755f 6d6f 7669 6e67         qu_moving
-00000de0: 636f 6f72 6473 3a20 5155 5f6d 6f76 696e  coords: QU_movin
-00000df0: 6763 6f6f 7264 732c 0a20 2020 2020 2020  gcoords,.       
-00000e00: 2071 705f 6275 696c 646f 7574 3a20 5150   qp_buildout: QP
-00000e10: 5f62 7569 6c64 6f75 742c 0a20 2020 2020  _buildout,.     
-00000e20: 2020 2071 755f 6d65 7470 6172 616d 733a     qu_metparams:
-00000e30: 2051 555f 6d65 7470 6172 616d 732c 0a20   QU_metparams,. 
-00000e40: 2020 2020 2020 2071 7569 635f 6669 7265         quic_fire
-00000e50: 3a20 5155 4943 5f66 6972 652c 0a20 2020  : QUIC_fire,.   
-00000e60: 2020 2020 2067 7269 646c 6973 743a 2047       gridlist: G
-00000e70: 7269 646c 6973 742c 0a20 2020 2020 2020  ridlist,.       
-00000e80: 2077 696e 6473 656e 736f 7273 3a20 5769   windsensors: Wi
-00000e90: 6e64 5365 6e73 6f72 4172 7261 792c 0a20  ndSensorArray,. 
-00000ea0: 2020 2020 2020 2071 755f 746f 706f 696e         qu_topoin
-00000eb0: 7075 7473 3a20 5155 5f54 6f70 6f49 6e70  puts: QU_TopoInp
-00000ec0: 7574 732c 0a20 2020 2020 2020 2071 755f  uts,.        qu_
-00000ed0: 7369 6d70 6172 616d 733a 2051 555f 5369  simparams: QU_Si
-00000ee0: 6d70 6172 616d 732c 0a20 2020 2029 3a0a  mparams,.    ):.
-00000ef0: 2020 2020 2020 2020 2320 5374 6f72 6520          # Store 
-00000f00: 7468 6520 696e 7075 7420 6669 6c65 7320  the input files 
-00000f10: 6173 2061 7474 7269 6275 7465 730a 2020  as attributes.  
-00000f20: 2020 2020 2020 7365 6c66 2e72 6173 7465        self.raste
-00000f30: 726f 7269 6769 6e20 3d20 7261 7374 6572  rorigin = raster
-00000f40: 6f72 6967 696e 0a20 2020 2020 2020 2073  origin.        s
-00000f50: 656c 662e 7175 5f62 7569 6c64 696e 6773  elf.qu_buildings
-00000f60: 203d 2071 755f 6275 696c 6469 6e67 730a   = qu_buildings.
-00000f70: 2020 2020 2020 2020 7365 6c66 2e71 755f          self.qu_
-00000f80: 6669 6c65 6f70 7469 6f6e 7320 3d20 7175  fileoptions = qu
-00000f90: 5f66 696c 656f 7074 696f 6e73 0a20 2020  _fileoptions.   
-00000fa0: 2020 2020 2073 656c 662e 7166 6972 655f       self.qfire_
-00000fb0: 6164 7661 6e63 6564 5f75 7365 725f 696e  advanced_user_in
-00000fc0: 7075 7473 203d 2071 6669 7265 5f61 6476  puts = qfire_adv
-00000fd0: 616e 6365 645f 7573 6572 5f69 6e70 7574  anced_user_input
-00000fe0: 730a 2020 2020 2020 2020 7365 6c66 2e71  s.        self.q
-00000ff0: 6669 7265 5f62 6c64 675f 6164 7661 6e63  fire_bldg_advanc
-00001000: 6564 5f75 7365 725f 696e 7075 7473 203d  ed_user_inputs =
-00001010: 2071 6669 7265 5f62 6c64 675f 6164 7661   qfire_bldg_adva
-00001020: 6e63 6564 5f75 7365 725f 696e 7075 7473  nced_user_inputs
-00001030: 0a20 2020 2020 2020 2073 656c 662e 7166  .        self.qf
-00001040: 6972 655f 706c 756d 655f 6164 7661 6e63  ire_plume_advanc
-00001050: 6564 5f75 7365 725f 696e 7075 7473 203d  ed_user_inputs =
-00001060: 2071 6669 7265 5f70 6c75 6d65 5f61 6476   qfire_plume_adv
-00001070: 616e 6365 645f 7573 6572 5f69 6e70 7574  anced_user_input
-00001080: 730a 2020 2020 2020 2020 7365 6c66 2e72  s.        self.r
-00001090: 756e 7469 6d65 5f61 6476 616e 6365 645f  untime_advanced_
-000010a0: 7573 6572 5f69 6e70 7574 7320 3d20 7275  user_inputs = ru
-000010b0: 6e74 696d 655f 6164 7661 6e63 6564 5f75  ntime_advanced_u
-000010c0: 7365 725f 696e 7075 7473 0a20 2020 2020  ser_inputs.     
-000010d0: 2020 2073 656c 662e 7175 5f6d 6f76 696e     self.qu_movin
-000010e0: 6763 6f6f 7264 7320 3d20 7175 5f6d 6f76  gcoords = qu_mov
-000010f0: 696e 6763 6f6f 7264 730a 2020 2020 2020  ingcoords.      
-00001100: 2020 7365 6c66 2e71 705f 6275 696c 646f    self.qp_buildo
-00001110: 7574 203d 2071 705f 6275 696c 646f 7574  ut = qp_buildout
-00001120: 0a20 2020 2020 2020 2073 656c 662e 7175  .        self.qu
-00001130: 5f6d 6574 7061 7261 6d73 203d 2071 755f  _metparams = qu_
-00001140: 6d65 7470 6172 616d 730a 2020 2020 2020  metparams.      
-00001150: 2020 7365 6c66 2e71 7569 635f 6669 7265    self.quic_fire
-00001160: 203d 2071 7569 635f 6669 7265 0a20 2020   = quic_fire.   
-00001170: 2020 2020 2073 656c 662e 6772 6964 6c69       self.gridli
-00001180: 7374 203d 2067 7269 646c 6973 740a 2020  st = gridlist.  
-00001190: 2020 2020 2020 7365 6c66 2e77 696e 6473        self.winds
-000011a0: 656e 736f 7273 203d 2077 696e 6473 656e  ensors = windsen
-000011b0: 736f 7273 0a20 2020 2020 2020 2073 656c  sors.        sel
-000011c0: 662e 7175 5f74 6f70 6f69 6e70 7574 7320  f.qu_topoinputs 
-000011d0: 3d20 7175 5f74 6f70 6f69 6e70 7574 730a  = qu_topoinputs.
-000011e0: 2020 2020 2020 2020 7365 6c66 2e71 755f          self.qu_
-000011f0: 7369 6d70 6172 616d 7320 3d20 7175 5f73  simparams = qu_s
-00001200: 696d 7061 7261 6d73 0a0a 2020 2020 2020  imparams..      
-00001210: 2020 2320 4372 6561 7465 2061 2064 6963    # Create a dic
-00001220: 7469 6f6e 6172 7920 6672 6f6d 2074 6865  tionary from the
-00001230: 206c 6f63 616c 2076 6172 6961 626c 6573   local variables
-00001240: 0a20 2020 2020 2020 2073 656c 662e 5f69  .        self._i
-00001250: 6e70 7574 5f66 696c 6573 5f64 6963 7420  nput_files_dict 
-00001260: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
-00001270: 2272 6173 7465 726f 7269 6769 6e22 3a20  "rasterorigin": 
-00001280: 7261 7374 6572 6f72 6967 696e 2c0a 2020  rasterorigin,.  
-00001290: 2020 2020 2020 2020 2020 2271 755f 6275            "qu_bu
-000012a0: 696c 6469 6e67 7322 3a20 7175 5f62 7569  ildings": qu_bui
-000012b0: 6c64 696e 6773 2c0a 2020 2020 2020 2020  ldings,.        
-000012c0: 2020 2020 2271 755f 6669 6c65 6f70 7469      "qu_fileopti
-000012d0: 6f6e 7322 3a20 7175 5f66 696c 656f 7074  ons": qu_fileopt
-000012e0: 696f 6e73 2c0a 2020 2020 2020 2020 2020  ions,.          
-000012f0: 2020 2271 6669 7265 5f61 6476 616e 6365    "qfire_advance
-00001300: 645f 7573 6572 5f69 6e70 7574 7322 3a20  d_user_inputs": 
-00001310: 7166 6972 655f 6164 7661 6e63 6564 5f75  qfire_advanced_u
-00001320: 7365 725f 696e 7075 7473 2c0a 2020 2020  ser_inputs,.    
-00001330: 2020 2020 2020 2020 2271 6669 7265 5f62          "qfire_b
-00001340: 6c64 675f 6164 7661 6e63 6564 5f75 7365  ldg_advanced_use
-00001350: 725f 696e 7075 7473 223a 2071 6669 7265  r_inputs": qfire
-00001360: 5f62 6c64 675f 6164 7661 6e63 6564 5f75  _bldg_advanced_u
-00001370: 7365 725f 696e 7075 7473 2c0a 2020 2020  ser_inputs,.    
-00001380: 2020 2020 2020 2020 2271 6669 7265 5f70          "qfire_p
-00001390: 6c75 6d65 5f61 6476 616e 6365 645f 7573  lume_advanced_us
-000013a0: 6572 5f69 6e70 7574 7322 3a20 7166 6972  er_inputs": qfir
-000013b0: 655f 706c 756d 655f 6164 7661 6e63 6564  e_plume_advanced
-000013c0: 5f75 7365 725f 696e 7075 7473 2c0a 2020  _user_inputs,.  
-000013d0: 2020 2020 2020 2020 2020 2272 756e 7469            "runti
-000013e0: 6d65 5f61 6476 616e 6365 645f 7573 6572  me_advanced_user
-000013f0: 5f69 6e70 7574 7322 3a20 7275 6e74 696d  _inputs": runtim
-00001400: 655f 6164 7661 6e63 6564 5f75 7365 725f  e_advanced_user_
-00001410: 696e 7075 7473 2c0a 2020 2020 2020 2020  inputs,.        
-00001420: 2020 2020 2271 755f 6d6f 7669 6e67 636f      "qu_movingco
-00001430: 6f72 6473 223a 2071 755f 6d6f 7669 6e67  ords": qu_moving
-00001440: 636f 6f72 6473 2c0a 2020 2020 2020 2020  coords,.        
-00001450: 2020 2020 2271 705f 6275 696c 646f 7574      "qp_buildout
-00001460: 223a 2071 705f 6275 696c 646f 7574 2c0a  ": qp_buildout,.
-00001470: 2020 2020 2020 2020 2020 2020 2271 755f              "qu_
-00001480: 6d65 7470 6172 616d 7322 3a20 7175 5f6d  metparams": qu_m
-00001490: 6574 7061 7261 6d73 2c0a 2020 2020 2020  etparams,.      
-000014a0: 2020 2020 2020 2271 7569 635f 6669 7265        "quic_fire
-000014b0: 223a 2071 7569 635f 6669 7265 2c0a 2020  ": quic_fire,.  
-000014c0: 2020 2020 2020 2020 2020 2267 7269 646c            "gridl
-000014d0: 6973 7422 3a20 6772 6964 6c69 7374 2c0a  ist": gridlist,.
-000014e0: 2020 2020 2020 2020 2020 2020 2271 755f              "qu_
-000014f0: 746f 706f 696e 7075 7473 223a 2071 755f  topoinputs": qu_
-00001500: 746f 706f 696e 7075 7473 2c0a 2020 2020  topoinputs,.    
-00001510: 2020 2020 2020 2020 2271 755f 7369 6d70          "qu_simp
-00001520: 6172 616d 7322 3a20 7175 5f73 696d 7061  arams": qu_simpa
-00001530: 7261 6d73 2c0a 2020 2020 2020 2020 2020  rams,.          
-00001540: 2020 2277 696e 6473 656e 736f 7273 223a    "windsensors":
-00001550: 2077 696e 6473 656e 736f 7273 2c0a 2020   windsensors,.  
-00001560: 2020 2020 2020 7d0a 0a20 2020 2040 636c        }..    @cl
-00001570: 6173 736d 6574 686f 640a 2020 2020 6465  assmethod.    de
-00001580: 6620 6372 6561 7465 5f73 696d 756c 6174  f create_simulat
-00001590: 696f 6e28 0a20 2020 2020 2020 2063 6c73  ion(.        cls
-000015a0: 2c0a 2020 2020 2020 2020 6e78 3a20 696e  ,.        nx: in
-000015b0: 742c 0a20 2020 2020 2020 206e 793a 2069  t,.        ny: i
-000015c0: 6e74 2c0a 2020 2020 2020 2020 6669 7265  nt,.        fire
-000015d0: 5f6e 7a3a 2069 6e74 2c0a 2020 2020 2020  _nz: int,.      
-000015e0: 2020 7769 6e64 5f73 7065 6564 3a20 666c    wind_speed: fl
-000015f0: 6f61 742c 0a20 2020 2020 2020 2077 696e  oat,.        win
-00001600: 645f 6469 7265 6374 696f 6e3a 2069 6e74  d_direction: int
-00001610: 2c0a 2020 2020 2020 2020 7369 6d75 6c61  ,.        simula
-00001620: 7469 6f6e 5f74 696d 653a 2069 6e74 2c0a  tion_time: int,.
-00001630: 2020 2020 2920 2d3e 2053 696d 756c 6174      ) -> Simulat
-00001640: 696f 6e49 6e70 7574 733a 0a20 2020 2020  ionInputs:.     
-00001650: 2020 2022 2222 0a20 2020 2020 2020 2043     """.        C
-00001660: 7265 6174 6573 2061 2053 696d 756c 6174  reates a Simulat
-00001670: 696f 6e49 6e70 7574 7320 6f62 6a65 6374  ionInputs object
-00001680: 2062 7920 7461 6b69 6e67 2069 6e20 7468   by taking in th
-00001690: 6520 6d69 6d75 6d20 7265 7175 6972 6564  e mimum required
-000016a0: 0a20 2020 2020 2020 2069 6e66 6f72 6d61  .        informa
-000016b0: 7469 6f6e 2074 6f20 6275 696c 6420 6120  tion to build a 
-000016c0: 5155 4943 2d46 6972 6520 696e 7075 7420  QUIC-Fire input 
-000016d0: 6669 6c65 2064 6563 6b2e 2052 6574 7572  file deck. Retur
-000016e0: 6e73 2061 0a20 2020 2020 2020 2053 696d  ns a.        Sim
-000016f0: 756c 6174 696f 6e49 6e70 7574 7320 6f62  ulationInputs ob
-00001700: 6a65 6374 2072 6570 7265 7365 6e74 696e  ject representin
-00001710: 6720 7468 6520 636f 6d70 6c65 7465 2073  g the complete s
-00001720: 7461 7465 206f 6620 7468 650a 2020 2020  tate of the.    
-00001730: 2020 2020 5155 4943 2d46 6972 6520 7369      QUIC-Fire si
-00001740: 6d75 6c61 7469 6f6e 2e0a 0a20 2020 2020  mulation...     
-00001750: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-00001760: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00001770: 0a20 2020 2020 2020 206e 783a 2069 6e74  .        nx: int
-00001780: 0a20 2020 2020 2020 2020 2020 204e 756d  .            Num
-00001790: 6265 7220 6f66 2063 656c 6c73 2069 6e20  ber of cells in 
-000017a0: 7468 6520 782d 6469 7265 6374 696f 6e20  the x-direction 
-000017b0: 5b2d 5d2e 2044 6566 6175 6c74 2063 656c  [-]. Default cel
-000017c0: 6c20 7369 7a65 2069 7320 326d 2e0a 2020  l size is 2m..  
-000017d0: 2020 2020 2020 6e79 3a20 696e 740a 2020        ny: int.  
-000017e0: 2020 2020 2020 2020 2020 4e75 6d62 6572            Number
-000017f0: 206f 6620 6365 6c6c 7320 696e 2074 6865   of cells in the
-00001800: 2079 2d64 6972 6563 7469 6f6e 205b 2d5d   y-direction [-]
-00001810: 2e20 4465 6661 756c 7420 6365 6c6c 2073  . Default cell s
-00001820: 697a 6520 6973 2032 6d2e 0a20 2020 2020  ize is 2m..     
-00001830: 2020 2066 6972 655f 6e7a 3a20 696e 740a     fire_nz: int.
-00001840: 2020 2020 2020 2020 2020 2020 4e75 6d62              Numb
-00001850: 6572 206f 6620 6365 6c6c 7320 696e 2074  er of cells in t
-00001860: 6865 207a 2d64 6972 6563 7469 6f6e 2066  he z-direction f
-00001870: 6f72 2074 6865 2066 6972 6520 6772 6964  or the fire grid
-00001880: 205b 2d5d 2e20 4465 6661 756c 740a 2020   [-]. Default.  
-00001890: 2020 2020 2020 2020 2020 6365 6c6c 2073            cell s
-000018a0: 697a 6520 6973 2031 6d2e 0a20 2020 2020  ize is 1m..     
-000018b0: 2020 2077 696e 645f 7370 6565 643a 2066     wind_speed: f
-000018c0: 6c6f 6174 0a20 2020 2020 2020 2020 2020  loat.           
-000018d0: 2057 696e 6420 7370 6565 6420 5b6d 2f73   Wind speed [m/s
-000018e0: 5d2e 0a20 2020 2020 2020 2077 696e 645f  ]..        wind_
-000018f0: 6469 7265 6374 696f 6e3a 2066 6c6f 6174  direction: float
-00001900: 0a20 2020 2020 2020 2020 2020 2057 696e  .            Win
-00001910: 6420 6469 7265 6374 696f 6e20 5b64 6567  d direction [deg
-00001920: 5d2e 2030 2064 6567 2069 7320 6e6f 7274  ]. 0 deg is nort
-00001930: 682c 2039 3020 6465 6720 6973 2065 6173  h, 90 deg is eas
-00001940: 742c 2065 7463 2e20 4d75 7374 0a20 2020  t, etc. Must.   
-00001950: 2020 2020 2020 2020 2062 6520 696e 2072           be in r
-00001960: 616e 6765 205b 302c 2033 3630 292e 0a20  ange [0, 360).. 
-00001970: 2020 2020 2020 2073 696d 756c 6174 696f         simulatio
-00001980: 6e5f 7469 6d65 3a20 696e 740a 2020 2020  n_time: int.    
-00001990: 2020 2020 2020 2020 4e75 6d62 6572 206f          Number o
-000019a0: 6620 7365 636f 6e64 7320 746f 2072 756e  f seconds to run
-000019b0: 2074 6865 2073 696d 756c 6174 696f 6e20   the simulation 
-000019c0: 666f 7220 5b73 5d2e 0a0a 2020 2020 2020  for [s]...      
-000019d0: 2020 5265 7475 726e 730a 2020 2020 2020    Returns.      
-000019e0: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
-000019f0: 2020 5369 6d75 6c61 7469 6f6e 496e 7075    SimulationInpu
-00001a00: 7473 0a20 2020 2020 2020 2020 2020 2043  ts.            C
-00001a10: 6c61 7373 2063 6f6e 7461 696e 696e 6720  lass containing 
-00001a20: 7468 6520 6461 7461 2074 6f20 6275 696c  the data to buil
-00001a30: 6420 6120 5155 4943 2d46 6972 6520 696e  d a QUIC-Fire in
-00001a40: 7075 7420 6669 6c65 2064 6563 6b20 616e  put file deck an
-00001a50: 640a 2020 2020 2020 2020 2020 2020 7275  d.            ru
-00001a60: 6e20 6120 7369 6d75 6c61 7469 6f6e 2075  n a simulation u
-00001a70: 7369 6e67 2064 6566 6175 6c74 2070 6172  sing default par
-00001a80: 616d 6574 6572 732e 0a0a 2020 2020 2020  ameters...      
-00001a90: 2020 4578 616d 706c 6573 0a20 2020 2020    Examples.     
-00001aa0: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
-00001ab0: 2020 2020 3e3e 3e20 6672 6f6d 2071 7569      >>> from qui
-00001ac0: 6366 6972 655f 746f 6f6c 7320 696d 706f  cfire_tools impo
-00001ad0: 7274 2053 696d 756c 6174 696f 6e49 6e70  rt SimulationInp
-00001ae0: 7574 730a 2020 2020 2020 2020 3e3e 3e20  uts.        >>> 
-00001af0: 7369 6d5f 696e 7075 7473 203d 2053 696d  sim_inputs = Sim
-00001b00: 756c 6174 696f 6e49 6e70 7574 732e 6372  ulationInputs.cr
-00001b10: 6561 7465 5f73 696d 756c 6174 696f 6e28  eate_simulation(
-00001b20: 6e78 3d31 3030 2c20 6e79 3d31 3030 2c20  nx=100, ny=100, 
-00001b30: 6669 7265 5f6e 7a3d 3236 2c20 7769 6e64  fire_nz=26, wind
-00001b40: 5f73 7065 6564 3d31 2e38 2c20 7769 6e64  _speed=1.8, wind
-00001b50: 5f64 6972 6563 7469 6f6e 3d39 302c 2073  _direction=90, s
-00001b60: 696d 756c 6174 696f 6e5f 7469 6d65 3d36  imulation_time=6
-00001b70: 3030 290a 2020 2020 2020 2020 2222 220a  00).        """.
-00001b80: 2020 2020 2020 2020 2320 496e 6974 6961          # Initia
-00001b90: 6c69 7a65 2064 6566 6175 6c74 2069 6e70  lize default inp
-00001ba0: 7574 2066 696c 6573 0a20 2020 2020 2020  ut files.       
-00001bb0: 2072 6173 7465 726f 7269 6769 6e20 3d20   rasterorigin = 
-00001bc0: 5261 7374 6572 4f72 6967 696e 2829 0a20  RasterOrigin(). 
-00001bd0: 2020 2020 2020 2071 755f 6275 696c 6469         qu_buildi
-00001be0: 6e67 7320 3d20 5155 5f42 7569 6c64 696e  ngs = QU_Buildin
-00001bf0: 6773 2829 0a20 2020 2020 2020 2071 755f  gs().        qu_
-00001c00: 6669 6c65 6f70 7469 6f6e 7320 3d20 5155  fileoptions = QU
-00001c10: 5f46 696c 656f 7074 696f 6e73 2829 0a20  _Fileoptions(). 
-00001c20: 2020 2020 2020 2071 6669 7265 5f61 6476         qfire_adv
-00001c30: 616e 6365 645f 7573 6572 5f69 6e70 7574  anced_user_input
-00001c40: 7320 3d20 5146 6972 655f 4164 7661 6e63  s = QFire_Advanc
-00001c50: 6564 5f55 7365 725f 496e 7075 7473 2829  ed_User_Inputs()
-00001c60: 0a20 2020 2020 2020 2071 6669 7265 5f62  .        qfire_b
-00001c70: 6c64 675f 6164 7661 6e63 6564 5f75 7365  ldg_advanced_use
-00001c80: 725f 696e 7075 7473 203d 2051 4669 7265  r_inputs = QFire
-00001c90: 5f42 6c64 675f 4164 7661 6e63 6564 5f55  _Bldg_Advanced_U
-00001ca0: 7365 725f 496e 7075 7473 2829 0a20 2020  ser_Inputs().   
-00001cb0: 2020 2020 2071 6669 7265 5f70 6c75 6d65       qfire_plume
-00001cc0: 5f61 6476 616e 6365 645f 7573 6572 5f69  _advanced_user_i
-00001cd0: 6e70 7574 7320 3d20 5146 6972 655f 506c  nputs = QFire_Pl
-00001ce0: 756d 655f 4164 7661 6e63 6564 5f55 7365  ume_Advanced_Use
-00001cf0: 725f 496e 7075 7473 2829 0a20 2020 2020  r_Inputs().     
-00001d00: 2020 2072 756e 7469 6d65 5f61 6476 616e     runtime_advan
-00001d10: 6365 645f 7573 6572 5f69 6e70 7574 7320  ced_user_inputs 
-00001d20: 3d20 5275 6e74 696d 6541 6476 616e 6365  = RuntimeAdvance
-00001d30: 6455 7365 7249 6e70 7574 7328 290a 2020  dUserInputs().  
-00001d40: 2020 2020 2020 7175 5f6d 6f76 696e 6763        qu_movingc
-00001d50: 6f6f 7264 7320 3d20 5155 5f6d 6f76 696e  oords = QU_movin
-00001d60: 6763 6f6f 7264 7328 290a 2020 2020 2020  gcoords().      
-00001d70: 2020 7170 5f62 7569 6c64 6f75 7420 3d20    qp_buildout = 
-00001d80: 5150 5f62 7569 6c64 6f75 7428 290a 2020  QP_buildout().  
-00001d90: 2020 2020 2020 7175 5f6d 6574 7061 7261        qu_metpara
-00001da0: 6d73 203d 2051 555f 6d65 7470 6172 616d  ms = QU_metparam
-00001db0: 7328 290a 0a20 2020 2020 2020 2023 2049  s()..        # I
-00001dc0: 6e69 7469 616c 697a 6520 696e 7075 7420  nitialize input 
-00001dd0: 6669 6c65 7320 7769 7468 2072 6571 7569  files with requi
-00001de0: 7265 6420 7061 7261 6d65 7465 7273 0a20  red parameters. 
-00001df0: 2020 2020 2020 2073 7461 7274 5f74 696d         start_tim
-00001e00: 6520 3d20 696e 7428 7469 6d65 2e74 696d  e = int(time.tim
-00001e10: 6528 2929 0a20 2020 2020 2020 2069 676e  e()).        ign
-00001e20: 6974 696f 6e5f 7479 7065 203d 2064 6566  ition_type = def
-00001e30: 6175 6c74 5f6c 696e 655f 6967 6e69 7469  ault_line_igniti
-00001e40: 6f6e 286e 782c 206e 792c 2077 696e 645f  on(nx, ny, wind_
-00001e50: 6469 7265 6374 696f 6e29 0a20 2020 2020  direction).     
-00001e60: 2020 2071 7569 635f 6669 7265 203d 2051     quic_fire = Q
-00001e70: 5549 435f 6669 7265 280a 2020 2020 2020  UIC_fire(.      
-00001e80: 2020 2020 2020 6e7a 3d66 6972 655f 6e7a        nz=fire_nz
-00001e90: 2c0a 2020 2020 2020 2020 2020 2020 7469  ,.            ti
-00001ea0: 6d65 5f6e 6f77 3d73 7461 7274 5f74 696d  me_now=start_tim
-00001eb0: 652c 0a20 2020 2020 2020 2020 2020 2073  e,.            s
-00001ec0: 696d 5f74 696d 653d 7369 6d75 6c61 7469  im_time=simulati
-00001ed0: 6f6e 5f74 696d 652c 0a20 2020 2020 2020  on_time,.       
-00001ee0: 2020 2020 2069 676e 6974 696f 6e5f 7479       ignition_ty
-00001ef0: 7065 3d69 676e 6974 696f 6e5f 7479 7065  pe=ignition_type
-00001f00: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-00001f10: 2020 2020 6772 6964 6c69 7374 203d 2047      gridlist = G
-00001f20: 7269 646c 6973 7428 6e3d 6e78 2c20 6d3d  ridlist(n=nx, m=
-00001f30: 6e79 2c20 6c3d 6669 7265 5f6e 7a29 0a20  ny, l=fire_nz). 
-00001f40: 2020 2020 2020 2077 696e 6473 656e 736f         windsenso
-00001f50: 7273 203d 2057 696e 6453 656e 736f 7241  rs = WindSensorA
-00001f60: 7272 6179 280a 2020 2020 2020 2020 2020  rray(.          
-00001f70: 2020 7469 6d65 5f6e 6f77 3d73 7461 7274    time_now=start
-00001f80: 5f74 696d 652c 0a20 2020 2020 2020 2029  _time,.        )
-00001f90: 0a20 2020 2020 2020 2077 696e 6473 656e  .        windsen
-00001fa0: 736f 7273 2e61 6464 5f73 656e 736f 7228  sors.add_sensor(
-00001fb0: 0a20 2020 2020 2020 2020 2020 2077 696e  .            win
-00001fc0: 645f 7370 6565 6473 3d5b 7769 6e64 5f73  d_speeds=[wind_s
-00001fd0: 7065 6564 5d2c 0a20 2020 2020 2020 2020  peed],.         
-00001fe0: 2020 2077 696e 645f 6469 7265 6374 696f     wind_directio
-00001ff0: 6e73 3d5b 7769 6e64 5f64 6972 6563 7469  ns=[wind_directi
-00002000: 6f6e 5d2c 0a20 2020 2020 2020 2020 2020  on],.           
-00002010: 2077 696e 645f 7469 6d65 733d 5b30 5d2c   wind_times=[0],
-00002020: 0a20 2020 2020 2020 2020 2020 2073 656e  .            sen
-00002030: 736f 725f 6865 6967 6874 3d36 2e31 2c0a  sor_height=6.1,.
-00002040: 2020 2020 2020 2020 2020 2020 785f 6c6f              x_lo
-00002050: 6361 7469 6f6e 3d31 2c0a 2020 2020 2020  cation=1,.      
-00002060: 2020 2020 2020 795f 6c6f 6361 7469 6f6e        y_location
-00002070: 3d31 2c0a 2020 2020 2020 2020 290a 2020  =1,.        ).  
-00002080: 2020 2020 2020 7175 5f74 6f70 6f69 6e70        qu_topoinp
-00002090: 7574 7320 3d20 5155 5f54 6f70 6f49 6e70  uts = QU_TopoInp
-000020a0: 7574 7328 290a 2020 2020 2020 2020 7175  uts().        qu
-000020b0: 5f73 696d 7061 7261 6d73 203d 2051 555f  _simparams = QU_
-000020c0: 5369 6d70 6172 616d 7328 6e78 3d6e 782c  Simparams(nx=nx,
-000020d0: 206e 793d 6e79 2c20 7769 6e64 5f74 696d   ny=ny, wind_tim
-000020e0: 6573 3d5b 7374 6172 745f 7469 6d65 5d29  es=[start_time])
-000020f0: 0a0a 2020 2020 2020 2020 2320 4372 6561  ..        # Crea
-00002100: 7465 2074 6865 2053 696d 756c 6174 696f  te the Simulatio
-00002110: 6e49 6e70 7574 7320 6f62 6a65 6374 0a20  nInputs object. 
-00002120: 2020 2020 2020 2072 6574 7572 6e20 636c         return cl
-00002130: 7328 0a20 2020 2020 2020 2020 2020 2072  s(.            r
-00002140: 6173 7465 726f 7269 6769 6e3d 7261 7374  asterorigin=rast
-00002150: 6572 6f72 6967 696e 2c0a 2020 2020 2020  erorigin,.      
-00002160: 2020 2020 2020 7175 5f62 7569 6c64 696e        qu_buildin
-00002170: 6773 3d71 755f 6275 696c 6469 6e67 732c  gs=qu_buildings,
-00002180: 0a20 2020 2020 2020 2020 2020 2071 755f  .            qu_
-00002190: 6669 6c65 6f70 7469 6f6e 733d 7175 5f66  fileoptions=qu_f
-000021a0: 696c 656f 7074 696f 6e73 2c0a 2020 2020  ileoptions,.    
-000021b0: 2020 2020 2020 2020 7166 6972 655f 6164          qfire_ad
-000021c0: 7661 6e63 6564 5f75 7365 725f 696e 7075  vanced_user_inpu
-000021d0: 7473 3d71 6669 7265 5f61 6476 616e 6365  ts=qfire_advance
-000021e0: 645f 7573 6572 5f69 6e70 7574 732c 0a20  d_user_inputs,. 
-000021f0: 2020 2020 2020 2020 2020 2071 6669 7265             qfire
-00002200: 5f62 6c64 675f 6164 7661 6e63 6564 5f75  _bldg_advanced_u
-00002210: 7365 725f 696e 7075 7473 3d71 6669 7265  ser_inputs=qfire
-00002220: 5f62 6c64 675f 6164 7661 6e63 6564 5f75  _bldg_advanced_u
-00002230: 7365 725f 696e 7075 7473 2c0a 2020 2020  ser_inputs,.    
-00002240: 2020 2020 2020 2020 7166 6972 655f 706c          qfire_pl
-00002250: 756d 655f 6164 7661 6e63 6564 5f75 7365  ume_advanced_use
-00002260: 725f 696e 7075 7473 3d71 6669 7265 5f70  r_inputs=qfire_p
-00002270: 6c75 6d65 5f61 6476 616e 6365 645f 7573  lume_advanced_us
-00002280: 6572 5f69 6e70 7574 732c 0a20 2020 2020  er_inputs,.     
-00002290: 2020 2020 2020 2072 756e 7469 6d65 5f61         runtime_a
-000022a0: 6476 616e 6365 645f 7573 6572 5f69 6e70  dvanced_user_inp
-000022b0: 7574 733d 7275 6e74 696d 655f 6164 7661  uts=runtime_adva
+00000290: 2020 4967 6e69 7469 6f6e 466c 6167 732c    IgnitionFlags,
+000002a0: 0a20 2020 2043 6972 6375 6c61 7252 696e  .    CircularRin
+000002b0: 6749 676e 6974 696f 6e2c 0a20 2020 2049  gIgnition,.    I
+000002c0: 676e 6974 696f 6e2c 0a20 2020 2052 6563  gnition,.    Rec
+000002d0: 7461 6e67 6c65 4967 6e69 7469 6f6e 2c0a  tangleIgnition,.
+000002e0: 2020 2020 5371 7561 7265 5269 6e67 4967      SquareRingIg
+000002f0: 6e69 7469 6f6e 2c0a 2020 2020 6465 6661  nition,.    defa
+00000300: 756c 745f 6c69 6e65 5f69 676e 6974 696f  ult_line_ignitio
+00000310: 6e2c 0a20 2020 2073 6572 6961 6c69 7a65  n,.    serialize
+00000320: 5f69 676e 6974 696f 6e2c 0a29 0a66 726f  _ignition,.).fro
+00000330: 6d20 7175 6963 6669 7265 5f74 6f6f 6c73  m quicfire_tools
+00000340: 2e74 6f70 6f67 7261 7068 7920 696d 706f  .topography impo
+00000350: 7274 2028 0a20 2020 2054 6f70 6f46 6c61  rt (.    TopoFla
+00000360: 6773 2c0a 2020 2020 4361 6e79 6f6e 546f  gs,.    CanyonTo
+00000370: 706f 2c0a 2020 2020 436f 7348 696c 6c54  po,.    CosHillT
+00000380: 6f70 6f2c 0a20 2020 2047 6175 7373 6961  opo,.    Gaussia
+00000390: 6e48 696c 6c54 6f70 6f2c 0a20 2020 2048  nHillTopo,.    H
+000003a0: 616c 6643 6972 636c 6554 6f70 6f2c 0a20  alfCircleTopo,. 
+000003b0: 2020 2048 696c 6c50 6173 7354 6f70 6f2c     HillPassTopo,
+000003c0: 0a20 2020 2053 696e 7573 6f69 6454 6f70  .    SinusoidTop
+000003d0: 6f2c 0a20 2020 2053 6c6f 7065 4d65 7361  o,.    SlopeMesa
+000003e0: 546f 706f 2c0a 2020 2020 546f 706f 6772  Topo,.    Topogr
+000003f0: 6170 6879 2c0a 2020 2020 7365 7269 616c  aphy,.    serial
+00000400: 697a 655f 746f 706f 6772 6170 6879 2c0a  ize_topography,.
+00000410: 290a 6672 6f6d 2071 7569 6366 6972 655f  ).from quicfire_
+00000420: 746f 6f6c 732e 7574 696c 7320 696d 706f  tools.utils impo
+00000430: 7274 2063 6f6d 7075 7465 5f70 6172 6162  rt compute_parab
+00000440: 6f6c 6963 5f73 7472 6574 6368 6564 5f67  olic_stretched_g
+00000450: 7269 640a 0a0a 444f 4353 5f50 4154 4820  rid...DOCS_PATH 
+00000460: 3d20 280a 2020 2020 696d 706f 7274 6c69  = (.    importli
+00000470: 622e 7265 736f 7572 6365 732e 6669 6c65  b.resources.file
+00000480: 7328 2271 7569 6366 6972 655f 746f 6f6c  s("quicfire_tool
+00000490: 7322 290a 2020 2020 2e6a 6f69 6e70 6174  s").    .joinpat
+000004a0: 6828 2264 6174 6122 290a 2020 2020 2e6a  h("data").    .j
+000004b0: 6f69 6e70 6174 6828 2264 6f63 756d 656e  oinpath("documen
+000004c0: 7461 7469 6f6e 2229 0a29 0a54 454d 504c  tation").).TEMPL
+000004d0: 4154 4553 5f50 4154 4820 3d20 280a 2020  ATES_PATH = (.  
+000004e0: 2020 696d 706f 7274 6c69 622e 7265 736f    importlib.reso
+000004f0: 7572 6365 732e 6669 6c65 7328 2271 7569  urces.files("qui
+00000500: 6366 6972 655f 746f 6f6c 7322 292e 6a6f  cfire_tools").jo
+00000510: 696e 7061 7468 2822 6461 7461 2229 2e6a  inpath("data").j
+00000520: 6f69 6e70 6174 6828 2274 656d 706c 6174  oinpath("templat
+00000530: 6573 2229 0a29 0a0a 4c41 5445 5354 5f56  es").)..LATEST_V
+00000540: 4552 5349 4f4e 203d 2022 7636 220a 0a0a  ERSION = "v6"...
+00000550: 636c 6173 7320 5369 6d75 6c61 7469 6f6e  class Simulation
+00000560: 496e 7075 7473 3a0a 2020 2020 2222 220a  Inputs:.    """.
+00000570: 2020 2020 436c 6173 7320 7265 7072 6573      Class repres
+00000580: 656e 7469 6e67 2061 2051 5549 432d 4669  enting a QUIC-Fi
+00000590: 7265 2069 6e70 7574 2066 696c 6520 6465  re input file de
+000005a0: 636b 2e20 5468 6973 2063 6c61 7373 2069  ck. This class i
+000005b0: 7320 7468 6520 7072 696d 6172 790a 2020  s the primary.  
+000005c0: 2020 696e 7465 7266 6163 6520 666f 7220    interface for 
+000005d0: 6275 696c 6469 6e67 2061 2051 5549 432d  building a QUIC-
+000005e0: 4669 7265 2069 6e70 7574 2066 696c 6520  Fire input file 
+000005f0: 6465 636b 2061 6e64 2073 6176 696e 6720  deck and saving 
+00000600: 7468 6520 696e 7075 740a 2020 2020 6669  the input.    fi
+00000610: 6c65 7320 746f 2061 2064 6972 6563 746f  les to a directo
+00000620: 7279 2066 6f72 2072 756e 6e69 6e67 2061  ry for running a
+00000630: 2073 696d 756c 6174 696f 6e2e 0a0a 2020   simulation...  
+00000640: 2020 4174 7472 6962 7574 6573 0a20 2020    Attributes.   
+00000650: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+00000660: 7261 7374 6572 6f72 6967 696e 3a20 5261  rasterorigin: Ra
+00000670: 7374 6572 4f72 6967 696e 0a20 2020 2020  sterOrigin.     
+00000680: 2020 204f 626a 6563 7420 7265 7072 6573     Object repres
+00000690: 656e 7469 6e67 2074 6865 2072 6173 7465  enting the raste
+000006a0: 726f 7269 6769 6e2e 7478 7420 6669 6c65  rorigin.txt file
+000006b0: 2e0a 2020 2020 7175 5f62 7569 6c64 696e  ..    qu_buildin
+000006c0: 6773 3a20 5155 5f42 7569 6c64 696e 6773  gs: QU_Buildings
+000006d0: 0a20 2020 2020 2020 204f 626a 6563 7420  .        Object 
+000006e0: 7265 7072 6573 656e 7469 6e67 2074 6865  representing the
+000006f0: 2051 555f 6275 696c 6469 6e67 732e 696e   QU_buildings.in
+00000700: 7020 6669 6c65 2e0a 2020 2020 7175 5f66  p file..    qu_f
+00000710: 696c 656f 7074 696f 6e73 3a20 5155 5f46  ileoptions: QU_F
+00000720: 696c 656f 7074 696f 6e73 0a20 2020 2020  ileoptions.     
+00000730: 2020 204f 626a 6563 7420 7265 7072 6573     Object repres
+00000740: 656e 7469 6e67 2074 6865 2051 555f 6669  enting the QU_fi
+00000750: 6c65 6f70 7469 6f6e 732e 696e 7020 6669  leoptions.inp fi
+00000760: 6c65 2e0a 2020 2020 7166 6972 655f 6164  le..    qfire_ad
+00000770: 7661 6e63 6564 5f75 7365 725f 696e 7075  vanced_user_inpu
+00000780: 7473 3a20 5146 6972 655f 4164 7661 6e63  ts: QFire_Advanc
+00000790: 6564 5f55 7365 725f 496e 7075 7473 0a20  ed_User_Inputs. 
+000007a0: 2020 2020 2020 204f 626a 6563 7420 7265         Object re
+000007b0: 7072 6573 656e 7469 6e67 2074 6865 2071  presenting the q
+000007c0: 6669 7265 5f61 6476 616e 6365 645f 7573  fire_advanced_us
+000007d0: 6572 5f69 6e70 7574 732e 696e 7020 6669  er_inputs.inp fi
+000007e0: 6c65 2e0a 2020 2020 7166 6972 655f 626c  le..    qfire_bl
+000007f0: 6467 5f61 6476 616e 6365 645f 7573 6572  dg_advanced_user
+00000800: 5f69 6e70 7574 733a 2051 4669 7265 5f42  _inputs: QFire_B
+00000810: 6c64 675f 4164 7661 6e63 6564 5f55 7365  ldg_Advanced_Use
+00000820: 725f 496e 7075 7473 0a20 2020 2020 2020  r_Inputs.       
+00000830: 204f 626a 6563 7420 7265 7072 6573 656e   Object represen
+00000840: 7469 6e67 2074 6865 2071 6669 7265 5f62  ting the qfire_b
+00000850: 6c64 675f 6164 7661 6e63 6564 5f75 7365  ldg_advanced_use
+00000860: 725f 696e 7075 7473 2e69 6e70 2066 696c  r_inputs.inp fil
+00000870: 652e 0a20 2020 2071 6669 7265 5f70 6c75  e..    qfire_plu
+00000880: 6d65 5f61 6476 616e 6365 645f 7573 6572  me_advanced_user
+00000890: 5f69 6e70 7574 733a 2051 4669 7265 5f50  _inputs: QFire_P
+000008a0: 6c75 6d65 5f41 6476 616e 6365 645f 5573  lume_Advanced_Us
+000008b0: 6572 5f49 6e70 7574 730a 2020 2020 2020  er_Inputs.      
+000008c0: 2020 4f62 6a65 6374 2072 6570 7265 7365    Object represe
+000008d0: 6e74 696e 6720 7468 6520 7166 6972 655f  nting the qfire_
+000008e0: 706c 756d 655f 6164 7661 6e63 6564 5f75  plume_advanced_u
+000008f0: 7365 725f 696e 7075 7473 2e69 6e70 2066  ser_inputs.inp f
+00000900: 696c 652e 0a20 2020 2072 756e 7469 6d65  ile..    runtime
+00000910: 5f61 6476 616e 6365 645f 7573 6572 5f69  _advanced_user_i
+00000920: 6e70 7574 733a 2052 756e 7469 6d65 4164  nputs: RuntimeAd
+00000930: 7661 6e63 6564 5573 6572 496e 7075 7473  vancedUserInputs
+00000940: 0a20 2020 2020 2020 204f 626a 6563 7420  .        Object 
+00000950: 7265 7072 6573 656e 7469 6e67 2074 6865  representing the
+00000960: 2072 756e 7469 6d65 5f61 6476 616e 6365   runtime_advance
+00000970: 645f 7573 6572 5f69 6e70 7574 732e 696e  d_user_inputs.in
+00000980: 7020 6669 6c65 2e0a 2020 2020 7175 5f6d  p file..    qu_m
+00000990: 6f76 696e 6763 6f6f 7264 733a 2051 555f  ovingcoords: QU_
+000009a0: 6d6f 7669 6e67 636f 6f72 6473 0a20 2020  movingcoords.   
+000009b0: 2020 2020 204f 626a 6563 7420 7265 7072       Object repr
+000009c0: 6573 656e 7469 6e67 2074 6865 2051 555f  esenting the QU_
+000009d0: 6d6f 7669 6e67 636f 6f72 6473 2e69 6e70  movingcoords.inp
+000009e0: 2066 696c 652e 0a20 2020 2071 705f 6275   file..    qp_bu
+000009f0: 696c 646f 7574 3a20 5150 5f62 7569 6c64  ildout: QP_build
+00000a00: 6f75 740a 2020 2020 2020 2020 4f62 6a65  out.        Obje
+00000a10: 6374 2072 6570 7265 7365 6e74 696e 6720  ct representing 
+00000a20: 7468 6520 7170 5f62 7569 6c64 6f75 742e  the qp_buildout.
+00000a30: 696e 7020 6669 6c65 2e0a 2020 2020 7175  inp file..    qu
+00000a40: 5f6d 6574 7061 7261 6d73 3a20 5155 5f6d  _metparams: QU_m
+00000a50: 6574 7061 7261 6d73 0a20 2020 2020 2020  etparams.       
+00000a60: 204f 626a 6563 7420 7265 7072 6573 656e   Object represen
+00000a70: 7469 6e67 2074 6865 2051 555f 6d65 7470  ting the QU_metp
+00000a80: 6172 616d 732e 696e 7020 6669 6c65 2e0a  arams.inp file..
+00000a90: 2020 2020 7175 6963 5f66 6972 653a 2051      quic_fire: Q
+00000aa0: 5549 435f 6669 7265 0a20 2020 2020 2020  UIC_fire.       
+00000ab0: 204f 626a 6563 7420 7265 7072 6573 656e   Object represen
+00000ac0: 7469 6e67 2074 6865 2051 5549 435f 6669  ting the QUIC_fi
+00000ad0: 7265 2e69 6e70 2066 696c 652e 0a20 2020  re.inp file..   
+00000ae0: 2067 7269 646c 6973 743a 2047 7269 646c   gridlist: Gridl
+00000af0: 6973 740a 2020 2020 2020 2020 4f62 6a65  ist.        Obje
+00000b00: 6374 2072 6570 7265 7365 6e74 696e 6720  ct representing 
+00000b10: 7468 6520 6772 6964 6c69 7374 2e74 7874  the gridlist.txt
+00000b20: 2066 696c 652e 0a20 2020 2077 696e 6473   file..    winds
+00000b30: 656e 736f 723a 2064 6963 745b 7374 722c  ensor: dict[str,
+00000b40: 2057 696e 6453 656e 736f 725d 0a20 2020   WindSensor].   
+00000b50: 2020 2020 204f 626a 6563 7420 7265 7072       Object repr
+00000b60: 6573 656e 7469 6e67 2074 6865 2061 6c6c  esenting the all
+00000b70: 2077 696e 6420 7365 6e73 6f72 2069 6e70   wind sensor inp
+00000b80: 7574 2066 696c 6573 2c20 652e 672e 2073  ut files, e.g. s
+00000b90: 656e 736f 7231 2e69 6e70 2e0a 2020 2020  ensor1.inp..    
+00000ba0: 7175 5f74 6f70 6f69 6e70 7574 733a 2051  qu_topoinputs: Q
+00000bb0: 555f 546f 706f 496e 7075 7473 0a20 2020  U_TopoInputs.   
+00000bc0: 2020 2020 204f 626a 6563 7420 7265 7072       Object repr
+00000bd0: 6573 656e 7469 6e67 2074 6865 2051 555f  esenting the QU_
+00000be0: 746f 706f 696e 7075 7473 2e69 6e70 2066  topoinputs.inp f
+00000bf0: 696c 652e 0a20 2020 2071 755f 7369 6d70  ile..    qu_simp
+00000c00: 6172 616d 733a 2051 555f 5369 6d70 6172  arams: QU_Simpar
+00000c10: 616d 730a 2020 2020 2020 2020 4f62 6a65  ams.        Obje
+00000c20: 6374 2072 6570 7265 7365 6e74 696e 6720  ct representing 
+00000c30: 7468 6520 5155 5f73 696d 7061 7261 6d73  the QU_simparams
+00000c40: 2e69 6e70 2066 696c 652e 0a20 2020 2022  .inp file..    "
+00000c50: 2222 0a0a 2020 2020 6465 6620 5f5f 696e  ""..    def __in
+00000c60: 6974 5f5f 280a 2020 2020 2020 2020 7365  it__(.        se
+00000c70: 6c66 2c0a 2020 2020 2020 2020 7261 7374  lf,.        rast
+00000c80: 6572 6f72 6967 696e 3a20 5261 7374 6572  erorigin: Raster
+00000c90: 4f72 6967 696e 2c0a 2020 2020 2020 2020  Origin,.        
+00000ca0: 7175 5f62 7569 6c64 696e 6773 3a20 5155  qu_buildings: QU
+00000cb0: 5f42 7569 6c64 696e 6773 2c0a 2020 2020  _Buildings,.    
+00000cc0: 2020 2020 7175 5f66 696c 656f 7074 696f      qu_fileoptio
+00000cd0: 6e73 3a20 5155 5f46 696c 656f 7074 696f  ns: QU_Fileoptio
+00000ce0: 6e73 2c0a 2020 2020 2020 2020 7166 6972  ns,.        qfir
+00000cf0: 655f 6164 7661 6e63 6564 5f75 7365 725f  e_advanced_user_
+00000d00: 696e 7075 7473 3a20 5146 6972 655f 4164  inputs: QFire_Ad
+00000d10: 7661 6e63 6564 5f55 7365 725f 496e 7075  vanced_User_Inpu
+00000d20: 7473 2c0a 2020 2020 2020 2020 7166 6972  ts,.        qfir
+00000d30: 655f 626c 6467 5f61 6476 616e 6365 645f  e_bldg_advanced_
+00000d40: 7573 6572 5f69 6e70 7574 733a 2051 4669  user_inputs: QFi
+00000d50: 7265 5f42 6c64 675f 4164 7661 6e63 6564  re_Bldg_Advanced
+00000d60: 5f55 7365 725f 496e 7075 7473 2c0a 2020  _User_Inputs,.  
+00000d70: 2020 2020 2020 7166 6972 655f 706c 756d        qfire_plum
+00000d80: 655f 6164 7661 6e63 6564 5f75 7365 725f  e_advanced_user_
+00000d90: 696e 7075 7473 3a20 5146 6972 655f 506c  inputs: QFire_Pl
+00000da0: 756d 655f 4164 7661 6e63 6564 5f55 7365  ume_Advanced_Use
+00000db0: 725f 496e 7075 7473 2c0a 2020 2020 2020  r_Inputs,.      
+00000dc0: 2020 7275 6e74 696d 655f 6164 7661 6e63    runtime_advanc
+00000dd0: 6564 5f75 7365 725f 696e 7075 7473 3a20  ed_user_inputs: 
+00000de0: 5275 6e74 696d 6541 6476 616e 6365 6455  RuntimeAdvancedU
+00000df0: 7365 7249 6e70 7574 732c 0a20 2020 2020  serInputs,.     
+00000e00: 2020 2071 755f 6d6f 7669 6e67 636f 6f72     qu_movingcoor
+00000e10: 6473 3a20 5155 5f6d 6f76 696e 6763 6f6f  ds: QU_movingcoo
+00000e20: 7264 732c 0a20 2020 2020 2020 2071 705f  rds,.        qp_
+00000e30: 6275 696c 646f 7574 3a20 5150 5f62 7569  buildout: QP_bui
+00000e40: 6c64 6f75 742c 0a20 2020 2020 2020 2071  ldout,.        q
+00000e50: 755f 6d65 7470 6172 616d 733a 2051 555f  u_metparams: QU_
+00000e60: 6d65 7470 6172 616d 732c 0a20 2020 2020  metparams,.     
+00000e70: 2020 2071 7569 635f 6669 7265 3a20 5155     quic_fire: QU
+00000e80: 4943 5f66 6972 652c 0a20 2020 2020 2020  IC_fire,.       
+00000e90: 2067 7269 646c 6973 743a 2047 7269 646c   gridlist: Gridl
+00000ea0: 6973 742c 0a20 2020 2020 2020 2077 696e  ist,.        win
+00000eb0: 6473 656e 736f 7273 3a20 5769 6e64 5365  dsensors: WindSe
+00000ec0: 6e73 6f72 4172 7261 792c 0a20 2020 2020  nsorArray,.     
+00000ed0: 2020 2071 755f 746f 706f 696e 7075 7473     qu_topoinputs
+00000ee0: 3a20 5155 5f54 6f70 6f49 6e70 7574 732c  : QU_TopoInputs,
+00000ef0: 0a20 2020 2020 2020 2071 755f 7369 6d70  .        qu_simp
+00000f00: 6172 616d 733a 2051 555f 5369 6d70 6172  arams: QU_Simpar
+00000f10: 616d 732c 0a20 2020 2029 3a0a 2020 2020  ams,.    ):.    
+00000f20: 2020 2020 2320 5374 6f72 6520 7468 6520      # Store the 
+00000f30: 696e 7075 7420 6669 6c65 7320 6173 2061  input files as a
+00000f40: 7474 7269 6275 7465 730a 2020 2020 2020  ttributes.      
+00000f50: 2020 7365 6c66 2e72 6173 7465 726f 7269    self.rasterori
+00000f60: 6769 6e20 3d20 7261 7374 6572 6f72 6967  gin = rasterorig
+00000f70: 696e 0a20 2020 2020 2020 2073 656c 662e  in.        self.
+00000f80: 7175 5f62 7569 6c64 696e 6773 203d 2071  qu_buildings = q
+00000f90: 755f 6275 696c 6469 6e67 730a 2020 2020  u_buildings.    
+00000fa0: 2020 2020 7365 6c66 2e71 755f 6669 6c65      self.qu_file
+00000fb0: 6f70 7469 6f6e 7320 3d20 7175 5f66 696c  options = qu_fil
+00000fc0: 656f 7074 696f 6e73 0a20 2020 2020 2020  eoptions.       
+00000fd0: 2073 656c 662e 7166 6972 655f 6164 7661   self.qfire_adva
+00000fe0: 6e63 6564 5f75 7365 725f 696e 7075 7473  nced_user_inputs
+00000ff0: 203d 2071 6669 7265 5f61 6476 616e 6365   = qfire_advance
+00001000: 645f 7573 6572 5f69 6e70 7574 730a 2020  d_user_inputs.  
+00001010: 2020 2020 2020 7365 6c66 2e71 6669 7265        self.qfire
+00001020: 5f62 6c64 675f 6164 7661 6e63 6564 5f75  _bldg_advanced_u
+00001030: 7365 725f 696e 7075 7473 203d 2071 6669  ser_inputs = qfi
+00001040: 7265 5f62 6c64 675f 6164 7661 6e63 6564  re_bldg_advanced
+00001050: 5f75 7365 725f 696e 7075 7473 0a20 2020  _user_inputs.   
+00001060: 2020 2020 2073 656c 662e 7166 6972 655f       self.qfire_
+00001070: 706c 756d 655f 6164 7661 6e63 6564 5f75  plume_advanced_u
+00001080: 7365 725f 696e 7075 7473 203d 2071 6669  ser_inputs = qfi
+00001090: 7265 5f70 6c75 6d65 5f61 6476 616e 6365  re_plume_advance
+000010a0: 645f 7573 6572 5f69 6e70 7574 730a 2020  d_user_inputs.  
+000010b0: 2020 2020 2020 7365 6c66 2e72 756e 7469        self.runti
+000010c0: 6d65 5f61 6476 616e 6365 645f 7573 6572  me_advanced_user
+000010d0: 5f69 6e70 7574 7320 3d20 7275 6e74 696d  _inputs = runtim
+000010e0: 655f 6164 7661 6e63 6564 5f75 7365 725f  e_advanced_user_
+000010f0: 696e 7075 7473 0a20 2020 2020 2020 2073  inputs.        s
+00001100: 656c 662e 7175 5f6d 6f76 696e 6763 6f6f  elf.qu_movingcoo
+00001110: 7264 7320 3d20 7175 5f6d 6f76 696e 6763  rds = qu_movingc
+00001120: 6f6f 7264 730a 2020 2020 2020 2020 7365  oords.        se
+00001130: 6c66 2e71 705f 6275 696c 646f 7574 203d  lf.qp_buildout =
+00001140: 2071 705f 6275 696c 646f 7574 0a20 2020   qp_buildout.   
+00001150: 2020 2020 2073 656c 662e 7175 5f6d 6574       self.qu_met
+00001160: 7061 7261 6d73 203d 2071 755f 6d65 7470  params = qu_metp
+00001170: 6172 616d 730a 2020 2020 2020 2020 7365  arams.        se
+00001180: 6c66 2e71 7569 635f 6669 7265 203d 2071  lf.quic_fire = q
+00001190: 7569 635f 6669 7265 0a20 2020 2020 2020  uic_fire.       
+000011a0: 2073 656c 662e 6772 6964 6c69 7374 203d   self.gridlist =
+000011b0: 2067 7269 646c 6973 740a 2020 2020 2020   gridlist.      
+000011c0: 2020 7365 6c66 2e77 696e 6473 656e 736f    self.windsenso
+000011d0: 7273 203d 2077 696e 6473 656e 736f 7273  rs = windsensors
+000011e0: 0a20 2020 2020 2020 2073 656c 662e 7175  .        self.qu
+000011f0: 5f74 6f70 6f69 6e70 7574 7320 3d20 7175  _topoinputs = qu
+00001200: 5f74 6f70 6f69 6e70 7574 730a 2020 2020  _topoinputs.    
+00001210: 2020 2020 7365 6c66 2e71 755f 7369 6d70      self.qu_simp
+00001220: 6172 616d 7320 3d20 7175 5f73 696d 7061  arams = qu_simpa
+00001230: 7261 6d73 0a0a 2020 2020 2020 2020 2320  rams..        # 
+00001240: 4372 6561 7465 2061 2064 6963 7469 6f6e  Create a diction
+00001250: 6172 7920 6672 6f6d 2074 6865 206c 6f63  ary from the loc
+00001260: 616c 2076 6172 6961 626c 6573 0a20 2020  al variables.   
+00001270: 2020 2020 2073 656c 662e 5f69 6e70 7574       self._input
+00001280: 5f66 696c 6573 5f64 6963 7420 3d20 7b0a  _files_dict = {.
+00001290: 2020 2020 2020 2020 2020 2020 2272 6173              "ras
+000012a0: 7465 726f 7269 6769 6e22 3a20 7261 7374  terorigin": rast
+000012b0: 6572 6f72 6967 696e 2c0a 2020 2020 2020  erorigin,.      
+000012c0: 2020 2020 2020 2271 755f 6275 696c 6469        "qu_buildi
+000012d0: 6e67 7322 3a20 7175 5f62 7569 6c64 696e  ngs": qu_buildin
+000012e0: 6773 2c0a 2020 2020 2020 2020 2020 2020  gs,.            
+000012f0: 2271 755f 6669 6c65 6f70 7469 6f6e 7322  "qu_fileoptions"
+00001300: 3a20 7175 5f66 696c 656f 7074 696f 6e73  : qu_fileoptions
+00001310: 2c0a 2020 2020 2020 2020 2020 2020 2271  ,.            "q
+00001320: 6669 7265 5f61 6476 616e 6365 645f 7573  fire_advanced_us
+00001330: 6572 5f69 6e70 7574 7322 3a20 7166 6972  er_inputs": qfir
+00001340: 655f 6164 7661 6e63 6564 5f75 7365 725f  e_advanced_user_
+00001350: 696e 7075 7473 2c0a 2020 2020 2020 2020  inputs,.        
+00001360: 2020 2020 2271 6669 7265 5f62 6c64 675f      "qfire_bldg_
+00001370: 6164 7661 6e63 6564 5f75 7365 725f 696e  advanced_user_in
+00001380: 7075 7473 223a 2071 6669 7265 5f62 6c64  puts": qfire_bld
+00001390: 675f 6164 7661 6e63 6564 5f75 7365 725f  g_advanced_user_
+000013a0: 696e 7075 7473 2c0a 2020 2020 2020 2020  inputs,.        
+000013b0: 2020 2020 2271 6669 7265 5f70 6c75 6d65      "qfire_plume
+000013c0: 5f61 6476 616e 6365 645f 7573 6572 5f69  _advanced_user_i
+000013d0: 6e70 7574 7322 3a20 7166 6972 655f 706c  nputs": qfire_pl
+000013e0: 756d 655f 6164 7661 6e63 6564 5f75 7365  ume_advanced_use
+000013f0: 725f 696e 7075 7473 2c0a 2020 2020 2020  r_inputs,.      
+00001400: 2020 2020 2020 2272 756e 7469 6d65 5f61        "runtime_a
+00001410: 6476 616e 6365 645f 7573 6572 5f69 6e70  dvanced_user_inp
+00001420: 7574 7322 3a20 7275 6e74 696d 655f 6164  uts": runtime_ad
+00001430: 7661 6e63 6564 5f75 7365 725f 696e 7075  vanced_user_inpu
+00001440: 7473 2c0a 2020 2020 2020 2020 2020 2020  ts,.            
+00001450: 2271 755f 6d6f 7669 6e67 636f 6f72 6473  "qu_movingcoords
+00001460: 223a 2071 755f 6d6f 7669 6e67 636f 6f72  ": qu_movingcoor
+00001470: 6473 2c0a 2020 2020 2020 2020 2020 2020  ds,.            
+00001480: 2271 705f 6275 696c 646f 7574 223a 2071  "qp_buildout": q
+00001490: 705f 6275 696c 646f 7574 2c0a 2020 2020  p_buildout,.    
+000014a0: 2020 2020 2020 2020 2271 755f 6d65 7470          "qu_metp
+000014b0: 6172 616d 7322 3a20 7175 5f6d 6574 7061  arams": qu_metpa
+000014c0: 7261 6d73 2c0a 2020 2020 2020 2020 2020  rams,.          
+000014d0: 2020 2271 7569 635f 6669 7265 223a 2071    "quic_fire": q
+000014e0: 7569 635f 6669 7265 2c0a 2020 2020 2020  uic_fire,.      
+000014f0: 2020 2020 2020 2267 7269 646c 6973 7422        "gridlist"
+00001500: 3a20 6772 6964 6c69 7374 2c0a 2020 2020  : gridlist,.    
+00001510: 2020 2020 2020 2020 2271 755f 746f 706f          "qu_topo
+00001520: 696e 7075 7473 223a 2071 755f 746f 706f  inputs": qu_topo
+00001530: 696e 7075 7473 2c0a 2020 2020 2020 2020  inputs,.        
+00001540: 2020 2020 2271 755f 7369 6d70 6172 616d      "qu_simparam
+00001550: 7322 3a20 7175 5f73 696d 7061 7261 6d73  s": qu_simparams
+00001560: 2c0a 2020 2020 2020 2020 2020 2020 2277  ,.            "w
+00001570: 696e 6473 656e 736f 7273 223a 2077 696e  indsensors": win
+00001580: 6473 656e 736f 7273 2c0a 2020 2020 2020  dsensors,.      
+00001590: 2020 7d0a 0a20 2020 2040 636c 6173 736d    }..    @classm
+000015a0: 6574 686f 640a 2020 2020 6465 6620 6372  ethod.    def cr
+000015b0: 6561 7465 5f73 696d 756c 6174 696f 6e28  eate_simulation(
+000015c0: 0a20 2020 2020 2020 2063 6c73 2c0a 2020  .        cls,.  
+000015d0: 2020 2020 2020 6e78 3a20 696e 742c 0a20        nx: int,. 
+000015e0: 2020 2020 2020 206e 793a 2069 6e74 2c0a         ny: int,.
+000015f0: 2020 2020 2020 2020 6669 7265 5f6e 7a3a          fire_nz:
+00001600: 2069 6e74 2c0a 2020 2020 2020 2020 7769   int,.        wi
+00001610: 6e64 5f73 7065 6564 3a20 666c 6f61 742c  nd_speed: float,
+00001620: 0a20 2020 2020 2020 2077 696e 645f 6469  .        wind_di
+00001630: 7265 6374 696f 6e3a 2069 6e74 2c0a 2020  rection: int,.  
+00001640: 2020 2020 2020 7369 6d75 6c61 7469 6f6e        simulation
+00001650: 5f74 696d 653a 2069 6e74 2c0a 2020 2020  _time: int,.    
+00001660: 2920 2d3e 2053 696d 756c 6174 696f 6e49  ) -> SimulationI
+00001670: 6e70 7574 733a 0a20 2020 2020 2020 2022  nputs:.        "
+00001680: 2222 0a20 2020 2020 2020 2043 7265 6174  "".        Creat
+00001690: 6573 2061 2053 696d 756c 6174 696f 6e49  es a SimulationI
+000016a0: 6e70 7574 7320 6f62 6a65 6374 2062 7920  nputs object by 
+000016b0: 7461 6b69 6e67 2069 6e20 7468 6520 6d69  taking in the mi
+000016c0: 6d75 6d20 7265 7175 6972 6564 0a20 2020  mum required.   
+000016d0: 2020 2020 2069 6e66 6f72 6d61 7469 6f6e       information
+000016e0: 2074 6f20 6275 696c 6420 6120 5155 4943   to build a QUIC
+000016f0: 2d46 6972 6520 696e 7075 7420 6669 6c65  -Fire input file
+00001700: 2064 6563 6b2e 2052 6574 7572 6e73 2061   deck. Returns a
+00001710: 0a20 2020 2020 2020 2053 696d 756c 6174  .        Simulat
+00001720: 696f 6e49 6e70 7574 7320 6f62 6a65 6374  ionInputs object
+00001730: 2072 6570 7265 7365 6e74 696e 6720 7468   representing th
+00001740: 6520 636f 6d70 6c65 7465 2073 7461 7465  e complete state
+00001750: 206f 6620 7468 650a 2020 2020 2020 2020   of the.        
+00001760: 5155 4943 2d46 6972 6520 7369 6d75 6c61  QUIC-Fire simula
+00001770: 7469 6f6e 2e0a 0a20 2020 2020 2020 2050  tion...        P
+00001780: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
+00001790: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+000017a0: 2020 2020 206e 783a 2069 6e74 0a20 2020       nx: int.   
+000017b0: 2020 2020 2020 2020 204e 756d 6265 7220           Number 
+000017c0: 6f66 2063 656c 6c73 2069 6e20 7468 6520  of cells in the 
+000017d0: 782d 6469 7265 6374 696f 6e20 5b2d 5d2e  x-direction [-].
+000017e0: 2044 6566 6175 6c74 2063 656c 6c20 7369   Default cell si
+000017f0: 7a65 2069 7320 326d 2e0a 2020 2020 2020  ze is 2m..      
+00001800: 2020 6e79 3a20 696e 740a 2020 2020 2020    ny: int.      
+00001810: 2020 2020 2020 4e75 6d62 6572 206f 6620        Number of 
+00001820: 6365 6c6c 7320 696e 2074 6865 2079 2d64  cells in the y-d
+00001830: 6972 6563 7469 6f6e 205b 2d5d 2e20 4465  irection [-]. De
+00001840: 6661 756c 7420 6365 6c6c 2073 697a 6520  fault cell size 
+00001850: 6973 2032 6d2e 0a20 2020 2020 2020 2066  is 2m..        f
+00001860: 6972 655f 6e7a 3a20 696e 740a 2020 2020  ire_nz: int.    
+00001870: 2020 2020 2020 2020 4e75 6d62 6572 206f          Number o
+00001880: 6620 6365 6c6c 7320 696e 2074 6865 207a  f cells in the z
+00001890: 2d64 6972 6563 7469 6f6e 2066 6f72 2074  -direction for t
+000018a0: 6865 2066 6972 6520 6772 6964 205b 2d5d  he fire grid [-]
+000018b0: 2e20 4465 6661 756c 740a 2020 2020 2020  . Default.      
+000018c0: 2020 2020 2020 6365 6c6c 2073 697a 6520        cell size 
+000018d0: 6973 2031 6d2e 0a20 2020 2020 2020 2077  is 1m..        w
+000018e0: 696e 645f 7370 6565 643a 2066 6c6f 6174  ind_speed: float
+000018f0: 0a20 2020 2020 2020 2020 2020 2057 696e  .            Win
+00001900: 6420 7370 6565 6420 5b6d 2f73 5d2e 0a20  d speed [m/s].. 
+00001910: 2020 2020 2020 2077 696e 645f 6469 7265         wind_dire
+00001920: 6374 696f 6e3a 2066 6c6f 6174 0a20 2020  ction: float.   
+00001930: 2020 2020 2020 2020 2057 696e 6420 6469           Wind di
+00001940: 7265 6374 696f 6e20 5b64 6567 5d2e 2030  rection [deg]. 0
+00001950: 2064 6567 2069 7320 6e6f 7274 682c 2039   deg is north, 9
+00001960: 3020 6465 6720 6973 2065 6173 742c 2065  0 deg is east, e
+00001970: 7463 2e20 4d75 7374 0a20 2020 2020 2020  tc. Must.       
+00001980: 2020 2020 2062 6520 696e 2072 616e 6765       be in range
+00001990: 205b 302c 2033 3630 292e 0a20 2020 2020   [0, 360)..     
+000019a0: 2020 2073 696d 756c 6174 696f 6e5f 7469     simulation_ti
+000019b0: 6d65 3a20 696e 740a 2020 2020 2020 2020  me: int.        
+000019c0: 2020 2020 4e75 6d62 6572 206f 6620 7365      Number of se
+000019d0: 636f 6e64 7320 746f 2072 756e 2074 6865  conds to run the
+000019e0: 2073 696d 756c 6174 696f 6e20 666f 7220   simulation for 
+000019f0: 5b73 5d2e 0a0a 2020 2020 2020 2020 5265  [s]...        Re
+00001a00: 7475 726e 730a 2020 2020 2020 2020 2d2d  turns.        --
+00001a10: 2d2d 2d2d 2d0a 2020 2020 2020 2020 5369  -----.        Si
+00001a20: 6d75 6c61 7469 6f6e 496e 7075 7473 0a20  mulationInputs. 
+00001a30: 2020 2020 2020 2020 2020 2043 6c61 7373             Class
+00001a40: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
+00001a50: 6461 7461 2074 6f20 6275 696c 6420 6120  data to build a 
+00001a60: 5155 4943 2d46 6972 6520 696e 7075 7420  QUIC-Fire input 
+00001a70: 6669 6c65 2064 6563 6b20 616e 640a 2020  file deck and.  
+00001a80: 2020 2020 2020 2020 2020 7275 6e20 6120            run a 
+00001a90: 7369 6d75 6c61 7469 6f6e 2075 7369 6e67  simulation using
+00001aa0: 2064 6566 6175 6c74 2070 6172 616d 6574   default paramet
+00001ab0: 6572 732e 0a0a 2020 2020 2020 2020 4578  ers...        Ex
+00001ac0: 616d 706c 6573 0a20 2020 2020 2020 202d  amples.        -
+00001ad0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00001ae0: 3e3e 3e20 6672 6f6d 2071 7569 6366 6972  >>> from quicfir
+00001af0: 655f 746f 6f6c 7320 696d 706f 7274 2053  e_tools import S
+00001b00: 696d 756c 6174 696f 6e49 6e70 7574 730a  imulationInputs.
+00001b10: 2020 2020 2020 2020 3e3e 3e20 7369 6d5f          >>> sim_
+00001b20: 696e 7075 7473 203d 2053 696d 756c 6174  inputs = Simulat
+00001b30: 696f 6e49 6e70 7574 732e 6372 6561 7465  ionInputs.create
+00001b40: 5f73 696d 756c 6174 696f 6e28 6e78 3d31  _simulation(nx=1
+00001b50: 3030 2c20 6e79 3d31 3030 2c20 6669 7265  00, ny=100, fire
+00001b60: 5f6e 7a3d 3236 2c20 7769 6e64 5f73 7065  _nz=26, wind_spe
+00001b70: 6564 3d31 2e38 2c20 7769 6e64 5f64 6972  ed=1.8, wind_dir
+00001b80: 6563 7469 6f6e 3d39 302c 2073 696d 756c  ection=90, simul
+00001b90: 6174 696f 6e5f 7469 6d65 3d36 3030 290a  ation_time=600).
+00001ba0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00001bb0: 2020 2020 2320 496e 6974 6961 6c69 7a65      # Initialize
+00001bc0: 2064 6566 6175 6c74 2069 6e70 7574 2066   default input f
+00001bd0: 696c 6573 0a20 2020 2020 2020 2072 6173  iles.        ras
+00001be0: 7465 726f 7269 6769 6e20 3d20 5261 7374  terorigin = Rast
+00001bf0: 6572 4f72 6967 696e 2829 0a20 2020 2020  erOrigin().     
+00001c00: 2020 2071 755f 6275 696c 6469 6e67 7320     qu_buildings 
+00001c10: 3d20 5155 5f42 7569 6c64 696e 6773 2829  = QU_Buildings()
+00001c20: 0a20 2020 2020 2020 2071 755f 6669 6c65  .        qu_file
+00001c30: 6f70 7469 6f6e 7320 3d20 5155 5f46 696c  options = QU_Fil
+00001c40: 656f 7074 696f 6e73 2829 0a20 2020 2020  eoptions().     
+00001c50: 2020 2071 6669 7265 5f61 6476 616e 6365     qfire_advance
+00001c60: 645f 7573 6572 5f69 6e70 7574 7320 3d20  d_user_inputs = 
+00001c70: 5146 6972 655f 4164 7661 6e63 6564 5f55  QFire_Advanced_U
+00001c80: 7365 725f 496e 7075 7473 2829 0a20 2020  ser_Inputs().   
+00001c90: 2020 2020 2071 6669 7265 5f62 6c64 675f       qfire_bldg_
+00001ca0: 6164 7661 6e63 6564 5f75 7365 725f 696e  advanced_user_in
+00001cb0: 7075 7473 203d 2051 4669 7265 5f42 6c64  puts = QFire_Bld
+00001cc0: 675f 4164 7661 6e63 6564 5f55 7365 725f  g_Advanced_User_
+00001cd0: 496e 7075 7473 2829 0a20 2020 2020 2020  Inputs().       
+00001ce0: 2071 6669 7265 5f70 6c75 6d65 5f61 6476   qfire_plume_adv
+00001cf0: 616e 6365 645f 7573 6572 5f69 6e70 7574  anced_user_input
+00001d00: 7320 3d20 5146 6972 655f 506c 756d 655f  s = QFire_Plume_
+00001d10: 4164 7661 6e63 6564 5f55 7365 725f 496e  Advanced_User_In
+00001d20: 7075 7473 2829 0a20 2020 2020 2020 2072  puts().        r
+00001d30: 756e 7469 6d65 5f61 6476 616e 6365 645f  untime_advanced_
+00001d40: 7573 6572 5f69 6e70 7574 7320 3d20 5275  user_inputs = Ru
+00001d50: 6e74 696d 6541 6476 616e 6365 6455 7365  ntimeAdvancedUse
+00001d60: 7249 6e70 7574 7328 290a 2020 2020 2020  rInputs().      
+00001d70: 2020 7175 5f6d 6f76 696e 6763 6f6f 7264    qu_movingcoord
+00001d80: 7320 3d20 5155 5f6d 6f76 696e 6763 6f6f  s = QU_movingcoo
+00001d90: 7264 7328 290a 2020 2020 2020 2020 7170  rds().        qp
+00001da0: 5f62 7569 6c64 6f75 7420 3d20 5150 5f62  _buildout = QP_b
+00001db0: 7569 6c64 6f75 7428 290a 2020 2020 2020  uildout().      
+00001dc0: 2020 7175 5f6d 6574 7061 7261 6d73 203d    qu_metparams =
+00001dd0: 2051 555f 6d65 7470 6172 616d 7328 290a   QU_metparams().
+00001de0: 0a20 2020 2020 2020 2023 2049 6e69 7469  .        # Initi
+00001df0: 616c 697a 6520 696e 7075 7420 6669 6c65  alize input file
+00001e00: 7320 7769 7468 2072 6571 7569 7265 6420  s with required 
+00001e10: 7061 7261 6d65 7465 7273 0a20 2020 2020  parameters.     
+00001e20: 2020 2073 7461 7274 5f74 696d 6520 3d20     start_time = 
+00001e30: 696e 7428 7469 6d65 2e74 696d 6528 2929  int(time.time())
+00001e40: 0a20 2020 2020 2020 2069 676e 6974 696f  .        ignitio
+00001e50: 6e20 3d20 6465 6661 756c 745f 6c69 6e65  n = default_line
+00001e60: 5f69 676e 6974 696f 6e28 6e78 2c20 6e79  _ignition(nx, ny
+00001e70: 2c20 7769 6e64 5f64 6972 6563 7469 6f6e  , wind_direction
+00001e80: 290a 2020 2020 2020 2020 7175 6963 5f66  ).        quic_f
+00001e90: 6972 6520 3d20 5155 4943 5f66 6972 6528  ire = QUIC_fire(
+00001ea0: 0a20 2020 2020 2020 2020 2020 206e 7a3d  .            nz=
+00001eb0: 6669 7265 5f6e 7a2c 0a20 2020 2020 2020  fire_nz,.       
+00001ec0: 2020 2020 2074 696d 655f 6e6f 773d 7374       time_now=st
+00001ed0: 6172 745f 7469 6d65 2c0a 2020 2020 2020  art_time,.      
+00001ee0: 2020 2020 2020 7369 6d5f 7469 6d65 3d73        sim_time=s
+00001ef0: 696d 756c 6174 696f 6e5f 7469 6d65 2c0a  imulation_time,.
+00001f00: 2020 2020 2020 2020 2020 2020 6967 6e69              igni
+00001f10: 7469 6f6e 3d69 676e 6974 696f 6e2c 0a20  tion=ignition,. 
+00001f20: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00001f30: 2067 7269 646c 6973 7420 3d20 4772 6964   gridlist = Grid
+00001f40: 6c69 7374 286e 3d6e 782c 206d 3d6e 792c  list(n=nx, m=ny,
+00001f50: 206c 3d66 6972 655f 6e7a 290a 2020 2020   l=fire_nz).    
+00001f60: 2020 2020 7769 6e64 7365 6e73 6f72 7320      windsensors 
+00001f70: 3d20 5769 6e64 5365 6e73 6f72 4172 7261  = WindSensorArra
+00001f80: 7928 0a20 2020 2020 2020 2020 2020 2074  y(.            t
+00001f90: 696d 655f 6e6f 773d 7374 6172 745f 7469  ime_now=start_ti
+00001fa0: 6d65 2c0a 2020 2020 2020 2020 290a 2020  me,.        ).  
+00001fb0: 2020 2020 2020 7769 6e64 7365 6e73 6f72        windsensor
+00001fc0: 732e 6164 645f 7365 6e73 6f72 280a 2020  s.add_sensor(.  
+00001fd0: 2020 2020 2020 2020 2020 7769 6e64 5f73            wind_s
+00001fe0: 7065 6564 733d 5b77 696e 645f 7370 6565  peeds=[wind_spee
+00001ff0: 645d 2c0a 2020 2020 2020 2020 2020 2020  d],.            
+00002000: 7769 6e64 5f64 6972 6563 7469 6f6e 733d  wind_directions=
+00002010: 5b77 696e 645f 6469 7265 6374 696f 6e5d  [wind_direction]
+00002020: 2c0a 2020 2020 2020 2020 2020 2020 7769  ,.            wi
+00002030: 6e64 5f74 696d 6573 3d5b 305d 2c0a 2020  nd_times=[0],.  
+00002040: 2020 2020 2020 2020 2020 7365 6e73 6f72            sensor
+00002050: 5f68 6569 6768 743d 362e 312c 0a20 2020  _height=6.1,.   
+00002060: 2020 2020 2020 2020 2078 5f6c 6f63 6174           x_locat
+00002070: 696f 6e3d 312c 0a20 2020 2020 2020 2020  ion=1,.         
+00002080: 2020 2079 5f6c 6f63 6174 696f 6e3d 312c     y_location=1,
+00002090: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+000020a0: 2020 2071 755f 746f 706f 696e 7075 7473     qu_topoinputs
+000020b0: 203d 2051 555f 546f 706f 496e 7075 7473   = QU_TopoInputs
+000020c0: 2829 0a20 2020 2020 2020 2071 755f 7369  ().        qu_si
+000020d0: 6d70 6172 616d 7320 3d20 5155 5f53 696d  mparams = QU_Sim
+000020e0: 7061 7261 6d73 286e 783d 6e78 2c20 6e79  params(nx=nx, ny
+000020f0: 3d6e 792c 2077 696e 645f 7469 6d65 733d  =ny, wind_times=
+00002100: 5b73 7461 7274 5f74 696d 655d 290a 0a20  [start_time]).. 
+00002110: 2020 2020 2020 2023 2043 7265 6174 6520         # Create 
+00002120: 7468 6520 5369 6d75 6c61 7469 6f6e 496e  the SimulationIn
+00002130: 7075 7473 206f 626a 6563 740a 2020 2020  puts object.    
+00002140: 2020 2020 7265 7475 726e 2063 6c73 280a      return cls(.
+00002150: 2020 2020 2020 2020 2020 2020 7261 7374              rast
+00002160: 6572 6f72 6967 696e 3d72 6173 7465 726f  erorigin=rastero
+00002170: 7269 6769 6e2c 0a20 2020 2020 2020 2020  rigin,.         
+00002180: 2020 2071 755f 6275 696c 6469 6e67 733d     qu_buildings=
+00002190: 7175 5f62 7569 6c64 696e 6773 2c0a 2020  qu_buildings,.  
+000021a0: 2020 2020 2020 2020 2020 7175 5f66 696c            qu_fil
+000021b0: 656f 7074 696f 6e73 3d71 755f 6669 6c65  eoptions=qu_file
+000021c0: 6f70 7469 6f6e 732c 0a20 2020 2020 2020  options,.       
+000021d0: 2020 2020 2071 6669 7265 5f61 6476 616e       qfire_advan
+000021e0: 6365 645f 7573 6572 5f69 6e70 7574 733d  ced_user_inputs=
+000021f0: 7166 6972 655f 6164 7661 6e63 6564 5f75  qfire_advanced_u
+00002200: 7365 725f 696e 7075 7473 2c0a 2020 2020  ser_inputs,.    
+00002210: 2020 2020 2020 2020 7166 6972 655f 626c          qfire_bl
+00002220: 6467 5f61 6476 616e 6365 645f 7573 6572  dg_advanced_user
+00002230: 5f69 6e70 7574 733d 7166 6972 655f 626c  _inputs=qfire_bl
+00002240: 6467 5f61 6476 616e 6365 645f 7573 6572  dg_advanced_user
+00002250: 5f69 6e70 7574 732c 0a20 2020 2020 2020  _inputs,.       
+00002260: 2020 2020 2071 6669 7265 5f70 6c75 6d65       qfire_plume
+00002270: 5f61 6476 616e 6365 645f 7573 6572 5f69  _advanced_user_i
+00002280: 6e70 7574 733d 7166 6972 655f 706c 756d  nputs=qfire_plum
+00002290: 655f 6164 7661 6e63 6564 5f75 7365 725f  e_advanced_user_
+000022a0: 696e 7075 7473 2c0a 2020 2020 2020 2020  inputs,.        
+000022b0: 2020 2020 7275 6e74 696d 655f 6164 7661      runtime_adva
 000022c0: 6e63 6564 5f75 7365 725f 696e 7075 7473  nced_user_inputs
-000022d0: 2c0a 2020 2020 2020 2020 2020 2020 7175  ,.            qu
-000022e0: 5f6d 6f76 696e 6763 6f6f 7264 733d 7175  _movingcoords=qu
-000022f0: 5f6d 6f76 696e 6763 6f6f 7264 732c 0a20  _movingcoords,. 
-00002300: 2020 2020 2020 2020 2020 2071 705f 6275             qp_bu
-00002310: 696c 646f 7574 3d71 705f 6275 696c 646f  ildout=qp_buildo
-00002320: 7574 2c0a 2020 2020 2020 2020 2020 2020  ut,.            
-00002330: 7175 5f6d 6574 7061 7261 6d73 3d71 755f  qu_metparams=qu_
-00002340: 6d65 7470 6172 616d 732c 0a20 2020 2020  metparams,.     
-00002350: 2020 2020 2020 2071 7569 635f 6669 7265         quic_fire
-00002360: 3d71 7569 635f 6669 7265 2c0a 2020 2020  =quic_fire,.    
-00002370: 2020 2020 2020 2020 6772 6964 6c69 7374          gridlist
-00002380: 3d67 7269 646c 6973 742c 0a20 2020 2020  =gridlist,.     
-00002390: 2020 2020 2020 2077 696e 6473 656e 736f         windsenso
-000023a0: 7273 3d77 696e 6473 656e 736f 7273 2c0a  rs=windsensors,.
-000023b0: 2020 2020 2020 2020 2020 2020 7175 5f74              qu_t
-000023c0: 6f70 6f69 6e70 7574 733d 7175 5f74 6f70  opoinputs=qu_top
-000023d0: 6f69 6e70 7574 732c 0a20 2020 2020 2020  oinputs,.       
-000023e0: 2020 2020 2071 755f 7369 6d70 6172 616d       qu_simparam
-000023f0: 733d 7175 5f73 696d 7061 7261 6d73 2c0a  s=qu_simparams,.
-00002400: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
-00002410: 636c 6173 736d 6574 686f 640a 2020 2020  classmethod.    
-00002420: 6465 6620 6672 6f6d 5f64 6972 6563 746f  def from_directo
-00002430: 7279 280a 2020 2020 2020 2020 636c 732c  ry(.        cls,
-00002440: 2064 6972 6563 746f 7279 3a20 7374 7220   directory: str 
-00002450: 7c20 5061 7468 2c20 7665 7273 696f 6e3a  | Path, version:
-00002460: 2073 7472 203d 2022 6c61 7465 7374 220a   str = "latest".
-00002470: 2020 2020 2920 2d3e 2053 696d 756c 6174      ) -> Simulat
-00002480: 696f 6e49 6e70 7574 733a 0a20 2020 2020  ionInputs:.     
-00002490: 2020 2022 2222 0a20 2020 2020 2020 2049     """.        I
-000024a0: 6e69 7469 616c 697a 6573 2061 2053 696d  nitializes a Sim
-000024b0: 756c 6174 696f 6e49 6e70 7574 7320 6f62  ulationInputs ob
-000024c0: 6a65 6374 2066 726f 6d20 6120 6469 7265  ject from a dire
-000024d0: 6374 6f72 7920 636f 6e74 6169 6e69 6e67  ctory containing
-000024e0: 2061 0a20 2020 2020 2020 2051 5549 432d   a.        QUIC-
-000024f0: 4669 7265 2069 6e70 7574 2066 696c 6520  Fire input file 
-00002500: 6465 636b 2e20 5468 6520 6675 6e63 7469  deck. The functi
-00002510: 6f6e 206c 6f6f 6b73 2066 6f72 2065 6163  on looks for eac
-00002520: 6820 696e 7075 7420 6669 6c65 2069 6e20  h input file in 
-00002530: 7468 650a 2020 2020 2020 2020 5155 4943  the.        QUIC
-00002540: 2d46 6972 6520 696e 7075 7420 6669 6c65  -Fire input file
-00002550: 2064 6563 6b2c 2072 6561 6473 2069 6e20   deck, reads in 
-00002560: 7468 6520 6669 6c65 2074 6f20 616e 206f  the file to an o
-00002570: 626a 6563 742c 2061 6e64 2063 6f6d 7069  bject, and compi
-00002580: 6c65 730a 2020 2020 2020 2020 7468 6520  les.        the 
-00002590: 6f62 6a65 6374 7320 746f 2061 2053 696d  objects to a Sim
-000025a0: 756c 6174 696f 6e49 6e70 7574 7320 6f62  ulationInputs ob
-000025b0: 6a65 6374 2074 6861 7420 7265 7072 6573  ject that repres
-000025c0: 656e 7473 2074 6865 2063 6f6d 706c 6574  ents the complet
-000025d0: 650a 2020 2020 2020 2020 7374 6174 6520  e.        state 
-000025e0: 6f66 2074 6865 2051 5549 432d 4669 7265  of the QUIC-Fire
-000025f0: 2073 696d 756c 6174 696f 6e2e 0a0a 2020   simulation...  
-00002600: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-00002610: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00002620: 2d2d 2d0a 2020 2020 2020 2020 6469 7265  ---.        dire
-00002630: 6374 6f72 793a 2073 7472 207c 2050 6174  ctory: str | Pat
-00002640: 680a 2020 2020 2020 2020 2020 2020 4469  h.            Di
-00002650: 7265 6374 6f72 7920 636f 6e74 6169 6e69  rectory containi
-00002660: 6e67 2061 2051 5549 432d 4669 7265 2069  ng a QUIC-Fire i
-00002670: 6e70 7574 2066 696c 6520 6465 636b 2e0a  nput file deck..
-00002680: 2020 2020 2020 2020 7665 7273 696f 6e3a          version:
-00002690: 2073 7472 0a20 2020 2020 2020 2020 2020   str.           
-000026a0: 2051 5549 432d 4669 7265 2076 6572 7369   QUIC-Fire versi
-000026b0: 6f6e 206f 6620 7468 6520 696e 7075 7420  on of the input 
-000026c0: 6669 6c65 7320 746f 2072 6561 642e 2043  files to read. C
-000026d0: 7572 7265 6e74 6c79 2073 7570 706f 7274  urrently support
-000026e0: 6564 0a20 2020 2020 2020 2020 2020 2076  ed.            v
-000026f0: 6572 7369 6f6e 7320 6172 6520 2276 3522  ersions are "v5"
-00002700: 2c20 2276 3622 2c20 616e 6420 226c 6174  , "v6", and "lat
-00002710: 6573 7422 2e20 4465 6661 756c 7420 6973  est". Default is
-00002720: 2022 6c61 7465 7374 222e 0a0a 2020 2020   "latest"...    
-00002730: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
-00002740: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
-00002750: 2020 2020 5369 6d75 6c61 7469 6f6e 496e      SimulationIn
-00002760: 7075 7473 0a20 2020 2020 2020 2020 2020  puts.           
-00002770: 2043 6c61 7373 2063 6f6e 7461 696e 696e   Class containin
-00002780: 6720 7468 6520 696e 7075 7420 6669 6c65  g the input file
-00002790: 7320 696e 2074 6865 2051 5549 432d 4669  s in the QUIC-Fi
-000027a0: 7265 2069 6e70 7574 2066 696c 6520 6465  re input file de
-000027b0: 636b 2e0a 0a20 2020 2020 2020 2045 7861  ck...        Exa
-000027c0: 6d70 6c65 730a 2020 2020 2020 2020 2d2d  mples.        --
-000027d0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203e  ------.        >
-000027e0: 3e3e 2066 726f 6d20 7175 6963 6669 7265  >> from quicfire
-000027f0: 5f74 6f6f 6c73 2069 6d70 6f72 7420 5369  _tools import Si
-00002800: 6d75 6c61 7469 6f6e 496e 7075 7473 0a20  mulationInputs. 
-00002810: 2020 2020 2020 203e 3e3e 2073 696d 756c         >>> simul
-00002820: 6174 696f 6e5f 7061 7468 203d 2022 7061  ation_path = "pa
-00002830: 7468 2f74 6f2f 7369 6d75 6c61 7469 6f6e  th/to/simulation
-00002840: 2f64 6972 6563 746f 7279 220a 2020 2020  /directory".    
-00002850: 2020 2020 3e3e 3e20 7369 6d5f 696e 7075      >>> sim_inpu
-00002860: 7473 203d 2053 696d 756c 6174 696f 6e49  ts = SimulationI
-00002870: 6e70 7574 732e 6672 6f6d 5f64 6972 6563  nputs.from_direc
-00002880: 746f 7279 2873 696d 756c 6174 696f 6e5f  tory(simulation_
-00002890: 7061 7468 290a 2020 2020 2020 2020 2222  path).        ""
-000028a0: 220a 2020 2020 2020 2020 6966 2069 7369  ".        if isi
-000028b0: 6e73 7461 6e63 6528 6469 7265 6374 6f72  nstance(director
-000028c0: 792c 2073 7472 293a 0a20 2020 2020 2020  y, str):.       
-000028d0: 2020 2020 2064 6972 6563 746f 7279 203d       directory =
-000028e0: 2050 6174 6828 6469 7265 6374 6f72 7929   Path(directory)
-000028f0: 0a0a 2020 2020 2020 2020 7665 7273 696f  ..        versio
-00002900: 6e20 3d20 5f76 616c 6964 6174 655f 616e  n = _validate_an
-00002910: 645f 7265 7475 726e 5f76 6572 7369 6f6e  d_return_version
-00002920: 2876 6572 7369 6f6e 290a 0a20 2020 2020  (version)..     
-00002930: 2020 2072 6574 7572 6e20 636c 7328 0a20     return cls(. 
-00002940: 2020 2020 2020 2020 2020 2072 6173 7465             raste
-00002950: 726f 7269 6769 6e3d 5261 7374 6572 4f72  rorigin=RasterOr
-00002960: 6967 696e 2e66 726f 6d5f 6669 6c65 2864  igin.from_file(d
-00002970: 6972 6563 746f 7279 292c 0a20 2020 2020  irectory),.     
-00002980: 2020 2020 2020 2071 755f 6275 696c 6469         qu_buildi
-00002990: 6e67 733d 5155 5f42 7569 6c64 696e 6773  ngs=QU_Buildings
-000029a0: 2e66 726f 6d5f 6669 6c65 2864 6972 6563  .from_file(direc
-000029b0: 746f 7279 292c 0a20 2020 2020 2020 2020  tory),.         
-000029c0: 2020 2071 755f 6669 6c65 6f70 7469 6f6e     qu_fileoption
-000029d0: 733d 5155 5f46 696c 656f 7074 696f 6e73  s=QU_Fileoptions
-000029e0: 2e66 726f 6d5f 6669 6c65 2864 6972 6563  .from_file(direc
-000029f0: 746f 7279 292c 0a20 2020 2020 2020 2020  tory),.         
-00002a00: 2020 2071 6669 7265 5f61 6476 616e 6365     qfire_advance
-00002a10: 645f 7573 6572 5f69 6e70 7574 733d 5146  d_user_inputs=QF
-00002a20: 6972 655f 4164 7661 6e63 6564 5f55 7365  ire_Advanced_Use
-00002a30: 725f 496e 7075 7473 2e66 726f 6d5f 6669  r_Inputs.from_fi
-00002a40: 6c65 2864 6972 6563 746f 7279 292c 0a20  le(directory),. 
-00002a50: 2020 2020 2020 2020 2020 2071 6669 7265             qfire
-00002a60: 5f62 6c64 675f 6164 7661 6e63 6564 5f75  _bldg_advanced_u
-00002a70: 7365 725f 696e 7075 7473 3d51 4669 7265  ser_inputs=QFire
-00002a80: 5f42 6c64 675f 4164 7661 6e63 6564 5f55  _Bldg_Advanced_U
-00002a90: 7365 725f 496e 7075 7473 2e66 726f 6d5f  ser_Inputs.from_
-00002aa0: 6669 6c65 280a 2020 2020 2020 2020 2020  file(.          
-00002ab0: 2020 2020 2020 6469 7265 6374 6f72 790a        directory.
-00002ac0: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
-00002ad0: 2020 2020 2020 2020 2020 2071 6669 7265             qfire
-00002ae0: 5f70 6c75 6d65 5f61 6476 616e 6365 645f  _plume_advanced_
-00002af0: 7573 6572 5f69 6e70 7574 733d 5146 6972  user_inputs=QFir
-00002b00: 655f 506c 756d 655f 4164 7661 6e63 6564  e_Plume_Advanced
-00002b10: 5f55 7365 725f 496e 7075 7473 2e66 726f  _User_Inputs.fro
-00002b20: 6d5f 6669 6c65 280a 2020 2020 2020 2020  m_file(.        
-00002b30: 2020 2020 2020 2020 6469 7265 6374 6f72          director
-00002b40: 790a 2020 2020 2020 2020 2020 2020 292c  y.            ),
-00002b50: 0a20 2020 2020 2020 2020 2020 2072 756e  .            run
-00002b60: 7469 6d65 5f61 6476 616e 6365 645f 7573  time_advanced_us
-00002b70: 6572 5f69 6e70 7574 733d 5275 6e74 696d  er_inputs=Runtim
-00002b80: 6541 6476 616e 6365 6455 7365 7249 6e70  eAdvancedUserInp
-00002b90: 7574 732e 6672 6f6d 5f66 696c 6528 6469  uts.from_file(di
-00002ba0: 7265 6374 6f72 7929 2c0a 2020 2020 2020  rectory),.      
-00002bb0: 2020 2020 2020 7175 5f6d 6f76 696e 6763        qu_movingc
-00002bc0: 6f6f 7264 733d 5155 5f6d 6f76 696e 6763  oords=QU_movingc
-00002bd0: 6f6f 7264 732e 6672 6f6d 5f66 696c 6528  oords.from_file(
-00002be0: 6469 7265 6374 6f72 7929 2c0a 2020 2020  directory),.    
-00002bf0: 2020 2020 2020 2020 7170 5f62 7569 6c64          qp_build
-00002c00: 6f75 743d 5150 5f62 7569 6c64 6f75 742e  out=QP_buildout.
-00002c10: 6672 6f6d 5f66 696c 6528 6469 7265 6374  from_file(direct
-00002c20: 6f72 7929 2c0a 2020 2020 2020 2020 2020  ory),.          
-00002c30: 2020 7175 5f6d 6574 7061 7261 6d73 3d51    qu_metparams=Q
-00002c40: 555f 6d65 7470 6172 616d 732e 6672 6f6d  U_metparams.from
-00002c50: 5f66 696c 6528 6469 7265 6374 6f72 7929  _file(directory)
-00002c60: 2c0a 2020 2020 2020 2020 2020 2020 7175  ,.            qu
-00002c70: 6963 5f66 6972 653d 5155 4943 5f66 6972  ic_fire=QUIC_fir
-00002c80: 652e 6672 6f6d 5f66 696c 6528 6469 7265  e.from_file(dire
-00002c90: 6374 6f72 792c 2076 6572 7369 6f6e 3d76  ctory, version=v
-00002ca0: 6572 7369 6f6e 292c 0a20 2020 2020 2020  ersion),.       
-00002cb0: 2020 2020 2067 7269 646c 6973 743d 4772       gridlist=Gr
-00002cc0: 6964 6c69 7374 2e66 726f 6d5f 6669 6c65  idlist.from_file
-00002cd0: 2864 6972 6563 746f 7279 292c 0a20 2020  (directory),.   
-00002ce0: 2020 2020 2020 2020 2077 696e 6473 656e           windsen
-00002cf0: 736f 7273 3d57 696e 6453 656e 736f 7241  sors=WindSensorA
-00002d00: 7272 6179 2e66 726f 6d5f 6669 6c65 2864  rray.from_file(d
-00002d10: 6972 6563 746f 7279 292c 0a20 2020 2020  irectory),.     
-00002d20: 2020 2020 2020 2071 755f 746f 706f 696e         qu_topoin
-00002d30: 7075 7473 3d51 555f 546f 706f 496e 7075  puts=QU_TopoInpu
-00002d40: 7473 2e66 726f 6d5f 6669 6c65 2864 6972  ts.from_file(dir
-00002d50: 6563 746f 7279 292c 0a20 2020 2020 2020  ectory),.       
-00002d60: 2020 2020 2071 755f 7369 6d70 6172 616d       qu_simparam
-00002d70: 733d 5155 5f53 696d 7061 7261 6d73 2e66  s=QU_Simparams.f
-00002d80: 726f 6d5f 6669 6c65 2864 6972 6563 746f  rom_file(directo
-00002d90: 7279 292c 0a20 2020 2020 2020 2029 0a0a  ry),.        )..
-00002da0: 2020 2020 4063 6c61 7373 6d65 7468 6f64      @classmethod
-00002db0: 0a20 2020 2064 6566 2066 726f 6d5f 6469  .    def from_di
-00002dc0: 6374 2863 6c73 2c20 6461 7461 3a20 6469  ct(cls, data: di
-00002dd0: 6374 2920 2d3e 2053 696d 756c 6174 696f  ct) -> Simulatio
-00002de0: 6e49 6e70 7574 733a 0a20 2020 2020 2020  nInputs:.       
-00002df0: 2022 2222 0a20 2020 2020 2020 2049 6e69   """.        Ini
-00002e00: 7469 616c 697a 6573 2061 2053 696d 756c  tializes a Simul
-00002e10: 6174 696f 6e49 6e70 7574 7320 6f62 6a65  ationInputs obje
-00002e20: 6374 2066 726f 6d20 6120 6469 6374 696f  ct from a dictio
-00002e30: 6e61 7279 2e0a 0a20 2020 2020 2020 2050  nary...        P
-00002e40: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
-00002e50: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-00002e60: 2020 2020 2064 6174 613a 2064 6963 740a       data: dict.
-00002e70: 2020 2020 2020 2020 2020 2020 4469 6374              Dict
-00002e80: 696f 6e61 7279 2063 6f6e 7461 696e 696e  ionary containin
-00002e90: 6720 696e 7075 7420 6669 6c65 2064 6174  g input file dat
-00002ea0: 612e 0a0a 2020 2020 2020 2020 4578 616d  a...        Exam
-00002eb0: 706c 6573 0a20 2020 2020 2020 202d 2d2d  ples.        ---
-00002ec0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3e3e  -----.        >>
-00002ed0: 3e20 6672 6f6d 2071 7569 6366 6972 655f  > from quicfire_
-00002ee0: 746f 6f6c 7320 696d 706f 7274 2053 696d  tools import Sim
-00002ef0: 756c 6174 696f 6e49 6e70 7574 730a 2020  ulationInputs.  
-00002f00: 2020 2020 2020 3e3e 3e20 6a73 6f6e 5f70        >>> json_p
-00002f10: 6174 6820 3d20 2270 6174 682f 746f 2f6a  ath = "path/to/j
-00002f20: 736f 6e2f 6f62 6a65 6374 220a 2020 2020  son/object".    
-00002f30: 2020 2020 3e3e 3e20 7369 6d5f 696e 7075      >>> sim_inpu
-00002f40: 7473 203d 2053 696d 756c 6174 696f 6e49  ts = SimulationI
-00002f50: 6e70 7574 732e 6672 6f6d 5f6a 736f 6e28  nputs.from_json(
-00002f60: 6a73 6f6e 5f70 6174 6829 0a20 2020 2020  json_path).     
-00002f70: 2020 203e 3e3e 2073 696d 5f64 6963 7420     >>> sim_dict 
-00002f80: 3d20 7369 6d5f 696e 7075 7473 2e74 6f5f  = sim_inputs.to_
-00002f90: 6469 6374 2829 0a20 2020 2020 2020 203e  dict().        >
-00002fa0: 3e3e 206e 6577 5f73 696d 5f69 6e70 7574  >> new_sim_input
-00002fb0: 7320 3d20 5369 6d75 6c61 7469 6f6e 496e  s = SimulationIn
-00002fc0: 7075 7473 2e66 726f 6d5f 6469 6374 2873  puts.from_dict(s
-00002fd0: 696d 5f64 6963 7429 0a20 2020 2020 2020  im_dict).       
-00002fe0: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
-00002ff0: 7572 6e20 636c 7328 0a20 2020 2020 2020  urn cls(.       
-00003000: 2020 2020 2072 6173 7465 726f 7269 6769       rasterorigi
-00003010: 6e3d 5261 7374 6572 4f72 6967 696e 2e66  n=RasterOrigin.f
-00003020: 726f 6d5f 6469 6374 2864 6174 615b 2272  rom_dict(data["r
-00003030: 6173 7465 726f 7269 6769 6e22 5d29 2c0a  asterorigin"]),.
-00003040: 2020 2020 2020 2020 2020 2020 7175 5f62              qu_b
-00003050: 7569 6c64 696e 6773 3d51 555f 4275 696c  uildings=QU_Buil
-00003060: 6469 6e67 732e 6672 6f6d 5f64 6963 7428  dings.from_dict(
-00003070: 6461 7461 5b22 7175 5f62 7569 6c64 696e  data["qu_buildin
-00003080: 6773 225d 292c 0a20 2020 2020 2020 2020  gs"]),.         
-00003090: 2020 2071 755f 6669 6c65 6f70 7469 6f6e     qu_fileoption
-000030a0: 733d 5155 5f46 696c 656f 7074 696f 6e73  s=QU_Fileoptions
-000030b0: 2e66 726f 6d5f 6469 6374 2864 6174 615b  .from_dict(data[
-000030c0: 2271 755f 6669 6c65 6f70 7469 6f6e 7322  "qu_fileoptions"
-000030d0: 5d29 2c0a 2020 2020 2020 2020 2020 2020  ]),.            
-000030e0: 7166 6972 655f 6164 7661 6e63 6564 5f75  qfire_advanced_u
-000030f0: 7365 725f 696e 7075 7473 3d51 4669 7265  ser_inputs=QFire
-00003100: 5f41 6476 616e 6365 645f 5573 6572 5f49  _Advanced_User_I
-00003110: 6e70 7574 732e 6672 6f6d 5f64 6963 7428  nputs.from_dict(
-00003120: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00003130: 2064 6174 615b 2271 6669 7265 5f61 6476   data["qfire_adv
-00003140: 616e 6365 645f 7573 6572 5f69 6e70 7574  anced_user_input
-00003150: 7322 5d0a 2020 2020 2020 2020 2020 2020  s"].            
-00003160: 292c 0a20 2020 2020 2020 2020 2020 2071  ),.            q
-00003170: 6669 7265 5f62 6c64 675f 6164 7661 6e63  fire_bldg_advanc
-00003180: 6564 5f75 7365 725f 696e 7075 7473 3d51  ed_user_inputs=Q
-00003190: 4669 7265 5f42 6c64 675f 4164 7661 6e63  Fire_Bldg_Advanc
-000031a0: 6564 5f55 7365 725f 496e 7075 7473 2e66  ed_User_Inputs.f
-000031b0: 726f 6d5f 6469 6374 280a 2020 2020 2020  rom_dict(.      
-000031c0: 2020 2020 2020 2020 2020 6461 7461 5b22            data["
-000031d0: 7166 6972 655f 626c 6467 5f61 6476 616e  qfire_bldg_advan
-000031e0: 6365 645f 7573 6572 5f69 6e70 7574 7322  ced_user_inputs"
-000031f0: 5d0a 2020 2020 2020 2020 2020 2020 292c  ].            ),
-00003200: 0a20 2020 2020 2020 2020 2020 2071 6669  .            qfi
-00003210: 7265 5f70 6c75 6d65 5f61 6476 616e 6365  re_plume_advance
-00003220: 645f 7573 6572 5f69 6e70 7574 733d 5146  d_user_inputs=QF
-00003230: 6972 655f 506c 756d 655f 4164 7661 6e63  ire_Plume_Advanc
-00003240: 6564 5f55 7365 725f 496e 7075 7473 2e66  ed_User_Inputs.f
-00003250: 726f 6d5f 6469 6374 280a 2020 2020 2020  rom_dict(.      
-00003260: 2020 2020 2020 2020 2020 6461 7461 5b22            data["
-00003270: 7166 6972 655f 706c 756d 655f 6164 7661  qfire_plume_adva
-00003280: 6e63 6564 5f75 7365 725f 696e 7075 7473  nced_user_inputs
-00003290: 225d 0a20 2020 2020 2020 2020 2020 2029  "].            )
-000032a0: 2c0a 2020 2020 2020 2020 2020 2020 7275  ,.            ru
-000032b0: 6e74 696d 655f 6164 7661 6e63 6564 5f75  ntime_advanced_u
-000032c0: 7365 725f 696e 7075 7473 3d52 756e 7469  ser_inputs=Runti
-000032d0: 6d65 4164 7661 6e63 6564 5573 6572 496e  meAdvancedUserIn
-000032e0: 7075 7473 2e66 726f 6d5f 6469 6374 280a  puts.from_dict(.
-000032f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003300: 6461 7461 5b22 7275 6e74 696d 655f 6164  data["runtime_ad
-00003310: 7661 6e63 6564 5f75 7365 725f 696e 7075  vanced_user_inpu
-00003320: 7473 225d 0a20 2020 2020 2020 2020 2020  ts"].           
-00003330: 2029 2c0a 2020 2020 2020 2020 2020 2020   ),.            
-00003340: 7175 5f6d 6f76 696e 6763 6f6f 7264 733d  qu_movingcoords=
-00003350: 5155 5f6d 6f76 696e 6763 6f6f 7264 732e  QU_movingcoords.
-00003360: 6672 6f6d 5f64 6963 7428 6461 7461 5b22  from_dict(data["
-00003370: 7175 5f6d 6f76 696e 6763 6f6f 7264 7322  qu_movingcoords"
-00003380: 5d29 2c0a 2020 2020 2020 2020 2020 2020  ]),.            
-00003390: 7170 5f62 7569 6c64 6f75 743d 5150 5f62  qp_buildout=QP_b
-000033a0: 7569 6c64 6f75 742e 6672 6f6d 5f64 6963  uildout.from_dic
-000033b0: 7428 6461 7461 5b22 7170 5f62 7569 6c64  t(data["qp_build
-000033c0: 6f75 7422 5d29 2c0a 2020 2020 2020 2020  out"]),.        
-000033d0: 2020 2020 7175 5f6d 6574 7061 7261 6d73      qu_metparams
-000033e0: 3d51 555f 6d65 7470 6172 616d 732e 6672  =QU_metparams.fr
-000033f0: 6f6d 5f64 6963 7428 6461 7461 5b22 7175  om_dict(data["qu
-00003400: 5f6d 6574 7061 7261 6d73 225d 292c 0a20  _metparams"]),. 
-00003410: 2020 2020 2020 2020 2020 2071 7569 635f             quic_
-00003420: 6669 7265 3d51 5549 435f 6669 7265 2e66  fire=QUIC_fire.f
-00003430: 726f 6d5f 6469 6374 2864 6174 615b 2271  rom_dict(data["q
-00003440: 7569 635f 6669 7265 225d 292c 0a20 2020  uic_fire"]),.   
-00003450: 2020 2020 2020 2020 2067 7269 646c 6973           gridlis
-00003460: 743d 4772 6964 6c69 7374 2e66 726f 6d5f  t=Gridlist.from_
-00003470: 6469 6374 2864 6174 615b 2267 7269 646c  dict(data["gridl
-00003480: 6973 7422 5d29 2c0a 2020 2020 2020 2020  ist"]),.        
-00003490: 2020 2020 7769 6e64 7365 6e73 6f72 733d      windsensors=
-000034a0: 5769 6e64 5365 6e73 6f72 4172 7261 792e  WindSensorArray.
-000034b0: 6672 6f6d 5f64 6963 7428 6461 7461 5b22  from_dict(data["
-000034c0: 7769 6e64 7365 6e73 6f72 7322 5d29 2c0a  windsensors"]),.
-000034d0: 2020 2020 2020 2020 2020 2020 7175 5f74              qu_t
-000034e0: 6f70 6f69 6e70 7574 733d 5155 5f54 6f70  opoinputs=QU_Top
-000034f0: 6f49 6e70 7574 732e 6672 6f6d 5f64 6963  oInputs.from_dic
-00003500: 7428 6461 7461 5b22 7175 5f74 6f70 6f69  t(data["qu_topoi
-00003510: 6e70 7574 7322 5d29 2c0a 2020 2020 2020  nputs"]),.      
-00003520: 2020 2020 2020 7175 5f73 696d 7061 7261        qu_simpara
-00003530: 6d73 3d51 555f 5369 6d70 6172 616d 732e  ms=QU_Simparams.
-00003540: 6672 6f6d 5f64 6963 7428 6461 7461 5b22  from_dict(data["
-00003550: 7175 5f73 696d 7061 7261 6d73 225d 292c  qu_simparams"]),
-00003560: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00003570: 4063 6c61 7373 6d65 7468 6f64 0a20 2020  @classmethod.   
-00003580: 2064 6566 2066 726f 6d5f 6a73 6f6e 2863   def from_json(c
-00003590: 6c73 2c20 7061 7468 3a20 7374 7220 7c20  ls, path: str | 
-000035a0: 5061 7468 2920 2d3e 2053 696d 756c 6174  Path) -> Simulat
-000035b0: 696f 6e49 6e70 7574 733a 0a20 2020 2020  ionInputs:.     
-000035c0: 2020 2022 2222 0a20 2020 2020 2020 2049     """.        I
-000035d0: 6e69 7469 616c 697a 6573 2061 2053 696d  nitializes a Sim
-000035e0: 756c 6174 696f 6e49 6e70 7574 7320 6f62  ulationInputs ob
-000035f0: 6a65 6374 2066 726f 6d20 6120 4a53 4f4e  ject from a JSON
-00003600: 2066 696c 652e 0a0a 2020 2020 2020 2020   file...        
-00003610: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
-00003620: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
-00003630: 2020 2020 2020 7061 7468 3a20 7374 7220        path: str 
-00003640: 7c20 5061 7468 0a20 2020 2020 2020 2020  | Path.         
-00003650: 2020 2050 6174 6820 746f 2074 6865 204a     Path to the J
-00003660: 534f 4e20 6669 6c65 2e0a 0a20 2020 2020  SON file...     
-00003670: 2020 2045 7861 6d70 6c65 730a 2020 2020     Examples.    
-00003680: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
-00003690: 2020 2020 203e 3e3e 2066 726f 6d20 7175       >>> from qu
-000036a0: 6963 6669 7265 5f74 6f6f 6c73 2069 6d70  icfire_tools imp
-000036b0: 6f72 7420 5369 6d75 6c61 7469 6f6e 496e  ort SimulationIn
-000036c0: 7075 7473 0a20 2020 2020 2020 203e 3e3e  puts.        >>>
-000036d0: 206a 736f 6e5f 7061 7468 203d 2022 7061   json_path = "pa
-000036e0: 7468 2f74 6f2f 6a73 6f6e 2f6f 626a 6563  th/to/json/objec
-000036f0: 7422 0a20 2020 2020 2020 203e 3e3e 2073  t".        >>> s
-00003700: 696d 5f69 6e70 7574 7320 3d20 5369 6d75  im_inputs = Simu
-00003710: 6c61 7469 6f6e 496e 7075 7473 2e66 726f  lationInputs.fro
-00003720: 6d5f 6a73 6f6e 286a 736f 6e5f 7061 7468  m_json(json_path
-00003730: 290a 2020 2020 2020 2020 2222 220a 2020  ).        """.  
-00003740: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-00003750: 6e63 6528 7061 7468 2c20 7374 7229 3a0a  nce(path, str):.
-00003760: 2020 2020 2020 2020 2020 2020 7061 7468              path
-00003770: 203d 2050 6174 6828 7061 7468 290a 2020   = Path(path).  
-00003780: 2020 2020 2020 7769 7468 206f 7065 6e28        with open(
-00003790: 7061 7468 2c20 2272 2229 2061 7320 663a  path, "r") as f:
-000037a0: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
-000037b0: 6120 3d20 6a73 6f6e 2e6c 6f61 6428 6629  a = json.load(f)
-000037c0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000037d0: 636c 732e 6672 6f6d 5f64 6963 7428 6461  cls.from_dict(da
-000037e0: 7461 290a 0a20 2020 2064 6566 2077 7269  ta)..    def wri
-000037f0: 7465 5f69 6e70 7574 7328 7365 6c66 2c20  te_inputs(self, 
-00003800: 6469 7265 6374 6f72 793a 2073 7472 207c  directory: str |
-00003810: 2050 6174 682c 2076 6572 7369 6f6e 3a20   Path, version: 
-00003820: 7374 7220 3d20 226c 6174 6573 7422 2920  str = "latest") 
-00003830: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-00003840: 2022 2222 0a20 2020 2020 2020 2057 7269   """.        Wri
-00003850: 7465 2061 6c6c 2069 6e70 7574 2066 696c  te all input fil
-00003860: 6573 2069 6e20 7468 6520 5369 6d75 6c61  es in the Simula
-00003870: 7469 6f6e 496e 7075 7473 206f 626a 6563  tionInputs objec
-00003880: 7420 746f 2061 2073 7065 6369 6669 6564  t to a specified
-00003890: 0a20 2020 2020 2020 2064 6972 6563 746f  .        directo
-000038a0: 7279 2e0a 0a20 2020 2020 2020 2054 6869  ry...        Thi
-000038b0: 7320 6d65 7468 6f64 2069 7320 6120 636f  s method is a co
-000038c0: 7265 206d 6574 686f 6420 6f66 2074 6865  re method of the
-000038d0: 2053 696d 756c 6174 696f 6e49 6e70 7574   SimulationInput
-000038e0: 7320 636c 6173 732e 2049 740a 2020 2020  s class. It.    
-000038f0: 2020 2020 6973 2074 6865 2070 7269 6e63      is the princ
-00003900: 6970 6c65 2077 6179 2074 6f20 7472 616e  iple way to tran
-00003910: 736c 6174 6520 6120 5369 6d75 6c61 7469  slate a Simulati
-00003920: 6f6e 496e 7075 7473 206f 626a 6563 7420  onInputs object 
-00003930: 696e 746f 2061 0a20 2020 2020 2020 2051  into a.        Q
-00003940: 5549 432d 4669 7265 2069 6e70 7574 2066  UIC-Fire input f
-00003950: 696c 6520 6465 636b 2e0a 0a20 2020 2020  ile deck...     
-00003960: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-00003970: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00003980: 0a20 2020 2020 2020 2064 6972 6563 746f  .        directo
-00003990: 7279 3a20 7374 7220 7c20 5061 7468 0a20  ry: str | Path. 
-000039a0: 2020 2020 2020 2020 2020 2044 6972 6563             Direc
-000039b0: 746f 7279 2074 6f20 7772 6974 6520 7468  tory to write th
-000039c0: 6520 696e 7075 7420 6669 6c65 7320 746f  e input files to
-000039d0: 2e0a 2020 2020 2020 2020 7665 7273 696f  ..        versio
-000039e0: 6e3a 2073 7472 0a20 2020 2020 2020 2020  n: str.         
-000039f0: 2020 2056 6572 7369 6f6e 206f 6620 7468     Version of th
-00003a00: 6520 696e 7075 7420 6669 6c65 7320 746f  e input files to
-00003a10: 2077 7269 7465 2e20 4465 6661 756c 7420   write. Default 
-00003a20: 6973 2022 6c61 7465 7374 222e 0a0a 2020  is "latest"...  
-00003a30: 2020 2020 2020 4578 616d 706c 6573 0a20        Examples. 
-00003a40: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0a         --------.
-00003a50: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
-00003a60: 2071 7569 6366 6972 655f 746f 6f6c 7320   quicfire_tools 
-00003a70: 696d 706f 7274 2053 696d 756c 6174 696f  import Simulatio
-00003a80: 6e49 6e70 7574 730a 2020 2020 2020 2020  nInputs.        
-00003a90: 3e3e 3e20 7369 6d5f 696e 7075 7473 203d  >>> sim_inputs =
-00003aa0: 2053 696d 756c 6174 696f 6e49 6e70 7574   SimulationInput
-00003ab0: 732e 6372 6561 7465 5f73 696d 756c 6174  s.create_simulat
-00003ac0: 696f 6e28 6e78 3d31 3030 2c20 6e79 3d31  ion(nx=100, ny=1
-00003ad0: 3030 2c20 6669 7265 5f6e 7a3d 3236 2c20  00, fire_nz=26, 
-00003ae0: 7769 6e64 5f73 7065 6564 3d31 2e38 2c20  wind_speed=1.8, 
-00003af0: 7769 6e64 5f64 6972 6563 7469 6f6e 3d39  wind_direction=9
-00003b00: 302c 2073 696d 756c 6174 696f 6e5f 7469  0, simulation_ti
-00003b10: 6d65 3d36 3030 290a 2020 2020 2020 2020  me=600).        
-00003b20: 3e3e 3e20 7369 6d5f 696e 7075 7473 2e77  >>> sim_inputs.w
-00003b30: 7269 7465 5f69 6e70 7574 7328 2270 6174  rite_inputs("pat
-00003b40: 682f 746f 2f73 696d 756c 6174 696f 6e2f  h/to/simulation/
-00003b50: 6469 7265 6374 6f72 7922 290a 2020 2020  directory").    
-00003b60: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00003b70: 6966 2069 7369 6e73 7461 6e63 6528 6469  if isinstance(di
-00003b80: 7265 6374 6f72 792c 2073 7472 293a 0a20  rectory, str):. 
-00003b90: 2020 2020 2020 2020 2020 2064 6972 6563             direc
-00003ba0: 746f 7279 203d 2050 6174 6828 6469 7265  tory = Path(dire
-00003bb0: 6374 6f72 7929 0a0a 2020 2020 2020 2020  ctory)..        
-00003bc0: 6966 206e 6f74 2064 6972 6563 746f 7279  if not directory
-00003bd0: 2e65 7869 7374 7328 293a 0a20 2020 2020  .exists():.     
-00003be0: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
-00003bf0: 4144 6972 6563 746f 7279 4572 726f 7228  ADirectoryError(
-00003c00: 6622 7b64 6972 6563 746f 7279 7d20 646f  f"{directory} do
-00003c10: 6573 206e 6f74 2065 7869 7374 2229 0a0a  es not exist")..
-00003c20: 2020 2020 2020 2020 7665 7273 696f 6e20          version 
-00003c30: 3d20 5f76 616c 6964 6174 655f 616e 645f  = _validate_and_
-00003c40: 7265 7475 726e 5f76 6572 7369 6f6e 2876  return_version(v
-00003c50: 6572 7369 6f6e 290a 0a20 2020 2020 2020  ersion)..       
-00003c60: 2073 656c 662e 5f75 7064 6174 655f 7368   self._update_sh
-00003c70: 6172 6564 5f61 7474 7269 6275 7465 7328  ared_attributes(
-00003c80: 290a 0a20 2020 2020 2020 2023 2053 6b69  )..        # Ski
-00003c90: 7020 7772 6974 696e 6720 6772 6964 6c69  p writing gridli
-00003ca0: 7374 2061 6e64 2072 6173 7465 726f 7269  st and rasterori
-00003cb0: 6769 6e20 6966 2066 7565 6c5f 666c 6167  gin if fuel_flag
-00003cc0: 203d 3d20 310a 2020 2020 2020 2020 736b   == 1.        sk
-00003cd0: 6970 5f69 6e70 7574 7320 3d20 5b5d 0a20  ip_inputs = []. 
-00003ce0: 2020 2020 2020 2069 6620 7365 6c66 2e71         if self.q
-00003cf0: 7569 635f 6669 7265 2e66 7565 6c5f 6465  uic_fire.fuel_de
-00003d00: 6e73 6974 795f 666c 6167 203d 3d20 333a  nsity_flag == 3:
-00003d10: 0a20 2020 2020 2020 2020 2020 2073 6b69  .            ski
-00003d20: 705f 696e 7075 7473 2e65 7874 656e 6428  p_inputs.extend(
-00003d30: 5b22 6772 6964 6c69 7374 222c 2022 7261  ["gridlist", "ra
-00003d40: 7374 6572 6f72 6967 696e 225d 290a 0a20  sterorigin"]).. 
-00003d50: 2020 2020 2020 2023 2057 7269 7465 2065         # Write e
-00003d60: 6163 6820 696e 7075 7420 6669 6c65 2074  ach input file t
-00003d70: 6f20 7468 6520 6f75 7470 7574 2064 6972  o the output dir
-00003d80: 6563 746f 7279 0a20 2020 2020 2020 2066  ectory.        f
-00003d90: 6f72 2069 6e70 7574 5f66 696c 6520 696e  or input_file in
-00003da0: 2073 656c 662e 5f69 6e70 7574 5f66 696c   self._input_fil
-00003db0: 6573 5f64 6963 742e 7661 6c75 6573 2829  es_dict.values()
-00003dc0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-00003dd0: 2069 6e70 7574 5f66 696c 6520 213d 2073   input_file != s
-00003de0: 656c 662e 5f69 6e70 7574 5f66 696c 6573  elf._input_files
-00003df0: 5f64 6963 745b 2277 696e 6473 656e 736f  _dict["windsenso
-00003e00: 7273 225d 3a0a 2020 2020 2020 2020 2020  rs"]:.          
-00003e10: 2020 2020 2020 696e 7075 745f 6669 6c65        input_file
-00003e20: 2e74 6f5f 6669 6c65 2864 6972 6563 746f  .to_file(directo
-00003e30: 7279 2c20 7665 7273 696f 6e3d 7665 7273  ry, version=vers
-00003e40: 696f 6e29 0a20 2020 2020 2020 2020 2020  ion).           
-00003e50: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00003e60: 2020 2020 2020 2069 6e70 7574 5f66 696c         input_fil
-00003e70: 652e 746f 5f66 696c 6528 7365 6c66 2e71  e.to_file(self.q
-00003e80: 7569 635f 6669 7265 2e74 696d 655f 6e6f  uic_fire.time_no
-00003e90: 772c 2064 6972 6563 746f 7279 2c20 7665  w, directory, ve
-00003ea0: 7273 696f 6e3d 7665 7273 696f 6e29 0a0a  rsion=version)..
-00003eb0: 2020 2020 2020 2020 2320 436f 7079 2051          # Copy Q
-00003ec0: 555f 6c61 6e64 7573 6520 6672 6f6d 2074  U_landuse from t
-00003ed0: 6865 2074 656d 706c 6174 6520 6469 7265  he template dire
-00003ee0: 6374 6f72 7920 746f 2074 6865 206f 7574  ctory to the out
-00003ef0: 7075 7420 6469 7265 6374 6f72 790a 2020  put directory.  
-00003f00: 2020 2020 2020 7465 6d70 6c61 7465 5f66        template_f
-00003f10: 696c 655f 7061 7468 203d 2054 454d 504c  ile_path = TEMPL
-00003f20: 4154 4553 5f50 4154 4820 2f20 7665 7273  ATES_PATH / vers
-00003f30: 696f 6e20 2f20 2251 555f 6c61 6e64 7573  ion / "QU_landus
-00003f40: 652e 696e 7022 0a20 2020 2020 2020 206f  e.inp".        o
-00003f50: 7574 7075 745f 6669 6c65 5f70 6174 6820  utput_file_path 
-00003f60: 3d20 6469 7265 6374 6f72 7920 2f20 2251  = directory / "Q
-00003f70: 555f 6c61 6e64 7573 652e 696e 7022 0a20  U_landuse.inp". 
-00003f80: 2020 2020 2020 2077 6974 6820 6f70 656e         with open
-00003f90: 2874 656d 706c 6174 655f 6669 6c65 5f70  (template_file_p
-00003fa0: 6174 682c 2022 7262 2229 2061 7320 6674  ath, "rb") as ft
-00003fb0: 656d 703a 0a20 2020 2020 2020 2020 2020  emp:.           
-00003fc0: 2077 6974 6820 6f70 656e 286f 7574 7075   with open(outpu
-00003fd0: 745f 6669 6c65 5f70 6174 682c 2022 7762  t_file_path, "wb
-00003fe0: 2229 2061 7320 666f 7574 3a0a 2020 2020  ") as fout:.    
-00003ff0: 2020 2020 2020 2020 2020 2020 666f 7574              fout
-00004000: 2e77 7269 7465 2866 7465 6d70 2e72 6561  .write(ftemp.rea
-00004010: 6428 2929 0a0a 2020 2020 6465 6620 746f  d())..    def to
-00004020: 5f64 6963 7428 7365 6c66 2920 2d3e 2064  _dict(self) -> d
-00004030: 6963 743a 0a20 2020 2020 2020 2022 2222  ict:.        """
-00004040: 0a20 2020 2020 2020 2043 6f6e 7665 7274  .        Convert
-00004050: 2074 6865 2073 7461 7465 206f 6620 7468   the state of th
-00004060: 6520 5369 6d75 6c61 7469 6f6e 496e 7075  e SimulationInpu
-00004070: 7473 206f 626a 6563 7420 746f 2061 2064  ts object to a d
-00004080: 6963 7469 6f6e 6172 792e 0a20 2020 2020  ictionary..     
-00004090: 2020 2054 6865 206e 616d 6520 6f66 2065     The name of e
-000040a0: 6163 6820 696e 7075 7420 6669 6c65 2069  ach input file i
-000040b0: 6e20 7468 6520 5369 6d75 6c61 7469 6f6e  n the Simulation
-000040c0: 496e 7075 7473 206f 626a 6563 7420 6973  Inputs object is
-000040d0: 2061 206b 6579 0a20 2020 2020 2020 2074   a key.        t
-000040e0: 6f20 7468 6174 2069 6e70 7574 2066 696c  o that input fil
-000040f0: 6527 7320 6469 6374 696f 6e61 7279 2066  e's dictionary f
-00004100: 6f72 6d2e 0a0a 2020 2020 2020 2020 5265  orm...        Re
-00004110: 7475 726e 730a 2020 2020 2020 2020 2d2d  turns.        --
-00004120: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6469  -----.        di
-00004130: 6374 0a20 2020 2020 2020 2020 2020 2044  ct.            D
-00004140: 6963 7469 6f6e 6172 7920 7265 7072 6573  ictionary repres
-00004150: 656e 7461 7469 6f6e 206f 6620 7468 6520  entation of the 
-00004160: 6f62 6a65 6374 2e0a 0a20 2020 2020 2020  object...       
-00004170: 2045 7861 6d70 6c65 730a 2020 2020 2020   Examples.      
-00004180: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
-00004190: 2020 203e 3e3e 2066 726f 6d20 7175 6963     >>> from quic
-000041a0: 6669 7265 5f74 6f6f 6c73 2069 6d70 6f72  fire_tools impor
-000041b0: 7420 5369 6d75 6c61 7469 6f6e 496e 7075  t SimulationInpu
-000041c0: 7473 0a20 2020 2020 2020 203e 3e3e 2073  ts.        >>> s
-000041d0: 696d 5f69 6e70 7574 7320 3d20 5369 6d75  im_inputs = Simu
-000041e0: 6c61 7469 6f6e 496e 7075 7473 2e63 7265  lationInputs.cre
-000041f0: 6174 655f 7369 6d75 6c61 7469 6f6e 286e  ate_simulation(n
-00004200: 783d 3130 302c 206e 793d 3130 302c 2066  x=100, ny=100, f
-00004210: 6972 655f 6e7a 3d32 362c 2077 696e 645f  ire_nz=26, wind_
-00004220: 7370 6565 643d 312e 382c 2077 696e 645f  speed=1.8, wind_
-00004230: 6469 7265 6374 696f 6e3d 3930 2c20 7369  direction=90, si
-00004240: 6d75 6c61 7469 6f6e 5f74 696d 653d 3630  mulation_time=60
-00004250: 3029 0a20 2020 2020 2020 203e 3e3e 2073  0).        >>> s
-00004260: 696d 5f64 6963 7420 3d20 7369 6d5f 696e  im_dict = sim_in
-00004270: 7075 7473 2e74 6f5f 6469 6374 2829 0a20  puts.to_dict(). 
-00004280: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00004290: 2020 2072 6574 7572 6e20 7b6b 6579 3a20     return {key: 
-000042a0: 7661 6c75 652e 746f 5f64 6963 7428 2920  value.to_dict() 
-000042b0: 666f 7220 6b65 792c 2076 616c 7565 2069  for key, value i
-000042c0: 6e20 7365 6c66 2e5f 696e 7075 745f 6669  n self._input_fi
-000042d0: 6c65 735f 6469 6374 2e69 7465 6d73 2829  les_dict.items()
-000042e0: 7d0a 0a20 2020 2064 6566 2074 6f5f 6a73  }..    def to_js
-000042f0: 6f6e 2873 656c 662c 2070 6174 683a 2073  on(self, path: s
-00004300: 7472 207c 2050 6174 6829 202d 3e20 4e6f  tr | Path) -> No
-00004310: 6e65 3a0a 2020 2020 2020 2020 2222 220a  ne:.        """.
-00004320: 2020 2020 2020 2020 5772 6974 6520 7468          Write th
-00004330: 6520 5369 6d75 6c61 7469 6f6e 496e 7075  e SimulationInpu
-00004340: 7473 206f 626a 6563 7420 746f 2061 204a  ts object to a J
-00004350: 534f 4e20 6669 6c65 2e0a 0a20 2020 2020  SON file...     
-00004360: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-00004370: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00004380: 0a20 2020 2020 2020 2070 6174 6820 3a20  .        path : 
-00004390: 7374 7220 7c20 5061 7468 0a20 2020 2020  str | Path.     
-000043a0: 2020 2020 2020 2050 6174 6820 746f 2077         Path to w
-000043b0: 7269 7465 2074 6865 204a 534f 4e20 6669  rite the JSON fi
-000043c0: 6c65 2074 6f2e 0a0a 2020 2020 2020 2020  le to...        
-000043d0: 4578 616d 706c 6573 0a20 2020 2020 2020  Examples.       
-000043e0: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
-000043f0: 2020 3e3e 3e20 6672 6f6d 2071 7569 6366    >>> from quicf
-00004400: 6972 655f 746f 6f6c 7320 696d 706f 7274  ire_tools import
-00004410: 2053 696d 756c 6174 696f 6e49 6e70 7574   SimulationInput
-00004420: 730a 2020 2020 2020 2020 3e3e 3e20 7369  s.        >>> si
-00004430: 6d5f 696e 7075 7473 203d 2053 696d 756c  m_inputs = Simul
-00004440: 6174 696f 6e49 6e70 7574 732e 6372 6561  ationInputs.crea
-00004450: 7465 5f73 696d 756c 6174 696f 6e28 6e78  te_simulation(nx
-00004460: 3d31 3030 2c20 6e79 3d31 3030 2c20 6669  =100, ny=100, fi
-00004470: 7265 5f6e 7a3d 3236 2c20 7769 6e64 5f73  re_nz=26, wind_s
-00004480: 7065 6564 3d31 2e38 2c20 7769 6e64 5f64  peed=1.8, wind_d
-00004490: 6972 6563 7469 6f6e 3d39 302c 2073 696d  irection=90, sim
-000044a0: 756c 6174 696f 6e5f 7469 6d65 3d36 3030  ulation_time=600
-000044b0: 290a 2020 2020 2020 2020 3e3e 3e20 7369  ).        >>> si
-000044c0: 6d5f 696e 7075 7473 2e74 6f5f 6a73 6f6e  m_inputs.to_json
-000044d0: 2822 7061 7468 2f74 6f2f 6a73 6f6e 2f6f  ("path/to/json/o
-000044e0: 626a 6563 7422 290a 2020 2020 2020 2020  bject").        
-000044f0: 2222 220a 2020 2020 2020 2020 6966 2069  """.        if i
-00004500: 7369 6e73 7461 6e63 6528 7061 7468 2c20  sinstance(path, 
-00004510: 7374 7229 3a0a 2020 2020 2020 2020 2020  str):.          
-00004520: 2020 7061 7468 203d 2050 6174 6828 7061    path = Path(pa
-00004530: 7468 290a 2020 2020 2020 2020 7769 7468  th).        with
-00004540: 206f 7065 6e28 7061 7468 2c20 2277 2229   open(path, "w")
-00004550: 2061 7320 663a 0a20 2020 2020 2020 2020   as f:.         
-00004560: 2020 206a 736f 6e2e 6475 6d70 2873 656c     json.dump(sel
-00004570: 662e 746f 5f64 6963 7428 292c 2066 2c20  f.to_dict(), f, 
-00004580: 696e 6465 6e74 3d34 290a 0a20 2020 2064  indent=4)..    d
-00004590: 6566 2073 6574 5f63 7573 746f 6d5f 7369  ef set_custom_si
-000045a0: 6d75 6c61 7469 6f6e 280a 2020 2020 2020  mulation(.      
-000045b0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-000045c0: 6675 656c 5f64 656e 7369 7479 3a20 626f  fuel_density: bo
-000045d0: 6f6c 203d 2054 7275 652c 0a20 2020 2020  ol = True,.     
-000045e0: 2020 2066 7565 6c5f 6d6f 6973 7475 7265     fuel_moisture
-000045f0: 3a20 626f 6f6c 203d 2054 7275 652c 0a20  : bool = True,. 
-00004600: 2020 2020 2020 2066 7565 6c5f 6865 6967         fuel_heig
-00004610: 6874 3a20 626f 6f6c 203d 2054 7275 652c  ht: bool = True,
-00004620: 0a20 2020 2020 2020 2073 697a 655f 7363  .        size_sc
-00004630: 616c 653a 2062 6f6f 6c20 3d20 4661 6c73  ale: bool = Fals
-00004640: 652c 0a20 2020 2020 2020 2070 6174 6368  e,.        patch
-00004650: 5f61 6e64 5f67 6170 3a20 626f 6f6c 203d  _and_gap: bool =
-00004660: 2046 616c 7365 2c0a 2020 2020 2020 2020   False,.        
-00004670: 6967 6e69 7469 6f6e 3a20 626f 6f6c 203d  ignition: bool =
-00004680: 2054 7275 652c 0a20 2020 2020 2020 2074   True,.        t
-00004690: 6f70 6f3a 2062 6f6f 6c20 3d20 5472 7565  opo: bool = True
-000046a0: 2c0a 2020 2020 2920 2d3e 204e 6f6e 653a  ,.    ) -> None:
-000046b0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-000046c0: 2020 2020 2053 6574 7320 7468 6520 7369       Sets the si
-000046d0: 6d75 6c61 7469 6f6e 2074 6f20 7573 6520  mulation to use 
-000046e0: 6375 7374 6f6d 2066 7565 6c2c 2069 676e  custom fuel, ign
-000046f0: 6974 696f 6e2c 2061 6e64 2074 6f70 6f67  ition, and topog
-00004700: 7261 7068 790a 2020 2020 2020 2020 7365  raphy.        se
-00004710: 7474 696e 6773 2e0a 0a20 2020 2020 2020  ttings...       
-00004720: 2054 6869 7320 6675 6e63 7469 6f6e 2063   This function c
-00004730: 616e 2062 6520 7573 6566 756c 2066 6f72  an be useful for
-00004740: 2073 6574 7469 6e67 2075 7020 7369 6d75   setting up simu
-00004750: 6c61 7469 6f6e 7320 7468 6174 2075 7365  lations that use
-00004760: 202e 6461 740a 2020 2020 2020 2020 6669   .dat.        fi
-00004770: 6c65 7320 746f 2064 6566 696e 6520 6375  les to define cu
-00004780: 7374 6f6d 2066 7565 6c2c 2074 6f70 6f67  stom fuel, topog
-00004790: 7261 7068 792c 206f 7220 6967 6e69 7469  raphy, or igniti
-000047a0: 6f6e 2069 6e70 7574 732e 0a0a 2020 2020  on inputs...    
-000047b0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-000047c0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-000047d0: 2d0a 2020 2020 2020 2020 6675 656c 5f64  -.        fuel_d
-000047e0: 656e 7369 7479 3a20 626f 6f6c 2c20 6f70  ensity: bool, op
-000047f0: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
-00004800: 2020 2049 6620 5472 7565 2c20 7365 7473     If True, sets
-00004810: 2074 6865 2073 696d 756c 6174 696f 6e20   the simulation 
-00004820: 746f 2075 7365 2066 7565 6c20 6465 6e73  to use fuel dens
-00004830: 6974 7920 696e 666f 726d 6174 696f 6e20  ity information 
-00004840: 6672 6f6d 0a20 2020 2020 2020 2020 2020  from.           
-00004850: 2061 2074 7265 6573 7268 6f66 2e64 6174   a treesrhof.dat
-00004860: 2066 696c 6520 2866 7565 6c20 6465 6e73   file (fuel dens
-00004870: 6974 7920 666c 6167 2033 292e 2044 6566  ity flag 3). Def
-00004880: 6175 6c74 2069 7320 5472 7565 2e0a 2020  ault is True..  
-00004890: 2020 2020 2020 6675 656c 5f6d 6f69 7374        fuel_moist
-000048a0: 7572 653a 2062 6f6f 6c2c 206f 7074 696f  ure: bool, optio
-000048b0: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
-000048c0: 4966 2054 7275 652c 2073 6574 7320 7468  If True, sets th
-000048d0: 6520 7369 6d75 6c61 7469 6f6e 2074 6f20  e simulation to 
-000048e0: 7573 6520 6675 656c 206d 6f69 7374 7572  use fuel moistur
-000048f0: 6520 696e 666f 726d 6174 696f 6e20 6672  e information fr
-00004900: 6f6d 0a20 2020 2020 2020 2020 2020 2061  om.            a
-00004910: 2074 7265 6573 6d6f 6973 742e 6461 7420   treesmoist.dat 
-00004920: 6669 6c65 2028 6675 656c 206d 6f69 7374  file (fuel moist
-00004930: 7572 6520 666c 6167 2033 292e 2044 6566  ure flag 3). Def
-00004940: 6175 6c74 2069 7320 5472 7565 2e0a 2020  ault is True..  
-00004950: 2020 2020 2020 6675 656c 5f68 6569 6768        fuel_heigh
-00004960: 743a 2062 6f6f 6c2c 206f 7074 696f 6e61  t: bool, optiona
-00004970: 6c0a 2020 2020 2020 2020 2020 2020 4966  l.            If
-00004980: 2054 7275 652c 2073 6574 7320 7468 6520   True, sets the 
-00004990: 7369 6d75 6c61 7469 6f6e 2074 6f20 7573  simulation to us
-000049a0: 6520 6675 656c 2068 6569 6768 7420 696e  e fuel height in
-000049b0: 666f 726d 6174 696f 6e20 6672 6f6d 0a20  formation from. 
-000049c0: 2020 2020 2020 2020 2020 2061 2074 7265             a tre
-000049d0: 6573 6465 7074 682e 6461 7420 6669 6c65  esdepth.dat file
-000049e0: 2028 6675 656c 2068 6569 6768 7420 666c   (fuel height fl
-000049f0: 6167 2033 292e 2044 6566 6175 6c74 2069  ag 3). Default i
-00004a00: 7320 5472 7565 2e0a 2020 2020 2020 2020  s True..        
-00004a10: 7369 7a65 5f73 6361 6c65 3a20 626f 6f6c  size_scale: bool
-00004a20: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
-00004a30: 2020 2020 2020 2049 6620 5472 7565 2c20         If True, 
-00004a40: 7365 7473 2074 6865 2073 696d 756c 6174  sets the simulat
-00004a50: 696f 6e20 746f 2075 7365 2073 697a 6520  ion to use size 
-00004a60: 7363 616c 6520 696e 666f 726d 6174 696f  scale informatio
-00004a70: 6e20 6672 6f6d 0a20 2020 2020 2020 2020  n from.         
-00004a80: 2020 2061 2074 7265 6573 7373 2e64 6174     a treesss.dat
-00004a90: 2066 696c 6520 2873 697a 6520 7363 616c   file (size scal
-00004aa0: 6520 666c 6167 2033 292e 2044 6566 6175  e flag 3). Defau
-00004ab0: 6c74 7320 746f 2046 616c 7365 2061 7320  lts to False as 
-00004ac0: 7468 6973 0a20 2020 2020 2020 2020 2020  this.           
-00004ad0: 2069 7320 6120 6e65 7720 6665 6174 7572   is a new featur
-00004ae0: 652e 0a20 2020 2020 2020 2070 6174 6368  e..        patch
-00004af0: 5f61 6e64 5f67 6170 3a20 626f 6f6c 2c20  _and_gap: bool, 
-00004b00: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-00004b10: 2020 2020 2049 6620 5472 7565 2c20 7365       If True, se
-00004b20: 7473 2074 6865 2073 696d 756c 6174 696f  ts the simulatio
-00004b30: 6e20 746f 2075 7365 2070 6174 6368 2061  n to use patch a
-00004b40: 6e64 2067 6170 2069 6e66 6f72 6d61 7469  nd gap informati
-00004b50: 6f6e 2066 726f 6d0a 2020 2020 2020 2020  on from.        
-00004b60: 2020 2020 7061 7463 682e 6461 7420 616e      patch.dat an
-00004b70: 6420 6761 702e 6461 7420 6669 6c65 7320  d gap.dat files 
-00004b80: 2870 6174 6368 2061 6e64 2067 6170 2066  (patch and gap f
-00004b90: 6c61 6720 3229 2e20 4465 6661 756c 7473  lag 2). Defaults
-00004ba0: 2074 6f0a 2020 2020 2020 2020 2020 2020   to.            
-00004bb0: 4661 6c73 6520 6173 2074 6869 7320 6973  False as this is
-00004bc0: 2061 206e 6577 2066 6561 7475 7265 2e0a   a new feature..
-00004bd0: 2020 2020 2020 2020 6967 6e69 7469 6f6e          ignition
-00004be0: 203a 2062 6f6f 6c2c 206f 7074 696f 6e61   : bool, optiona
-00004bf0: 6c0a 2020 2020 2020 2020 2020 2020 4966  l.            If
-00004c00: 2054 7275 652c 2073 6574 7320 7468 6520   True, sets the 
-00004c10: 7369 6d75 6c61 7469 6f6e 2074 6f20 7573  simulation to us
-00004c20: 6520 6120 6375 7374 6f6d 2069 676e 6974  e a custom ignit
-00004c30: 696f 6e20 736f 7572 6365 0a20 2020 2020  ion source.     
-00004c40: 2020 2020 2020 2028 6967 6e69 7469 6f6e         (ignition
-00004c50: 2066 6c61 6720 3629 2e20 4465 6661 756c   flag 6). Defaul
-00004c60: 7420 6973 2054 7275 652e 0a20 2020 2020  t is True..     
-00004c70: 2020 2074 6f70 6f20 3a20 626f 6f6c 2c20     topo : bool, 
-00004c80: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-00004c90: 2020 2020 2049 6620 5472 7565 2c20 7365       If True, se
-00004ca0: 7473 2074 6865 2073 696d 756c 6174 696f  ts the simulatio
-00004cb0: 6e20 746f 2075 7365 2063 7573 746f 6d20  n to use custom 
-00004cc0: 746f 706f 6772 6170 6879 2073 6574 7469  topography setti
-00004cd0: 6e67 730a 2020 2020 2020 2020 2020 2020  ngs.            
-00004ce0: 2874 6f70 6f67 7261 7068 7920 666c 6167  (topography flag
-00004cf0: 2035 292e 2044 6566 6175 6c74 2069 7320   5). Default is 
-00004d00: 5472 7565 2e0a 0a20 2020 2020 2020 2045  True...        E
-00004d10: 7861 6d70 6c65 730a 2020 2020 2020 2020  xamples.        
-00004d20: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00004d30: 203e 3e3e 2066 726f 6d20 7175 6963 6669   >>> from quicfi
-00004d40: 7265 5f74 6f6f 6c73 2069 6d70 6f72 7420  re_tools import 
-00004d50: 5369 6d75 6c61 7469 6f6e 496e 7075 7473  SimulationInputs
-00004d60: 0a20 2020 2020 2020 203e 3e3e 2073 696d  .        >>> sim
-00004d70: 5f69 6e70 7574 7320 3d20 5369 6d75 6c61  _inputs = Simula
-00004d80: 7469 6f6e 496e 7075 7473 2e63 7265 6174  tionInputs.creat
-00004d90: 655f 7369 6d75 6c61 7469 6f6e 286e 783d  e_simulation(nx=
-00004da0: 3130 302c 206e 793d 3130 302c 2066 6972  100, ny=100, fir
-00004db0: 655f 6e7a 3d32 362c 2077 696e 645f 7370  e_nz=26, wind_sp
-00004dc0: 6565 643d 312e 382c 2077 696e 645f 6469  eed=1.8, wind_di
-00004dd0: 7265 6374 696f 6e3d 3930 2c20 7369 6d75  rection=90, simu
-00004de0: 6c61 7469 6f6e 5f74 696d 653d 3630 3029  lation_time=600)
-00004df0: 0a20 2020 2020 2020 203e 3e3e 2073 696d  .        >>> sim
-00004e00: 5f69 6e70 7574 732e 7365 745f 6375 7374  _inputs.set_cust
-00004e10: 6f6d 5f73 696d 756c 6174 696f 6e28 6675  om_simulation(fu
-00004e20: 656c 3d54 7275 652c 2069 676e 6974 696f  el=True, ignitio
-00004e30: 6e3d 5472 7565 2c20 746f 706f 3d54 7275  n=True, topo=Tru
-00004e40: 6529 0a20 2020 2020 2020 203e 3e3e 2073  e).        >>> s
-00004e50: 696d 5f69 6e70 7574 732e 7175 6963 5f66  im_inputs.quic_f
-00004e60: 6972 652e 6675 656c 5f66 6c61 670a 2020  ire.fuel_flag.  
-00004e70: 2020 2020 2020 330a 2020 2020 2020 2020        3.        
-00004e80: 2222 220a 2020 2020 2020 2020 6966 2066  """.        if f
-00004e90: 7565 6c5f 6465 6e73 6974 793a 0a20 2020  uel_density:.   
-00004ea0: 2020 2020 2020 2020 2073 656c 662e 7175           self.qu
-00004eb0: 6963 5f66 6972 652e 6675 656c 5f64 656e  ic_fire.fuel_den
-00004ec0: 7369 7479 5f66 6c61 6720 3d20 330a 2020  sity_flag = 3.  
-00004ed0: 2020 2020 2020 6966 2066 7565 6c5f 6d6f        if fuel_mo
-00004ee0: 6973 7475 7265 3a0a 2020 2020 2020 2020  isture:.        
-00004ef0: 2020 2020 7365 6c66 2e71 7569 635f 6669      self.quic_fi
-00004f00: 7265 2e66 7565 6c5f 6d6f 6973 7475 7265  re.fuel_moisture
-00004f10: 5f66 6c61 6720 3d20 330a 2020 2020 2020  _flag = 3.      
-00004f20: 2020 6966 2066 7565 6c5f 6865 6967 6874    if fuel_height
-00004f30: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-00004f40: 6c66 2e71 7569 635f 6669 7265 2e66 7565  lf.quic_fire.fue
-00004f50: 6c5f 6865 6967 6874 5f66 6c61 6720 3d20  l_height_flag = 
-00004f60: 330a 2020 2020 2020 2020 6966 2073 697a  3.        if siz
-00004f70: 655f 7363 616c 653a 0a20 2020 2020 2020  e_scale:.       
-00004f80: 2020 2020 2073 656c 662e 7175 6963 5f66       self.quic_f
-00004f90: 6972 652e 7369 7a65 5f73 6361 6c65 5f66  ire.size_scale_f
-00004fa0: 6c61 6720 3d20 330a 2020 2020 2020 2020  lag = 3.        
-00004fb0: 6966 2070 6174 6368 5f61 6e64 5f67 6170  if patch_and_gap
-00004fc0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-00004fd0: 6c66 2e71 7569 635f 6669 7265 2e70 6174  lf.quic_fire.pat
-00004fe0: 6368 5f61 6e64 5f67 6170 5f66 6c61 6720  ch_and_gap_flag 
-00004ff0: 3d20 320a 2020 2020 2020 2020 6966 2069  = 2.        if i
-00005000: 676e 6974 696f 6e3a 0a20 2020 2020 2020  gnition:.       
-00005010: 2020 2020 2073 656c 662e 7175 6963 5f66       self.quic_f
-00005020: 6972 652e 6967 6e69 7469 6f6e 5f74 7970  ire.ignition_typ
-00005030: 6520 3d20 4967 6e69 7469 6f6e 5479 7065  e = IgnitionType
-00005040: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00005050: 2020 6967 6e69 7469 6f6e 5f66 6c61 673d    ignition_flag=
-00005060: 4967 6e69 7469 6f6e 536f 7572 6365 7328  IgnitionSources(
-00005070: 3729 0a20 2020 2020 2020 2020 2020 2029  7).            )
-00005080: 0a20 2020 2020 2020 2069 6620 746f 706f  .        if topo
-00005090: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-000050a0: 6c66 2e71 755f 746f 706f 696e 7075 7473  lf.qu_topoinputs
-000050b0: 2e74 6f70 6f5f 7479 7065 203d 2054 6f70  .topo_type = Top
-000050c0: 6f54 7970 6528 746f 706f 5f66 6c61 673d  oType(topo_flag=
-000050d0: 546f 706f 536f 7572 6365 7328 3529 290a  TopoSources(5)).
-000050e0: 0a20 2020 2064 6566 2073 6574 5f75 6e69  .    def set_uni
-000050f0: 666f 726d 5f66 7565 6c73 280a 2020 2020  form_fuels(.    
-00005100: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-00005110: 2020 6675 656c 5f64 656e 7369 7479 3a20    fuel_density: 
-00005120: 666c 6f61 742c 0a20 2020 2020 2020 2066  float,.        f
-00005130: 7565 6c5f 6d6f 6973 7475 7265 3a20 666c  uel_moisture: fl
-00005140: 6f61 742c 0a20 2020 2020 2020 2066 7565  oat,.        fue
-00005150: 6c5f 6865 6967 6874 3a20 666c 6f61 742c  l_height: float,
-00005160: 0a20 2020 2020 2020 2073 697a 655f 7363  .        size_sc
-00005170: 616c 653a 2066 6c6f 6174 203d 2030 2e30  ale: float = 0.0
-00005180: 3030 352c 0a20 2020 2020 2020 2070 6174  005,.        pat
-00005190: 6368 5f73 697a 653a 2066 6c6f 6174 203d  ch_size: float =
-000051a0: 2030 2e30 2c0a 2020 2020 2020 2020 6761   0.0,.        ga
-000051b0: 705f 7369 7a65 3a20 666c 6f61 7420 3d20  p_size: float = 
-000051c0: 302e 302c 0a20 2020 2029 202d 3e20 4e6f  0.0,.    ) -> No
-000051d0: 6e65 3a0a 2020 2020 2020 2020 2222 220a  ne:.        """.
-000051e0: 2020 2020 2020 2020 5365 7473 2074 6865          Sets the
-000051f0: 2073 696d 756c 6174 696f 6e20 746f 2075   simulation to u
-00005200: 7365 2075 6e69 666f 726d 2066 7565 6c20  se uniform fuel 
-00005210: 7365 7474 696e 6773 2e20 5468 6973 2066  settings. This f
-00005220: 756e 6374 696f 6e20 7570 6461 7465 730a  unction updates.
-00005230: 2020 2020 2020 2020 7468 6520 6675 656c          the fuel
-00005240: 2066 6c61 6720 746f 2031 2061 6e64 2073   flag to 1 and s
-00005250: 6574 7320 7468 6520 6675 656c 2064 656e  ets the fuel den
-00005260: 7369 7479 2c20 6675 656c 206d 6f69 7374  sity, fuel moist
-00005270: 7572 652c 2061 6e64 2066 7565 6c0a 2020  ure, and fuel.  
-00005280: 2020 2020 2020 6865 6967 6874 2074 6f20        height to 
-00005290: 7468 6520 7370 6563 6966 6965 6420 7661  the specified va
-000052a0: 6c75 6573 2e0a 0a20 2020 2020 2020 2050  lues...        P
-000052b0: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
-000052c0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-000052d0: 2020 2020 2066 7565 6c5f 6465 6e73 6974       fuel_densit
-000052e0: 793a 2066 6c6f 6174 0a20 2020 2020 2020  y: float.       
-000052f0: 2020 2020 2046 7565 6c20 6275 6c6b 2064       Fuel bulk d
-00005300: 656e 7369 7479 205b 6b67 2f6d 5e33 5d2e  ensity [kg/m^3].
-00005310: 204e 6f74 653a 2054 6869 7320 6973 2074   Note: This is t
-00005320: 6865 2066 7565 6c20 6275 6c6b 2064 656e  he fuel bulk den
-00005330: 7369 7479 2c20 736f 0a20 2020 2020 2020  sity, so.       
-00005340: 2020 2020 2074 6865 2066 7565 6c20 6c6f       the fuel lo
-00005350: 6164 2073 686f 756c 6420 6265 206e 6f72  ad should be nor
-00005360: 6d61 6c69 7a65 6420 6279 2074 6865 2068  malized by the h
-00005370: 6569 6768 7420 6f66 2074 6865 2066 7565  eight of the fue
-00005380: 6c20 6265 642e 0a20 2020 2020 2020 2066  l bed..        f
-00005390: 7565 6c5f 6d6f 6973 7475 7265 3a20 666c  uel_moisture: fl
-000053a0: 6f61 740a 2020 2020 2020 2020 2020 2020  oat.            
-000053b0: 4675 656c 206d 6f69 7374 7572 6520 636f  Fuel moisture co
-000053c0: 6e74 656e 7420 5b25 5d2e 0a20 2020 2020  ntent [%]..     
-000053d0: 2020 2066 7565 6c5f 6865 6967 6874 3a20     fuel_height: 
-000053e0: 666c 6f61 740a 2020 2020 2020 2020 2020  float.          
-000053f0: 2020 4675 656c 2062 6564 2068 6569 6768    Fuel bed heigh
-00005400: 7420 5b6d 5d2e 0a20 2020 2020 2020 2073  t [m]..        s
-00005410: 697a 655f 7363 616c 653a 2066 6c6f 6174  ize_scale: float
-00005420: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
-00005430: 2020 2020 2020 2053 697a 6520 7363 616c         Size scal
-00005440: 6520 5b6d 5d2e 2044 6566 6175 6c74 2069  e [m]. Default i
-00005450: 7320 302e 3030 3035 2e0a 2020 2020 2020  s 0.0005..      
-00005460: 2020 7061 7463 685f 7369 7a65 3a20 666c    patch_size: fl
-00005470: 6f61 742c 206f 7074 696f 6e61 6c0a 2020  oat, optional.  
-00005480: 2020 2020 2020 2020 2020 5061 7463 6820            Patch 
-00005490: 7369 7a65 205b 6d5d 2e20 4465 6661 756c  size [m]. Defaul
-000054a0: 7420 6973 2030 2e30 2e0a 2020 2020 2020  t is 0.0..      
-000054b0: 2020 6761 705f 7369 7a65 3a20 666c 6f61    gap_size: floa
-000054c0: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
-000054d0: 2020 2020 2020 2020 4761 7020 7369 7a65          Gap size
-000054e0: 205b 6d5d 2e20 4465 6661 756c 7420 6973   [m]. Default is
-000054f0: 2030 2e30 2e0a 0a20 2020 2020 2020 2045   0.0...        E
-00005500: 7861 6d70 6c65 730a 2020 2020 2020 2020  xamples.        
-00005510: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00005520: 203e 3e3e 2066 726f 6d20 7175 6963 6669   >>> from quicfi
-00005530: 7265 5f74 6f6f 6c73 2069 6d70 6f72 7420  re_tools import 
-00005540: 5369 6d75 6c61 7469 6f6e 496e 7075 7473  SimulationInputs
-00005550: 0a20 2020 2020 2020 203e 3e3e 2073 696d  .        >>> sim
-00005560: 5f69 6e70 7574 7320 3d20 5369 6d75 6c61  _inputs = Simula
-00005570: 7469 6f6e 496e 7075 7473 2e63 7265 6174  tionInputs.creat
-00005580: 655f 7369 6d75 6c61 7469 6f6e 286e 783d  e_simulation(nx=
-00005590: 3130 302c 206e 793d 3130 302c 2066 6972  100, ny=100, fir
-000055a0: 655f 6e7a 3d32 362c 2077 696e 645f 7370  e_nz=26, wind_sp
-000055b0: 6565 643d 312e 382c 2077 696e 645f 6469  eed=1.8, wind_di
-000055c0: 7265 6374 696f 6e3d 3930 2c20 7369 6d75  rection=90, simu
-000055d0: 6c61 7469 6f6e 5f74 696d 653d 3630 3029  lation_time=600)
-000055e0: 0a20 2020 2020 2020 203e 3e3e 2073 696d  .        >>> sim
-000055f0: 5f69 6e70 7574 732e 7365 745f 756e 6966  _inputs.set_unif
-00005600: 6f72 6d5f 6675 656c 7328 6675 656c 5f64  orm_fuels(fuel_d
-00005610: 656e 7369 7479 3d30 2e35 2c20 6675 656c  ensity=0.5, fuel
-00005620: 5f6d 6f69 7374 7572 653d 3235 2c20 6675  _moisture=25, fu
-00005630: 656c 5f68 6569 6768 743d 3129 0a20 2020  el_height=1).   
-00005640: 2020 2020 203e 3e3e 2073 696d 5f69 6e70       >>> sim_inp
-00005650: 7574 732e 7175 6963 5f66 6972 652e 6675  uts.quic_fire.fu
-00005660: 656c 5f64 656e 7369 7479 5f66 6c61 670a  el_density_flag.
-00005670: 2020 2020 2020 2020 310a 2020 2020 2020          1.      
-00005680: 2020 3e3e 3e20 7369 6d5f 696e 7075 7473    >>> sim_inputs
-00005690: 2e71 7569 635f 6669 7265 2e66 7565 6c5f  .quic_fire.fuel_
-000056a0: 6465 6e73 6974 790a 2020 2020 2020 2020  density.        
-000056b0: 302e 350a 2020 2020 2020 2020 2222 220a  0.5.        """.
-000056c0: 2020 2020 2020 2020 7365 6c66 2e71 7569          self.qui
-000056d0: 635f 6669 7265 2e66 7565 6c5f 6465 6e73  c_fire.fuel_dens
-000056e0: 6974 795f 666c 6167 203d 2031 0a20 2020  ity_flag = 1.   
-000056f0: 2020 2020 2073 656c 662e 7175 6963 5f66       self.quic_f
-00005700: 6972 652e 6675 656c 5f64 656e 7369 7479  ire.fuel_density
-00005710: 203d 2066 7565 6c5f 6465 6e73 6974 790a   = fuel_density.
-00005720: 2020 2020 2020 2020 7365 6c66 2e71 7569          self.qui
-00005730: 635f 6669 7265 2e66 7565 6c5f 6d6f 6973  c_fire.fuel_mois
-00005740: 7475 7265 5f66 6c61 6720 3d20 310a 2020  ture_flag = 1.  
-00005750: 2020 2020 2020 7365 6c66 2e71 7569 635f        self.quic_
-00005760: 6669 7265 2e66 7565 6c5f 6d6f 6973 7475  fire.fuel_moistu
-00005770: 7265 203d 2066 7565 6c5f 6d6f 6973 7475  re = fuel_moistu
-00005780: 7265 0a20 2020 2020 2020 2073 656c 662e  re.        self.
-00005790: 7175 6963 5f66 6972 652e 6675 656c 5f68  quic_fire.fuel_h
-000057a0: 6569 6768 745f 666c 6167 203d 2031 0a20  eight_flag = 1. 
-000057b0: 2020 2020 2020 2073 656c 662e 7175 6963         self.quic
-000057c0: 5f66 6972 652e 6675 656c 5f68 6569 6768  _fire.fuel_heigh
-000057d0: 7420 3d20 6675 656c 5f68 6569 6768 740a  t = fuel_height.
-000057e0: 2020 2020 2020 2020 6966 2073 697a 655f          if size_
-000057f0: 7363 616c 6520 213d 2030 2e30 3030 353a  scale != 0.0005:
-00005800: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00005810: 662e 7175 6963 5f66 6972 652e 7369 7a65  f.quic_fire.size
-00005820: 5f73 6361 6c65 5f66 6c61 6720 3d20 310a  _scale_flag = 1.
-00005830: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00005840: 2e71 7569 635f 6669 7265 2e73 697a 655f  .quic_fire.size_
-00005850: 7363 616c 6520 3d20 7369 7a65 5f73 6361  scale = size_sca
-00005860: 6c65 0a20 2020 2020 2020 2065 6c73 653a  le.        else:
-00005870: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00005880: 662e 7175 6963 5f66 6972 652e 7369 7a65  f.quic_fire.size
-00005890: 5f73 6361 6c65 5f66 6c61 6720 3d20 300a  _scale_flag = 0.
-000058a0: 2020 2020 2020 2020 6966 2070 6174 6368          if patch
-000058b0: 5f73 697a 6520 213d 2030 2e30 206f 7220  _size != 0.0 or 
-000058c0: 6761 705f 7369 7a65 2021 3d20 302e 303a  gap_size != 0.0:
-000058d0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-000058e0: 662e 7175 6963 5f66 6972 652e 7061 7463  f.quic_fire.patc
-000058f0: 685f 616e 645f 6761 705f 666c 6167 203d  h_and_gap_flag =
-00005900: 2031 0a20 2020 2020 2020 2020 2020 2073   1.            s
-00005910: 656c 662e 7175 6963 5f66 6972 652e 7061  elf.quic_fire.pa
-00005920: 7463 685f 7369 7a65 203d 2070 6174 6368  tch_size = patch
-00005930: 5f73 697a 650a 2020 2020 2020 2020 2020  _size.          
-00005940: 2020 7365 6c66 2e71 7569 635f 6669 7265    self.quic_fire
-00005950: 2e67 6170 5f73 697a 6520 3d20 6761 705f  .gap_size = gap_
-00005960: 7369 7a65 0a20 2020 2020 2020 2065 6c73  size.        els
-00005970: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
-00005980: 656c 662e 7175 6963 5f66 6972 652e 7061  elf.quic_fire.pa
-00005990: 7463 685f 616e 645f 6761 705f 666c 6167  tch_and_gap_flag
-000059a0: 203d 2030 0a0a 2020 2020 6465 6620 7365   = 0..    def se
-000059b0: 745f 7265 6374 616e 676c 655f 6967 6e69  t_rectangle_igni
-000059c0: 7469 6f6e 280a 2020 2020 2020 2020 7365  tion(.        se
-000059d0: 6c66 2c20 785f 6d69 6e3a 2066 6c6f 6174  lf, x_min: float
-000059e0: 2c20 795f 6d69 6e3a 2066 6c6f 6174 2c20  , y_min: float, 
-000059f0: 785f 6c65 6e67 7468 3a20 666c 6f61 742c  x_length: float,
-00005a00: 2079 5f6c 656e 6774 683a 2066 6c6f 6174   y_length: float
-00005a10: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
-00005a20: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00005a30: 2020 2020 5365 7473 2074 6865 2073 696d      Sets the sim
-00005a40: 756c 6174 696f 6e20 746f 2075 7365 2061  ulation to use a
-00005a50: 2072 6563 7461 6e67 6c65 2069 676e 6974   rectangle ignit
-00005a60: 696f 6e20 736f 7572 6365 2e20 5468 6973  ion source. This
-00005a70: 2066 756e 6374 696f 6e0a 2020 2020 2020   function.      
-00005a80: 2020 7570 6461 7465 7320 7468 6520 6967    updates the ig
-00005a90: 6e69 7469 6f6e 2066 6c61 6720 746f 2031  nition flag to 1
-00005aa0: 2061 6e64 2073 6574 7320 7468 6520 6967   and sets the ig
-00005ab0: 6e69 7469 6f6e 2073 6f75 7263 6520 746f  nition source to
-00005ac0: 2074 6865 0a20 2020 2020 2020 2073 7065   the.        spe
-00005ad0: 6369 6669 6564 2072 6563 7461 6e67 6c65  cified rectangle
-00005ae0: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-00005af0: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
-00005b00: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00005b10: 2078 5f6d 696e 3a20 666c 6f61 740a 2020   x_min: float.  
-00005b20: 2020 2020 2020 2020 2020 536f 7574 682d            South-
-00005b30: 7765 7374 2063 6f72 6e65 7220 696e 2074  west corner in t
-00005b40: 6865 2078 2d64 6972 6563 7469 6f6e 205b  he x-direction [
-00005b50: 6d5d 0a20 2020 2020 2020 2079 5f6d 696e  m].        y_min
-00005b60: 3a20 666c 6f61 740a 2020 2020 2020 2020  : float.        
-00005b70: 2020 2020 536f 7574 682d 7765 7374 2063      South-west c
-00005b80: 6f72 6e65 7220 696e 2074 6865 2079 2d64  orner in the y-d
-00005b90: 6972 6563 7469 6f6e 205b 6d5d 0a20 2020  irection [m].   
-00005ba0: 2020 2020 2078 5f6c 656e 6774 683a 2066       x_length: f
-00005bb0: 6c6f 6174 0a20 2020 2020 2020 2020 2020  loat.           
-00005bc0: 204c 656e 6774 6820 696e 2074 6865 2078   Length in the x
-00005bd0: 2d64 6972 6563 7469 6f6e 205b 6d5d 0a20  -direction [m]. 
-00005be0: 2020 2020 2020 2079 5f6c 656e 6774 683a         y_length:
-00005bf0: 2066 6c6f 6174 0a20 2020 2020 2020 2020   float.         
-00005c00: 2020 204c 656e 6774 6820 696e 2074 6865     Length in the
-00005c10: 2079 2d64 6972 6563 7469 6f6e 205b 6d5d   y-direction [m]
-00005c20: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
-00005c30: 6573 0a20 2020 2020 2020 202d 2d2d 2d2d  es.        -----
-00005c40: 2d2d 0a20 2020 2020 2020 203e 3e3e 2066  --.        >>> f
-00005c50: 726f 6d20 7175 6963 6669 7265 5f74 6f6f  rom quicfire_too
-00005c60: 6c73 2069 6d70 6f72 7420 5369 6d75 6c61  ls import Simula
-00005c70: 7469 6f6e 496e 7075 7473 0a20 2020 2020  tionInputs.     
-00005c80: 2020 203e 3e3e 2073 696d 5f69 6e70 7574     >>> sim_input
-00005c90: 7320 3d20 5369 6d75 6c61 7469 6f6e 496e  s = SimulationIn
-00005ca0: 7075 7473 2e63 7265 6174 655f 7369 6d75  puts.create_simu
-00005cb0: 6c61 7469 6f6e 286e 783d 3130 302c 206e  lation(nx=100, n
-00005cc0: 793d 3130 302c 2066 6972 655f 6e7a 3d32  y=100, fire_nz=2
-00005cd0: 362c 2077 696e 645f 7370 6565 643d 312e  6, wind_speed=1.
-00005ce0: 382c 2077 696e 645f 6469 7265 6374 696f  8, wind_directio
-00005cf0: 6e3d 3930 2c20 7369 6d75 6c61 7469 6f6e  n=90, simulation
-00005d00: 5f74 696d 653d 3630 3029 0a20 2020 2020  _time=600).     
-00005d10: 2020 203e 3e3e 2073 696d 5f69 6e70 7574     >>> sim_input
-00005d20: 732e 7365 745f 7265 6374 616e 676c 655f  s.set_rectangle_
-00005d30: 6967 6e69 7469 6f6e 2878 5f6d 696e 3d30  ignition(x_min=0
-00005d40: 2c20 795f 6d69 6e3d 302c 2078 5f6c 656e  , y_min=0, x_len
-00005d50: 6774 683d 3130 2c20 795f 6c65 6e67 7468  gth=10, y_length
-00005d60: 3d31 3029 0a20 2020 2020 2020 2022 2222  =10).        """
-00005d70: 0a20 2020 2020 2020 2069 676e 6974 696f  .        ignitio
-00005d80: 6e20 3d20 5265 6374 616e 676c 6549 676e  n = RectangleIgn
-00005d90: 6974 696f 6e28 0a20 2020 2020 2020 2020  ition(.         
-00005da0: 2020 2078 5f6d 696e 3d78 5f6d 696e 2c20     x_min=x_min, 
-00005db0: 795f 6d69 6e3d 795f 6d69 6e2c 2078 5f6c  y_min=y_min, x_l
-00005dc0: 656e 6774 683d 785f 6c65 6e67 7468 2c20  ength=x_length, 
-00005dd0: 795f 6c65 6e67 7468 3d79 5f6c 656e 6774  y_length=y_lengt
-00005de0: 680a 2020 2020 2020 2020 290a 2020 2020  h.        ).    
-00005df0: 2020 2020 7365 6c66 2e71 7569 635f 6669      self.quic_fi
-00005e00: 7265 2e69 676e 6974 696f 6e5f 7479 7065  re.ignition_type
-00005e10: 203d 2069 676e 6974 696f 6e0a 0a20 2020   = ignition..   
-00005e20: 2064 6566 2073 6574 5f6f 7574 7075 745f   def set_output_
-00005e30: 6669 6c65 7328 0a20 2020 2020 2020 2073  files(.        s
-00005e40: 656c 662c 0a20 2020 2020 2020 2065 6e67  elf,.        eng
-00005e50: 5f74 6f5f 6174 6d3a 2062 6f6f 6c20 3d20  _to_atm: bool = 
-00005e60: 4661 6c73 652c 0a20 2020 2020 2020 2072  False,.        r
-00005e70: 6561 6374 5f72 6174 653a 2062 6f6f 6c20  eact_rate: bool 
-00005e80: 3d20 4661 6c73 652c 0a20 2020 2020 2020  = False,.       
-00005e90: 2066 7565 6c5f 6465 6e73 3a20 626f 6f6c   fuel_dens: bool
-00005ea0: 203d 2046 616c 7365 2c0a 2020 2020 2020   = False,.      
-00005eb0: 2020 7166 5f77 696e 643a 2062 6f6f 6c20    qf_wind: bool 
-00005ec0: 3d20 4661 6c73 652c 0a20 2020 2020 2020  = False,.       
-00005ed0: 2071 755f 7769 6e64 5f69 6e73 743a 2062   qu_wind_inst: b
-00005ee0: 6f6f 6c20 3d20 4661 6c73 652c 0a20 2020  ool = False,.   
-00005ef0: 2020 2020 2071 755f 7769 6e64 5f61 7667       qu_wind_avg
-00005f00: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
-00005f10: 2020 2020 2020 2020 6675 656c 5f6d 6f69          fuel_moi
-00005f20: 7374 3a20 626f 6f6c 203d 2046 616c 7365  st: bool = False
-00005f30: 2c0a 2020 2020 2020 2020 6d61 7373 5f62  ,.        mass_b
-00005f40: 7572 6e74 3a20 626f 6f6c 203d 2046 616c  urnt: bool = Fal
-00005f50: 7365 2c0a 2020 2020 2020 2020 656d 6973  se,.        emis
-00005f60: 7369 6f6e 733a 2062 6f6f 6c20 3d20 4661  sions: bool = Fa
-00005f70: 6c73 652c 0a20 2020 2020 2020 2072 6164  lse,.        rad
-00005f80: 6961 7469 6f6e 3a20 626f 6f6c 203d 2046  iation: bool = F
-00005f90: 616c 7365 2c0a 2020 2020 2020 2020 7375  alse,.        su
-00005fa0: 7266 5f65 6e67 3a20 626f 6f6c 203d 2046  rf_eng: bool = F
-00005fb0: 616c 7365 2c0a 2020 2020 2020 2020 696e  alse,.        in
-00005fc0: 7465 6e73 6974 793a 2062 6f6f 6c20 3d20  tensity: bool = 
-00005fd0: 4661 6c73 652c 0a20 2020 2029 202d 3e20  False,.    ) -> 
-00005fe0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2222  None:.        ""
-00005ff0: 220a 2020 2020 2020 2020 5365 7473 2074  ".        Sets t
-00006000: 6865 2073 696d 756c 6174 696f 6e20 746f  he simulation to
-00006010: 206f 7574 7075 7420 7468 6520 7370 6563   output the spec
-00006020: 6966 6965 6420 6669 6c65 732e 2046 696c  ified files. Fil
-00006030: 6573 2073 6574 2074 6f20 5472 7565 0a20  es set to True. 
-00006040: 2020 2020 2020 2077 696c 6c20 6265 206f         will be o
-00006050: 7574 7075 7420 6279 2074 6865 2073 696d  utput by the sim
-00006060: 756c 6174 696f 6e2c 2061 6e64 2066 696c  ulation, and fil
-00006070: 6573 2073 6574 2074 6f20 4661 6c73 6520  es set to False 
-00006080: 7769 6c6c 206e 6f74 2062 650a 2020 2020  will not be.    
-00006090: 2020 2020 6f75 7470 7574 2e0a 0a20 2020      output...   
-000060a0: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
-000060b0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-000060c0: 2d2d 0a20 2020 2020 2020 2065 6e67 5f74  --.        eng_t
-000060d0: 6f5f 6174 6d3a 2062 6f6f 6c2c 206f 7074  o_atm: bool, opt
-000060e0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
-000060f0: 2020 4966 2054 7275 652c 206f 7574 7075    If True, outpu
-00006100: 7420 7468 6520 6669 7265 2d65 6e65 7267  t the fire-energ
-00006110: 795f 746f 5f61 746d 6f73 2e62 696e 2066  y_to_atmos.bin f
-00006120: 696c 652e 2044 6566 6175 6c74 2069 7320  ile. Default is 
-00006130: 4661 6c73 652e 0a20 2020 2020 2020 2072  False..        r
-00006140: 6561 6374 5f72 6174 653a 2062 6f6f 6c2c  eact_rate: bool,
-00006150: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-00006160: 2020 2020 2020 4966 2054 7275 652c 206f        If True, o
-00006170: 7574 7075 7420 7468 6520 6669 7265 2d72  utput the fire-r
-00006180: 6561 6374 696f 6e5f 7261 7465 2e62 696e  eaction_rate.bin
-00006190: 2066 696c 652e 2044 6566 6175 6c74 2069   file. Default i
-000061a0: 7320 4661 6c73 652e 0a20 2020 2020 2020  s False..       
-000061b0: 2066 7565 6c5f 6465 6e73 3a20 626f 6f6c   fuel_dens: bool
-000061c0: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
-000061d0: 2020 2020 2020 2049 6620 5472 7565 2c20         If True, 
-000061e0: 6f75 7470 7574 2074 6865 2066 7565 6c73  output the fuels
-000061f0: 2d64 656e 732e 6269 6e20 6669 6c65 2e20  -dens.bin file. 
-00006200: 4465 6661 756c 7420 6973 2046 616c 7365  Default is False
-00006210: 2e0a 2020 2020 2020 2020 7166 5f77 696e  ..        qf_win
-00006220: 643a 2062 6f6f 6c2c 206f 7074 696f 6e61  d: bool, optiona
-00006230: 6c0a 2020 2020 2020 2020 2020 2020 4966  l.            If
-00006240: 2054 7275 652c 206f 7574 7075 7420 7468   True, output th
-00006250: 6520 7769 6e64 752c 2077 696e 6476 2c20  e windu, windv, 
-00006260: 616e 6420 7769 6e64 7720 2e62 696e 2066  and windw .bin f
-00006270: 696c 6573 2e0a 2020 2020 2020 2020 2020  iles..          
-00006280: 2020 4465 6661 756c 7420 6973 2046 616c    Default is Fal
-00006290: 7365 2e0a 2020 2020 2020 2020 7175 5f77  se..        qu_w
-000062a0: 696e 645f 696e 7374 3a20 626f 6f6c 2c20  ind_inst: bool, 
-000062b0: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-000062c0: 2020 2020 2049 6620 5472 7565 2c20 6f75       If True, ou
-000062d0: 7470 7574 2074 6865 2071 7569 635f 7769  tput the quic_wi
-000062e0: 6e64 5f69 6e73 742e 6269 6e20 6669 6c65  nd_inst.bin file
-000062f0: 2e20 4465 6661 756c 7420 6973 2046 616c  . Default is Fal
-00006300: 7365 2e0a 2020 2020 2020 2020 7175 5f77  se..        qu_w
-00006310: 696e 645f 6176 673a 2062 6f6f 6c2c 206f  ind_avg: bool, o
-00006320: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
-00006330: 2020 2020 4966 2054 7275 652c 206f 7574      If True, out
-00006340: 7075 7420 7468 6520 7175 6963 5f77 696e  put the quic_win
-00006350: 645f 6176 672e 6269 6e20 6669 6c65 2e20  d_avg.bin file. 
-00006360: 4465 6661 756c 7420 6973 2046 616c 7365  Default is False
-00006370: 2e0a 2020 2020 2020 2020 6675 656c 5f6d  ..        fuel_m
-00006380: 6f69 7374 3a20 626f 6f6c 2c20 6f70 7469  oist: bool, opti
-00006390: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
-000063a0: 2049 6620 5472 7565 2c20 6f75 7470 7574   If True, output
-000063b0: 2074 6865 2066 7565 6c73 2d6d 6f69 7374   the fuels-moist
-000063c0: 2e62 696e 2066 696c 652e 2044 6566 6175  .bin file. Defau
-000063d0: 6c74 2069 7320 4661 6c73 652e 0a20 2020  lt is False..   
-000063e0: 2020 2020 206d 6173 735f 6275 726e 743a       mass_burnt:
-000063f0: 2062 6f6f 6c2c 206f 7074 696f 6e61 6c0a   bool, optional.
-00006400: 2020 2020 2020 2020 2020 2020 4966 2054              If T
-00006410: 7275 652c 206f 7574 7075 7420 7468 6520  rue, output the 
-00006420: 6d62 7572 6e74 5f69 6e74 6567 2e62 696e  mburnt_integ.bin
-00006430: 2066 696c 652e 2044 6566 6175 6c74 2069   file. Default i
-00006440: 7320 4661 6c73 652e 0a20 2020 2020 2020  s False..       
-00006450: 2065 6d69 7373 696f 6e73 3a20 626f 6f6c   emissions: bool
-00006460: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
-00006470: 2020 2020 2020 2049 6620 5472 7565 2c20         If True, 
-00006480: 6f75 7470 7574 2074 6865 2063 6f2d 656d  output the co-em
-00006490: 6973 7369 6f6e 7320 616e 6420 706d 2d65  issions and pm-e
-000064a0: 6d69 7373 696f 6e73 202e 6269 6e20 6669  missions .bin fi
-000064b0: 6c65 732e 0a20 2020 2020 2020 2020 2020  les..           
-000064c0: 2044 6566 6175 6c74 2069 7320 4661 6c73   Default is Fals
-000064d0: 652e 0a20 2020 2020 2020 2072 6164 6961  e..        radia
-000064e0: 7469 6f6e 3a20 626f 6f6c 2c20 6f70 7469  tion: bool, opti
-000064f0: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
-00006500: 2049 6620 5472 7565 2c20 6f75 7470 7574   If True, output
-00006510: 2074 6865 2074 6865 726d 616c 646f 7365   the thermaldose
-00006520: 2061 6e64 2074 6865 726d 616c 7261 6469   and thermalradi
-00006530: 6174 696f 6e20 2e62 696e 2066 696c 6573  ation .bin files
-00006540: 2e0a 2020 2020 2020 2020 2020 2020 4465  ..            De
-00006550: 6661 756c 7420 6973 2046 616c 7365 2e0a  fault is False..
-00006560: 2020 2020 2020 2020 696e 7465 6e73 6974          intensit
-00006570: 793a 2062 6f6f 6c2c 206f 7074 696f 6e61  y: bool, optiona
-00006580: 6c0a 2020 2020 2020 2020 2020 2020 4966  l.            If
-00006590: 2054 7275 652c 206f 7574 7075 7420 7468   True, output th
-000065a0: 6520 6669 7265 2d69 6e74 656e 7369 7479  e fire-intensity
-000065b0: 2e62 696e 2066 696c 652e 2044 6566 6175  .bin file. Defau
-000065c0: 6c74 2069 7320 4661 6c73 652e 0a0a 2020  lt is False...  
-000065d0: 2020 2020 2020 4578 616d 706c 6573 0a20        Examples. 
-000065e0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0a         --------.
-000065f0: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
-00006600: 2071 7569 6366 6972 655f 746f 6f6c 7320   quicfire_tools 
-00006610: 696d 706f 7274 2053 696d 756c 6174 696f  import Simulatio
-00006620: 6e49 6e70 7574 730a 2020 2020 2020 2020  nInputs.        
-00006630: 3e3e 3e20 7369 6d5f 696e 7075 7473 203d  >>> sim_inputs =
-00006640: 2053 696d 756c 6174 696f 6e49 6e70 7574   SimulationInput
-00006650: 732e 6372 6561 7465 5f73 696d 756c 6174  s.create_simulat
-00006660: 696f 6e28 6e78 3d31 3030 2c20 6e79 3d31  ion(nx=100, ny=1
-00006670: 3030 2c20 6669 7265 5f6e 7a3d 3236 2c20  00, fire_nz=26, 
-00006680: 7769 6e64 5f73 7065 6564 3d31 2e38 2c20  wind_speed=1.8, 
-00006690: 7769 6e64 5f64 6972 6563 7469 6f6e 3d39  wind_direction=9
-000066a0: 302c 2073 696d 756c 6174 696f 6e5f 7469  0, simulation_ti
-000066b0: 6d65 3d36 3030 290a 2020 2020 2020 2020  me=600).        
-000066c0: 3e3e 3e20 7369 6d5f 696e 7075 7473 2e73  >>> sim_inputs.s
-000066d0: 6574 5f6f 7574 7075 745f 6669 6c65 7328  et_output_files(
-000066e0: 6675 656c 5f64 656e 733d 5472 7565 2c20  fuel_dens=True, 
-000066f0: 6d61 7373 5f62 7572 6e74 3d54 7275 6529  mass_burnt=True)
-00006700: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
-00006710: 2020 2020 2020 7365 6c66 2e71 7569 635f        self.quic_
-00006720: 6669 7265 2e65 6e67 5f74 6f5f 6174 6d5f  fire.eng_to_atm_
-00006730: 6f75 7420 3d20 696e 7428 656e 675f 746f  out = int(eng_to
-00006740: 5f61 746d 290a 2020 2020 2020 2020 7365  _atm).        se
-00006750: 6c66 2e71 7569 635f 6669 7265 2e72 6561  lf.quic_fire.rea
-00006760: 6374 5f72 6174 655f 6f75 7420 3d20 696e  ct_rate_out = in
-00006770: 7428 7265 6163 745f 7261 7465 290a 2020  t(react_rate).  
-00006780: 2020 2020 2020 7365 6c66 2e71 7569 635f        self.quic_
-00006790: 6669 7265 2e66 7565 6c5f 6465 6e73 5f6f  fire.fuel_dens_o
-000067a0: 7574 203d 2069 6e74 2866 7565 6c5f 6465  ut = int(fuel_de
-000067b0: 6e73 290a 2020 2020 2020 2020 7365 6c66  ns).        self
-000067c0: 2e71 7569 635f 6669 7265 2e71 665f 7769  .quic_fire.qf_wi
-000067d0: 6e64 5f6f 7574 203d 2069 6e74 2871 665f  nd_out = int(qf_
-000067e0: 7769 6e64 290a 2020 2020 2020 2020 7365  wind).        se
-000067f0: 6c66 2e71 7569 635f 6669 7265 2e71 755f  lf.quic_fire.qu_
-00006800: 7769 6e64 5f69 6e73 745f 6f75 7420 3d20  wind_inst_out = 
-00006810: 696e 7428 7175 5f77 696e 645f 696e 7374  int(qu_wind_inst
-00006820: 290a 2020 2020 2020 2020 7365 6c66 2e71  ).        self.q
-00006830: 7569 635f 6669 7265 2e71 755f 7769 6e64  uic_fire.qu_wind
-00006840: 5f61 7667 5f6f 7574 203d 2069 6e74 2871  _avg_out = int(q
-00006850: 755f 7769 6e64 5f61 7667 290a 2020 2020  u_wind_avg).    
-00006860: 2020 2020 7365 6c66 2e71 7569 635f 6669      self.quic_fi
-00006870: 7265 2e66 7565 6c5f 6d6f 6973 745f 6f75  re.fuel_moist_ou
-00006880: 7420 3d20 696e 7428 6675 656c 5f6d 6f69  t = int(fuel_moi
-00006890: 7374 290a 2020 2020 2020 2020 7365 6c66  st).        self
-000068a0: 2e71 7569 635f 6669 7265 2e6d 6173 735f  .quic_fire.mass_
-000068b0: 6275 726e 745f 6f75 7420 3d20 696e 7428  burnt_out = int(
-000068c0: 6d61 7373 5f62 7572 6e74 290a 2020 2020  mass_burnt).    
-000068d0: 2020 2020 7365 6c66 2e71 7569 635f 6669      self.quic_fi
-000068e0: 7265 2e72 6164 6961 7469 6f6e 5f6f 7574  re.radiation_out
-000068f0: 203d 2069 6e74 2872 6164 6961 7469 6f6e   = int(radiation
-00006900: 290a 2020 2020 2020 2020 7365 6c66 2e71  ).        self.q
-00006910: 7569 635f 6669 7265 2e73 7572 665f 656e  uic_fire.surf_en
-00006920: 675f 6f75 7420 3d20 696e 7428 7375 7266  g_out = int(surf
-00006930: 5f65 6e67 290a 2020 2020 2020 2020 7365  _eng).        se
-00006940: 6c66 2e71 7569 635f 6669 7265 2e65 6d69  lf.quic_fire.emi
-00006950: 7373 696f 6e73 5f6f 7574 203d 2032 2069  ssions_out = 2 i
-00006960: 6620 656d 6973 7369 6f6e 7320 656c 7365  f emissions else
-00006970: 2030 0a0a 2020 2020 6465 6620 6e65 775f   0..    def new_
-00006980: 7769 6e64 5f73 656e 736f 7228 0a20 2020  wind_sensor(.   
-00006990: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-000069a0: 2020 2075 7064 6174 653a 2073 7472 203d     update: str =
-000069b0: 204e 6f6e 652c 0a20 2020 2020 2020 2077   None,.        w
-000069c0: 696e 645f 7370 6565 6473 3a20 666c 6f61  ind_speeds: floa
-000069d0: 7420 7c20 6c69 7374 2866 6c6f 6174 2920  t | list(float) 
-000069e0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-000069f0: 7769 6e64 5f64 6972 6563 7469 6f6e 733a  wind_directions:
-00006a00: 2069 6e74 207c 206c 6973 7428 696e 7429   int | list(int)
-00006a10: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-00006a20: 2077 696e 645f 7469 6d65 733a 2069 6e74   wind_times: int
-00006a30: 207c 206c 6973 7428 696e 7429 203d 204e   | list(int) = N
-00006a40: 6f6e 652c 0a20 2020 2020 2020 2073 656e  one,.        sen
-00006a50: 736f 725f 6865 6967 6874 3a20 666c 6f61  sor_height: floa
-00006a60: 7420 3d20 4e6f 6e65 2c0a 2020 2020 2020  t = None,.      
-00006a70: 2020 785f 6c6f 6361 7469 6f6e 3a20 696e    x_location: in
-00006a80: 7420 3d20 4e6f 6e65 2c0a 2020 2020 2020  t = None,.      
-00006a90: 2020 795f 6c6f 6361 7469 6f6e 3a20 696e    y_location: in
-00006aa0: 7420 3d20 4e6f 6e65 2c0a 2020 2020 293a  t = None,.    ):
-00006ab0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00006ac0: 2020 2020 2041 6464 7320 6120 7769 6e64       Adds a wind
-00006ad0: 2073 656e 736f 7220 6f72 2075 7064 6174   sensor or updat
-00006ae0: 6573 2061 6e20 6578 6973 7469 6e67 206f  es an existing o
-00006af0: 6e65 2e0a 0a20 2020 2020 2020 2050 6172  ne...        Par
-00006b00: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
-00006b10: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-00006b20: 2020 2075 7064 6174 653a 2073 7472 0a20     update: str. 
-00006b30: 2020 2020 2020 2020 2020 204e 616d 6520             Name 
-00006b40: 6f66 2074 6865 2077 696e 6420 7365 6e73  of the wind sens
-00006b50: 6f72 2c20 652e 672e 2022 7365 6e73 6f72  or, e.g. "sensor
-00006b60: 3122 2e20 5365 6e73 6f72 206d 7573 7420  1". Sensor must 
-00006b70: 616c 7265 6164 7920 6578 6973 7420 696e  already exist in
-00006b80: 2077 696e 6473 656e 736f 7273 2e0a 2020   windsensors..  
-00006b90: 2020 2020 2020 2020 2020 4f6d 6974 206f            Omit o
-00006ba0: 7220 7573 6520 7570 6461 7465 203d 204e  r use update = N
-00006bb0: 6f6e 6520 746f 2061 6464 2061 206e 6577  one to add a new
-00006bc0: 2073 656e 736f 722e 0a20 2020 2020 2020   sensor..       
-00006bd0: 2077 696e 645f 7370 6565 6473 203a 2050   wind_speeds : P
-00006be0: 6f73 6974 6976 6546 6c6f 6174 207c 206c  ositiveFloat | l
-00006bf0: 6973 7428 506f 7369 7469 7665 466c 6f61  ist(PositiveFloa
-00006c00: 7429 0a20 2020 2020 2020 2020 2020 204f  t).            O
-00006c10: 7074 696f 6e61 6c2e 2055 7064 6174 6564  ptional. Updated
-00006c20: 2077 696e 6420 7370 6565 6420 6f72 206c   wind speed or l
-00006c30: 6973 7420 6f66 2077 696e 6420 7370 6565  ist of wind spee
-00006c40: 6473 2069 6e20 6d2f 730a 2020 2020 2020  ds in m/s.      
-00006c50: 2020 7769 6e64 5f64 6972 6563 7469 6f6e    wind_direction
-00006c60: 733a 2050 6f73 6974 6976 6549 6e74 207c  s: PositiveInt |
-00006c70: 206c 6973 7428 506f 7369 7469 7665 496e   list(PositiveIn
-00006c80: 7429 0a20 2020 2020 2020 2020 2020 204f  t).            O
-00006c90: 7074 696f 6e61 6c2e 2055 7064 6174 6564  ptional. Updated
-00006ca0: 2077 696e 6420 6469 7265 6374 696f 6e20   wind direction 
-00006cb0: 6f72 206c 6973 7420 6f66 2077 696e 6420  or list of wind 
-00006cc0: 6469 7265 6374 696f 6e73 2069 6e20 6465  directions in de
-00006cd0: 6772 6565 732e 2055 7365 2030 2066 6f72  grees. Use 0 for
-00006ce0: 206e 6f72 7468 2e0a 2020 2020 2020 2020   north..        
-00006cf0: 7769 6e64 5f74 696d 6573 203a 204e 6f6e  wind_times : Non
-00006d00: 4e65 6761 7469 7665 496e 7420 7c20 6c69  NegativeInt | li
-00006d10: 7374 284e 6f6e 4e65 6761 7469 7665 496e  st(NonNegativeIn
-00006d20: 7429 0a20 2020 2020 2020 2020 2020 204f  t).            O
-00006d30: 7074 696f 6e61 6c2e 2055 7064 6174 6564  ptional. Updated
-00006d40: 206c 6973 7420 6f66 2074 696d 6573 2066   list of times f
-00006d50: 6f72 2065 6163 6820 7769 6e64 7368 6966  or each windshif
-00006d60: 742e 2055 7365 2030 2066 6f72 2073 696e  t. Use 0 for sin
-00006d70: 676c 6520 7769 6e64 7368 6966 742e 2046  gle windshift. F
-00006d80: 6972 7374 2076 616c 7565 206d 7573 7420  irst value must 
-00006d90: 6265 2030 2e0a 2020 2020 2020 2020 7365  be 0..        se
-00006da0: 6e73 6f72 5f68 6569 6768 7420 3a20 506f  nsor_height : Po
-00006db0: 7369 7469 7665 466c 6f61 740a 2020 2020  sitiveFloat.    
-00006dc0: 2020 2020 2020 2020 4f70 7469 6f6e 616c          Optional
-00006dd0: 2e20 5570 6461 7465 6420 6865 6967 6874  . Updated height
-00006de0: 206f 6620 7468 6520 7769 6e64 2073 656e   of the wind sen
-00006df0: 736f 7220 696e 206d 6574 6572 732e 0a20  sor in meters.. 
-00006e00: 2020 2020 2020 2078 5f6c 6f63 6174 696f         x_locatio
-00006e10: 6e20 3a20 506f 7369 7469 7665 496e 740a  n : PositiveInt.
-00006e20: 2020 2020 2020 2020 2020 2020 4f70 7469              Opti
-00006e30: 6f6e 616c 2e20 5570 6461 7465 6420 6c6f  onal. Updated lo
-00006e40: 6361 7469 6f6e 206f 6620 7468 6520 7769  cation of the wi
-00006e50: 6e64 2073 656e 736f 7220 696e 2074 6865  nd sensor in the
-00006e60: 2078 2d64 6972 6563 7469 6f6e 2028 6d29   x-direction (m)
-00006e70: 2e0a 2020 2020 2020 2020 795f 6c6f 6361  ..        y_loca
-00006e80: 7469 6f6e 203a 2050 6f73 6974 6976 6549  tion : PositiveI
-00006e90: 6e74 0a20 2020 2020 2020 2020 2020 204f  nt.            O
-00006ea0: 7074 696f 6e61 6c2e 2055 7064 6174 6564  ptional. Updated
-00006eb0: 206c 6f63 6174 696f 6e20 6f66 2074 6865   location of the
-00006ec0: 2077 696e 6420 7365 6e73 6f72 2069 6e20   wind sensor in 
-00006ed0: 7468 6520 792d 6469 7265 6374 696f 6e20  the y-direction 
-00006ee0: 286d 292e 0a0a 2020 2020 2020 2020 4578  (m)...        Ex
-00006ef0: 616d 706c 6573 0a20 2020 2020 2020 202d  amples.        -
-00006f00: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00006f10: 3e3e 3e20 6672 6f6d 2071 7569 6366 6972  >>> from quicfir
-00006f20: 655f 746f 6f6c 7320 696d 706f 7274 2053  e_tools import S
-00006f30: 696d 756c 6174 696f 6e49 6e70 7574 730a  imulationInputs.
-00006f40: 2020 2020 2020 2020 3e3e 3e20 7369 6d5f          >>> sim_
-00006f50: 696e 7075 7473 203d 2053 696d 756c 6174  inputs = Simulat
-00006f60: 696f 6e49 6e70 7574 732e 6372 6561 7465  ionInputs.create
-00006f70: 5f73 696d 756c 6174 696f 6e28 6e78 3d31  _simulation(nx=1
-00006f80: 3030 2c20 6e79 3d31 3030 2c20 6669 7265  00, ny=100, fire
-00006f90: 5f6e 7a3d 3236 2c20 7769 6e64 5f73 7065  _nz=26, wind_spe
-00006fa0: 6564 3d31 2e38 2c20 7769 6e64 5f64 6972  ed=1.8, wind_dir
-00006fb0: 6563 7469 6f6e 3d39 302c 2073 696d 756c  ection=90, simul
-00006fc0: 6174 696f 6e5f 7469 6d65 3d36 3030 290a  ation_time=600).
-00006fd0: 2020 2020 2020 2020 3e3e 3e20 2320 4164          >>> # Ad
-00006fe0: 6420 6120 6e65 7720 7365 6e73 6f72 0a20  d a new sensor. 
-00006ff0: 2020 2020 2020 203e 3e3e 2073 696d 5f69         >>> sim_i
-00007000: 6e70 7574 732e 6e65 775f 7769 6e64 5f73  nputs.new_wind_s
-00007010: 656e 736f 7228 7769 6e64 5f73 7065 6564  ensor(wind_speed
-00007020: 7320 3d20 342e 3437 2c20 7769 6e64 5f64  s = 4.47, wind_d
-00007030: 6972 6563 7469 6f6e 7320 3d20 3237 302c  irections = 270,
-00007040: 2077 696e 645f 7469 6d65 7320 3d20 302c   wind_times = 0,
-00007050: 2073 656e 736f 725f 6865 6967 6874 203d   sensor_height =
-00007060: 2036 2e31 2c20 785f 6c6f 6361 7469 6f6e   6.1, x_location
-00007070: 203d 2035 302c 2079 5f6c 6f63 6174 696f   = 50, y_locatio
-00007080: 6e20 3d20 3530 290a 2020 2020 2020 2020  n = 50).        
-00007090: 3e3e 3e20 2320 5570 6461 7465 2061 6e20  >>> # Update an 
-000070a0: 6578 6973 7469 6e67 2077 696e 6420 7365  existing wind se
-000070b0: 6e73 6f72 0a20 2020 2020 2020 203e 3e3e  nsor.        >>>
-000070c0: 2073 696d 5f69 6e70 7574 732e 6e65 775f   sim_inputs.new_
-000070d0: 7769 6e64 5f73 656e 736f 7228 7570 6461  wind_sensor(upda
-000070e0: 7465 203d 2027 7365 6e73 6f72 3227 2c20  te = 'sensor2', 
-000070f0: 7769 6e64 5f73 7065 6564 7320 3d20 5b34  wind_speeds = [4
-00007100: 2e34 372c 2036 2e37 5d2c 2077 696e 645f  .47, 6.7], wind_
-00007110: 6469 7265 6374 696f 6e73 203d 205b 3237  directions = [27
-00007120: 302c 2032 3730 5d2c 2077 696e 645f 7469  0, 270], wind_ti
-00007130: 6d65 7320 3d20 5b30 2c33 3030 5d29 0a20  mes = [0,300]). 
-00007140: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00007150: 2020 2069 6620 7570 6461 7465 2069 7320     if update is 
-00007160: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-00007170: 2020 6172 675f 6469 6374 203d 207b 0a20    arg_dict = {. 
-00007180: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00007190: 785f 6c6f 6361 7469 6f6e 223a 2078 5f6c  x_location": x_l
-000071a0: 6f63 6174 696f 6e2c 0a20 2020 2020 2020  ocation,.       
-000071b0: 2020 2020 2020 2020 2022 795f 6c6f 6361           "y_loca
-000071c0: 7469 6f6e 223a 2079 5f6c 6f63 6174 696f  tion": y_locatio
-000071d0: 6e2c 0a20 2020 2020 2020 2020 2020 2020  n,.             
-000071e0: 2020 2022 7769 6e64 5f73 7065 6564 7322     "wind_speeds"
-000071f0: 3a20 7769 6e64 5f73 7065 6564 732c 0a20  : wind_speeds,. 
-00007200: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00007210: 7769 6e64 5f64 6972 6563 7469 6f6e 7322  wind_directions"
-00007220: 3a20 7769 6e64 5f64 6972 6563 7469 6f6e  : wind_direction
-00007230: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-00007240: 2020 2022 7769 6e64 5f74 696d 6573 223a     "wind_times":
-00007250: 2077 696e 645f 7469 6d65 732c 0a20 2020   wind_times,.   
-00007260: 2020 2020 2020 2020 2020 2020 2022 7365               "se
-00007270: 6e73 6f72 5f68 6569 6768 7422 3a20 7365  nsor_height": se
-00007280: 6e73 6f72 5f68 6569 6768 742c 0a20 2020  nsor_height,.   
-00007290: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
-000072a0: 2020 2020 2020 2065 7272 6f72 5f6c 6973         error_lis
-000072b0: 7420 3d20 5b5d 0a20 2020 2020 2020 2020  t = [].         
-000072c0: 2020 2066 6f72 206b 2c20 7620 696e 2061     for k, v in a
-000072d0: 7267 5f64 6963 742e 6974 656d 7328 293a  rg_dict.items():
-000072e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000072f0: 2069 6620 7620 6973 204e 6f6e 653a 0a20   if v is None:. 
-00007300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007310: 2020 2065 7272 6f72 5f6c 6973 742e 6170     error_list.ap
-00007320: 7065 6e64 286b 290a 2020 2020 2020 2020  pend(k).        
-00007330: 2020 2020 6966 206c 656e 2865 7272 6f72      if len(error
-00007340: 5f6c 6973 7429 203e 2030 3a0a 2020 2020  _list) > 0:.    
-00007350: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00007360: 6520 5479 7065 4572 726f 7228 0a20 2020  e TypeError(.   
-00007370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007380: 2066 2241 7267 756d 656e 7473 207b 6572   f"Arguments {er
-00007390: 726f 725f 6c69 7374 7d20 6d75 7374 2062  ror_list} must b
-000073a0: 6520 7375 7070 6c69 6564 2077 6865 6e20  e supplied when 
-000073b0: 7570 6461 7465 203d 204e 6f6e 6522 0a20  update = None". 
-000073c0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-000073d0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-000073e0: 662e 7769 6e64 7365 6e73 6f72 732e 6164  f.windsensors.ad
-000073f0: 645f 7365 6e73 6f72 280a 2020 2020 2020  d_sensor(.      
-00007400: 2020 2020 2020 2020 2020 7769 6e64 5f74            wind_t
-00007410: 696d 6573 3d77 696e 645f 7469 6d65 732c  imes=wind_times,
-00007420: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007430: 2077 696e 645f 7370 6565 6473 3d77 696e   wind_speeds=win
-00007440: 645f 7370 6565 6473 2c0a 2020 2020 2020  d_speeds,.      
-00007450: 2020 2020 2020 2020 2020 7769 6e64 5f64            wind_d
-00007460: 6972 6563 7469 6f6e 733d 7769 6e64 5f64  irections=wind_d
-00007470: 6972 6563 7469 6f6e 732c 0a20 2020 2020  irections,.     
-00007480: 2020 2020 2020 2020 2020 2073 656e 736f             senso
-00007490: 725f 6865 6967 6874 3d73 656e 736f 725f  r_height=sensor_
-000074a0: 6865 6967 6874 2c0a 2020 2020 2020 2020  height,.        
-000074b0: 2020 2020 2020 2020 785f 6c6f 6361 7469          x_locati
-000074c0: 6f6e 3d78 5f6c 6f63 6174 696f 6e2c 0a20  on=x_location,. 
-000074d0: 2020 2020 2020 2020 2020 2020 2020 2079                 y
-000074e0: 5f6c 6f63 6174 696f 6e3d 795f 6c6f 6361  _location=y_loca
-000074f0: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
-00007500: 2020 290a 2020 2020 2020 2020 656c 7365    ).        else
-00007510: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-00007520: 6c66 2e77 696e 6473 656e 736f 7273 2e75  lf.windsensors.u
-00007530: 7064 6174 655f 7365 6e73 6f72 280a 2020  pdate_sensor(.  
-00007540: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00007550: 6e73 6f72 5f6e 616d 653d 7570 6461 7465  nsor_name=update
-00007560: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00007570: 2020 7769 6e64 5f74 696d 6573 3d77 696e    wind_times=win
-00007580: 645f 7469 6d65 732c 0a20 2020 2020 2020  d_times,.       
-00007590: 2020 2020 2020 2020 2077 696e 645f 7370           wind_sp
-000075a0: 6565 6473 3d77 696e 645f 7370 6565 6473  eeds=wind_speeds
-000075b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000075c0: 2020 7769 6e64 5f64 6972 6563 7469 6f6e    wind_direction
-000075d0: 733d 7769 6e64 5f64 6972 6563 7469 6f6e  s=wind_direction
-000075e0: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-000075f0: 2020 2073 656e 736f 725f 6865 6967 6874     sensor_height
-00007600: 3d73 656e 736f 725f 6865 6967 6874 2c0a  =sensor_height,.
-00007610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007620: 785f 6c6f 6361 7469 6f6e 3d78 5f6c 6f63  x_location=x_loc
-00007630: 6174 696f 6e2c 0a20 2020 2020 2020 2020  ation,.         
-00007640: 2020 2020 2020 2079 5f6c 6f63 6174 696f         y_locatio
-00007650: 6e3d 795f 6c6f 6361 7469 6f6e 2c0a 2020  n=y_location,.  
-00007660: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-00007670: 2064 6566 206e 6577 5f77 696e 645f 7365   def new_wind_se
-00007680: 6e73 6f72 5f66 726f 6d5f 6373 7628 0a20  nsor_from_csv(. 
-00007690: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-000076a0: 2020 2020 2064 6972 6563 746f 7279 3a20       directory: 
-000076b0: 7374 7220 7c20 5061 7468 2c0a 2020 2020  str | Path,.    
-000076c0: 2020 2020 6669 6c65 6e61 6d65 3a20 7374      filename: st
-000076d0: 722c 0a20 2020 2020 2020 2075 7064 6174  r,.        updat
-000076e0: 653a 2073 7472 203d 204e 6f6e 652c 0a20  e: str = None,. 
-000076f0: 2020 2020 2020 2073 656e 736f 725f 6865         sensor_he
-00007700: 6967 6874 3a20 666c 6f61 7420 3d20 4e6f  ight: float = No
-00007710: 6e65 2c0a 2020 2020 2020 2020 785f 6c6f  ne,.        x_lo
-00007720: 6361 7469 6f6e 3a20 696e 7420 3d20 4e6f  cation: int = No
-00007730: 6e65 2c0a 2020 2020 2020 2020 795f 6c6f  ne,.        y_lo
-00007740: 6361 7469 6f6e 3a20 696e 7420 3d20 4e6f  cation: int = No
-00007750: 6e65 2c0a 2020 2020 293a 0a20 2020 2020  ne,.    ):.     
-00007760: 2020 2022 2222 0a20 2020 2020 2020 2041     """.        A
-00007770: 6464 7320 6120 7769 6e64 2073 656e 736f  dds a wind senso
-00007780: 7220 6f72 2075 7064 6174 6573 2061 6e20  r or updates an 
-00007790: 6578 6973 7469 6e67 206f 6e65 2066 726f  existing one fro
-000077a0: 6d20 6120 6373 7620 6669 6c65 2e0a 0a20  m a csv file... 
-000077b0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-000077c0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-000077d0: 2d2d 2d2d 0a20 2020 2020 2020 2064 6972  ----.        dir
-000077e0: 6563 746f 7279 203a 2073 7472 207c 2050  ectory : str | P
-000077f0: 6174 680a 2020 2020 2020 2020 2020 2020  ath.            
-00007800: 4469 7265 6374 6f72 7920 636f 6e74 6169  Directory contai
-00007810: 6e69 6e67 2074 6865 2063 7376 2074 6f20  ning the csv to 
-00007820: 7265 6164 0a20 2020 2020 2020 2066 696c  read.        fil
-00007830: 656e 616d 6520 3a20 7374 720a 2020 2020  ename : str.    
-00007840: 2020 2020 2020 2020 4e61 6d65 206f 6620          Name of 
-00007850: 7468 6520 6373 7620 6669 6c65 0a20 2020  the csv file.   
-00007860: 2020 2020 2075 7064 6174 653a 2073 7472       update: str
-00007870: 0a20 2020 2020 2020 2020 2020 204e 616d  .            Nam
-00007880: 6520 6f66 2074 6865 2077 696e 6420 7365  e of the wind se
-00007890: 6e73 6f72 2c20 652e 672e 2022 7365 6e73  nsor, e.g. "sens
-000078a0: 6f72 3122 2e20 5365 6e73 6f72 206d 7573  or1". Sensor mus
-000078b0: 7420 616c 7265 6164 7920 6578 6973 7420  t already exist 
-000078c0: 696e 2077 696e 6473 656e 736f 7273 2e0a  in windsensors..
-000078d0: 2020 2020 2020 2020 2020 2020 4f6d 6974              Omit
-000078e0: 206f 7220 7573 6520 7570 6461 7465 203d   or use update =
-000078f0: 204e 6f6e 6520 746f 2061 6464 2061 206e   None to add a n
-00007900: 6577 2073 656e 736f 722e 0a20 2020 2020  ew sensor..     
-00007910: 2020 2073 656e 736f 725f 6865 6967 6874     sensor_height
-00007920: 203a 2066 6c6f 6174 203e 2030 0a20 2020   : float > 0.   
-00007930: 2020 2020 2020 2020 2048 6569 6768 7420           Height 
-00007940: 6f66 2077 696e 6420 7365 6e73 6f72 2e0a  of wind sensor..
-00007950: 2020 2020 2020 2020 785f 6c6f 6361 7469          x_locati
-00007960: 6f6e 203a 2069 6e74 203e 3d20 300a 2020  on : int >= 0.  
-00007970: 2020 2020 2020 2020 2020 4c6f 6361 7469            Locati
-00007980: 6f6e 206f 6620 7468 6520 7769 6e64 2073  on of the wind s
-00007990: 656e 736f 7220 696e 2074 6865 2078 2d64  ensor in the x-d
-000079a0: 6972 6563 7469 6f6e 2e0a 2020 2020 2020  irection..      
-000079b0: 2020 795f 6c6f 6361 7469 6f6e 203a 2069    y_location : i
-000079c0: 6e74 203e 3d20 300a 2020 2020 2020 2020  nt >= 0.        
-000079d0: 2020 2020 4c6f 6361 7469 6f6e 206f 6620      Location of 
-000079e0: 7468 6520 7769 6e64 2073 656e 736f 7220  the wind sensor 
-000079f0: 696e 2074 6865 2079 2d64 6972 6563 7469  in the y-directi
-00007a00: 6f6e 2e0a 0a20 2020 2020 2020 2043 6f6c  on...        Col
-00007a10: 756d 6e73 0a20 2020 2020 2020 202d 2d2d  umns.        ---
-00007a20: 2d2d 2d2d 0a20 2020 2020 2020 2077 696e  ----.        win
-00007a30: 645f 7469 6d65 7320 3a20 696e 7420 3e3d  d_times : int >=
-00007a40: 2030 0a20 2020 2020 2020 2020 2020 2054   0.            T
-00007a50: 696d 6520 696e 2073 6563 6f6e 6473 2074  ime in seconds t
-00007a60: 6861 7420 6561 6368 2077 696e 6473 6869  hat each windshi
-00007a70: 6674 206f 6363 7572 7320 6672 6f6d 2074  ft occurs from t
-00007a80: 6865 2073 7461 7274 206f 6620 7468 6520  he start of the 
-00007a90: 7369 6d75 6c61 7469 6f6e 2e0a 2020 2020  simulation..    
-00007aa0: 2020 2020 2020 2020 4669 7273 7420 656e          First en
-00007ab0: 7472 7920 6d75 7374 2062 6520 302e 0a20  try must be 0.. 
-00007ac0: 2020 2020 2020 2077 696e 645f 7370 6565         wind_spee
-00007ad0: 6473 203a 2066 6c6f 6174 203e 2030 0a20  ds : float > 0. 
-00007ae0: 2020 2020 2020 2020 2020 2057 696e 6420             Wind 
-00007af0: 7370 6565 6420 6f66 2065 6163 6820 7769  speed of each wi
-00007b00: 6e64 7368 6966 7420 696e 206d 2f73 2e0a  ndshift in m/s..
-00007b10: 2020 2020 2020 2020 7769 6e64 5f64 6972          wind_dir
-00007b20: 6563 7469 6f6e 7320 3a20 3020 3c3d 2069  ections : 0 <= i
-00007b30: 6e74 203c 2033 3630 0a20 2020 2020 2020  nt < 360.       
-00007b40: 2020 2020 2057 696e 6420 6469 7265 6374       Wind direct
-00007b50: 696f 6e20 6f66 2065 6163 6820 7769 6e64  ion of each wind
-00007b60: 7368 6966 7420 696e 2064 6567 7265 6573  shift in degrees
-00007b70: 2e0a 0a20 2020 2020 2020 2045 7861 6d70  ...        Examp
-00007b80: 6c65 730a 2020 2020 2020 2020 2d2d 2d2d  les.        ----
-00007b90: 2d2d 2d2d 0a20 2020 2020 2020 203e 3e3e  ----.        >>>
-00007ba0: 2066 726f 6d20 7175 6963 6669 7265 5f74   from quicfire_t
-00007bb0: 6f6f 6c73 2069 6d70 6f72 7420 5369 6d75  ools import Simu
-00007bc0: 6c61 7469 6f6e 496e 7075 7473 0a20 2020  lationInputs.   
-00007bd0: 2020 2020 203e 3e3e 2073 696d 5f69 6e70       >>> sim_inp
-00007be0: 7574 7320 3d20 5369 6d75 6c61 7469 6f6e  uts = Simulation
-00007bf0: 496e 7075 7473 2e63 7265 6174 655f 7369  Inputs.create_si
-00007c00: 6d75 6c61 7469 6f6e 286e 783d 3130 302c  mulation(nx=100,
-00007c10: 206e 793d 3130 302c 2066 6972 655f 6e7a   ny=100, fire_nz
-00007c20: 3d32 362c 2077 696e 645f 7370 6565 643d  =26, wind_speed=
-00007c30: 312e 382c 2077 696e 645f 6469 7265 6374  1.8, wind_direct
-00007c40: 696f 6e3d 3930 2c20 7369 6d75 6c61 7469  ion=90, simulati
-00007c50: 6f6e 5f74 696d 653d 3630 3029 0a20 2020  on_time=600).   
-00007c60: 2020 2020 203e 3e3e 2073 696d 5f69 6e70       >>> sim_inp
-00007c70: 7574 732e 6e65 775f 7769 6e64 5f73 656e  uts.new_wind_sen
-00007c80: 736f 725f 6672 6f6d 5f63 7376 2822 7061  sor_from_csv("pa
-00007c90: 7468 2f74 6f2f 6469 7265 6374 6f72 7922  th/to/directory"
-00007ca0: 2c22 6669 6c65 6e61 6d65 222c 7570 6461  ,"filename",upda
-00007cb0: 7465 3d27 7365 6e73 6f72 3127 290a 2020  te='sensor1').  
-00007cc0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00007cd0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00007ce0: 6469 7265 6374 6f72 792c 2073 7472 293a  directory, str):
-00007cf0: 0a20 2020 2020 2020 2020 2020 2064 6972  .            dir
-00007d00: 6563 746f 7279 203d 2050 6174 6828 6469  ectory = Path(di
-00007d10: 7265 6374 6f72 7929 0a20 2020 2020 2020  rectory).       
-00007d20: 2066 696c 6570 6174 6820 3d20 6469 7265   filepath = dire
-00007d30: 6374 6f72 7920 2f20 6669 6c65 6e61 6d65  ctory / filename
-00007d40: 0a20 2020 2020 2020 2064 6620 3d20 7064  .        df = pd
-00007d50: 2e72 6561 645f 6373 7628 6669 6c65 7061  .read_csv(filepa
-00007d60: 7468 290a 2020 2020 2020 2020 7661 6c69  th).        vali
-00007d70: 6461 7465 203d 2044 6174 6146 7261 6d65  date = DataFrame
-00007d80: 5363 6865 6d61 280a 2020 2020 2020 2020  Schema(.        
-00007d90: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
-00007da0: 2020 2020 2020 2277 696e 645f 7469 6d65        "wind_time
-00007db0: 7322 3a20 436f 6c75 6d6e 2869 6e74 2c20  s": Column(int, 
-00007dc0: 6368 6563 6b73 3d43 6865 636b 2e67 6528  checks=Check.ge(
-00007dd0: 3029 292c 0a20 2020 2020 2020 2020 2020  0)),.           
-00007de0: 2020 2020 2022 7769 6e64 5f73 7065 6564       "wind_speed
-00007df0: 7322 3a20 436f 6c75 6d6e 2866 6c6f 6174  s": Column(float
-00007e00: 2c20 6368 6563 6b73 3d43 6865 636b 2e67  , checks=Check.g
-00007e10: 7428 3029 292c 2020 2320 6361 6e20 7769  t(0)),  # can wi
-00007e20: 6e64 7370 6565 6420 6265 2030 3f0a 2020  ndspeed be 0?.  
-00007e30: 2020 2020 2020 2020 2020 2020 2020 2277                "w
-00007e40: 696e 645f 6469 7265 6374 696f 6e73 223a  ind_directions":
-00007e50: 2043 6f6c 756d 6e28 696e 742c 2063 6865   Column(int, che
-00007e60: 636b 733d 4368 6563 6b2e 6c74 2833 3630  cks=Check.lt(360
-00007e70: 2929 2c0a 2020 2020 2020 2020 2020 2020  )),.            
-00007e80: 7d0a 2020 2020 2020 2020 290a 2020 2020  }.        ).    
-00007e90: 2020 2020 7661 6c69 6461 7465 645f 6466      validated_df
-00007ea0: 203d 2076 616c 6964 6174 6528 6466 290a   = validate(df).
-00007eb0: 2020 2020 2020 2020 6966 2075 7064 6174          if updat
-00007ec0: 6520 6973 204e 6f6e 653a 0a20 2020 2020  e is None:.     
-00007ed0: 2020 2020 2020 2073 656c 662e 7769 6e64         self.wind
-00007ee0: 7365 6e73 6f72 732e 6164 645f 7365 6e73  sensors.add_sens
-00007ef0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-00007f00: 2020 2020 7769 6e64 5f74 696d 6573 3d6c      wind_times=l
-00007f10: 6973 7428 7661 6c69 6461 7465 645f 6466  ist(validated_df
-00007f20: 5b22 7769 6e64 5f74 696d 6573 225d 292c  ["wind_times"]),
-00007f30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007f40: 2077 696e 645f 7370 6565 6473 3d6c 6973   wind_speeds=lis
-00007f50: 7428 7661 6c69 6461 7465 645f 6466 5b22  t(validated_df["
-00007f60: 7769 6e64 5f73 7065 6564 7322 5d29 2c0a  wind_speeds"]),.
-00007f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007f80: 7769 6e64 5f64 6972 6563 7469 6f6e 733d  wind_directions=
-00007f90: 6c69 7374 2876 616c 6964 6174 6564 5f64  list(validated_d
-00007fa0: 665b 2277 696e 645f 6469 7265 6374 696f  f["wind_directio
-00007fb0: 6e73 225d 292c 0a20 2020 2020 2020 2020  ns"]),.         
-00007fc0: 2020 2020 2020 2073 656e 736f 725f 6865         sensor_he
-00007fd0: 6967 6874 3d73 656e 736f 725f 6865 6967  ight=sensor_heig
-00007fe0: 6874 2c0a 2020 2020 2020 2020 2020 2020  ht,.            
-00007ff0: 2020 2020 785f 6c6f 6361 7469 6f6e 3d78      x_location=x
-00008000: 5f6c 6f63 6174 696f 6e2c 0a20 2020 2020  _location,.     
-00008010: 2020 2020 2020 2020 2020 2079 5f6c 6f63             y_loc
-00008020: 6174 696f 6e3d 795f 6c6f 6361 7469 6f6e  ation=y_location
-00008030: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-00008040: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00008050: 2020 2020 2020 2020 2020 7365 6c66 2e77            self.w
-00008060: 696e 6473 656e 736f 7273 2e75 7064 6174  indsensors.updat
-00008070: 655f 7365 6e73 6f72 280a 2020 2020 2020  e_sensor(.      
-00008080: 2020 2020 2020 2020 2020 7365 6e73 6f72            sensor
-00008090: 5f6e 616d 653d 7570 6461 7465 2c0a 2020  _name=update,.  
-000080a0: 2020 2020 2020 2020 2020 2020 2020 7769                wi
-000080b0: 6e64 5f74 696d 6573 3d6c 6973 7428 7661  nd_times=list(va
-000080c0: 6c69 6461 7465 645f 6466 5b22 7769 6e64  lidated_df["wind
-000080d0: 5f74 696d 6573 225d 292c 0a20 2020 2020  _times"]),.     
-000080e0: 2020 2020 2020 2020 2020 2077 696e 645f             wind_
-000080f0: 7370 6565 6473 3d6c 6973 7428 7661 6c69  speeds=list(vali
-00008100: 6461 7465 645f 6466 5b22 7769 6e64 5f73  dated_df["wind_s
-00008110: 7065 6564 7322 5d29 2c0a 2020 2020 2020  peeds"]),.      
-00008120: 2020 2020 2020 2020 2020 7769 6e64 5f64            wind_d
-00008130: 6972 6563 7469 6f6e 733d 6c69 7374 2876  irections=list(v
-00008140: 616c 6964 6174 6564 5f64 665b 2277 696e  alidated_df["win
-00008150: 645f 6469 7265 6374 696f 6e73 225d 292c  d_directions"]),
-00008160: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008170: 2073 656e 736f 725f 6865 6967 6874 3d73   sensor_height=s
-00008180: 656e 736f 725f 6865 6967 6874 2c0a 2020  ensor_height,.  
-00008190: 2020 2020 2020 2020 2020 2020 2020 785f                x_
-000081a0: 6c6f 6361 7469 6f6e 3d78 5f6c 6f63 6174  location=x_locat
-000081b0: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
-000081c0: 2020 2020 2079 5f6c 6f63 6174 696f 6e3d       y_location=
-000081d0: 795f 6c6f 6361 7469 6f6e 2c0a 2020 2020  y_location,.    
-000081e0: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-000081f0: 6566 205f 7570 6461 7465 5f73 6861 7265  ef _update_share
-00008200: 645f 6174 7472 6962 7574 6573 2873 656c  d_attributes(sel
-00008210: 6629 3a0a 2020 2020 2020 2020 7365 6c66  f):.        self
-00008220: 2e67 7269 646c 6973 742e 6e20 3d20 7365  .gridlist.n = se
-00008230: 6c66 2e71 755f 7369 6d70 6172 616d 732e  lf.qu_simparams.
-00008240: 6e78 0a20 2020 2020 2020 2073 656c 662e  nx.        self.
-00008250: 6772 6964 6c69 7374 2e6d 203d 2073 656c  gridlist.m = sel
-00008260: 662e 7175 5f73 696d 7061 7261 6d73 2e6e  f.qu_simparams.n
-00008270: 790a 2020 2020 2020 2020 7365 6c66 2e67  y.        self.g
-00008280: 7269 646c 6973 742e 6c20 3d20 7365 6c66  ridlist.l = self
-00008290: 2e71 7569 635f 6669 7265 2e6e 7a0a 2020  .quic_fire.nz.  
-000082a0: 2020 2020 2020 7365 6c66 2e67 7269 646c        self.gridl
-000082b0: 6973 742e 6478 203d 2073 656c 662e 7175  ist.dx = self.qu
-000082c0: 5f73 696d 7061 7261 6d73 2e64 780a 2020  _simparams.dx.  
-000082d0: 2020 2020 2020 7365 6c66 2e67 7269 646c        self.gridl
-000082e0: 6973 742e 6479 203d 2073 656c 662e 7175  ist.dy = self.qu
-000082f0: 5f73 696d 7061 7261 6d73 2e64 790a 2020  _simparams.dy.  
-00008300: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
-00008310: 662e 7175 5f73 696d 7061 7261 6d73 2e77  f.qu_simparams.w
-00008320: 696e 645f 7469 6d65 735b 305d 203d 3d20  ind_times[0] == 
-00008330: 7365 6c66 2e71 7569 635f 6669 7265 2e74  self.quic_fire.t
-00008340: 696d 655f 6e6f 773a 0a20 2020 2020 2020  ime_now:.       
-00008350: 2020 2020 2070 7269 6e74 280a 2020 2020       print(.    
-00008360: 2020 2020 2020 2020 2020 2020 6622 5741              f"WA
-00008370: 524e 494e 473a 2066 6972 6520 7374 6172  RNING: fire star
-00008380: 7420 7469 6d65 206d 7573 7420 6265 2074  t time must be t
-00008390: 6865 2073 616d 6520 666f 7220 616c 6c20  he same for all 
-000083a0: 696e 7075 7420 6669 6c65 732e 5c6e 220a  input files.\n".
-000083b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000083c0: 6622 5469 6d65 733a 205c 6e22 0a20 2020  f"Times: \n".   
-000083d0: 2020 2020 2020 2020 2020 2020 2066 225c               f"\
-000083e0: 7451 5549 435f 6669 7265 2e69 6e70 3a20  tQUIC_fire.inp: 
-000083f0: 7b73 656c 662e 7175 6963 5f66 6972 652e  {self.quic_fire.
-00008400: 7469 6d65 5f6e 6f77 7d5c 6e22 0a20 2020  time_now}\n".   
-00008410: 2020 2020 2020 2020 2020 2020 2066 225c               f"\
-00008420: 7451 555f 7369 6d70 6172 616d 732e 696e  tQU_simparams.in
-00008430: 703a 207b 7365 6c66 2e71 755f 7369 6d70  p: {self.qu_simp
-00008440: 6172 616d 732e 7769 6e64 5f74 696d 6573  arams.wind_times
-00008450: 5b30 5d7d 5c6e 220a 2020 2020 2020 2020  [0]}\n".        
-00008460: 2020 2020 2020 2020 6622 5365 7474 696e          f"Settin
-00008470: 6720 616c 6c20 7661 6c75 6573 2074 6f20  g all values to 
-00008480: 7b73 656c 662e 7175 6963 5f66 6972 652e  {self.quic_fire.
-00008490: 7469 6d65 5f6e 6f77 7d22 0a20 2020 2020  time_now}".     
-000084a0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-000084b0: 2023 2054 4f44 4f3a 2063 6865 636b 2071   # TODO: check q
-000084c0: 755f 6d65 7470 6172 616d 7320 616e 6420  u_metparams and 
-000084d0: 7175 5f73 696d 7061 7261 6d73 0a20 2020  qu_simparams.   
-000084e0: 2020 2020 2073 656c 662e 7175 5f73 696d       self.qu_sim
-000084f0: 7061 7261 6d73 2e77 696e 645f 7469 6d65  params.wind_time
-00008500: 7320 3d20 5b0a 2020 2020 2020 2020 2020  s = [.          
-00008510: 2020 7320 2b20 7365 6c66 2e71 7569 635f    s + self.quic_
-00008520: 6669 7265 2e74 696d 655f 6e6f 7720 666f  fire.time_now fo
-00008530: 7220 7320 696e 2073 656c 662e 7769 6e64  r s in self.wind
-00008540: 7365 6e73 6f72 732e 7769 6e64 5f74 696d  sensors.wind_tim
-00008550: 6573 0a20 2020 2020 2020 205d 0a20 2020  es.        ].   
-00008560: 2020 2020 2073 656c 662e 7175 5f6d 6574       self.qu_met
-00008570: 7061 7261 6d73 2e6e 756d 5f73 656e 736f  params.num_senso
-00008580: 7273 203d 206c 656e 2873 656c 662e 7769  rs = len(self.wi
-00008590: 6e64 7365 6e73 6f72 732e 7365 6e73 6f72  ndsensors.sensor
-000085a0: 5f61 7272 6179 290a 0a0a 636c 6173 7320  _array)...class 
-000085b0: 496e 7075 7446 696c 6528 4261 7365 4d6f  InputFile(BaseMo
-000085c0: 6465 6c2c 2076 616c 6964 6174 655f 6173  del, validate_as
-000085d0: 7369 676e 6d65 6e74 3d54 7275 6529 3a0a  signment=True):.
-000085e0: 2020 2020 2222 220a 2020 2020 4261 7365      """.    Base
-000085f0: 2063 6c61 7373 2072 6570 7265 7365 6e74   class represent
-00008600: 696e 6720 616e 2069 6e70 7574 2066 696c  ing an input fil
-00008610: 652e 0a0a 2020 2020 5468 6973 2062 6173  e...    This bas
-00008620: 6520 636c 6173 7320 7072 6f76 6964 6573  e class provides
-00008630: 2061 2063 6f6d 6d6f 6e20 696e 7465 7266   a common interf
-00008640: 6163 6520 666f 7220 616c 6c20 696e 7075  ace for all inpu
-00008650: 7420 6669 6c65 7320 696e 206f 7264 6572  t files in order
-00008660: 2074 6f0a 2020 2020 6163 636f 6d70 6c69   to.    accompli
-00008670: 7368 2074 776f 206d 6169 6e20 676f 616c  sh two main goal
-00008680: 733a 0a0a 2020 2020 3129 2052 6574 7572  s:..    1) Retur
-00008690: 6e20 646f 6375 6d65 6e74 6174 696f 6e20  n documentation 
-000086a0: 666f 7220 6561 6368 2070 6172 616d 6574  for each paramet
-000086b0: 6572 2069 6e20 7468 6520 696e 7075 7420  er in the input 
-000086c0: 6669 6c65 2e0a 0a20 2020 2032 2920 5072  file...    2) Pr
-000086d0: 6f76 6964 6520 6120 6d65 7468 6f64 2074  ovide a method t
-000086e0: 6f20 7772 6974 6520 7468 6520 696e 7075  o write the inpu
-000086f0: 7420 6669 6c65 2074 6f20 6120 6469 7265  t file to a dire
-00008700: 6374 6f72 792e 0a20 2020 2022 2222 0a0a  ctory..    """..
-00008710: 2020 2020 6e61 6d65 3a20 7374 720a 2020      name: str.  
-00008720: 2020 5f65 7874 656e 7369 6f6e 3a20 7374    _extension: st
-00008730: 720a 0a20 2020 2040 7072 6f70 6572 7479  r..    @property
-00008740: 0a20 2020 2064 6566 205f 6669 6c65 6e61  .    def _filena
-00008750: 6d65 2873 656c 6629 3a0a 2020 2020 2020  me(self):.      
-00008760: 2020 7265 7475 726e 2066 227b 7365 6c66    return f"{self
-00008770: 2e6e 616d 657d 7b73 656c 662e 5f65 7874  .name}{self._ext
-00008780: 656e 7369 6f6e 7d22 0a0a 2020 2020 4070  ension}"..    @p
-00008790: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-000087a0: 646f 6375 6d65 6e74 6174 696f 6e5f 6469  documentation_di
-000087b0: 6374 2873 656c 6629 202d 3e20 6469 6374  ct(self) -> dict
-000087c0: 3a0a 2020 2020 2020 2020 2320 5265 7475  :.        # Retu
-000087d0: 726e 2074 6865 2064 6f63 756d 656e 7461  rn the documenta
-000087e0: 7469 6f6e 2064 6963 7469 6f6e 6172 790a  tion dictionary.
-000087f0: 2020 2020 2020 2020 7769 7468 206f 7065          with ope
-00008800: 6e28 444f 4353 5f50 4154 4820 2f20 6622  n(DOCS_PATH / f"
-00008810: 7b73 656c 662e 5f66 696c 656e 616d 657d  {self._filename}
-00008820: 2e6a 736f 6e22 2c20 2272 2229 2061 7320  .json", "r") as 
-00008830: 663a 0a20 2020 2020 2020 2020 2020 2072  f:.            r
-00008840: 6574 7572 6e20 6a73 6f6e 2e6c 6f61 6428  eturn json.load(
-00008850: 6629 0a0a 2020 2020 6465 6620 6c69 7374  f)..    def list
-00008860: 5f70 6172 616d 6574 6572 7328 7365 6c66  _parameters(self
-00008870: 2920 2d3e 206c 6973 745b 7374 725d 3a0a  ) -> list[str]:.
-00008880: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00008890: 2020 2020 4765 7420 6120 6c69 7374 206f      Get a list o
-000088a0: 6620 7468 6520 6e61 6d65 7320 6f66 2061  f the names of a
-000088b0: 6c6c 2070 6172 616d 6574 6572 7320 696e  ll parameters in
-000088c0: 2074 6865 2069 6e70 7574 2066 696c 652e   the input file.
-000088d0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-000088e0: 2020 2020 2072 6574 7572 6e20 6c69 7374       return list
-000088f0: 2873 656c 662e 646f 6375 6d65 6e74 6174  (self.documentat
-00008900: 696f 6e5f 6469 6374 2e6b 6579 7328 2929  ion_dict.keys())
-00008910: 0a0a 2020 2020 6465 6620 6765 745f 646f  ..    def get_do
-00008920: 6375 6d65 6e74 6174 696f 6e28 7365 6c66  cumentation(self
-00008930: 2c20 7061 7261 6d65 7465 723a 2073 7472  , parameter: str
-00008940: 203d 204e 6f6e 6529 202d 3e20 6469 6374   = None) -> dict
-00008950: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-00008960: 2020 2020 2020 5265 7472 6965 7665 2064        Retrieve d
-00008970: 6f63 756d 656e 7461 7469 6f6e 2066 6f72  ocumentation for
-00008980: 2061 2070 6172 616d 6574 6572 2e20 4966   a parameter. If
-00008990: 206e 6f20 7061 7261 6d65 7465 7220 6973   no parameter is
-000089a0: 2073 7065 6369 6669 6564 2c0a 2020 2020   specified,.    
-000089b0: 2020 2020 7265 7475 726e 2064 6f63 756d      return docum
-000089c0: 656e 7461 7469 6f6e 2066 6f72 2061 6c6c  entation for all
-000089d0: 2070 6172 616d 6574 6572 732e 0a20 2020   parameters..   
-000089e0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-000089f0: 2069 6620 7061 7261 6d65 7465 723a 0a20   if parameter:. 
-00008a00: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00008a10: 6e20 7365 6c66 2e64 6f63 756d 656e 7461  n self.documenta
-00008a20: 7469 6f6e 5f64 6963 742e 6765 7428 7061  tion_dict.get(pa
-00008a30: 7261 6d65 7465 722c 207b 7d29 0a20 2020  rameter, {}).   
-00008a40: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00008a50: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00008a60: 6c66 2e64 6f63 756d 656e 7461 7469 6f6e  lf.documentation
-00008a70: 5f64 6963 740a 0a20 2020 2064 6566 2070  _dict..    def p
-00008a80: 7269 6e74 5f64 6f63 756d 656e 7461 7469  rint_documentati
-00008a90: 6f6e 5f74 6162 6c65 2873 656c 662c 2070  on_table(self, p
-00008aa0: 6172 616d 6574 6572 3a20 7374 7220 3d20  arameter: str = 
-00008ab0: 4e6f 6e65 2920 2d3e 204e 6f6e 653a 0a20  None) -> None:. 
-00008ac0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00008ad0: 2020 2050 7269 6e74 2064 6f63 756d 656e     Print documen
-00008ae0: 7461 7469 6f6e 2066 6f72 2061 2070 6172  tation for a par
-00008af0: 616d 6574 6572 2e20 4966 206e 6f20 7061  ameter. If no pa
-00008b00: 7261 6d65 7465 7220 6973 2073 7065 6369  rameter is speci
-00008b10: 6669 6564 2c0a 2020 2020 2020 2020 7072  fied,.        pr
-00008b20: 696e 7420 646f 6375 6d65 6e74 6174 696f  int documentatio
-00008b30: 6e20 666f 7220 616c 6c20 7061 7261 6d65  n for all parame
-00008b40: 7465 7273 2e0a 2020 2020 2020 2020 2222  ters..        ""
-00008b50: 220a 2020 2020 2020 2020 6966 2070 6172  ".        if par
-00008b60: 616d 6574 6572 3a0a 2020 2020 2020 2020  ameter:.        
-00008b70: 2020 2020 696e 666f 203d 2073 656c 662e      info = self.
-00008b80: 6765 745f 646f 6375 6d65 6e74 6174 696f  get_documentatio
-00008b90: 6e28 7061 7261 6d65 7465 7229 0a20 2020  n(parameter).   
-00008ba0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00008bb0: 2020 2020 2020 2069 6e66 6f20 3d20 7365         info = se
-00008bc0: 6c66 2e67 6574 5f64 6f63 756d 656e 7461  lf.get_documenta
-00008bd0: 7469 6f6e 2829 0a20 2020 2020 2020 2066  tion().        f
-00008be0: 6f72 206b 6579 2c20 7661 6c75 6520 696e  or key, value in
-00008bf0: 2069 6e66 6f2e 6974 656d 7328 293a 0a20   info.items():. 
-00008c00: 2020 2020 2020 2020 2020 206b 6579 203d             key =
-00008c10: 206b 6579 2e72 6570 6c61 6365 2822 5f22   key.replace("_"
-00008c20: 2c20 2220 2229 2e63 6170 6974 616c 697a  , " ").capitaliz
-00008c30: 6528 290a 2020 2020 2020 2020 2020 2020  e().            
-00008c40: 7072 696e 7428 6622 2d20 7b6b 6579 7d3a  print(f"- {key}:
-00008c50: 207b 7661 6c75 657d 2229 0a0a 2020 2020   {value}")..    
-00008c60: 6465 6620 746f 5f64 6963 7428 7365 6c66  def to_dict(self
-00008c70: 2c20 696e 636c 7564 655f 7072 6976 6174  , include_privat
-00008c80: 653a 2062 6f6f 6c20 3d20 4661 6c73 6529  e: bool = False)
-00008c90: 202d 3e20 6469 6374 3a0a 2020 2020 2020   -> dict:.      
-00008ca0: 2020 2222 220a 2020 2020 2020 2020 436f    """.        Co
-00008cb0: 6e76 6572 7420 7468 6520 6f62 6a65 6374  nvert the object
-00008cc0: 2074 6f20 6120 6469 6374 696f 6e61 7279   to a dictionary
-00008cd0: 2c20 6578 636c 7564 696e 6720 6174 7472  , excluding attr
-00008ce0: 6962 7574 6573 2074 6861 7420 7374 6172  ibutes that star
-00008cf0: 740a 2020 2020 2020 2020 7769 7468 2061  t.        with a
-00008d00: 6e20 756e 6465 7273 636f 7265 2e0a 0a20  n underscore... 
-00008d10: 2020 2020 2020 2052 6574 7572 6e73 0a20         Returns. 
-00008d20: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
-00008d30: 2020 2020 2020 2064 6963 740a 2020 2020         dict.    
-00008d40: 2020 2020 2020 2020 4469 6374 696f 6e61          Dictiona
-00008d50: 7279 2072 6570 7265 7365 6e74 6174 696f  ry representatio
-00008d60: 6e20 6f66 2074 6865 206f 626a 6563 742e  n of the object.
-00008d70: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00008d80: 2020 2020 2061 6c6c 5f66 6965 6c64 7320       all_fields 
-00008d90: 3d20 7365 6c66 2e6d 6f64 656c 5f64 756d  = self.model_dum
-00008da0: 7028 0a20 2020 2020 2020 2020 2020 2065  p(.            e
-00008db0: 7863 6c75 6465 3d7b 226e 616d 6522 2c20  xclude={"name", 
-00008dc0: 225f 6578 7465 6e73 696f 6e22 2c20 225f  "_extension", "_
-00008dd0: 6669 6c65 6e61 6d65 222c 2022 646f 6375  filename", "docu
-00008de0: 6d65 6e74 6174 696f 6e5f 6469 6374 227d  mentation_dict"}
-00008df0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00008e00: 2020 2069 6620 696e 636c 7564 655f 7072     if include_pr
-00008e10: 6976 6174 653a 0a20 2020 2020 2020 2020  ivate:.         
-00008e20: 2020 2072 6574 7572 6e20 616c 6c5f 6669     return all_fi
-00008e30: 656c 6473 0a20 2020 2020 2020 2072 6574  elds.        ret
-00008e40: 7572 6e20 7b0a 2020 2020 2020 2020 2020  urn {.          
-00008e50: 2020 6b65 793a 2076 616c 7565 2066 6f72    key: value for
-00008e60: 206b 6579 2c20 7661 6c75 6520 696e 2061   key, value in a
-00008e70: 6c6c 5f66 6965 6c64 732e 6974 656d 7328  ll_fields.items(
-00008e80: 2920 6966 206e 6f74 206b 6579 2e73 7461  ) if not key.sta
-00008e90: 7274 7377 6974 6828 225f 2229 0a20 2020  rtswith("_").   
-00008ea0: 2020 2020 207d 0a0a 2020 2020 6465 6620       }..    def 
-00008eb0: 746f 5f66 696c 6528 7365 6c66 2c20 6469  to_file(self, di
-00008ec0: 7265 6374 6f72 793a 2050 6174 682c 2076  rectory: Path, v
-00008ed0: 6572 7369 6f6e 3a20 7374 7220 3d20 226c  ersion: str = "l
-00008ee0: 6174 6573 7422 293a 0a20 2020 2020 2020  atest"):.       
-00008ef0: 2022 2222 0a20 2020 2020 2020 2057 7269   """.        Wri
-00008f00: 7465 2074 6865 2069 6e70 7574 2066 696c  te the input fil
-00008f10: 6520 746f 2061 2073 7065 6369 6669 6564  e to a specified
-00008f20: 2064 6972 6563 746f 7279 2e0a 0a20 2020   directory...   
-00008f30: 2020 2020 2041 7474 7269 6275 7465 730a       Attributes.
-00008f40: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00008f50: 2d2d 0a20 2020 2020 2020 2064 6972 6563  --.        direc
-00008f60: 746f 7279 203a 2050 6174 680a 2020 2020  tory : Path.    
-00008f70: 2020 2020 2020 2020 4469 7265 6374 6f72          Director
-00008f80: 7920 746f 2077 7269 7465 2074 6865 2069  y to write the i
-00008f90: 6e70 7574 2066 696c 6520 746f 2e0a 2020  nput file to..  
-00008fa0: 2020 2020 2020 7665 7273 696f 6e20 3a20        version : 
-00008fb0: 7374 720a 2020 2020 2020 2020 2020 2020  str.            
-00008fc0: 5665 7273 696f 6e20 6f66 2074 6865 2069  Version of the i
-00008fd0: 6e70 7574 2066 696c 6520 746f 2077 7269  nput file to wri
-00008fe0: 7465 2e20 4465 6661 756c 7420 6973 2022  te. Default is "
-00008ff0: 6c61 7465 7374 222e 0a20 2020 2020 2020  latest"..       
-00009000: 2022 2222 0a20 2020 2020 2020 2069 6620   """.        if 
-00009010: 6973 696e 7374 616e 6365 2864 6972 6563  isinstance(direc
-00009020: 746f 7279 2c20 7374 7229 3a0a 2020 2020  tory, str):.    
-00009030: 2020 2020 2020 2020 6469 7265 6374 6f72          director
-00009040: 7920 3d20 5061 7468 2864 6972 6563 746f  y = Path(directo
-00009050: 7279 290a 0a20 2020 2020 2020 2076 6572  ry)..        ver
-00009060: 7369 6f6e 203d 205f 7661 6c69 6461 7465  sion = _validate
-00009070: 5f61 6e64 5f72 6574 7572 6e5f 7665 7273  _and_return_vers
-00009080: 696f 6e28 7665 7273 696f 6e29 0a0a 2020  ion(version)..  
-00009090: 2020 2020 2020 7465 6d70 6c61 7465 5f66        template_f
-000090a0: 696c 655f 7061 7468 203d 2054 454d 504c  ile_path = TEMPL
-000090b0: 4154 4553 5f50 4154 4820 2f20 7665 7273  ATES_PATH / vers
-000090c0: 696f 6e20 2f20 6622 7b73 656c 662e 5f66  ion / f"{self._f
-000090d0: 696c 656e 616d 657d 220a 2020 2020 2020  ilename}".      
-000090e0: 2020 7769 7468 206f 7065 6e28 7465 6d70    with open(temp
-000090f0: 6c61 7465 5f66 696c 655f 7061 7468 2c20  late_file_path, 
-00009100: 2272 2229 2061 7320 6674 656d 703a 0a20  "r") as ftemp:. 
-00009110: 2020 2020 2020 2020 2020 2073 7263 203d             src =
-00009120: 2054 656d 706c 6174 6528 6674 656d 702e   Template(ftemp.
-00009130: 7265 6164 2829 290a 0a20 2020 2020 2020  read())..       
-00009140: 2072 6573 756c 7420 3d20 7372 632e 7375   result = src.su
-00009150: 6273 7469 7475 7465 2873 656c 662e 746f  bstitute(self.to
-00009160: 5f64 6963 7428 696e 636c 7564 655f 7072  _dict(include_pr
-00009170: 6976 6174 653d 5472 7565 2929 0a0a 2020  ivate=True))..  
-00009180: 2020 2020 2020 6f75 7470 7574 5f66 696c        output_fil
-00009190: 655f 7061 7468 203d 2064 6972 6563 746f  e_path = directo
-000091a0: 7279 202f 2073 656c 662e 5f66 696c 656e  ry / self._filen
-000091b0: 616d 650a 2020 2020 2020 2020 7769 7468  ame.        with
-000091c0: 206f 7065 6e28 6f75 7470 7574 5f66 696c   open(output_fil
-000091d0: 655f 7061 7468 2c20 2277 2229 2061 7320  e_path, "w") as 
-000091e0: 666f 7574 3a0a 2020 2020 2020 2020 2020  fout:.          
-000091f0: 2020 666f 7574 2e77 7269 7465 2872 6573    fout.write(res
-00009200: 756c 7429 0a0a 2020 2020 4063 6c61 7373  ult)..    @class
-00009210: 6d65 7468 6f64 0a20 2020 2064 6566 2066  method.    def f
-00009220: 726f 6d5f 6469 6374 2863 6c73 2c20 6461  rom_dict(cls, da
-00009230: 7461 3a20 6469 6374 293a 0a20 2020 2020  ta: dict):.     
-00009240: 2020 2072 6574 7572 6e20 636c 7328 2a2a     return cls(**
-00009250: 6461 7461 290a 0a0a 2320 544f 444f 3a20  data)...# TODO: 
-00009260: 556e 6966 7920 636c 6173 7320 6e61 6d69  Unify class nami
-00009270: 6e67 0a0a 0a63 6c61 7373 2047 7269 646c  ng...class Gridl
-00009280: 6973 7428 496e 7075 7446 696c 6529 3a0a  ist(InputFile):.
-00009290: 2020 2020 2222 220a 2020 2020 436c 6173      """.    Clas
-000092a0: 7320 7265 7072 6573 656e 7469 6e67 2074  s representing t
-000092b0: 6865 2067 7269 646c 6973 742e 7478 7420  he gridlist.txt 
-000092c0: 6669 6c65 2e20 5468 6973 2066 696c 6520  file. This file 
-000092d0: 636f 6e74 6169 6e73 2074 6865 2067 7269  contains the gri
-000092e0: 640a 2020 2020 696e 666f 726d 6174 696f  d.    informatio
-000092f0: 6e20 666f 7220 7468 6520 5155 4943 2d46  n for the QUIC-F
-00009300: 6972 6520 7369 6d75 6c61 7469 6f6e 2077  ire simulation w
-00009310: 6865 6e20 6361 6e6f 7069 6573 2061 7265  hen canopies are
-00009320: 2070 7265 7365 6e74 2e0a 0a20 2020 2041   present...    A
-00009330: 7474 7269 6275 7465 730a 2020 2020 2d2d  ttributes.    --
-00009340: 2d2d 2d2d 2d2d 2d2d 0a20 2020 206e 203a  --------.    n :
-00009350: 2069 6e74 0a20 2020 2020 2020 204e 756d   int.        Num
-00009360: 6265 7220 6f66 2063 656c 6c73 2069 6e20  ber of cells in 
-00009370: 7468 6520 782d 6469 7265 6374 696f 6e20  the x-direction 
-00009380: 5b2d 5d0a 2020 2020 6d20 3a20 696e 740a  [-].    m : int.
-00009390: 2020 2020 2020 2020 4e75 6d62 6572 206f          Number o
-000093a0: 6620 6365 6c6c 7320 696e 2074 6865 2079  f cells in the y
-000093b0: 2d64 6972 6563 7469 6f6e 205b 2d5d 0a20  -direction [-]. 
-000093c0: 2020 206c 203a 2069 6e74 0a20 2020 2020     l : int.     
-000093d0: 2020 204e 756d 6265 7220 6f66 2063 656c     Number of cel
-000093e0: 6c73 2069 6e20 7468 6520 7a2d 6469 7265  ls in the z-dire
-000093f0: 6374 696f 6e20 5b2d 5d0a 2020 2020 6478  ction [-].    dx
-00009400: 203a 2066 6c6f 6174 0a20 2020 2020 2020   : float.       
-00009410: 2043 656c 6c20 7369 7a65 2069 6e20 7468   Cell size in th
-00009420: 6520 782d 6469 7265 6374 696f 6e20 5b6d  e x-direction [m
-00009430: 5d0a 2020 2020 6479 203a 2066 6c6f 6174  ].    dy : float
-00009440: 0a20 2020 2020 2020 2043 656c 6c20 7369  .        Cell si
-00009450: 7a65 2069 6e20 7468 6520 792d 6469 7265  ze in the y-dire
-00009460: 6374 696f 6e20 5b6d 5d0a 2020 2020 647a  ction [m].    dz
-00009470: 203a 2066 6c6f 6174 0a20 2020 2020 2020   : float.       
-00009480: 2043 656c 6c20 7369 7a65 2069 6e20 7468   Cell size in th
-00009490: 6520 7a2d 6469 7265 6374 696f 6e20 5b6d  e z-direction [m
-000094a0: 5d0a 2020 2020 6161 3120 3a20 666c 6f61  ].    aa1 : floa
-000094b0: 740a 2020 2020 2020 2020 5374 7265 7463  t.        Stretc
-000094c0: 6869 6e67 2066 6163 746f 7220 666f 7220  hing factor for 
-000094d0: 7468 6520 7665 7274 6963 616c 2067 7269  the vertical gri
-000094e0: 6420 7370 6163 696e 6720 5b2d 5d0a 2020  d spacing [-].  
-000094f0: 2020 2222 220a 0a20 2020 206e 616d 653a    """..    name:
-00009500: 2073 7472 203d 2046 6965 6c64 2822 6772   str = Field("gr
-00009510: 6964 6c69 7374 222c 2066 726f 7a65 6e3d  idlist", frozen=
-00009520: 5472 7565 290a 2020 2020 5f65 7874 656e  True).    _exten
-00009530: 7369 6f6e 3a20 7374 7220 3d20 2222 0a20  sion: str = "". 
-00009540: 2020 206e 3a20 506f 7369 7469 7665 496e     n: PositiveIn
-00009550: 740a 2020 2020 6d3a 2050 6f73 6974 6976  t.    m: Positiv
-00009560: 6549 6e74 0a20 2020 206c 3a20 506f 7369  eInt.    l: Posi
-00009570: 7469 7665 496e 740a 2020 2020 6478 3a20  tiveInt.    dx: 
-00009580: 506f 7369 7469 7665 466c 6f61 7420 3d20  PositiveFloat = 
-00009590: 320a 2020 2020 6479 3a20 506f 7369 7469  2.    dy: Positi
-000095a0: 7665 466c 6f61 7420 3d20 320a 2020 2020  veFloat = 2.    
-000095b0: 647a 3a20 506f 7369 7469 7665 466c 6f61  dz: PositiveFloa
-000095c0: 7420 3d20 310a 2020 2020 6161 313a 2050  t = 1.    aa1: P
-000095d0: 6f73 6974 6976 6546 6c6f 6174 203d 2031  ositiveFloat = 1
-000095e0: 2e30 0a0a 2020 2020 4063 6c61 7373 6d65  .0..    @classme
-000095f0: 7468 6f64 0a20 2020 2064 6566 2066 726f  thod.    def fro
-00009600: 6d5f 6669 6c65 2863 6c73 2c20 6469 7265  m_file(cls, dire
-00009610: 6374 6f72 793a 2073 7472 207c 2050 6174  ctory: str | Pat
-00009620: 682c 202a 2a6b 7761 7267 7329 3a0a 2020  h, **kwargs):.  
-00009630: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00009640: 2020 496e 6974 6961 6c69 7a65 7320 6120    Initializes a 
-00009650: 4772 6964 6c69 7374 206f 626a 6563 7420  Gridlist object 
-00009660: 6672 6f6d 2061 2064 6972 6563 746f 7279  from a directory
-00009670: 2063 6f6e 7461 696e 696e 6720 610a 2020   containing a.  
-00009680: 2020 2020 2020 6772 6964 6c69 7374 2e74        gridlist.t
-00009690: 7874 2066 696c 652e 0a20 2020 2020 2020  xt file..       
-000096a0: 2022 2222 0a20 2020 2020 2020 2069 6620   """.        if 
-000096b0: 6973 696e 7374 616e 6365 2864 6972 6563  isinstance(direc
-000096c0: 746f 7279 2c20 7374 7229 3a0a 2020 2020  tory, str):.    
-000096d0: 2020 2020 2020 2020 6469 7265 6374 6f72          director
-000096e0: 7920 3d20 5061 7468 2864 6972 6563 746f  y = Path(directo
-000096f0: 7279 290a 2020 2020 2020 2020 7769 7468  ry).        with
-00009700: 206f 7065 6e28 6469 7265 6374 6f72 7920   open(directory 
-00009710: 2f20 2267 7269 646c 6973 7422 2c20 2272  / "gridlist", "r
-00009720: 2229 2061 7320 663a 0a20 2020 2020 2020  ") as f:.       
-00009730: 2020 2020 206c 696e 6573 203d 2066 2e72       lines = f.r
-00009740: 6561 6428 290a 0a20 2020 2020 2020 2072  ead()..        r
-00009750: 6574 7572 6e20 636c 7328 0a20 2020 2020  eturn cls(.     
-00009760: 2020 2020 2020 206e 3d69 6e74 286c 696e         n=int(lin
-00009770: 6573 2e73 706c 6974 2822 6e3d 2229 5b31  es.split("n=")[1
-00009780: 5d2e 7370 6c69 7428 295b 305d 292c 0a20  ].split()[0]),. 
-00009790: 2020 2020 2020 2020 2020 206d 3d69 6e74             m=int
-000097a0: 286c 696e 6573 2e73 706c 6974 2822 6d3d  (lines.split("m=
-000097b0: 2229 5b31 5d2e 7370 6c69 7428 295b 305d  ")[1].split()[0]
-000097c0: 292c 0a20 2020 2020 2020 2020 2020 206c  ),.            l
-000097d0: 3d69 6e74 286c 696e 6573 2e73 706c 6974  =int(lines.split
-000097e0: 2822 6c3d 2229 5b31 5d2e 7370 6c69 7428  ("l=")[1].split(
-000097f0: 295b 305d 292c 0a20 2020 2020 2020 2020  )[0]),.         
-00009800: 2020 2064 783d 666c 6f61 7428 6c69 6e65     dx=float(line
-00009810: 732e 7370 6c69 7428 2264 783d 2229 5b31  s.split("dx=")[1
-00009820: 5d2e 7370 6c69 7428 295b 305d 292c 0a20  ].split()[0]),. 
-00009830: 2020 2020 2020 2020 2020 2064 793d 666c             dy=fl
-00009840: 6f61 7428 6c69 6e65 732e 7370 6c69 7428  oat(lines.split(
-00009850: 2264 793d 2229 5b31 5d2e 7370 6c69 7428  "dy=")[1].split(
-00009860: 295b 305d 292c 0a20 2020 2020 2020 2020  )[0]),.         
-00009870: 2020 2064 7a3d 666c 6f61 7428 6c69 6e65     dz=float(line
-00009880: 732e 7370 6c69 7428 2264 7a3d 2229 5b31  s.split("dz=")[1
-00009890: 5d2e 7370 6c69 7428 295b 305d 292c 0a20  ].split()[0]),. 
-000098a0: 2020 2020 2020 2020 2020 2061 6131 3d66             aa1=f
-000098b0: 6c6f 6174 286c 696e 6573 2e73 706c 6974  loat(lines.split
-000098c0: 2822 6161 313d 2229 5b31 5d2e 7370 6c69  ("aa1=")[1].spli
-000098d0: 7428 295b 305d 292c 0a20 2020 2020 2020  t()[0]),.       
-000098e0: 2029 0a0a 0a63 6c61 7373 2052 6173 7465   )...class Raste
-000098f0: 724f 7269 6769 6e28 496e 7075 7446 696c  rOrigin(InputFil
-00009900: 6529 3a0a 2020 2020 2222 220a 2020 2020  e):.    """.    
-00009910: 436c 6173 7320 7265 7072 6573 656e 7469  Class representi
-00009920: 6e67 2074 6865 2072 6173 7465 726f 7269  ng the rasterori
-00009930: 6769 6e2e 7478 7420 6669 6c65 2e20 5468  gin.txt file. Th
-00009940: 6973 2066 696c 6520 636f 6e74 6169 6e73  is file contains
-00009950: 2074 6865 0a20 2020 2063 6f6f 7264 696e   the.    coordin
-00009960: 6174 6573 206f 6620 7468 6520 736f 7574  ates of the sout
-00009970: 682d 7765 7374 2063 6f72 6e65 7220 6f66  h-west corner of
-00009980: 2074 6865 2064 6f6d 6169 6e20 696e 2055   the domain in U
-00009990: 544d 2063 6f6f 7264 696e 6174 6573 2e0a  TM coordinates..
-000099a0: 0a20 2020 2041 7474 7269 6275 7465 730a  .    Attributes.
-000099b0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-000099c0: 2020 2075 746d 5f78 203a 2066 6c6f 6174     utm_x : float
-000099d0: 0a20 2020 2020 2020 2055 544d 2d78 2063  .        UTM-x c
-000099e0: 6f6f 7264 696e 6174 6573 206f 6620 7468  oordinates of th
-000099f0: 6520 736f 7574 682d 7765 7374 2063 6f72  e south-west cor
-00009a00: 6e65 7220 6f66 2064 6f6d 6169 6e20 5b6d  ner of domain [m
-00009a10: 5d0a 2020 2020 7574 6d5f 7920 3a20 666c  ].    utm_y : fl
-00009a20: 6f61 740a 2020 2020 2020 2020 5554 4d2d  oat.        UTM-
-00009a30: 7920 636f 6f72 6469 6e61 7465 7320 6f66  y coordinates of
-00009a40: 2074 6865 2073 6f75 7468 2d77 6573 7420   the south-west 
-00009a50: 636f 726e 6572 206f 6620 646f 6d61 696e  corner of domain
-00009a60: 205b 6d5d 0a20 2020 2022 2222 0a0a 2020   [m].    """..  
-00009a70: 2020 6e61 6d65 3a20 7374 7220 3d20 4669    name: str = Fi
-00009a80: 656c 6428 2272 6173 7465 726f 7269 6769  eld("rasterorigi
-00009a90: 6e22 2c20 6672 6f7a 656e 3d54 7275 6529  n", frozen=True)
-00009aa0: 0a20 2020 205f 6578 7465 6e73 696f 6e3a  .    _extension:
-00009ab0: 2073 7472 203d 2022 2e74 7874 220a 2020   str = ".txt".  
-00009ac0: 2020 7574 6d5f 783a 204e 6f6e 4e65 6761    utm_x: NonNega
-00009ad0: 7469 7665 466c 6f61 7420 3d20 302e 300a  tiveFloat = 0.0.
-00009ae0: 2020 2020 7574 6d5f 793a 204e 6f6e 4e65      utm_y: NonNe
-00009af0: 6761 7469 7665 466c 6f61 7420 3d20 302e  gativeFloat = 0.
-00009b00: 300a 0a20 2020 2040 636c 6173 736d 6574  0..    @classmet
-00009b10: 686f 640a 2020 2020 6465 6620 6672 6f6d  hod.    def from
-00009b20: 5f66 696c 6528 636c 732c 2064 6972 6563  _file(cls, direc
-00009b30: 746f 7279 3a20 7374 7220 7c20 5061 7468  tory: str | Path
-00009b40: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
-00009b50: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00009b60: 2049 6e69 7469 616c 697a 6573 2061 2052   Initializes a R
-00009b70: 6173 7465 724f 7269 6769 6e20 6f62 6a65  asterOrigin obje
-00009b80: 6374 2066 726f 6d20 6120 6469 7265 6374  ct from a direct
-00009b90: 6f72 7920 636f 6e74 6169 6e69 6e67 2061  ory containing a
-00009ba0: 0a20 2020 2020 2020 2072 6173 7465 726f  .        rastero
-00009bb0: 7269 6769 6e2e 7478 7420 6669 6c65 2e0a  rigin.txt file..
-00009bc0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00009bd0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00009be0: 6528 6469 7265 6374 6f72 792c 2073 7472  e(directory, str
-00009bf0: 293a 0a20 2020 2020 2020 2020 2020 2064  ):.            d
-00009c00: 6972 6563 746f 7279 203d 2050 6174 6828  irectory = Path(
-00009c10: 6469 7265 6374 6f72 7929 0a20 2020 2020  directory).     
-00009c20: 2020 2077 6974 6820 6f70 656e 2864 6972     with open(dir
-00009c30: 6563 746f 7279 202f 2022 7261 7374 6572  ectory / "raster
-00009c40: 6f72 6967 696e 2e74 7874 222c 2022 7222  origin.txt", "r"
-00009c50: 2920 6173 2066 3a0a 2020 2020 2020 2020  ) as f:.        
-00009c60: 2020 2020 6c69 6e65 7320 3d20 662e 7265      lines = f.re
-00009c70: 6164 6c69 6e65 7328 290a 2020 2020 2020  adlines().      
-00009c80: 2020 7265 7475 726e 2063 6c73 2875 746d    return cls(utm
-00009c90: 5f78 3d66 6c6f 6174 286c 696e 6573 5b30  _x=float(lines[0
-00009ca0: 5d2e 7370 6c69 7428 295b 305d 292c 2075  ].split()[0]), u
-00009cb0: 746d 5f79 3d66 6c6f 6174 286c 696e 6573  tm_y=float(lines
-00009cc0: 5b31 5d2e 7370 6c69 7428 295b 305d 2929  [1].split()[0]))
-00009cd0: 0a0a 0a63 6c61 7373 2051 555f 4275 696c  ...class QU_Buil
-00009ce0: 6469 6e67 7328 496e 7075 7446 696c 6529  dings(InputFile)
-00009cf0: 3a0a 2020 2020 2222 220a 2020 2020 436c  :.    """.    Cl
-00009d00: 6173 7320 7265 7072 6573 656e 7469 6e67  ass representing
-00009d10: 2074 6865 2051 555f 6275 696c 6469 6e67   the QU_building
-00009d20: 732e 696e 7020 6669 6c65 2e20 5468 6973  s.inp file. This
-00009d30: 2066 696c 6520 636f 6e74 6169 6e73 2074   file contains t
-00009d40: 6865 0a20 2020 2062 7569 6c64 696e 672d  he.    building-
-00009d50: 7265 6c61 7465 6420 6461 7461 2066 6f72  related data for
-00009d60: 2074 6865 2051 5549 432d 4669 7265 2073   the QUIC-Fire s
-00009d70: 696d 756c 6174 696f 6e2e 2054 6869 7320  imulation. This 
-00009d80: 636c 6173 7320 6973 206e 6f74 0a20 2020  class is not.   
-00009d90: 2063 7572 7265 6e74 6c79 2075 7365 6420   currently used 
-00009da0: 696e 2051 5549 432d 4669 7265 2e0a 0a20  in QUIC-Fire... 
-00009db0: 2020 2041 7474 7269 6275 7465 730a 2020     Attributes.  
-00009dc0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-00009dd0: 2077 616c 6c5f 726f 7567 686e 6573 735f   wall_roughness_
-00009de0: 6c65 6e67 7468 203a 2066 6c6f 6174 0a20  length : float. 
-00009df0: 2020 2020 2020 2057 616c 6c20 726f 7567         Wall roug
-00009e00: 686e 6573 7320 6c65 6e67 7468 205b 6d5d  hness length [m]
-00009e10: 2e20 4d75 7374 2062 6520 6772 6561 7465  . Must be greate
-00009e20: 7220 7468 616e 2030 2e20 4465 6661 756c  r than 0. Defaul
-00009e30: 7420 6973 2030 2e31 2e0a 2020 2020 6e75  t is 0.1..    nu
-00009e40: 6d62 6572 5f6f 665f 6275 696c 6469 6e67  mber_of_building
-00009e50: 7320 3a20 696e 740a 2020 2020 2020 2020  s : int.        
-00009e60: 4e75 6d62 6572 206f 6620 6275 696c 6469  Number of buildi
-00009e70: 6e67 7320 5b2d 5d2e 2044 6566 6175 6c74  ngs [-]. Default
-00009e80: 2069 7320 302e 204e 6f74 2063 7572 7265   is 0. Not curre
-00009e90: 6e74 6c79 2075 7365 6420 696e 2051 5549  ntly used in QUI
-00009ea0: 432d 4669 7265 2e0a 2020 2020 6e75 6d62  C-Fire..    numb
-00009eb0: 6572 5f6f 665f 706f 6c79 676f 6e5f 6e6f  er_of_polygon_no
-00009ec0: 6465 7320 3a20 696e 740a 2020 2020 2020  des : int.      
-00009ed0: 2020 4e75 6d62 6572 206f 6620 706f 6c79    Number of poly
-00009ee0: 676f 6e20 6275 696c 6469 6e67 206e 6f64  gon building nod
-00009ef0: 6573 205b 2d5d 2e20 4465 6661 756c 7420  es [-]. Default 
-00009f00: 6973 2030 2e20 4e6f 7420 6375 7272 656e  is 0. Not curren
-00009f10: 746c 7920 7573 6564 0a20 2020 2020 2020  tly used.       
-00009f20: 2069 6e20 5155 4943 2d46 6972 652e 0a20   in QUIC-Fire.. 
-00009f30: 2020 2022 2222 0a0a 2020 2020 6e61 6d65     """..    name
-00009f40: 3a20 7374 7220 3d20 4669 656c 6428 2251  : str = Field("Q
-00009f50: 555f 6275 696c 6469 6e67 7322 2c20 6672  U_buildings", fr
-00009f60: 6f7a 656e 3d54 7275 6529 0a20 2020 205f  ozen=True).    _
-00009f70: 6578 7465 6e73 696f 6e3a 2073 7472 203d  extension: str =
-00009f80: 2022 2e69 6e70 220a 2020 2020 7761 6c6c   ".inp".    wall
-00009f90: 5f72 6f75 6768 6e65 7373 5f6c 656e 6774  _roughness_lengt
-00009fa0: 683a 2050 6f73 6974 6976 6546 6c6f 6174  h: PositiveFloat
-00009fb0: 203d 2030 2e31 0a20 2020 206e 756d 6265   = 0.1.    numbe
-00009fc0: 725f 6f66 5f62 7569 6c64 696e 6773 3a20  r_of_buildings: 
-00009fd0: 4e6f 6e4e 6567 6174 6976 6549 6e74 203d  NonNegativeInt =
-00009fe0: 2030 0a20 2020 206e 756d 6265 725f 6f66   0.    number_of
-00009ff0: 5f70 6f6c 7967 6f6e 5f6e 6f64 6573 3a20  _polygon_nodes: 
-0000a000: 4e6f 6e4e 6567 6174 6976 6549 6e74 203d  NonNegativeInt =
-0000a010: 2030 0a0a 2020 2020 4063 6c61 7373 6d65   0..    @classme
-0000a020: 7468 6f64 0a20 2020 2064 6566 2066 726f  thod.    def fro
-0000a030: 6d5f 6669 6c65 2863 6c73 2c20 6469 7265  m_file(cls, dire
-0000a040: 6374 6f72 793a 2073 7472 207c 2050 6174  ctory: str | Pat
-0000a050: 682c 202a 2a6b 7761 7267 7329 3a0a 2020  h, **kwargs):.  
-0000a060: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0000a070: 2020 496e 6974 6961 6c69 7a65 7320 6120    Initializes a 
-0000a080: 5155 5f42 7569 6c64 696e 6773 206f 626a  QU_Buildings obj
-0000a090: 6563 7420 6672 6f6d 2061 2064 6972 6563  ect from a direc
-0000a0a0: 746f 7279 2063 6f6e 7461 696e 696e 6720  tory containing 
-0000a0b0: 610a 2020 2020 2020 2020 5155 5f62 7569  a.        QU_bui
-0000a0c0: 6c64 696e 6773 2e69 6e70 2066 696c 652e  ldings.inp file.
-0000a0d0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0000a0e0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-0000a0f0: 6365 2864 6972 6563 746f 7279 2c20 7374  ce(directory, st
-0000a100: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
-0000a110: 6469 7265 6374 6f72 7920 3d20 5061 7468  directory = Path
-0000a120: 2864 6972 6563 746f 7279 290a 2020 2020  (directory).    
-0000a130: 2020 2020 7769 7468 206f 7065 6e28 6469      with open(di
-0000a140: 7265 6374 6f72 7920 2f20 2251 555f 6275  rectory / "QU_bu
-0000a150: 696c 6469 6e67 732e 696e 7022 2c20 2272  ildings.inp", "r
-0000a160: 2229 2061 7320 663a 0a20 2020 2020 2020  ") as f:.       
-0000a170: 2020 2020 206c 696e 6573 203d 2066 2e72       lines = f.r
-0000a180: 6561 646c 696e 6573 2829 0a20 2020 2020  eadlines().     
-0000a190: 2020 2072 6574 7572 6e20 636c 7328 0a20     return cls(. 
-0000a1a0: 2020 2020 2020 2020 2020 2077 616c 6c5f             wall_
-0000a1b0: 726f 7567 686e 6573 735f 6c65 6e67 7468  roughness_length
-0000a1c0: 3d66 6c6f 6174 286c 696e 6573 5b31 5d2e  =float(lines[1].
-0000a1d0: 7370 6c69 7428 295b 305d 292c 0a20 2020  split()[0]),.   
-0000a1e0: 2020 2020 2020 2020 206e 756d 6265 725f           number_
-0000a1f0: 6f66 5f62 7569 6c64 696e 6773 3d69 6e74  of_buildings=int
-0000a200: 286c 696e 6573 5b32 5d2e 7370 6c69 7428  (lines[2].split(
-0000a210: 295b 305d 292c 0a20 2020 2020 2020 2020  )[0]),.         
-0000a220: 2020 206e 756d 6265 725f 6f66 5f70 6f6c     number_of_pol
-0000a230: 7967 6f6e 5f6e 6f64 6573 3d69 6e74 286c  ygon_nodes=int(l
-0000a240: 696e 6573 5b33 5d2e 7370 6c69 7428 295b  ines[3].split()[
-0000a250: 305d 292c 0a20 2020 2020 2020 2029 0a0a  0]),.        )..
-0000a260: 0a63 6c61 7373 2051 555f 4669 6c65 6f70  .class QU_Fileop
-0000a270: 7469 6f6e 7328 496e 7075 7446 696c 6529  tions(InputFile)
-0000a280: 3a0a 2020 2020 2222 220a 2020 2020 436c  :.    """.    Cl
-0000a290: 6173 7320 7265 7072 6573 656e 7469 6e67  ass representing
-0000a2a0: 2074 6865 2051 555f 6669 6c65 6f70 7469   the QU_fileopti
-0000a2b0: 6f6e 732e 696e 7020 6669 6c65 2e20 5468  ons.inp file. Th
-0000a2c0: 6973 2066 696c 6520 636f 6e74 6169 6e73  is file contains
-0000a2d0: 0a20 2020 2066 696c 6520 6f75 7470 7574  .    file output
-0000a2e0: 2d72 656c 6174 6564 206f 7074 696f 6e73  -related options
-0000a2f0: 2066 6f72 2074 6865 2051 5549 432d 4669   for the QUIC-Fi
-0000a300: 7265 2073 696d 756c 6174 696f 6e2e 0a0a  re simulation...
-0000a310: 2020 2020 4174 7472 6962 7574 6573 0a20      Attributes. 
-0000a320: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
-0000a330: 2020 6f75 7470 7574 5f64 6174 615f 6669    output_data_fi
-0000a340: 6c65 5f66 6f72 6d61 745f 666c 6167 203a  le_format_flag :
-0000a350: 2069 6e74 0a20 2020 2020 2020 204f 7574   int.        Out
-0000a360: 7075 7420 6461 7461 2066 696c 6520 666f  put data file fo
-0000a370: 726d 6174 2066 6c61 672e 2056 616c 7565  rmat flag. Value
-0000a380: 7320 6163 6365 7074 6564 2061 7265 205b  s accepted are [
-0000a390: 312c 2032 2c20 335d 2e0a 2020 2020 2020  1, 2, 3]..      
-0000a3a0: 2020 5265 636f 6d6d 656e 6465 6420 7661    Recommended va
-0000a3b0: 6c75 6520 322e 2031 202d 2062 696e 6172  lue 2. 1 - binar
-0000a3c0: 792c 2032 202d 2041 5343 4949 2c20 3320  y, 2 - ASCII, 3 
-0000a3d0: 2d20 626f 7468 2e0a 2020 2020 6e6f 6e5f  - both..    non_
-0000a3e0: 6d61 7373 5f63 6f6e 7365 7276 6564 5f69  mass_conserved_i
-0000a3f0: 6e69 7469 616c 5f66 6965 6c64 5f66 6c61  nitial_field_fla
-0000a400: 6720 3a20 696e 740a 2020 2020 2020 2020  g : int.        
-0000a410: 466c 6167 2074 6f20 7772 6974 6520 6f75  Flag to write ou
-0000a420: 7420 6e6f 6e2d 6d61 7373 2063 6f6e 7365  t non-mass conse
-0000a430: 7276 6564 2069 6e69 7469 616c 2066 6965  rved initial fie
-0000a440: 6c64 2066 696c 6520 756f 6669 656c 642e  ld file uofield.
-0000a450: 6461 742e 0a20 2020 2020 2020 2056 616c  dat..        Val
-0000a460: 7565 7320 6163 6365 7074 6564 2061 7265  ues accepted are
-0000a470: 205b 302c 2031 5d2e 2052 6563 6f6d 6d65   [0, 1]. Recomme
-0000a480: 6e64 6564 2076 616c 7565 2030 2e20 3020  nded value 0. 0 
-0000a490: 2d20 6f66 662c 2031 202d 206f 6e2e 0a20  - off, 1 - on.. 
-0000a4a0: 2020 2069 6e69 7469 616c 5f73 656e 736f     initial_senso
-0000a4b0: 725f 7665 6c6f 6369 7479 5f66 6965 6c64  r_velocity_field
-0000a4c0: 5f66 6c61 6720 3a20 696e 740a 2020 2020  _flag : int.    
-0000a4d0: 2020 2020 466c 6167 2074 6f20 7772 6974      Flag to writ
-0000a4e0: 6520 6f75 7420 7468 6520 6669 6c65 2075  e out the file u
-0000a4f0: 6f73 656e 736f 7266 6965 6c64 2e64 6174  osensorfield.dat
-0000a500: 2e20 5661 6c75 6573 2061 6363 6570 7465  . Values accepte
-0000a510: 6420 6172 650a 2020 2020 2020 2020 5b30  d are.        [0
-0000a520: 2c20 315d 2e20 5265 636f 6d6d 656e 6465  , 1]. Recommende
-0000a530: 6420 7661 6c75 6520 302e 2030 202d 206f  d value 0. 0 - o
-0000a540: 6666 2c20 3120 2d20 6f6e 2e0a 2020 2020  ff, 1 - on..    
-0000a550: 7175 5f73 7461 6767 6572 6564 5f76 656c  qu_staggered_vel
-0000a560: 6f63 6974 795f 6669 6c65 5f66 6c61 6720  ocity_file_flag 
-0000a570: 3a20 696e 740a 2020 2020 2020 2020 466c  : int.        Fl
-0000a580: 6167 2074 6f20 7772 6974 6520 6f75 7420  ag to write out 
-0000a590: 7468 6520 6669 6c65 2051 555f 7374 6167  the file QU_stag
-0000a5a0: 6765 7265 645f 7665 6c6f 6369 7479 2e62  gered_velocity.b
-0000a5b0: 696e 2e20 5661 6c75 6573 2061 6363 6570  in. Values accep
-0000a5c0: 7465 640a 2020 2020 2020 2020 6172 6520  ted.        are 
-0000a5d0: 5b30 2c20 315d 2e20 5265 636f 6d6d 656e  [0, 1]. Recommen
-0000a5e0: 6465 6420 7661 6c75 6520 302e 2030 202d  ded value 0. 0 -
-0000a5f0: 206f 6666 2c20 3120 2d20 6f6e 2e0a 2020   off, 1 - on..  
-0000a600: 2020 6765 6e65 7261 7465 5f77 696e 645f    generate_wind_
-0000a610: 7374 6172 7475 705f 6669 6c65 735f 666c  startup_files_fl
-0000a620: 6167 203a 2069 6e74 0a20 2020 2020 2020  ag : int.       
-0000a630: 2047 656e 6572 6174 6520 7769 6e64 2073   Generate wind s
-0000a640: 7461 7274 7570 2066 696c 6573 2066 6f72  tartup files for
-0000a650: 2065 6e73 656d 626c 6520 7369 6d75 6c61   ensemble simula
-0000a660: 7469 6f6e 732e 2056 616c 7565 7320 6163  tions. Values ac
-0000a670: 6365 7074 6564 0a20 2020 2020 2020 2061  cepted.        a
-0000a680: 7265 205b 302c 2031 5d2e 2052 6563 6f6d  re [0, 1]. Recom
-0000a690: 6d65 6e64 6564 2076 616c 7565 2030 2e20  mended value 0. 
-0000a6a0: 3020 2d20 6f66 662c 2031 202d 206f 6e2e  0 - off, 1 - on.
-0000a6b0: 0a20 2020 2022 2222 0a0a 2020 2020 6e61  .    """..    na
-0000a6c0: 6d65 3a20 7374 7220 3d20 4669 656c 6428  me: str = Field(
-0000a6d0: 2251 555f 6669 6c65 6f70 7469 6f6e 7322  "QU_fileoptions"
-0000a6e0: 2c20 6672 6f7a 656e 3d54 7275 6529 0a20  , frozen=True). 
-0000a6f0: 2020 205f 6578 7465 6e73 696f 6e3a 2073     _extension: s
-0000a700: 7472 203d 2022 2e69 6e70 220a 2020 2020  tr = ".inp".    
-0000a710: 6f75 7470 7574 5f64 6174 615f 6669 6c65  output_data_file
-0000a720: 5f66 6f72 6d61 745f 666c 6167 3a20 4c69  _format_flag: Li
-0000a730: 7465 7261 6c5b 312c 2032 2c20 335d 203d  teral[1, 2, 3] =
-0000a740: 2032 0a20 2020 206e 6f6e 5f6d 6173 735f   2.    non_mass_
-0000a750: 636f 6e73 6572 7665 645f 696e 6974 6961  conserved_initia
-0000a760: 6c5f 6669 656c 645f 666c 6167 3a20 4c69  l_field_flag: Li
-0000a770: 7465 7261 6c5b 302c 2031 5d20 3d20 300a  teral[0, 1] = 0.
-0000a780: 2020 2020 696e 6974 6961 6c5f 7365 6e73      initial_sens
-0000a790: 6f72 5f76 656c 6f63 6974 795f 6669 656c  or_velocity_fiel
-0000a7a0: 645f 666c 6167 3a20 4c69 7465 7261 6c5b  d_flag: Literal[
-0000a7b0: 302c 2031 5d20 3d20 300a 2020 2020 7175  0, 1] = 0.    qu
-0000a7c0: 5f73 7461 6767 6572 6564 5f76 656c 6f63  _staggered_veloc
-0000a7d0: 6974 795f 6669 6c65 5f66 6c61 673a 204c  ity_file_flag: L
-0000a7e0: 6974 6572 616c 5b30 2c20 315d 203d 2030  iteral[0, 1] = 0
-0000a7f0: 0a20 2020 2067 656e 6572 6174 655f 7769  .    generate_wi
-0000a800: 6e64 5f73 7461 7274 7570 5f66 696c 6573  nd_startup_files
-0000a810: 5f66 6c61 673a 204c 6974 6572 616c 5b30  _flag: Literal[0
-0000a820: 2c20 315d 203d 2030 0a0a 2020 2020 4063  , 1] = 0..    @c
-0000a830: 6c61 7373 6d65 7468 6f64 0a20 2020 2064  lassmethod.    d
-0000a840: 6566 2066 726f 6d5f 6669 6c65 2863 6c73  ef from_file(cls
-0000a850: 2c20 6469 7265 6374 6f72 793a 2073 7472  , directory: str
-0000a860: 207c 2050 6174 682c 202a 2a6b 7761 7267   | Path, **kwarg
-0000a870: 7329 3a0a 2020 2020 2020 2020 2222 220a  s):.        """.
-0000a880: 2020 2020 2020 2020 496e 6974 6961 6c69          Initiali
-0000a890: 7a65 7320 6120 5155 5f46 696c 656f 7074  zes a QU_Fileopt
-0000a8a0: 696f 6e73 206f 626a 6563 7420 6672 6f6d  ions object from
-0000a8b0: 2061 2064 6972 6563 746f 7279 2063 6f6e   a directory con
-0000a8c0: 7461 696e 696e 6720 610a 2020 2020 2020  taining a.      
-0000a8d0: 2020 5155 5f66 696c 656f 7074 696f 6e73    QU_fileoptions
-0000a8e0: 2e69 6e70 2066 696c 652e 0a20 2020 2020  .inp file..     
-0000a8f0: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
-0000a900: 6620 6973 696e 7374 616e 6365 2864 6972  f isinstance(dir
-0000a910: 6563 746f 7279 2c20 7374 7229 3a0a 2020  ectory, str):.  
-0000a920: 2020 2020 2020 2020 2020 6469 7265 6374            direct
-0000a930: 6f72 7920 3d20 5061 7468 2864 6972 6563  ory = Path(direc
-0000a940: 746f 7279 290a 2020 2020 2020 2020 7769  tory).        wi
-0000a950: 7468 206f 7065 6e28 6469 7265 6374 6f72  th open(director
-0000a960: 7920 2f20 2251 555f 6669 6c65 6f70 7469  y / "QU_fileopti
-0000a970: 6f6e 732e 696e 7022 2c20 2272 2229 2061  ons.inp", "r") a
-0000a980: 7320 663a 0a20 2020 2020 2020 2020 2020  s f:.           
-0000a990: 206c 696e 6573 203d 2066 2e72 6561 646c   lines = f.readl
-0000a9a0: 696e 6573 2829 0a20 2020 2020 2020 2072  ines().        r
-0000a9b0: 6574 7572 6e20 636c 7328 0a20 2020 2020  eturn cls(.     
-0000a9c0: 2020 2020 2020 206f 7574 7075 745f 6461         output_da
-0000a9d0: 7461 5f66 696c 655f 666f 726d 6174 5f66  ta_file_format_f
-0000a9e0: 6c61 673d 696e 7428 6c69 6e65 735b 315d  lag=int(lines[1]
-0000a9f0: 2e73 706c 6974 2829 5b30 5d29 2c0a 2020  .split()[0]),.  
-0000aa00: 2020 2020 2020 2020 2020 6e6f 6e5f 6d61            non_ma
-0000aa10: 7373 5f63 6f6e 7365 7276 6564 5f69 6e69  ss_conserved_ini
-0000aa20: 7469 616c 5f66 6965 6c64 5f66 6c61 673d  tial_field_flag=
-0000aa30: 696e 7428 6c69 6e65 735b 325d 2e73 706c  int(lines[2].spl
-0000aa40: 6974 2829 5b30 5d29 2c0a 2020 2020 2020  it()[0]),.      
-0000aa50: 2020 2020 2020 696e 6974 6961 6c5f 7365        initial_se
-0000aa60: 6e73 6f72 5f76 656c 6f63 6974 795f 6669  nsor_velocity_fi
-0000aa70: 656c 645f 666c 6167 3d69 6e74 286c 696e  eld_flag=int(lin
-0000aa80: 6573 5b33 5d2e 7370 6c69 7428 295b 305d  es[3].split()[0]
-0000aa90: 292c 0a20 2020 2020 2020 2020 2020 2071  ),.            q
-0000aaa0: 755f 7374 6167 6765 7265 645f 7665 6c6f  u_staggered_velo
-0000aab0: 6369 7479 5f66 696c 655f 666c 6167 3d69  city_file_flag=i
-0000aac0: 6e74 286c 696e 6573 5b34 5d2e 7370 6c69  nt(lines[4].spli
-0000aad0: 7428 295b 305d 292c 0a20 2020 2020 2020  t()[0]),.       
-0000aae0: 2020 2020 2067 656e 6572 6174 655f 7769       generate_wi
-0000aaf0: 6e64 5f73 7461 7274 7570 5f66 696c 6573  nd_startup_files
-0000ab00: 5f66 6c61 673d 696e 7428 6c69 6e65 735b  _flag=int(lines[
-0000ab10: 355d 2e73 706c 6974 2829 5b30 5d29 2c0a  5].split()[0]),.
-0000ab20: 2020 2020 2020 2020 290a 0a0a 636c 6173          )...clas
-0000ab30: 7320 5155 5f53 696d 7061 7261 6d73 2849  s QU_Simparams(I
-0000ab40: 6e70 7574 4669 6c65 293a 0a20 2020 2022  nputFile):.    "
-0000ab50: 2222 0a20 2020 2043 6c61 7373 2072 6570  "".    Class rep
-0000ab60: 7265 7365 6e74 696e 6720 7468 6520 5155  resenting the QU
-0000ab70: 5f73 696d 7061 7261 6d73 2e69 6e70 2066  _simparams.inp f
-0000ab80: 696c 652e 2054 6869 7320 6669 6c65 2063  ile. This file c
-0000ab90: 6f6e 7461 696e 7320 7468 650a 2020 2020  ontains the.    
-0000aba0: 7369 6d75 6c61 7469 6f6e 2070 6172 616d  simulation param
-0000abb0: 6574 6572 7320 666f 7220 7468 6520 5155  eters for the QU
-0000abc0: 4943 2d46 6972 6520 7369 6d75 6c61 7469  IC-Fire simulati
-0000abd0: 6f6e 2e0a 0a20 2020 2041 7474 7269 6275  on...    Attribu
-0000abe0: 7465 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  tes.    --------
-0000abf0: 2d2d 0a20 2020 206e 7820 3a20 696e 740a  --.    nx : int.
-0000ac00: 2020 2020 2020 2020 4e75 6d62 6572 206f          Number o
-0000ac10: 6620 6365 6c6c 7320 696e 2074 6865 2078  f cells in the x
-0000ac20: 2d64 6972 6563 7469 6f6e 205b 2d5d 2e20  -direction [-]. 
-0000ac30: 5265 636f 6d6d 656e 6465 6420 7661 6c75  Recommended valu
-0000ac40: 653a 203e 2031 3030 0a20 2020 206e 7920  e: > 100.    ny 
-0000ac50: 3a20 696e 740a 2020 2020 2020 2020 4e75  : int.        Nu
-0000ac60: 6d62 6572 206f 6620 6365 6c6c 7320 696e  mber of cells in
-0000ac70: 2074 6865 2079 2d64 6972 6563 7469 6f6e   the y-direction
-0000ac80: 205b 2d5d 2e20 5265 636f 6d6d 656e 6465   [-]. Recommende
-0000ac90: 6420 7661 6c75 653a 203e 2031 3030 0a20  d value: > 100. 
-0000aca0: 2020 206e 7a20 3a20 696e 740a 2020 2020     nz : int.    
-0000acb0: 2020 2020 4e75 6d62 6572 206f 6620 6365      Number of ce
-0000acc0: 6c6c 7320 696e 2074 6865 207a 2d64 6972  lls in the z-dir
-0000acd0: 6563 7469 6f6e 205b 2d5d 2e0a 2020 2020  ection [-]..    
-0000ace0: 6478 203a 2066 6c6f 6174 0a20 2020 2020  dx : float.     
-0000acf0: 2020 2043 656c 6c20 7369 7a65 2069 6e20     Cell size in 
-0000ad00: 7468 6520 782d 6469 7265 6374 696f 6e20  the x-direction 
-0000ad10: 5b6d 5d2e 2052 6563 6f6d 6d65 6e64 6564  [m]. Recommended
-0000ad20: 2076 616c 7565 3a20 3220 6d0a 2020 2020   value: 2 m.    
-0000ad30: 6479 203a 2066 6c6f 6174 0a20 2020 2020  dy : float.     
-0000ad40: 2020 2043 656c 6c20 7369 7a65 2069 6e20     Cell size in 
-0000ad50: 7468 6520 792d 6469 7265 6374 696f 6e20  the y-direction 
-0000ad60: 5b6d 5d2e 2052 6563 6f6d 6d65 6e64 6564  [m]. Recommended
-0000ad70: 2076 616c 7565 3a20 3220 6d0a 2020 2020   value: 2 m.    
-0000ad80: 7175 6963 5f64 6f6d 6169 6e5f 6865 6967  quic_domain_heig
-0000ad90: 6874 203a 2066 6c6f 6174 0a20 2020 2020  ht : float.     
-0000ada0: 2020 2051 5549 4320 646f 6d61 696e 2068     QUIC domain h
-0000adb0: 6569 6768 7420 5b6d 5d2e 2052 6563 6f6d  eight [m]. Recom
-0000adc0: 6d65 6e64 6564 2076 616c 7565 3a20 3330  mended value: 30
-0000add0: 3020 6d0a 2020 2020 7375 7266 6163 655f  0 m.    surface_
-0000ade0: 7665 7274 6963 616c 5f63 656c 6c5f 7369  vertical_cell_si
-0000adf0: 7a65 203a 2066 6c6f 6174 0a20 2020 2020  ze : float.     
-0000ae00: 2020 2053 7572 6661 6365 2076 6572 7469     Surface verti
-0000ae10: 6361 6c20 6365 6c6c 2073 697a 6520 5b6d  cal cell size [m
-0000ae20: 5d2e 0a20 2020 206e 756d 6265 725f 7375  ]..    number_su
-0000ae30: 7266 6163 655f 6365 6c6c 7320 3a20 696e  rface_cells : in
-0000ae40: 740a 2020 2020 2020 2020 4e75 6d62 6572  t.        Number
-0000ae50: 206f 6620 756e 6966 6f72 6d20 7375 7266   of uniform surf
-0000ae60: 6163 6520 6365 6c6c 7320 5b2d 5d2e 0a20  ace cells [-].. 
-0000ae70: 2020 2073 7472 6574 6368 5f67 7269 645f     stretch_grid_
-0000ae80: 666c 6167 203a 2069 6e74 0a20 2020 2020  flag : int.     
-0000ae90: 2020 2056 6572 7469 6361 6c20 6772 6964     Vertical grid
-0000aea0: 2073 7472 6574 6368 696e 6720 666c 6167   stretching flag
-0000aeb0: 2c20 7661 6c75 6573 2061 6363 6570 7465  , values accepte
-0000aec0: 6420 5b30 2c20 312c 2033 5d2e 2044 6566  d [0, 1, 3]. Def
-0000aed0: 6175 6c74 2069 7320 332e 0a20 2020 2020  ault is 3..     
-0000aee0: 2020 2030 202d 2075 6e69 666f 726d 2c20     0 - uniform, 
-0000aef0: 3120 2d20 6375 7374 6f6d 2c20 3320 2d20  1 - custom, 3 - 
-0000af00: 7061 7261 626f 6c69 632e 2049 6620 7374  parabolic. If st
-0000af10: 7265 7463 685f 6772 6964 5f66 6c61 6720  retch_grid_flag 
-0000af20: 6973 2030 206f 7220 330a 2020 2020 2020  is 0 or 3.      
-0000af30: 2020 647a 5f61 7272 6179 2069 7320 636f    dz_array is co
-0000af40: 6d70 7574 6564 2066 726f 6d20 6e7a 2c20  mputed from nz, 
-0000af50: 7375 7266 6163 655f 7665 7274 6963 616c  surface_vertical
-0000af60: 5f63 656c 6c5f 7369 7a65 2c20 616e 640a  _cell_size, and.
-0000af70: 2020 2020 2020 2020 6e75 6d62 6572 5f73          number_s
-0000af80: 7572 6661 6365 5f63 656c 6c73 2e20 4966  urface_cells. If
-0000af90: 2073 7472 6574 6368 5f67 7269 645f 666c   stretch_grid_fl
-0000afa0: 6167 2069 7320 312c 2063 7573 746f 6d5f  ag is 1, custom_
-0000afb0: 647a 5f61 7272 6179 206d 7573 740a 2020  dz_array must.  
-0000afc0: 2020 2020 2020 6265 2070 726f 7669 6465        be provide
-0000afd0: 642e 0a20 2020 2063 7573 746f 6d5f 647a  d..    custom_dz
-0000afe0: 5f61 7272 6179 203a 206c 6973 745b 666c  _array : list[fl
-0000aff0: 6f61 745d 0a20 2020 2020 2020 2056 6572  oat].        Ver
-0000b000: 7469 6361 6c20 6772 6964 2073 7061 6369  tical grid spaci
-0000b010: 6e67 2061 7272 6179 205b 6d5d 2e20 4d75  ng array [m]. Mu
-0000b020: 7374 2062 6520 7072 6f76 6964 6564 2069  st be provided i
-0000b030: 6620 7374 7265 7463 685f 6772 6964 5f66  f stretch_grid_f
-0000b040: 6c61 670a 2020 2020 2020 2020 6973 2031  lag.        is 1
-0000b050: 2e20 4966 2073 7472 6574 6368 5f67 7269  . If stretch_gri
-0000b060: 645f 666c 6167 2069 7320 3020 6f72 2033  d_flag is 0 or 3
-0000b070: 2c20 647a 5f61 7272 6179 2069 7320 636f  , dz_array is co
-0000b080: 6d70 7574 6564 2066 726f 6d20 6e7a 2c0a  mputed from nz,.
-0000b090: 2020 2020 2020 2020 7375 7266 6163 655f          surface_
-0000b0a0: 7665 7274 6963 616c 5f63 656c 6c5f 7369  vertical_cell_si
-0000b0b0: 7a65 2c20 616e 6420 6e75 6d62 6572 5f73  ze, and number_s
-0000b0c0: 7572 6661 6365 5f63 656c 6c73 2e0a 2020  urface_cells..  
-0000b0d0: 2020 7574 635f 6f66 6673 6574 203a 2069    utc_offset : i
-0000b0e0: 6e74 0a20 2020 2020 2020 2048 6f75 7273  nt.        Hours
-0000b0f0: 2064 6966 6665 7265 6e63 6520 6672 6f6d   difference from
-0000b100: 2055 5443 2028 616b 6120 5554 4d29 205b   UTC (aka UTM) [
-0000b110: 685d 0a20 2020 2077 696e 645f 7469 6d65  h].    wind_time
-0000b120: 7320 3a20 6c69 7374 5b69 6e74 5d0a 2020  s : list[int].  
-0000b130: 2020 2020 2020 4c69 7374 206f 6620 7469        List of ti
-0000b140: 6d65 7320 6174 2077 6869 6368 2074 6865  mes at which the
-0000b150: 2077 696e 6473 2061 7265 2061 7661 696c   winds are avail
-0000b160: 6162 6c65 2069 6e20 556e 6978 2045 706f  able in Unix Epo
-0000b170: 6368 2074 696d 650a 2020 2020 2020 2020  ch time.        
-0000b180: 2869 6e74 6567 6572 2073 6563 6f6e 6473  (integer seconds
-0000b190: 2073 696e 6365 2031 3937 302f 312f 3120   since 1970/1/1 
-0000b1a0: 3030 3a30 303a 3030 292e 2054 6865 7365  00:00:00). These
-0000b1b0: 2061 7265 2055 5443 2074 696d 6573 2e0a   are UTC times..
-0000b1c0: 2020 2020 2020 2020 4465 6661 756c 7473          Defaults
-0000b1d0: 2074 6f20 5b69 6e74 2874 696d 652e 7469   to [int(time.ti
-0000b1e0: 6d65 2829 295d 2069 6620 6e6f 7420 7072  me())] if not pr
-0000b1f0: 6f76 6964 6564 2e0a 2020 2020 736f 725f  ovided..    sor_
-0000b200: 6974 6572 5f6d 6178 203a 2069 6e74 0a20  iter_max : int. 
-0000b210: 2020 2020 2020 204d 6178 696d 756d 206e         Maximum n
-0000b220: 756d 6265 7220 6f66 2069 7465 7261 7469  umber of iterati
-0000b230: 6f6e 7320 6f66 2074 6865 2053 4f52 2077  ons of the SOR w
-0000b240: 696e 6420 736f 6c76 6572 2e20 5265 636f  ind solver. Reco
-0000b250: 6d6d 656e 6465 6420 7661 6c75 653a 0a20  mmended value:. 
-0000b260: 2020 2020 2020 2031 302e 2044 6566 6175         10. Defau
-0000b270: 6c74 2069 7320 3130 2e0a 2020 2020 736f  lt is 10..    so
-0000b280: 725f 7265 7369 6475 616c 5f72 6564 7563  r_residual_reduc
-0000b290: 7469 6f6e 203a 2069 6e74 0a20 2020 2020  tion : int.     
-0000b2a0: 2020 2052 6573 6964 7561 6c20 7265 6475     Residual redu
-0000b2b0: 6374 696f 6e20 746f 2061 7373 6573 7320  ction to assess 
-0000b2c0: 636f 6e76 6572 6765 6e63 6520 6f66 2074  convergence of t
-0000b2d0: 6865 2053 4f52 2073 6f6c 7665 7220 286f  he SOR solver (o
-0000b2e0: 7264 6572 7320 6f66 0a20 2020 2020 2020  rders of.       
-0000b2f0: 206d 6167 6e69 7475 6465 292e 2052 6563   magnitude). Rec
-0000b300: 6f6d 6d65 6e64 6564 2076 616c 7565 3a20  ommended value: 
-0000b310: 332e 2044 6566 6175 6c74 2069 7320 332e  3. Default is 3.
-0000b320: 0a20 2020 2075 7365 5f64 6966 6675 7369  .    use_diffusi
-0000b330: 6f6e 5f66 6c61 6720 3a20 696e 740a 2020  on_flag : int.  
-0000b340: 2020 2020 2020 5573 6520 6469 6666 7573        Use diffus
-0000b350: 696f 6e20 616c 676f 7269 7468 6d3a 2030  ion algorithm: 0
-0000b360: 203d 206f 6666 2c20 3120 3d20 6f6e 2e20   = off, 1 = on. 
-0000b370: 5265 636f 6d6d 656e 6465 6420 7661 6c75  Recommended valu
-0000b380: 653a 2030 2e0a 2020 2020 2020 2020 4465  e: 0..        De
-0000b390: 6661 756c 7420 6973 2030 2e0a 2020 2020  fault is 0..    
-0000b3a0: 6e75 6d62 6572 5f64 6966 6675 7369 6f6e  number_diffusion
-0000b3b0: 5f69 7465 7261 7469 6f6e 7320 3a20 696e  _iterations : in
-0000b3c0: 740a 2020 2020 2020 2020 4e75 6d62 6572  t.        Number
-0000b3d0: 206f 6620 6469 6666 7573 696f 6e20 6974   of diffusion it
-0000b3e0: 6572 6174 696f 6e73 2e20 5265 636f 6d6d  erations. Recomm
-0000b3f0: 656e 6465 6420 7661 6c75 653a 2031 302e  ended value: 10.
-0000b400: 2044 6566 6175 6c74 2069 7320 3130 2e0a   Default is 10..
-0000b410: 2020 2020 646f 6d61 696e 5f72 6f74 6174      domain_rotat
-0000b420: 696f 6e20 3a20 666c 6f61 740a 2020 2020  ion : float.    
-0000b430: 2020 2020 446f 6d61 696e 2072 6f74 6174      Domain rotat
-0000b440: 696f 6e20 7265 6c61 7469 7665 2074 6f20  ion relative to 
-0000b450: 7472 7565 206e 6f72 7468 2028 636c 6f63  true north (cloc
-0000b460: 6b77 6973 6520 6973 2070 6f73 6974 6976  kwise is positiv
-0000b470: 6529 0a20 2020 2020 2020 205b 6465 6772  e).        [degr
-0000b480: 6565 735d 2e20 5265 636f 6d6d 656e 6465  ees]. Recommende
-0000b490: 6420 7661 6c75 653a 2030 2064 6567 2e20  d value: 0 deg. 
-0000b4a0: 4465 6661 756c 7420 6973 2030 2e0a 2020  Default is 0..  
-0000b4b0: 2020 7574 6d5f 7820 3a20 666c 6f61 740a    utm_x : float.
-0000b4c0: 2020 2020 2020 2020 5554 4d2d 7820 636f          UTM-x co
-0000b4d0: 6f72 6469 6e61 7465 7320 6f66 2074 6865  ordinates of the
-0000b4e0: 2073 6f75 7468 2d77 6573 7420 636f 726e   south-west corn
-0000b4f0: 6572 206f 6620 646f 6d61 696e 205b 6d5d  er of domain [m]
-0000b500: 2e20 4465 6661 756c 7420 6973 2030 2e0a  . Default is 0..
-0000b510: 2020 2020 7574 6d5f 7920 3a20 666c 6f61      utm_y : floa
-0000b520: 740a 2020 2020 2020 2020 5554 4d2d 7920  t.        UTM-y 
-0000b530: 636f 6f72 6469 6e61 7465 7320 6f66 2074  coordinates of t
-0000b540: 6865 2073 6f75 7468 2d77 6573 7420 636f  he south-west co
-0000b550: 726e 6572 206f 6620 646f 6d61 696e 205b  rner of domain [
-0000b560: 6d5d 2e20 4465 6661 756c 7420 6973 2030  m]. Default is 0
-0000b570: 2e0a 2020 2020 7574 6d5f 7a6f 6e65 5f6e  ..    utm_zone_n
-0000b580: 756d 6265 7220 3a20 696e 740a 2020 2020  umber : int.    
-0000b590: 2020 2020 5554 4d20 7a6f 6e65 206e 756d      UTM zone num
-0000b5a0: 6265 7220 5b2d 5d2e 2044 6566 6175 6c74  ber [-]. Default
-0000b5b0: 2069 7320 312e 0a20 2020 2075 746d 5f7a   is 1..    utm_z
-0000b5c0: 6f6e 655f 6c65 7474 6572 203a 2069 6e74  one_letter : int
-0000b5d0: 0a20 2020 2020 2020 2055 544d 207a 6f6e  .        UTM zon
-0000b5e0: 6520 6c65 7474 6572 2028 413d 312c 2042  e letter (A=1, B
-0000b5f0: 3d32 2c20 2e2e 2e29 205b 2d5d 2e20 4465  =2, ...) [-]. De
-0000b600: 6661 756c 7420 6973 2031 2e0a 2020 2020  fault is 1..    
-0000b610: 7175 6963 5f63 6664 5f66 6c61 6720 3a20  quic_cfd_flag : 
-0000b620: 696e 740a 2020 2020 2020 2020 5155 4943  int.        QUIC
-0000b630: 2d43 4644 2066 6c61 673a 2030 203d 206f  -CFD flag: 0 = o
-0000b640: 6666 2c20 3120 3d20 6f6e 2e20 5265 636f  ff, 1 = on. Reco
-0000b650: 6d6d 656e 6465 6420 7661 6c75 653a 2030  mmended value: 0
-0000b660: 2e20 4465 6661 756c 7420 6973 2030 2e0a  . Default is 0..
-0000b670: 2020 2020 6578 706c 6f73 6976 655f 626c      explosive_bl
-0000b680: 6467 5f66 6c61 6720 3a20 696e 740a 2020  dg_flag : int.  
-0000b690: 2020 2020 2020 4578 706c 6f73 6976 6520        Explosive 
-0000b6a0: 6275 696c 6469 6e67 2064 616d 6167 6520  building damage 
-0000b6b0: 666c 6167 3a20 3020 3d20 6f66 662c 2031  flag: 0 = off, 1
-0000b6c0: 203d 206f 6e2e 2052 6563 6f6d 6d65 6e64   = on. Recommend
-0000b6d0: 6564 2076 616c 7565 3a20 302e 0a20 2020  ed value: 0..   
-0000b6e0: 2020 2020 2044 6566 6175 6c74 2069 7320       Default is 
-0000b6f0: 302e 0a20 2020 2062 6c64 675f 6172 7261  0..    bldg_arra
-0000b700: 795f 666c 6167 203a 2069 6e74 0a20 2020  y_flag : int.   
-0000b710: 2020 2020 2042 7569 6c64 696e 6720 6172       Building ar
-0000b720: 7261 7920 666c 6167 2e20 3020 3d20 6f66  ray flag. 0 = of
-0000b730: 662c 2031 203d 206f 6e2e 2052 6563 6f6d  f, 1 = on. Recom
-0000b740: 6d65 6e64 6564 2076 616c 7565 3a20 302e  mended value: 0.
-0000b750: 2044 6566 6175 6c74 2069 730a 2020 2020   Default is.    
-0000b760: 2020 2020 302e 0a20 2020 2022 2222 0a0a      0..    """..
-0000b770: 2020 2020 6e61 6d65 3a20 7374 7220 3d20      name: str = 
-0000b780: 4669 656c 6428 2251 555f 7369 6d70 6172  Field("QU_simpar
-0000b790: 616d 7322 2c20 6672 6f7a 656e 3d54 7275  ams", frozen=Tru
-0000b7a0: 6529 0a20 2020 205f 6578 7465 6e73 696f  e).    _extensio
-0000b7b0: 6e3a 2073 7472 203d 2022 2e69 6e70 220a  n: str = ".inp".
-0000b7c0: 2020 2020 6e78 3a20 506f 7369 7469 7665      nx: Positive
-0000b7d0: 496e 740a 2020 2020 6e79 3a20 506f 7369  Int.    ny: Posi
-0000b7e0: 7469 7665 496e 740a 2020 2020 6e7a 3a20  tiveInt.    nz: 
-0000b7f0: 506f 7369 7469 7665 496e 7420 3d20 3232  PositiveInt = 22
-0000b800: 0a20 2020 2064 783a 2050 6f73 6974 6976  .    dx: Positiv
-0000b810: 6546 6c6f 6174 203d 2032 0a20 2020 2064  eFloat = 2.    d
-0000b820: 793a 2050 6f73 6974 6976 6546 6c6f 6174  y: PositiveFloat
-0000b830: 203d 2032 0a20 2020 2071 7569 635f 646f   = 2.    quic_do
-0000b840: 6d61 696e 5f68 6569 6768 743a 2050 6f73  main_height: Pos
-0000b850: 6974 6976 6546 6c6f 6174 203d 2033 3030  itiveFloat = 300
-0000b860: 0a20 2020 2077 696e 645f 7469 6d65 733a  .    wind_times:
-0000b870: 206c 6973 745b 696e 745d 0a20 2020 2073   list[int].    s
-0000b880: 7572 6661 6365 5f76 6572 7469 6361 6c5f  urface_vertical_
-0000b890: 6365 6c6c 5f73 697a 653a 2050 6f73 6974  cell_size: Posit
-0000b8a0: 6976 6546 6c6f 6174 203d 2031 2e30 0a20  iveFloat = 1.0. 
-0000b8b0: 2020 206e 756d 6265 725f 7375 7266 6163     number_surfac
-0000b8c0: 655f 6365 6c6c 733a 2050 6f73 6974 6976  e_cells: Positiv
-0000b8d0: 6549 6e74 203d 2035 0a20 2020 2073 7472  eInt = 5.    str
-0000b8e0: 6574 6368 5f67 7269 645f 666c 6167 3a20  etch_grid_flag: 
-0000b8f0: 4c69 7465 7261 6c5b 302c 2031 2c20 335d  Literal[0, 1, 3]
-0000b900: 203d 2033 0a20 2020 2063 7573 746f 6d5f   = 3.    custom_
-0000b910: 647a 5f61 7272 6179 3a20 6c69 7374 5b50  dz_array: list[P
-0000b920: 6f73 6974 6976 6546 6c6f 6174 5d20 3d20  ositiveFloat] = 
-0000b930: 5b5d 0a20 2020 2075 7463 5f6f 6666 7365  [].    utc_offse
-0000b940: 743a 2069 6e74 203d 2030 0a20 2020 2073  t: int = 0.    s
-0000b950: 6f72 5f69 7465 725f 6d61 783a 2050 6f73  or_iter_max: Pos
-0000b960: 6974 6976 6549 6e74 203d 2031 300a 2020  itiveInt = 10.  
-0000b970: 2020 736f 725f 7265 7369 6475 616c 5f72    sor_residual_r
-0000b980: 6564 7563 7469 6f6e 3a20 506f 7369 7469  eduction: Positi
-0000b990: 7665 496e 7420 3d20 330a 2020 2020 7573  veInt = 3.    us
-0000b9a0: 655f 6469 6666 7573 696f 6e5f 666c 6167  e_diffusion_flag
-0000b9b0: 3a20 4c69 7465 7261 6c5b 302c 2031 5d20  : Literal[0, 1] 
-0000b9c0: 3d20 300a 2020 2020 6e75 6d62 6572 5f64  = 0.    number_d
-0000b9d0: 6966 6675 7369 6f6e 5f69 7465 7261 7469  iffusion_iterati
-0000b9e0: 6f6e 733a 2050 6f73 6974 6976 6549 6e74  ons: PositiveInt
-0000b9f0: 203d 2031 300a 2020 2020 646f 6d61 696e   = 10.    domain
-0000ba00: 5f72 6f74 6174 696f 6e3a 2066 6c6f 6174  _rotation: float
-0000ba10: 203d 2030 2e30 0a20 2020 2075 746d 5f78   = 0.0.    utm_x
-0000ba20: 3a20 666c 6f61 7420 3d20 302e 300a 2020  : float = 0.0.  
-0000ba30: 2020 7574 6d5f 793a 2066 6c6f 6174 203d    utm_y: float =
-0000ba40: 2030 2e30 0a20 2020 2075 746d 5f7a 6f6e   0.0.    utm_zon
-0000ba50: 655f 6e75 6d62 6572 3a20 506f 7369 7469  e_number: Positi
-0000ba60: 7665 496e 7420 3d20 310a 2020 2020 7574  veInt = 1.    ut
-0000ba70: 6d5f 7a6f 6e65 5f6c 6574 7465 723a 2050  m_zone_letter: P
-0000ba80: 6f73 6974 6976 6549 6e74 203d 2031 0a20  ositiveInt = 1. 
-0000ba90: 2020 2071 7569 635f 6366 645f 666c 6167     quic_cfd_flag
-0000baa0: 3a20 4c69 7465 7261 6c5b 302c 2031 5d20  : Literal[0, 1] 
-0000bab0: 3d20 300a 2020 2020 6578 706c 6f73 6976  = 0.    explosiv
-0000bac0: 655f 626c 6467 5f66 6c61 673a 204c 6974  e_bldg_flag: Lit
-0000bad0: 6572 616c 5b30 2c20 315d 203d 2030 0a20  eral[0, 1] = 0. 
-0000bae0: 2020 2062 6c64 675f 6172 7261 795f 666c     bldg_array_fl
-0000baf0: 6167 3a20 4c69 7465 7261 6c5b 302c 2031  ag: Literal[0, 1
-0000bb00: 5d20 3d20 300a 2020 2020 5f66 726f 6d5f  ] = 0.    _from_
-0000bb10: 6669 6c65 3a20 626f 6f6c 203d 2046 616c  file: bool = Fal
-0000bb20: 7365 0a20 2020 205f 6672 6f6d 5f66 696c  se.    _from_fil
-0000bb30: 655f 647a 5f61 7272 6179 3a20 6c69 7374  e_dz_array: list
-0000bb40: 5b50 6f73 6974 6976 6546 6c6f 6174 5d20  [PositiveFloat] 
-0000bb50: 3d20 5b5d 0a0a 2020 2020 4063 6f6d 7075  = []..    @compu
-0000bb60: 7465 645f 6669 656c 640a 2020 2020 4070  ted_field.    @p
-0000bb70: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-0000bb80: 5f64 7a5f 6172 7261 7928 7365 6c66 2920  _dz_array(self) 
-0000bb90: 2d3e 206c 6973 745b 666c 6f61 745d 3a0a  -> list[float]:.
-0000bba0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0000bbb0: 5f66 726f 6d5f 6669 6c65 3a0a 2020 2020  _from_file:.    
-0000bbc0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0000bbd0: 656c 662e 5f66 726f 6d5f 6669 6c65 5f64  elf._from_file_d
-0000bbe0: 7a5f 6172 7261 790a 2020 2020 2020 2020  z_array.        
-0000bbf0: 656c 6966 2073 656c 662e 7374 7265 7463  elif self.stretc
-0000bc00: 685f 6772 6964 5f66 6c61 6720 3d3d 2030  h_grid_flag == 0
-0000bc10: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-0000bc20: 7475 726e 205b 7365 6c66 2e73 7572 6661  turn [self.surfa
-0000bc30: 6365 5f76 6572 7469 6361 6c5f 6365 6c6c  ce_vertical_cell
-0000bc40: 5f73 697a 655d 202a 2073 656c 662e 6e7a  _size] * self.nz
-0000bc50: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
-0000bc60: 6c66 2e73 7472 6574 6368 5f67 7269 645f  lf.stretch_grid_
-0000bc70: 666c 6167 203d 3d20 313a 0a20 2020 2020  flag == 1:.     
-0000bc80: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0000bc90: 6c66 2e63 7573 746f 6d5f 647a 5f61 7272  lf.custom_dz_arr
-0000bca0: 6179 0a20 2020 2020 2020 2065 6c69 6620  ay.        elif 
-0000bcb0: 7365 6c66 2e73 7472 6574 6368 5f67 7269  self.stretch_gri
-0000bcc0: 645f 666c 6167 203d 3d20 333a 0a20 2020  d_flag == 3:.   
-0000bcd0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0000bce0: 636f 6d70 7574 655f 7061 7261 626f 6c69  compute_paraboli
-0000bcf0: 635f 7374 7265 7463 6865 645f 6772 6964  c_stretched_grid
-0000bd00: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0000bd10: 2020 7365 6c66 2e73 7572 6661 6365 5f76    self.surface_v
-0000bd20: 6572 7469 6361 6c5f 6365 6c6c 5f73 697a  ertical_cell_siz
-0000bd30: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-0000bd40: 2020 2073 656c 662e 6e75 6d62 6572 5f73     self.number_s
-0000bd50: 7572 6661 6365 5f63 656c 6c73 2c0a 2020  urface_cells,.  
-0000bd60: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0000bd70: 6c66 2e6e 7a2c 0a20 2020 2020 2020 2020  lf.nz,.         
-0000bd80: 2020 2020 2020 2073 656c 662e 7175 6963         self.quic
-0000bd90: 5f64 6f6d 6169 6e5f 6865 6967 6874 2c0a  _domain_height,.
-0000bda0: 2020 2020 2020 2020 2020 2020 292e 746f              ).to
-0000bdb0: 6c69 7374 2829 0a0a 2020 2020 4063 6f6d  list()..    @com
-0000bdc0: 7075 7465 645f 6669 656c 640a 2020 2020  puted_field.    
-0000bdd0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-0000bde0: 6620 5f76 6572 7469 6361 6c5f 6772 6964  f _vertical_grid
-0000bdf0: 5f6c 696e 6573 2873 656c 6629 202d 3e20  _lines(self) -> 
-0000be00: 7374 723a 0a20 2020 2020 2020 2022 2222  str:.        """
-0000be10: 0a20 2020 2020 2020 2050 6172 7365 7320  .        Parses 
-0000be20: 7468 6520 7665 7274 6963 616c 2067 7269  the vertical gri
-0000be30: 6420 7374 7265 7463 6869 6e67 2066 6c61  d stretching fla
-0000be40: 6720 616e 6420 647a 5f61 7272 6179 2074  g and dz_array t
-0000be50: 6f20 6765 6e65 7261 7465 2074 6865 0a20  o generate the. 
-0000be60: 2020 2020 2020 2076 6572 7469 6361 6c20         vertical 
-0000be70: 6772 6964 2061 7320 6120 7374 7269 6e67  grid as a string
-0000be80: 2066 6f72 2074 6865 2051 555f 7369 6d70   for the QU_simp
-0000be90: 6172 616d 732e 696e 7020 6669 6c65 2e0a  arams.inp file..
-0000bea0: 0a20 2020 2020 2020 2041 6c73 6f20 6d6f  .        Also mo
-0000beb0: 6469 6669 6573 2064 7a5f 6172 7261 7920  difies dz_array 
-0000bec0: 6966 2073 7472 6574 6368 5f67 7269 645f  if stretch_grid_
-0000bed0: 666c 6167 2069 7320 6e6f 7420 312e 0a20  flag is not 1.. 
-0000bee0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0000bef0: 2020 2073 7472 6574 6368 5f67 7269 645f     stretch_grid_
-0000bf00: 6675 6e63 5f6d 6170 203d 207b 0a20 2020  func_map = {.   
-0000bf10: 2020 2020 2020 2020 2030 3a20 7365 6c66           0: self
-0000bf20: 2e5f 7374 7265 7463 685f 6772 6964 5f66  ._stretch_grid_f
-0000bf30: 6c61 675f 302c 0a20 2020 2020 2020 2020  lag_0,.         
-0000bf40: 2020 2031 3a20 7365 6c66 2e5f 7374 7265     1: self._stre
-0000bf50: 7463 685f 6772 6964 5f66 6c61 675f 312c  tch_grid_flag_1,
-0000bf60: 0a20 2020 2020 2020 2020 2020 2033 3a20  .            3: 
-0000bf70: 7365 6c66 2e5f 7374 7265 7463 685f 6772  self._stretch_gr
-0000bf80: 6964 5f66 6c61 675f 332c 0a20 2020 2020  id_flag_3,.     
-0000bf90: 2020 207d 0a20 2020 2020 2020 2072 6574     }.        ret
-0000bfa0: 7572 6e20 7374 7265 7463 685f 6772 6964  urn stretch_grid
-0000bfb0: 5f66 756e 635f 6d61 705b 7365 6c66 2e73  _func_map[self.s
-0000bfc0: 7472 6574 6368 5f67 7269 645f 666c 6167  tretch_grid_flag
-0000bfd0: 5d28 290a 0a20 2020 2040 636f 6d70 7574  ]()..    @comput
-0000bfe0: 6564 5f66 6965 6c64 0a20 2020 2040 7072  ed_field.    @pr
-0000bff0: 6f70 6572 7479 0a20 2020 2064 6566 205f  operty.    def _
-0000c000: 7769 6e64 5f74 696d 655f 6c69 6e65 7328  wind_time_lines(
-0000c010: 7365 6c66 2920 2d3e 2073 7472 3a0a 2020  self) -> str:.  
-0000c020: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0000c030: 662e 5f67 656e 6572 6174 655f 7769 6e64  f._generate_wind
-0000c040: 5f74 696d 655f 6c69 6e65 7328 290a 0a20  _time_lines().. 
-0000c050: 2020 2064 6566 205f 7374 7265 7463 685f     def _stretch_
-0000c060: 6772 6964 5f66 6c61 675f 3028 7365 6c66  grid_flag_0(self
-0000c070: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-0000c080: 2020 2020 2020 2047 656e 6572 6174 6573         Generates
-0000c090: 2061 2075 6e69 666f 726d 2076 6572 7469   a uniform verti
-0000c0a0: 6361 6c20 6772 6964 2061 7320 6120 7374  cal grid as a st
-0000c0b0: 7269 6e67 2066 6f72 2074 6865 2051 555f  ring for the QU_
-0000c0c0: 7369 6d70 6172 616d 732e 696e 700a 2020  simparams.inp.  
-0000c0d0: 2020 2020 2020 6669 6c65 2e20 4164 6473        file. Adds
-0000c0e0: 2074 6865 2075 6e69 666f 726d 2067 7269   the uniform gri
-0000c0f0: 6420 746f 2064 7a5f 6172 7261 792e 0a20  d to dz_array.. 
-0000c100: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0000c110: 2020 2023 2043 7265 6174 6520 7468 6520     # Create the 
-0000c120: 6c69 6e65 7320 666f 7220 7468 6520 756e  lines for the un
-0000c130: 6966 6f72 6d20 6772 6964 0a20 2020 2020  iform grid.     
-0000c140: 2020 2073 7572 6661 6365 5f64 7a5f 6c69     surface_dz_li
-0000c150: 6e65 203d 2028 0a20 2020 2020 2020 2020  ne = (.         
-0000c160: 2020 2066 227b 666c 6f61 7428 7365 6c66     f"{float(self
-0000c170: 2e73 7572 6661 6365 5f76 6572 7469 6361  .surface_vertica
-0000c180: 6c5f 6365 6c6c 5f73 697a 6529 7d5c 7422  l_cell_size)}\t"
-0000c190: 2066 2221 2053 7572 6661 6365 2044 5a20   f"! Surface DZ 
-0000c1a0: 5b6d 5d22 0a20 2020 2020 2020 2029 0a20  [m]".        ). 
-0000c1b0: 2020 2020 2020 206e 756d 6265 725f 7375         number_su
-0000c1c0: 7266 6163 655f 6365 6c6c 735f 6c69 6e65  rface_cells_line
-0000c1d0: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
-0000c1e0: 2066 227b 7365 6c66 2e6e 756d 6265 725f   f"{self.number_
-0000c1f0: 7375 7266 6163 655f 6365 6c6c 737d 5c74  surface_cells}\t
-0000c200: 2220 6622 2120 4e75 6d62 6572 206f 6620  " f"! Number of 
-0000c210: 756e 6966 6f72 6d20 7375 7266 6163 6520  uniform surface 
-0000c220: 6365 6c6c 7322 0a20 2020 2020 2020 2029  cells".        )
-0000c230: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-0000c240: 2066 227b 7375 7266 6163 655f 647a 5f6c   f"{surface_dz_l
-0000c250: 696e 657d 5c6e 7b6e 756d 6265 725f 7375  ine}\n{number_su
-0000c260: 7266 6163 655f 6365 6c6c 735f 6c69 6e65  rface_cells_line
-0000c270: 7d22 0a0a 2020 2020 6465 6620 5f73 7472  }"..    def _str
-0000c280: 6574 6368 5f67 7269 645f 666c 6167 5f31  etch_grid_flag_1
-0000c290: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-0000c2a0: 2222 220a 2020 2020 2020 2020 4765 6e65  """.        Gene
-0000c2b0: 7261 7465 7320 6120 6375 7374 6f6d 2076  rates a custom v
-0000c2c0: 6572 7469 6361 6c20 6772 6964 2061 7320  ertical grid as 
-0000c2d0: 6120 7374 7269 6e67 2066 6f72 2074 6865  a string for the
-0000c2e0: 2051 555f 7369 6d70 6172 616d 732e 696e   QU_simparams.in
-0000c2f0: 700a 2020 2020 2020 2020 6669 6c65 2e0a  p.        file..
-0000c300: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0000c310: 2020 2020 2320 5665 7269 6679 2074 6861      # Verify tha
-0000c320: 7420 647a 5f61 7272 6179 2069 7320 6e6f  t dz_array is no
-0000c330: 7420 656d 7074 790a 2020 2020 2020 2020  t empty.        
-0000c340: 6966 206e 6f74 2073 656c 662e 5f64 7a5f  if not self._dz_
-0000c350: 6172 7261 793a 0a20 2020 2020 2020 2020  array:.         
-0000c360: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-0000c370: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-0000c380: 2020 2020 2022 647a 5f61 7272 6179 206d       "dz_array m
-0000c390: 7573 7420 6e6f 7420 6265 2065 6d70 7479  ust not be empty
-0000c3a0: 2069 6620 7374 7265 7463 685f 6772 6964   if stretch_grid
-0000c3b0: 5f66 6c61 6720 220a 2020 2020 2020 2020  _flag ".        
-0000c3c0: 2020 2020 2020 2020 2269 7320 312e 2050          "is 1. P
-0000c3d0: 6c65 6173 6520 7072 6f76 6964 6520 6120  lease provide a 
-0000c3e0: 6375 7374 6f6d 5f64 7a5f 6172 7261 7920  custom_dz_array 
-0000c3f0: 7769 7468 206e 7a20 220a 2020 2020 2020  with nz ".      
-0000c400: 2020 2020 2020 2020 2020 2265 6c65 6d65            "eleme
-0000c410: 6e74 7320 6f72 2075 7365 2061 2064 6966  nts or use a dif
-0000c420: 6665 7265 6e74 2073 7472 6574 6368 5f67  ferent stretch_g
-0000c430: 7269 645f 666c 6167 2e22 0a20 2020 2020  rid_flag.".     
-0000c440: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-0000c450: 2020 2320 5665 7269 6679 2074 6861 7420    # Verify that 
-0000c460: 6e7a 2069 7320 6571 7561 6c20 746f 2074  nz is equal to t
-0000c470: 6865 206c 656e 6774 6820 6f66 2064 7a5f  he length of dz_
-0000c480: 6172 7261 790a 2020 2020 2020 2020 6966  array.        if
-0000c490: 2073 656c 662e 6e7a 2021 3d20 6c65 6e28   self.nz != len(
-0000c4a0: 7365 6c66 2e5f 647a 5f61 7272 6179 293a  self._dz_array):
-0000c4b0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0000c4c0: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
-0000c4d0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0000c4e0: 226e 7a20 6d75 7374 2062 6520 6571 7561  "nz must be equa
-0000c4f0: 6c20 746f 2074 6865 206c 656e 6774 6820  l to the length 
-0000c500: 6f66 2064 7a5f 6172 7261 792e 2022 0a20  of dz_array. ". 
-0000c510: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0000c520: 227b 7365 6c66 2e6e 7a7d 2021 3d20 7b6c  "{self.nz} != {l
-0000c530: 656e 2873 656c 662e 5f64 7a5f 6172 7261  en(self._dz_arra
-0000c540: 7929 7d22 0a20 2020 2020 2020 2020 2020  y)}".           
-0000c550: 2029 0a0a 2020 2020 2020 2020 2320 5665   )..        # Ve
-0000c560: 7269 6679 2074 6861 7420 7468 6520 6669  rify that the fi
-0000c570: 7273 7420 6e75 6d62 6572 5f73 7572 6661  rst number_surfa
-0000c580: 6365 5f63 656c 6c73 5f6c 696e 6520 656c  ce_cells_line el
-0000c590: 656d 656e 7473 206f 6620 647a 5f61 7272  ements of dz_arr
-0000c5a0: 6179 0a20 2020 2020 2020 2023 2061 7265  ay.        # are
-0000c5b0: 2065 7175 616c 2074 6f20 7468 6520 7375   equal to the su
-0000c5c0: 7266 6163 655f 7665 7274 6963 616c 5f63  rface_vertical_c
-0000c5d0: 656c 6c5f 7369 7a65 0a20 2020 2020 2020  ell_size.       
-0000c5e0: 2066 6f72 2064 7a20 696e 2073 656c 662e   for dz in self.
-0000c5f0: 5f64 7a5f 6172 7261 795b 3a20 7365 6c66  _dz_array[: self
-0000c600: 2e6e 756d 6265 725f 7375 7266 6163 655f  .number_surface_
-0000c610: 6365 6c6c 735d 3a0a 2020 2020 2020 2020  cells]:.        
-0000c620: 2020 2020 6966 2064 7a20 213d 2073 656c      if dz != sel
-0000c630: 662e 7375 7266 6163 655f 7665 7274 6963  f.surface_vertic
-0000c640: 616c 5f63 656c 6c5f 7369 7a65 3a0a 2020  al_cell_size:.  
-0000c650: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-0000c660: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
-0000c670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c680: 2020 2020 2254 6865 2066 6972 7374 206e      "The first n
-0000c690: 756d 6265 725f 7375 7266 6163 655f 6365  umber_surface_ce
-0000c6a0: 6c6c 735f 6c69 6e65 2022 0a20 2020 2020  lls_line ".     
-0000c6b0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0000c6c0: 656c 656d 656e 7473 206f 6620 647a 5f61  elements of dz_a
-0000c6d0: 7272 6179 206d 7573 7420 6265 2065 7175  rray must be equ
-0000c6e0: 616c 2074 6f20 220a 2020 2020 2020 2020  al to ".        
-0000c6f0: 2020 2020 2020 2020 2020 2020 2273 7572              "sur
-0000c700: 6661 6365 5f76 6572 7469 6361 6c5f 6365  face_vertical_ce
-0000c710: 6c6c 5f73 697a 6522 0a20 2020 2020 2020  ll_size".       
-0000c720: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-0000c730: 2020 2020 2320 5772 6974 6520 7375 7266      # Write surf
-0000c740: 6163 6520 7665 7274 6963 616c 2063 656c  ace vertical cel
-0000c750: 6c20 7369 7a65 206c 696e 650a 2020 2020  l size line.    
-0000c760: 2020 2020 7375 7266 6163 655f 647a 5f6c      surface_dz_l
-0000c770: 696e 6520 3d20 280a 2020 2020 2020 2020  ine = (.        
-0000c780: 2020 2020 6622 7b66 6c6f 6174 2873 656c      f"{float(sel
-0000c790: 662e 7375 7266 6163 655f 7665 7274 6963  f.surface_vertic
-0000c7a0: 616c 5f63 656c 6c5f 7369 7a65 297d 5c74  al_cell_size)}\t
-0000c7b0: 2120 2220 6622 5375 7266 6163 6520 445a  ! " f"Surface DZ
-0000c7c0: 205b 6d5d 220a 2020 2020 2020 2020 290a   [m]".        ).
-0000c7d0: 0a20 2020 2020 2020 2023 2057 7269 7465  .        # Write
-0000c7e0: 2068 6561 6465 7220 6c69 6e65 0a20 2020   header line.   
-0000c7f0: 2020 2020 2068 6561 6465 725f 6c69 6e65       header_line
-0000c800: 203d 2022 2120 445a 2061 7272 6179 205b   = "! DZ array [
-0000c810: 6d5d 220a 0a20 2020 2020 2020 2023 2057  m]"..        # W
-0000c820: 7269 7465 2064 7a5f 6172 7261 7920 6c69  rite dz_array li
-0000c830: 6e65 730a 2020 2020 2020 2020 647a 5f61  nes.        dz_a
-0000c840: 7272 6179 5f6c 696e 6573 5f6c 6973 7420  rray_lines_list 
-0000c850: 3d20 5b5d 0a20 2020 2020 2020 2066 6f72  = [].        for
-0000c860: 2064 7a20 696e 2073 656c 662e 5f64 7a5f   dz in self._dz_
-0000c870: 6172 7261 793a 0a20 2020 2020 2020 2020  array:.         
-0000c880: 2020 2064 7a5f 6172 7261 795f 6c69 6e65     dz_array_line
-0000c890: 735f 6c69 7374 2e61 7070 656e 6428 6622  s_list.append(f"
-0000c8a0: 7b66 6c6f 6174 2864 7a29 7d22 290a 2020  {float(dz)}").  
-0000c8b0: 2020 2020 2020 647a 5f61 7272 6179 5f6c        dz_array_l
-0000c8c0: 696e 6573 203d 2022 5c6e 222e 6a6f 696e  ines = "\n".join
-0000c8d0: 2864 7a5f 6172 7261 795f 6c69 6e65 735f  (dz_array_lines_
-0000c8e0: 6c69 7374 290a 0a20 2020 2020 2020 2072  list)..        r
-0000c8f0: 6574 7572 6e20 6622 7b73 7572 6661 6365  eturn f"{surface
-0000c900: 5f64 7a5f 6c69 6e65 7d5c 6e7b 6865 6164  _dz_line}\n{head
-0000c910: 6572 5f6c 696e 657d 5c6e 7b64 7a5f 6172  er_line}\n{dz_ar
-0000c920: 7261 795f 6c69 6e65 737d 220a 0a20 2020  ray_lines}"..   
-0000c930: 2064 6566 205f 7374 7265 7463 685f 6772   def _stretch_gr
-0000c940: 6964 5f66 6c61 675f 3328 7365 6c66 293a  id_flag_3(self):
-0000c950: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0000c960: 2020 2020 2047 656e 6572 6174 6573 2061       Generates a
-0000c970: 2076 6572 7469 6361 6c20 6772 6964 2066   vertical grid f
-0000c980: 6f72 2073 7472 6574 6368 5f67 7269 645f  or stretch_grid_
-0000c990: 666c 6167 2033 2061 7320 6120 7374 7269  flag 3 as a stri
-0000c9a0: 6e67 2066 6f72 2074 6865 0a20 2020 2020  ng for the.     
-0000c9b0: 2020 2051 555f 7369 6d70 6172 616d 732e     QU_simparams.
-0000c9c0: 696e 7020 6669 6c65 2e20 5374 7265 7463  inp file. Stretc
-0000c9d0: 6820 6772 6964 2066 6c61 6720 3320 6973  h grid flag 3 is
-0000c9e0: 2061 2073 7472 6574 6368 696e 6720 7769   a stretching wi
-0000c9f0: 7468 0a20 2020 2020 2020 2070 6172 6162  th.        parab
-0000ca00: 6f6c 6963 2076 6572 7469 6361 6c20 6365  olic vertical ce
-0000ca10: 6c6c 2073 697a 652e 2041 6464 7320 7468  ll size. Adds th
-0000ca20: 6520 7061 7261 626f 6c69 6320 6772 6964  e parabolic grid
-0000ca30: 2074 6f20 647a 5f61 7272 6179 2e0a 2020   to dz_array..  
-0000ca40: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0000ca50: 2020 2320 5772 6974 6520 7375 7266 6163    # Write surfac
-0000ca60: 6520 7665 7274 6963 616c 2063 656c 6c20  e vertical cell 
-0000ca70: 7369 7a65 206c 696e 650a 2020 2020 2020  size line.      
-0000ca80: 2020 7375 7266 6163 655f 647a 5f6c 696e    surface_dz_lin
-0000ca90: 6520 3d20 280a 2020 2020 2020 2020 2020  e = (.          
-0000caa0: 2020 6622 7b66 6c6f 6174 2873 656c 662e    f"{float(self.
-0000cab0: 7375 7266 6163 655f 7665 7274 6963 616c  surface_vertical
-0000cac0: 5f63 656c 6c5f 7369 7a65 297d 5c74 2120  _cell_size)}\t! 
-0000cad0: 2220 6622 5375 7266 6163 6520 445a 205b  " f"Surface DZ [
-0000cae0: 6d5d 220a 2020 2020 2020 2020 290a 0a20  m]".        ).. 
-0000caf0: 2020 2020 2020 2023 2057 7269 7465 206e         # Write n
-0000cb00: 756d 6265 7220 6f66 2073 7572 6661 6365  umber of surface
-0000cb10: 2063 656c 6c73 206c 696e 650a 2020 2020   cells line.    
-0000cb20: 2020 2020 6e75 6d62 6572 5f73 7572 6661      number_surfa
-0000cb30: 6365 5f63 656c 6c73 5f6c 696e 6520 3d20  ce_cells_line = 
-0000cb40: 280a 2020 2020 2020 2020 2020 2020 6622  (.            f"
-0000cb50: 7b73 656c 662e 6e75 6d62 6572 5f73 7572  {self.number_sur
-0000cb60: 6661 6365 5f63 656c 6c73 7d5c 7421 2022  face_cells}\t! "
-0000cb70: 2066 224e 756d 6265 7220 6f66 2075 6e69   f"Number of uni
-0000cb80: 666f 726d 2073 7572 6661 6365 2063 656c  form surface cel
-0000cb90: 6c73 220a 2020 2020 2020 2020 290a 0a20  ls".        ).. 
-0000cba0: 2020 2020 2020 2023 2057 7269 7465 2068         # Write h
-0000cbb0: 6561 6465 7220 6c69 6e65 0a20 2020 2020  eader line.     
-0000cbc0: 2020 2068 6561 6465 725f 6c69 6e65 203d     header_line =
-0000cbd0: 2022 2120 445a 2061 7272 6179 205b 6d5d   "! DZ array [m]
-0000cbe0: 220a 0a20 2020 2020 2020 2023 2057 7269  "..        # Wri
-0000cbf0: 7465 2064 7a5f 6172 7261 7920 6c69 6e65  te dz_array line
-0000cc00: 730a 2020 2020 2020 2020 647a 5f6c 696e  s.        dz_lin
-0000cc10: 6573 203d 2022 5c6e 222e 6a6f 696e 285b  es = "\n".join([
-0000cc20: 6622 7b66 6c6f 6174 2864 7a29 7d22 2066  f"{float(dz)}" f
-0000cc30: 6f72 2064 7a20 696e 2073 656c 662e 5f64  or dz in self._d
-0000cc40: 7a5f 6172 7261 795d 290a 0a20 2020 2020  z_array])..     
-0000cc50: 2020 2072 6574 7572 6e20 280a 2020 2020     return (.    
-0000cc60: 2020 2020 2020 2020 6622 7b73 7572 6661          f"{surfa
-0000cc70: 6365 5f64 7a5f 6c69 6e65 7d5c 6e7b 6e75  ce_dz_line}\n{nu
-0000cc80: 6d62 6572 5f73 7572 6661 6365 5f63 656c  mber_surface_cel
-0000cc90: 6c73 5f6c 696e 657d 5c6e 7b68 6561 6465  ls_line}\n{heade
-0000cca0: 725f 6c69 6e65 7d22 0a20 2020 2020 2020  r_line}".       
-0000ccb0: 2020 2020 2066 225c 6e7b 647a 5f6c 696e       f"\n{dz_lin
-0000ccc0: 6573 7d22 0a20 2020 2020 2020 2029 0a0a  es}".        )..
-0000ccd0: 2020 2020 6465 6620 5f67 656e 6572 6174      def _generat
-0000cce0: 655f 7769 6e64 5f74 696d 655f 6c69 6e65  e_wind_time_line
-0000ccf0: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
-0000cd00: 2022 2222 0a20 2020 2020 2020 2050 6172   """.        Par
-0000cd10: 7365 7320 7468 6520 7574 635f 6f66 6673  ses the utc_offs
-0000cd20: 6574 2061 6e64 2077 696e 645f 7469 6d65  et and wind_time
-0000cd30: 7320 746f 2067 656e 6572 6174 6520 7468  s to generate th
-0000cd40: 6520 7769 6e64 2074 696d 6573 0a20 2020  e wind times.   
-0000cd50: 2020 2020 2061 7320 6120 7374 7269 6e67       as a string
-0000cd60: 2066 6f72 2074 6865 2051 555f 7369 6d70   for the QU_simp
-0000cd70: 6172 616d 732e 696e 7020 6669 6c65 2e0a  arams.inp file..
-0000cd80: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0000cd90: 2020 2020 2320 5665 7269 6679 2074 6861      # Verify tha
-0000cda0: 7420 7769 6e64 5f73 7465 705f 7469 6d65  t wind_step_time
-0000cdb0: 7320 6973 206e 6f74 2065 6d70 7479 0a20  s is not empty. 
-0000cdc0: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
-0000cdd0: 6c66 2e77 696e 645f 7469 6d65 733a 0a20  lf.wind_times:. 
-0000cde0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0000cdf0: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
-0000ce00: 2020 2020 2020 2020 2020 2020 2022 7769               "wi
-0000ce10: 6e64 5f74 696d 6573 206d 7573 7420 6e6f  nd_times must no
-0000ce20: 7420 6265 2065 6d70 7479 2e20 506c 6561  t be empty. Plea
-0000ce30: 7365 2022 0a20 2020 2020 2020 2020 2020  se ".           
-0000ce40: 2020 2020 2022 7072 6f76 6964 6520 6120       "provide a 
-0000ce50: 7769 6e64 5f74 696d 6573 2077 6974 6820  wind_times with 
-0000ce60: 6e75 6d5f 7769 6e64 5f73 7465 7073 2022  num_wind_steps "
-0000ce70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ce80: 2022 656c 656d 656e 7473 206f 7220 7573   "elements or us
-0000ce90: 6520 6120 6469 6666 6572 656e 7420 6e75  e a different nu
-0000cea0: 6d5f 7769 6e64 5f73 7465 7073 2e22 0a20  m_wind_steps.". 
-0000ceb0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-0000cec0: 2020 2020 2020 2320 5772 6974 6520 6e75        # Write nu
-0000ced0: 6d62 6572 206f 6620 7469 6d65 2069 6e63  mber of time inc
-0000cee0: 7265 6d65 6e74 7320 6c69 6e65 0a20 2020  rements line.   
-0000cef0: 2020 2020 206e 756d 6265 725f 7469 6d65       number_time
-0000cf00: 5f69 6e63 7265 6d65 6e74 735f 6c69 6e65  _increments_line
-0000cf10: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
-0000cf20: 2066 227b 6c65 6e28 7365 6c66 2e77 696e   f"{len(self.win
-0000cf30: 645f 7469 6d65 7329 7d5c 7422 2066 2221  d_times)}\t" f"!
-0000cf40: 204e 756d 6265 7220 6f66 2074 696d 6520   Number of time 
-0000cf50: 696e 6372 656d 656e 7473 220a 2020 2020  increments".    
-0000cf60: 2020 2020 290a 0a20 2020 2020 2020 2023      )..        #
-0000cf70: 2057 7269 7465 2075 7463 5f6f 6666 7365   Write utc_offse
-0000cf80: 7420 6c69 6e65 0a20 2020 2020 2020 2075  t line.        u
-0000cf90: 7463 5f6f 6666 7365 745f 6c69 6e65 203d  tc_offset_line =
-0000cfa0: 2066 227b 7365 6c66 2e75 7463 5f6f 6666   f"{self.utc_off
-0000cfb0: 7365 747d 5c74 2120 5554 4320 6f66 6673  set}\t! UTC offs
-0000cfc0: 6574 205b 686f 7572 735d 220a 0a20 2020  et [hours]"..   
-0000cfd0: 2020 2020 2023 2057 7269 7465 2068 6561       # Write hea
-0000cfe0: 6465 7220 6c69 6e65 0a20 2020 2020 2020  der line.       
-0000cff0: 2068 6561 6465 725f 6c69 6e65 203d 2022   header_line = "
-0000d000: 2120 5769 6e64 2073 7465 7020 7469 6d65  ! Wind step time
-0000d010: 7320 5b73 5d22 0a0a 2020 2020 2020 2020  s [s]"..        
-0000d020: 2320 5772 6974 6520 7769 6e64 5f73 7465  # Write wind_ste
-0000d030: 705f 7469 6d65 7320 6c69 6e65 730a 2020  p_times lines.  
-0000d040: 2020 2020 2020 7769 6e64 5f73 7465 705f        wind_step_
-0000d050: 7469 6d65 735f 6c69 6e65 735f 6c69 7374  times_lines_list
-0000d060: 203d 205b 5d0a 2020 2020 2020 2020 666f   = [].        fo
-0000d070: 7220 7769 6e64 5f74 696d 6520 696e 2073  r wind_time in s
-0000d080: 656c 662e 7769 6e64 5f74 696d 6573 3a0a  elf.wind_times:.
-0000d090: 2020 2020 2020 2020 2020 2020 7769 6e64              wind
-0000d0a0: 5f73 7465 705f 7469 6d65 735f 6c69 6e65  _step_times_line
-0000d0b0: 735f 6c69 7374 2e61 7070 656e 6428 6622  s_list.append(f"
-0000d0c0: 7b77 696e 645f 7469 6d65 7d22 290a 2020  {wind_time}").  
-0000d0d0: 2020 2020 2020 7769 6e64 5f73 7465 705f        wind_step_
-0000d0e0: 7469 6d65 735f 6c69 6e65 7320 3d20 225c  times_lines = "\
-0000d0f0: 6e22 2e6a 6f69 6e28 7769 6e64 5f73 7465  n".join(wind_ste
-0000d100: 705f 7469 6d65 735f 6c69 6e65 735f 6c69  p_times_lines_li
-0000d110: 7374 290a 0a20 2020 2020 2020 2072 6574  st)..        ret
-0000d120: 7572 6e20 225c 6e22 2e6a 6f69 6e28 0a20  urn "\n".join(. 
-0000d130: 2020 2020 2020 2020 2020 205b 0a20 2020             [.   
-0000d140: 2020 2020 2020 2020 2020 2020 206e 756d               num
-0000d150: 6265 725f 7469 6d65 5f69 6e63 7265 6d65  ber_time_increme
-0000d160: 6e74 735f 6c69 6e65 2c0a 2020 2020 2020  nts_line,.      
-0000d170: 2020 2020 2020 2020 2020 7574 635f 6f66            utc_of
-0000d180: 6673 6574 5f6c 696e 652c 0a20 2020 2020  fset_line,.     
-0000d190: 2020 2020 2020 2020 2020 2068 6561 6465             heade
-0000d1a0: 725f 6c69 6e65 2c0a 2020 2020 2020 2020  r_line,.        
-0000d1b0: 2020 2020 2020 2020 7769 6e64 5f73 7465          wind_ste
-0000d1c0: 705f 7469 6d65 735f 6c69 6e65 732c 0a20  p_times_lines,. 
-0000d1d0: 2020 2020 2020 2020 2020 205d 0a20 2020             ].   
-0000d1e0: 2020 2020 2029 0a0a 2020 2020 4063 6c61       )..    @cla
-0000d1f0: 7373 6d65 7468 6f64 0a20 2020 2064 6566  ssmethod.    def
-0000d200: 2066 726f 6d5f 6669 6c65 2863 6c73 2c20   from_file(cls, 
-0000d210: 6469 7265 6374 6f72 793a 2073 7472 207c  directory: str |
-0000d220: 2050 6174 682c 202a 2a6b 7761 7267 7329   Path, **kwargs)
-0000d230: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-0000d240: 2020 2020 2020 496e 6974 6961 6c69 7a65        Initialize
-0000d250: 7320 6120 5155 5f53 696d 7061 7261 6d73  s a QU_Simparams
-0000d260: 206f 626a 6563 7420 6672 6f6d 2061 2064   object from a d
-0000d270: 6972 6563 746f 7279 2063 6f6e 7461 696e  irectory contain
-0000d280: 696e 6720 610a 2020 2020 2020 2020 5155  ing a.        QU
-0000d290: 5f73 696d 7061 7261 6d73 2e69 6e70 2066  _simparams.inp f
-0000d2a0: 696c 652e 0a20 2020 2020 2020 2022 2222  ile..        """
-0000d2b0: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
-0000d2c0: 7374 616e 6365 2864 6972 6563 746f 7279  stance(directory
-0000d2d0: 2c20 7374 7229 3a0a 2020 2020 2020 2020  , str):.        
-0000d2e0: 2020 2020 6469 7265 6374 6f72 7920 3d20      directory = 
-0000d2f0: 5061 7468 2864 6972 6563 746f 7279 290a  Path(directory).
-0000d300: 0a20 2020 2020 2020 2077 6974 6820 6f70  .        with op
-0000d310: 656e 2864 6972 6563 746f 7279 202f 2022  en(directory / "
-0000d320: 5155 5f73 696d 7061 7261 6d73 2e69 6e70  QU_simparams.inp
-0000d330: 222c 2022 7222 2920 6173 2066 3a0a 2020  ", "r") as f:.  
-0000d340: 2020 2020 2020 2020 2020 6c69 6e65 7320            lines 
-0000d350: 3d20 662e 7265 6164 6c69 6e65 7328 290a  = f.readlines().
-0000d360: 0a20 2020 2020 2020 2023 2052 6561 6420  .        # Read 
-0000d370: 5155 2067 7269 6420 7061 7261 6d65 7465  QU grid paramete
-0000d380: 7273 0a20 2020 2020 2020 206e 7820 3d20  rs.        nx = 
-0000d390: 696e 7428 6c69 6e65 735b 315d 2e73 7472  int(lines[1].str
-0000d3a0: 6970 2829 2e73 706c 6974 2822 2122 295b  ip().split("!")[
-0000d3b0: 305d 290a 2020 2020 2020 2020 6e79 203d  0]).        ny =
-0000d3c0: 2069 6e74 286c 696e 6573 5b32 5d2e 7374   int(lines[2].st
-0000d3d0: 7269 7028 292e 7370 6c69 7428 2221 2229  rip().split("!")
-0000d3e0: 5b30 5d29 0a20 2020 2020 2020 206e 7a20  [0]).        nz 
-0000d3f0: 3d20 696e 7428 6c69 6e65 735b 335d 2e73  = int(lines[3].s
-0000d400: 7472 6970 2829 2e73 706c 6974 2822 2122  trip().split("!"
-0000d410: 295b 305d 290a 2020 2020 2020 2020 6478  )[0]).        dx
-0000d420: 203d 2066 6c6f 6174 286c 696e 6573 5b34   = float(lines[4
-0000d430: 5d2e 7374 7269 7028 292e 7370 6c69 7428  ].strip().split(
-0000d440: 2221 2229 5b30 5d29 0a20 2020 2020 2020  "!")[0]).       
-0000d450: 2064 7920 3d20 666c 6f61 7428 6c69 6e65   dy = float(line
-0000d460: 735b 355d 2e73 7472 6970 2829 2e73 706c  s[5].strip().spl
-0000d470: 6974 2822 2122 295b 305d 290a 0a20 2020  it("!")[0])..   
-0000d480: 2020 2020 2023 2052 6561 6420 7374 7265       # Read stre
-0000d490: 7463 6820 6772 6964 2066 6c61 670a 2020  tch grid flag.  
-0000d4a0: 2020 2020 2020 7374 7265 7463 685f 6772        stretch_gr
-0000d4b0: 6964 5f66 6c61 6720 3d20 696e 7428 6c69  id_flag = int(li
-0000d4c0: 6e65 735b 365d 2e73 7472 6970 2829 2e73  nes[6].strip().s
-0000d4d0: 706c 6974 2822 2122 295b 305d 290a 0a20  plit("!")[0]).. 
-0000d4e0: 2020 2020 2020 2023 2052 6561 6420 7665         # Read ve
-0000d4f0: 7274 6963 616c 2067 7269 6420 6c69 6e65  rtical grid line
-0000d500: 7320 6173 2066 756e 6374 696f 6e20 6f66  s as function of
-0000d510: 2073 7472 6574 6368 2067 7269 6420 666c   stretch grid fl
-0000d520: 6167 0a20 2020 2020 2020 205f 6672 6f6d  ag.        _from
-0000d530: 5f66 696c 655f 647a 5f61 7272 6179 203d  _file_dz_array =
-0000d540: 205b 5d0a 2020 2020 2020 2020 6375 7374   [].        cust
-0000d550: 6f6d 5f64 7a5f 6172 7261 7920 3d20 5b5d  om_dz_array = []
-0000d560: 0a20 2020 2020 2020 2069 6620 7374 7265  .        if stre
-0000d570: 7463 685f 6772 6964 5f66 6c61 6720 3d3d  tch_grid_flag ==
-0000d580: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
-0000d590: 7375 7266 6163 655f 7665 7274 6963 616c  surface_vertical
-0000d5a0: 5f63 656c 6c5f 7369 7a65 203d 2066 6c6f  _cell_size = flo
-0000d5b0: 6174 286c 696e 6573 5b37 5d2e 7374 7269  at(lines[7].stri
-0000d5c0: 7028 292e 7370 6c69 7428 2221 2229 5b30  p().split("!")[0
-0000d5d0: 5d29 0a20 2020 2020 2020 2020 2020 206e  ]).            n
-0000d5e0: 756d 6265 725f 7375 7266 6163 655f 6365  umber_surface_ce
-0000d5f0: 6c6c 7320 3d20 696e 7428 6c69 6e65 735b  lls = int(lines[
-0000d600: 385d 2e73 7472 6970 2829 2e73 706c 6974  8].strip().split
-0000d610: 2822 2122 295b 305d 290a 2020 2020 2020  ("!")[0]).      
-0000d620: 2020 2020 2020 7175 6963 5f64 6f6d 6169        quic_domai
-0000d630: 6e5f 6865 6967 6874 203d 2073 7572 6661  n_height = surfa
-0000d640: 6365 5f76 6572 7469 6361 6c5f 6365 6c6c  ce_vertical_cell
-0000d650: 5f73 697a 6520 2a20 6e75 6d62 6572 5f73  _size * number_s
-0000d660: 7572 6661 6365 5f63 656c 6c73 0a20 2020  urface_cells.   
-0000d670: 2020 2020 2020 2020 2063 7572 7265 6e74           current
-0000d680: 5f6c 696e 6520 3d20 390a 2020 2020 2020  _line = 9.      
-0000d690: 2020 656c 6966 2073 7472 6574 6368 5f67    elif stretch_g
-0000d6a0: 7269 645f 666c 6167 203d 3d20 313a 0a20  rid_flag == 1:. 
-0000d6b0: 2020 2020 2020 2020 2020 2073 7572 6661             surfa
-0000d6c0: 6365 5f76 6572 7469 6361 6c5f 6365 6c6c  ce_vertical_cell
-0000d6d0: 5f73 697a 6520 3d20 666c 6f61 7428 6c69  _size = float(li
-0000d6e0: 6e65 735b 375d 2e73 7472 6970 2829 2e73  nes[7].strip().s
-0000d6f0: 706c 6974 2822 2122 295b 305d 290a 2020  plit("!")[0]).  
-0000d700: 2020 2020 2020 2020 2020 6e75 6d62 6572            number
-0000d710: 5f73 7572 6661 6365 5f63 656c 6c73 203d  _surface_cells =
-0000d720: 2035 0a20 2020 2020 2020 2020 2020 2066   5.            f
-0000d730: 6f72 2069 2069 6e20 7261 6e67 6528 392c  or i in range(9,
-0000d740: 2039 202b 206e 7a29 3a0a 2020 2020 2020   9 + nz):.      
-0000d750: 2020 2020 2020 2020 2020 6375 7374 6f6d            custom
-0000d760: 5f64 7a5f 6172 7261 792e 6170 7065 6e64  _dz_array.append
-0000d770: 2866 6c6f 6174 286c 696e 6573 5b69 5d2e  (float(lines[i].
-0000d780: 7374 7269 7028 292e 7370 6c69 7428 2221  strip().split("!
-0000d790: 2229 5b30 5d29 290a 2020 2020 2020 2020  ")[0])).        
-0000d7a0: 2020 2020 7175 6963 5f64 6f6d 6169 6e5f      quic_domain_
-0000d7b0: 6865 6967 6874 203d 2072 6f75 6e64 2873  height = round(s
-0000d7c0: 756d 2863 7573 746f 6d5f 647a 5f61 7272  um(custom_dz_arr
-0000d7d0: 6179 292c 2032 290a 2020 2020 2020 2020  ay), 2).        
-0000d7e0: 2020 2020 6375 7272 656e 745f 6c69 6e65      current_line
-0000d7f0: 203d 2039 202b 206e 7a0a 2020 2020 2020   = 9 + nz.      
-0000d800: 2020 656c 6966 2073 7472 6574 6368 5f67    elif stretch_g
-0000d810: 7269 645f 666c 6167 203d 3d20 333a 0a20  rid_flag == 3:. 
-0000d820: 2020 2020 2020 2020 2020 2073 7572 6661             surfa
-0000d830: 6365 5f76 6572 7469 6361 6c5f 6365 6c6c  ce_vertical_cell
-0000d840: 5f73 697a 6520 3d20 666c 6f61 7428 6c69  _size = float(li
-0000d850: 6e65 735b 375d 2e73 7472 6970 2829 2e73  nes[7].strip().s
-0000d860: 706c 6974 2822 2122 295b 305d 290a 2020  plit("!")[0]).  
-0000d870: 2020 2020 2020 2020 2020 6e75 6d62 6572            number
-0000d880: 5f73 7572 6661 6365 5f63 656c 6c73 203d  _surface_cells =
-0000d890: 2069 6e74 286c 696e 6573 5b38 5d2e 7374   int(lines[8].st
-0000d8a0: 7269 7028 292e 7370 6c69 7428 2221 2229  rip().split("!")
-0000d8b0: 5b30 5d29 0a20 2020 2020 2020 2020 2020  [0]).           
-0000d8c0: 205f 203d 206c 696e 6573 5b39 5d2e 7374   _ = lines[9].st
-0000d8d0: 7269 7028 292e 7370 6c69 7428 2221 2229  rip().split("!")
-0000d8e0: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
-0000d8f0: 666f 7220 6920 696e 2072 616e 6765 2831  for i in range(1
-0000d900: 302c 2031 3020 2b20 6e7a 293a 0a20 2020  0, 10 + nz):.   
-0000d910: 2020 2020 2020 2020 2020 2020 205f 6672               _fr
-0000d920: 6f6d 5f66 696c 655f 647a 5f61 7272 6179  om_file_dz_array
-0000d930: 2e61 7070 656e 6428 666c 6f61 7428 6c69  .append(float(li
-0000d940: 6e65 735b 695d 2e73 7472 6970 2829 2e73  nes[i].strip().s
-0000d950: 706c 6974 2822 2122 295b 305d 2929 0a20  plit("!")[0])). 
-0000d960: 2020 2020 2020 2020 2020 2071 7569 635f             quic_
-0000d970: 646f 6d61 696e 5f68 6569 6768 7420 3d20  domain_height = 
-0000d980: 726f 756e 6428 7375 6d28 5f66 726f 6d5f  round(sum(_from_
-0000d990: 6669 6c65 5f64 7a5f 6172 7261 7929 2c20  file_dz_array), 
-0000d9a0: 3229 0a20 2020 2020 2020 2020 2020 2063  2).            c
-0000d9b0: 7572 7265 6e74 5f6c 696e 6520 3d20 3130  urrent_line = 10
-0000d9c0: 202b 206e 7a0a 2020 2020 2020 2020 656c   + nz.        el
-0000d9d0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0000d9e0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-0000d9f0: 2822 7374 7265 7463 685f 6772 6964 5f66  ("stretch_grid_f
-0000da00: 6c61 6720 6d75 7374 2062 6520 302c 2031  lag must be 0, 1
-0000da10: 2c20 6f72 2033 2e22 290a 0a20 2020 2020  , or 3.")..     
-0000da20: 2020 2023 2052 6561 6420 5155 2077 696e     # Read QU win
-0000da30: 6420 7061 7261 6d65 7465 7273 0a20 2020  d parameters.   
-0000da40: 2020 2020 206e 756d 6265 725f 7769 6e64       number_wind
-0000da50: 5f73 7465 7073 203d 2069 6e74 286c 696e  _steps = int(lin
-0000da60: 6573 5b63 7572 7265 6e74 5f6c 696e 655d  es[current_line]
-0000da70: 2e73 7472 6970 2829 2e73 706c 6974 2822  .strip().split("
-0000da80: 2122 295b 305d 290a 2020 2020 2020 2020  !")[0]).        
-0000da90: 7574 635f 6f66 6673 6574 203d 2069 6e74  utc_offset = int
-0000daa0: 286c 696e 6573 5b63 7572 7265 6e74 5f6c  (lines[current_l
-0000dab0: 696e 6520 2b20 315d 2e73 7472 6970 2829  ine + 1].strip()
-0000dac0: 2e73 706c 6974 2822 2122 295b 305d 290a  .split("!")[0]).
-0000dad0: 2020 2020 2020 2020 5f20 3d20 6c69 6e65          _ = line
-0000dae0: 735b 6375 7272 656e 745f 6c69 6e65 202b  s[current_line +
-0000daf0: 2032 5d2e 7374 7269 7028 292e 7370 6c69   2].strip().spli
-0000db00: 7428 2221 2229 5b30 5d0a 2020 2020 2020  t("!")[0].      
-0000db10: 2020 7769 6e64 5f74 696d 6573 203d 205b    wind_times = [
-0000db20: 5d0a 2020 2020 2020 2020 666f 7220 6920  ].        for i 
-0000db30: 696e 2072 616e 6765 2863 7572 7265 6e74  in range(current
-0000db40: 5f6c 696e 6520 2b20 332c 2063 7572 7265  _line + 3, curre
-0000db50: 6e74 5f6c 696e 6520 2b20 3320 2b20 6e75  nt_line + 3 + nu
-0000db60: 6d62 6572 5f77 696e 645f 7374 6570 7329  mber_wind_steps)
-0000db70: 3a0a 2020 2020 2020 2020 2020 2020 7769  :.            wi
-0000db80: 6e64 5f74 696d 6573 2e61 7070 656e 6428  nd_times.append(
-0000db90: 696e 7428 6c69 6e65 735b 695d 2e73 7472  int(lines[i].str
-0000dba0: 6970 2829 2929 0a20 2020 2020 2020 2063  ip())).        c
-0000dbb0: 7572 7265 6e74 5f6c 696e 6520 3d20 6375  urrent_line = cu
-0000dbc0: 7272 656e 745f 6c69 6e65 202b 2033 202b  rrent_line + 3 +
-0000dbd0: 206e 756d 6265 725f 7769 6e64 5f73 7465   number_wind_ste
-0000dbe0: 7073 0a0a 2020 2020 2020 2020 2320 536b  ps..        # Sk
-0000dbf0: 6970 206e 6f74 2075 7365 6420 7061 7261  ip not used para
-0000dc00: 6d65 7465 7273 0a20 2020 2020 2020 2063  meters.        c
-0000dc10: 7572 7265 6e74 5f6c 696e 6520 2b3d 2039  urrent_line += 9
-0000dc20: 0a0a 2020 2020 2020 2020 2320 5265 6164  ..        # Read
-0000dc30: 2072 656d 6169 6e69 6e67 2051 5520 7061   remaining QU pa
-0000dc40: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
-0000dc50: 2073 6f72 5f69 7465 725f 6d61 7820 3d20   sor_iter_max = 
-0000dc60: 696e 7428 6c69 6e65 735b 6375 7272 656e  int(lines[curren
-0000dc70: 745f 6c69 6e65 5d2e 7374 7269 7028 292e  t_line].strip().
-0000dc80: 7370 6c69 7428 2221 2229 5b30 5d29 0a20  split("!")[0]). 
-0000dc90: 2020 2020 2020 2073 6f72 5f72 6573 6964         sor_resid
-0000dca0: 7561 6c5f 7265 6475 6374 696f 6e20 3d20  ual_reduction = 
-0000dcb0: 696e 7428 6c69 6e65 735b 6375 7272 656e  int(lines[curren
-0000dcc0: 745f 6c69 6e65 202b 2031 5d2e 7374 7269  t_line + 1].stri
-0000dcd0: 7028 292e 7370 6c69 7428 2221 2229 5b30  p().split("!")[0
-0000dce0: 5d29 0a20 2020 2020 2020 2075 7365 5f64  ]).        use_d
-0000dcf0: 6966 6675 7369 6f6e 5f66 6c61 6720 3d20  iffusion_flag = 
-0000dd00: 696e 7428 6c69 6e65 735b 6375 7272 656e  int(lines[curren
-0000dd10: 745f 6c69 6e65 202b 2032 5d2e 7374 7269  t_line + 2].stri
-0000dd20: 7028 292e 7370 6c69 7428 2221 2229 5b30  p().split("!")[0
-0000dd30: 5d29 0a20 2020 2020 2020 206e 756d 6265  ]).        numbe
-0000dd40: 725f 6469 6666 7573 696f 6e5f 6974 6572  r_diffusion_iter
-0000dd50: 6174 696f 6e73 203d 2069 6e74 286c 696e  ations = int(lin
-0000dd60: 6573 5b63 7572 7265 6e74 5f6c 696e 6520  es[current_line 
-0000dd70: 2b20 335d 2e73 7472 6970 2829 2e73 706c  + 3].strip().spl
-0000dd80: 6974 2822 2122 295b 305d 290a 2020 2020  it("!")[0]).    
-0000dd90: 2020 2020 646f 6d61 696e 5f72 6f74 6174      domain_rotat
-0000dda0: 696f 6e20 3d20 666c 6f61 7428 6c69 6e65  ion = float(line
-0000ddb0: 735b 6375 7272 656e 745f 6c69 6e65 202b  s[current_line +
-0000ddc0: 2034 5d2e 7374 7269 7028 292e 7370 6c69   4].strip().spli
-0000ddd0: 7428 2221 2229 5b30 5d29 0a20 2020 2020  t("!")[0]).     
-0000dde0: 2020 2075 746d 5f78 203d 2066 6c6f 6174     utm_x = float
-0000ddf0: 286c 696e 6573 5b63 7572 7265 6e74 5f6c  (lines[current_l
-0000de00: 696e 6520 2b20 355d 2e73 7472 6970 2829  ine + 5].strip()
-0000de10: 2e73 706c 6974 2822 2122 295b 305d 290a  .split("!")[0]).
-0000de20: 2020 2020 2020 2020 7574 6d5f 7920 3d20          utm_y = 
-0000de30: 666c 6f61 7428 6c69 6e65 735b 6375 7272  float(lines[curr
-0000de40: 656e 745f 6c69 6e65 202b 2036 5d2e 7374  ent_line + 6].st
-0000de50: 7269 7028 292e 7370 6c69 7428 2221 2229  rip().split("!")
-0000de60: 5b30 5d29 0a20 2020 2020 2020 2075 746d  [0]).        utm
-0000de70: 5f7a 6f6e 655f 6e75 6d62 6572 203d 2069  _zone_number = i
-0000de80: 6e74 286c 696e 6573 5b63 7572 7265 6e74  nt(lines[current
-0000de90: 5f6c 696e 6520 2b20 375d 2e73 7472 6970  _line + 7].strip
-0000dea0: 2829 2e73 706c 6974 2822 2122 295b 305d  ().split("!")[0]
-0000deb0: 290a 2020 2020 2020 2020 7574 6d5f 7a6f  ).        utm_zo
-0000dec0: 6e65 5f6c 6574 7465 7220 3d20 696e 7428  ne_letter = int(
-0000ded0: 6c69 6e65 735b 6375 7272 656e 745f 6c69  lines[current_li
-0000dee0: 6e65 202b 2038 5d2e 7374 7269 7028 292e  ne + 8].strip().
-0000def0: 7370 6c69 7428 2221 2229 5b30 5d29 0a20  split("!")[0]). 
-0000df00: 2020 2020 2020 2071 7569 635f 6366 645f         quic_cfd_
-0000df10: 666c 6167 203d 2069 6e74 286c 696e 6573  flag = int(lines
-0000df20: 5b63 7572 7265 6e74 5f6c 696e 6520 2b20  [current_line + 
-0000df30: 395d 2e73 7472 6970 2829 2e73 706c 6974  9].strip().split
-0000df40: 2822 2122 295b 305d 290a 2020 2020 2020  ("!")[0]).      
-0000df50: 2020 6578 706c 6f73 6976 655f 626c 6467    explosive_bldg
-0000df60: 5f66 6c61 6720 3d20 696e 7428 6c69 6e65  _flag = int(line
-0000df70: 735b 6375 7272 656e 745f 6c69 6e65 202b  s[current_line +
-0000df80: 2031 305d 2e73 7472 6970 2829 2e73 706c   10].strip().spl
-0000df90: 6974 2822 2122 295b 305d 290a 2020 2020  it("!")[0]).    
-0000dfa0: 2020 2020 626c 6467 5f61 7272 6179 5f66      bldg_array_f
-0000dfb0: 6c61 6720 3d20 696e 7428 6c69 6e65 735b  lag = int(lines[
-0000dfc0: 6375 7272 656e 745f 6c69 6e65 202b 2031  current_line + 1
-0000dfd0: 315d 2e73 7472 6970 2829 2e73 706c 6974  1].strip().split
-0000dfe0: 2822 2122 295b 305d 290a 0a20 2020 2020  ("!")[0])..     
-0000dff0: 2020 2072 6574 7572 6e20 636c 7328 0a20     return cls(. 
-0000e000: 2020 2020 2020 2020 2020 206e 783d 6e78             nx=nx
-0000e010: 2c0a 2020 2020 2020 2020 2020 2020 6e79  ,.            ny
-0000e020: 3d6e 792c 0a20 2020 2020 2020 2020 2020  =ny,.           
-0000e030: 206e 7a3d 6e7a 2c0a 2020 2020 2020 2020   nz=nz,.        
-0000e040: 2020 2020 6478 3d64 782c 0a20 2020 2020      dx=dx,.     
-0000e050: 2020 2020 2020 2064 793d 6479 2c0a 2020         dy=dy,.  
-0000e060: 2020 2020 2020 2020 2020 7175 6963 5f64            quic_d
-0000e070: 6f6d 6169 6e5f 6865 6967 6874 3d71 7569  omain_height=qui
-0000e080: 635f 646f 6d61 696e 5f68 6569 6768 742c  c_domain_height,
-0000e090: 0a20 2020 2020 2020 2020 2020 2073 7572  .            sur
-0000e0a0: 6661 6365 5f76 6572 7469 6361 6c5f 6365  face_vertical_ce
-0000e0b0: 6c6c 5f73 697a 653d 7375 7266 6163 655f  ll_size=surface_
-0000e0c0: 7665 7274 6963 616c 5f63 656c 6c5f 7369  vertical_cell_si
-0000e0d0: 7a65 2c0a 2020 2020 2020 2020 2020 2020  ze,.            
-0000e0e0: 6e75 6d62 6572 5f73 7572 6661 6365 5f63  number_surface_c
-0000e0f0: 656c 6c73 3d6e 756d 6265 725f 7375 7266  ells=number_surf
-0000e100: 6163 655f 6365 6c6c 732c 0a20 2020 2020  ace_cells,.     
-0000e110: 2020 2020 2020 2073 7472 6574 6368 5f67         stretch_g
-0000e120: 7269 645f 666c 6167 3d73 7472 6574 6368  rid_flag=stretch
-0000e130: 5f67 7269 645f 666c 6167 2c0a 2020 2020  _grid_flag,.    
-0000e140: 2020 2020 2020 2020 6375 7374 6f6d 5f64          custom_d
-0000e150: 7a5f 6172 7261 793d 6375 7374 6f6d 5f64  z_array=custom_d
-0000e160: 7a5f 6172 7261 792c 0a20 2020 2020 2020  z_array,.       
-0000e170: 2020 2020 2075 7463 5f6f 6666 7365 743d       utc_offset=
-0000e180: 7574 635f 6f66 6673 6574 2c0a 2020 2020  utc_offset,.    
-0000e190: 2020 2020 2020 2020 7769 6e64 5f74 696d          wind_tim
-0000e1a0: 6573 3d77 696e 645f 7469 6d65 732c 0a20  es=wind_times,. 
-0000e1b0: 2020 2020 2020 2020 2020 2073 6f72 5f69             sor_i
-0000e1c0: 7465 725f 6d61 783d 736f 725f 6974 6572  ter_max=sor_iter
-0000e1d0: 5f6d 6178 2c0a 2020 2020 2020 2020 2020  _max,.          
-0000e1e0: 2020 736f 725f 7265 7369 6475 616c 5f72    sor_residual_r
-0000e1f0: 6564 7563 7469 6f6e 3d73 6f72 5f72 6573  eduction=sor_res
-0000e200: 6964 7561 6c5f 7265 6475 6374 696f 6e2c  idual_reduction,
-0000e210: 0a20 2020 2020 2020 2020 2020 2075 7365  .            use
-0000e220: 5f64 6966 6675 7369 6f6e 5f66 6c61 673d  _diffusion_flag=
-0000e230: 7573 655f 6469 6666 7573 696f 6e5f 666c  use_diffusion_fl
-0000e240: 6167 2c0a 2020 2020 2020 2020 2020 2020  ag,.            
-0000e250: 6e75 6d62 6572 5f64 6966 6675 7369 6f6e  number_diffusion
-0000e260: 5f69 7465 7261 7469 6f6e 733d 6e75 6d62  _iterations=numb
-0000e270: 6572 5f64 6966 6675 7369 6f6e 5f69 7465  er_diffusion_ite
-0000e280: 7261 7469 6f6e 732c 0a20 2020 2020 2020  rations,.       
-0000e290: 2020 2020 2064 6f6d 6169 6e5f 726f 7461       domain_rota
-0000e2a0: 7469 6f6e 3d64 6f6d 6169 6e5f 726f 7461  tion=domain_rota
-0000e2b0: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
-0000e2c0: 2020 7574 6d5f 783d 7574 6d5f 782c 0a20    utm_x=utm_x,. 
-0000e2d0: 2020 2020 2020 2020 2020 2075 746d 5f79             utm_y
-0000e2e0: 3d75 746d 5f79 2c0a 2020 2020 2020 2020  =utm_y,.        
-0000e2f0: 2020 2020 7574 6d5f 7a6f 6e65 5f6e 756d      utm_zone_num
-0000e300: 6265 723d 7574 6d5f 7a6f 6e65 5f6e 756d  ber=utm_zone_num
-0000e310: 6265 722c 0a20 2020 2020 2020 2020 2020  ber,.           
-0000e320: 2075 746d 5f7a 6f6e 655f 6c65 7474 6572   utm_zone_letter
-0000e330: 3d75 746d 5f7a 6f6e 655f 6c65 7474 6572  =utm_zone_letter
-0000e340: 2c0a 2020 2020 2020 2020 2020 2020 7175  ,.            qu
-0000e350: 6963 5f63 6664 5f66 6c61 673d 7175 6963  ic_cfd_flag=quic
-0000e360: 5f63 6664 5f66 6c61 672c 0a20 2020 2020  _cfd_flag,.     
-0000e370: 2020 2020 2020 2065 7870 6c6f 7369 7665         explosive
-0000e380: 5f62 6c64 675f 666c 6167 3d65 7870 6c6f  _bldg_flag=explo
-0000e390: 7369 7665 5f62 6c64 675f 666c 6167 2c0a  sive_bldg_flag,.
-0000e3a0: 2020 2020 2020 2020 2020 2020 626c 6467              bldg
-0000e3b0: 5f61 7272 6179 5f66 6c61 673d 626c 6467  _array_flag=bldg
-0000e3c0: 5f61 7272 6179 5f66 6c61 672c 0a20 2020  _array_flag,.   
-0000e3d0: 2020 2020 2020 2020 205f 6672 6f6d 5f66           _from_f
-0000e3e0: 696c 653d 5472 7565 2c0a 2020 2020 2020  ile=True,.      
-0000e3f0: 2020 2020 2020 5f66 726f 6d5f 6669 6c65        _from_file
-0000e400: 5f64 7a5f 6172 7261 793d 5f66 726f 6d5f  _dz_array=_from_
-0000e410: 6669 6c65 5f64 7a5f 6172 7261 792c 0a20  file_dz_array,. 
-0000e420: 2020 2020 2020 2029 0a0a 0a63 6c61 7373         )...class
-0000e430: 2051 4669 7265 5f41 6476 616e 6365 645f   QFire_Advanced_
-0000e440: 5573 6572 5f49 6e70 7574 7328 496e 7075  User_Inputs(Inpu
-0000e450: 7446 696c 6529 3a0a 2020 2020 2222 220a  tFile):.    """.
-0000e460: 2020 2020 436c 6173 7320 7265 7072 6573      Class repres
-0000e470: 656e 7469 6e67 2074 6865 2051 4669 7265  enting the QFire
-0000e480: 5f41 6476 616e 6365 645f 5573 6572 5f49  _Advanced_User_I
-0000e490: 6e70 7574 732e 696e 7020 696e 7075 7420  nputs.inp input 
-0000e4a0: 6669 6c65 2e20 5468 6973 2066 696c 650a  file. This file.
-0000e4b0: 2020 2020 636f 6e74 6169 6e73 2061 6476      contains adv
-0000e4c0: 616e 6365 6420 7061 7261 6d65 7465 7273  anced parameters
-0000e4d0: 2072 656c 6174 6564 2074 6f20 6669 7265   related to fire
-0000e4e0: 6272 616e 6473 2e0a 0a20 2020 2041 7474  brands...    Att
-0000e4f0: 7269 6275 7465 730a 2020 2020 2d2d 2d2d  ributes.    ----
-0000e500: 2d2d 2d2d 2d2d 0a20 2020 2066 7261 6374  ------.    fract
-0000e510: 696f 6e5f 6365 6c6c 735f 6c61 756e 6368  ion_cells_launch
-0000e520: 5f66 6972 6562 7261 6e64 7320 3a20 506f  _firebrands : Po
-0000e530: 7369 7469 7665 466c 6f61 740a 2020 2020  sitiveFloat.    
-0000e540: 2020 2020 4672 6163 7469 6f6e 206f 6620      Fraction of 
-0000e550: 6365 6c6c 7320 7468 6174 2063 6f75 6c64  cells that could
-0000e560: 206c 6175 6e63 6820 6669 7265 6272 616e   launch firebran
-0000e570: 6420 7472 6163 6572 7320 6672 6f6d 2077  d tracers from w
-0000e580: 6869 6368 0a20 2020 2020 2020 2066 6972  hich.        fir
-0000e590: 6562 7261 6e64 2074 7261 6365 7273 2077  ebrand tracers w
-0000e5a0: 696c 6c20 6163 7475 616c 6c79 2062 6520  ill actually be 
-0000e5b0: 6c61 756e 6368 6564 205b 2d5d 2e20 4869  launched [-]. Hi
-0000e5c0: 6768 6572 2076 616c 7565 203d 206d 6f72  gher value = mor
-0000e5d0: 650a 2020 2020 2020 2020 6669 7265 6272  e.        firebr
-0000e5e0: 616e 6420 7472 6163 6572 732e 2052 6563  and tracers. Rec
-0000e5f0: 6f6d 6d65 6e64 6564 2076 616c 7565 3a20  ommended value: 
-0000e600: 302e 3035 0a20 2020 2066 6972 6562 7261  0.05.    firebra
-0000e610: 6e64 5f72 6164 6975 735f 7363 616c 655f  nd_radius_scale_
-0000e620: 6661 6374 6f72 203a 2050 6f73 6974 6976  factor : Positiv
-0000e630: 6546 6c6f 6174 0a20 2020 2020 2020 204d  eFloat.        M
-0000e640: 756c 7469 706c 6963 6174 6976 6520 6661  ultiplicative fa
-0000e650: 6374 6f72 2075 7365 6420 746f 2072 656c  ctor used to rel
-0000e660: 6174 6520 7468 6520 6c65 6e67 7468 2073  ate the length s
-0000e670: 6361 6c65 206f 6620 7468 6520 6d69 7869  cale of the mixi
-0000e680: 6e67 0a20 2020 2020 2020 2028 6669 7265  ng.        (fire
-0000e690: 6272 616e 6420 6469 7374 7269 6275 7469  brand distributi
-0000e6a0: 6f6e 2065 6e74 7261 696e 6d65 6e74 206c  on entrainment l
-0000e6b0: 656e 6774 6820 7363 616c 6529 2074 6f20  ength scale) to 
-0000e6c0: 7468 6520 696e 6974 6961 6c20 7369 7a65  the initial size
-0000e6d0: 0a20 2020 2020 2020 206f 6620 7468 6520  .        of the 
-0000e6e0: 6469 7374 7269 6275 7469 6f6e 205b 2d5d  distribution [-]
-0000e6f0: 2e20 4869 6768 6572 2076 616c 7565 203d  . Higher value =
-0000e700: 2068 6967 6865 7220 6772 6f77 7468 2072   higher growth r
-0000e710: 6174 6520 6f72 2052 540a 2020 2020 2020  ate or RT.      
-0000e720: 2020 2866 6972 6562 7261 6e64 2064 6973    (firebrand dis
-0000e730: 7472 6962 7574 696f 6e29 2077 6974 6820  tribution) with 
-0000e740: 666c 6967 6874 2074 696d 652e 2052 6563  flight time. Rec
-0000e750: 6f6d 6d65 6e64 6564 2076 616c 7565 3a20  ommended value: 
-0000e760: 3430 0a20 2020 2066 6972 6562 7261 6e64  40.    firebrand
-0000e770: 5f74 7261 6a65 6374 6f72 795f 7469 6d65  _trajectory_time
-0000e780: 5f73 7465 7020 3a20 506f 7369 7469 7665  _step : Positive
-0000e790: 496e 740a 2020 2020 2020 2020 5469 6d65  Int.        Time
-0000e7a0: 2073 7465 7020 7573 6564 2074 6f20 6465   step used to de
-0000e7b0: 7465 726d 696e 6520 7468 6520 6669 7265  termine the fire
-0000e7c0: 6272 616e 6420 7472 6163 6572 2074 7261  brand tracer tra
-0000e7d0: 6a65 6374 6f72 7920 5b73 5d2e 0a20 2020  jectory [s]..   
-0000e7e0: 2020 2020 2048 6967 6865 7220 7661 6c75       Higher valu
-0000e7f0: 6520 3d20 6c65 7373 2061 6363 7572 6174  e = less accurat
-0000e800: 6520 7472 616a 6563 746f 7279 2e20 5265  e trajectory. Re
-0000e810: 636f 6d6d 656e 6465 6420 7661 6c75 653a  commended value:
-0000e820: 2031 2073 0a20 2020 2066 6972 6562 7261   1 s.    firebra
-0000e830: 6e64 5f6c 6175 6e63 685f 696e 7465 7276  nd_launch_interv
-0000e840: 616c 203a 2050 6f73 6974 6976 6549 6e74  al : PositiveInt
-0000e850: 0a20 2020 2020 2020 2054 696d 6520 696e  .        Time in
-0000e860: 7465 7276 616c 2062 6574 7765 656e 206c  terval between l
-0000e870: 6175 6e63 6869 6e67 206f 6620 6669 7265  aunching of fire
-0000e880: 6272 616e 6420 7472 6163 6572 7320 5b73  brand tracers [s
-0000e890: 5d2e 2048 6967 6865 7220 7661 6c75 6520  ]. Higher value 
-0000e8a0: 3d0a 2020 2020 2020 2020 6c65 7373 2066  =.        less f
-0000e8b0: 6972 6562 7261 6e64 2074 7261 6365 7273  irebrand tracers
-0000e8c0: 206c 6175 6e63 6865 642e 2052 6563 6f6d   launched. Recom
-0000e8d0: 6d65 6e64 6564 2076 616c 7565 3a20 3130  mended value: 10
-0000e8e0: 2073 0a20 2020 2066 6972 6562 7261 6e64   s.    firebrand
-0000e8f0: 735f 7065 725f 6465 706f 7369 7469 6f6e  s_per_deposition
-0000e900: 203a 2050 6f73 6974 6976 6549 6e74 0a20   : PositiveInt. 
-0000e910: 2020 2020 2020 204e 756d 6265 7220 6f66         Number of
-0000e920: 2066 6972 6562 7261 6e64 2074 7261 6365   firebrand trace
-0000e930: 7273 2074 6861 7420 6f6e 6520 6669 7265  rs that one fire
-0000e940: 6272 616e 6420 7472 6163 6572 206c 6175  brand tracer lau
-0000e950: 6e63 6865 640a 2020 2020 2020 2020 7265  nched.        re
-0000e960: 7072 6573 656e 7473 205b 2d5d 2e20 5265  presents [-]. Re
-0000e970: 636f 6d6d 656e 6465 6420 7661 6c75 653a  commended value:
-0000e980: 2035 3030 0a20 2020 2066 6972 6562 7261   500.    firebra
-0000e990: 6e64 5f61 7265 615f 7261 7469 6f20 3a20  nd_area_ratio : 
-0000e9a0: 506f 7369 7469 7665 466c 6f61 740a 2020  PositiveFloat.  
-0000e9b0: 2020 2020 2020 4d75 6c74 6970 6c69 6361        Multiplica
-0000e9c0: 7469 7665 2066 6163 746f 7220 7573 6564  tive factor used
-0000e9d0: 2074 6f20 7265 6c61 7465 2074 6865 2063   to relate the c
-0000e9e0: 656c 6c20 6172 6561 2061 6e64 2066 7261  ell area and fra
-0000e9f0: 6374 696f 6e20 6f66 2063 656c 6c73 0a20  ction of cells. 
-0000ea00: 2020 2020 2020 2066 726f 6d20 7768 6963         from whic
-0000ea10: 6820 7472 6163 6572 7320 6172 6520 6c61  h tracers are la
-0000ea20: 756e 6368 6564 2074 6f20 696e 6974 6961  unched to initia
-0000ea30: 6c20 6172 6561 2072 6570 7265 7365 6e74  l area represent
-0000ea40: 6564 2062 7920 6f6e 650a 2020 2020 2020  ed by one.      
-0000ea50: 2020 6669 7265 6272 616e 6420 5b2d 5d2e    firebrand [-].
-0000ea60: 0a20 2020 206d 696e 696d 756d 5f62 7572  .    minimum_bur
-0000ea70: 6e5f 7261 7465 5f63 6f65 6666 6963 6965  n_rate_coefficie
-0000ea80: 6e74 203a 2050 6f73 6974 6976 6546 6c6f  nt : PositiveFlo
-0000ea90: 6174 0a20 2020 2020 2020 204d 756c 7469  at.        Multi
-0000eaa0: 706c 6963 6174 6976 6520 6661 6374 6f72  plicative factor
-0000eab0: 2072 656c 6174 696e 6720 7468 6520 6d69   relating the mi
-0000eac0: 6e69 6d75 6d20 6d61 7373 2d6c 6f73 7320  nimum mass-loss 
-0000ead0: 7261 7465 2074 6861 7420 610a 2020 2020  rate that a.    
-0000eae0: 2020 2020 6669 7265 6272 616e 6420 7472      firebrand tr
-0000eaf0: 6163 6572 206e 6565 6473 2074 6f20 6861  acer needs to ha
-0000eb00: 7665 2074 6f20 6a75 7374 6966 7920 636f  ve to justify co
-0000eb10: 6e74 696e 7569 6e67 2074 6f20 7472 6163  ntinuing to trac
-0000eb20: 6b20 6974 730a 2020 2020 2020 2020 7472  k its.        tr
-0000eb30: 616a 6563 746f 7279 2074 6f20 7468 6520  ajectory to the 
-0000eb40: 656e 6572 6779 2061 7373 6f63 6961 7465  energy associate
-0000eb50: 6420 7769 7468 2061 206e 6577 2069 676e  d with a new ign
-0000eb60: 6974 696f 6e20 5b2d 5d2e 0a20 2020 206d  ition [-]..    m
-0000eb70: 6178 5f66 6972 6562 7261 6e64 5f74 6869  ax_firebrand_thi
-0000eb80: 636b 6e65 7373 5f66 7261 6374 696f 6e20  ckness_fraction 
-0000eb90: 3a20 506f 7369 7469 7665 466c 6f61 740a  : PositiveFloat.
-0000eba0: 2020 2020 2020 2020 4d75 6c74 6970 6c69          Multipli
-0000ebb0: 6361 7469 7665 2066 6163 746f 7220 7265  cative factor re
-0000ebc0: 6c61 7469 6e67 2074 6865 2074 6869 636b  lating the thick
-0000ebd0: 6e65 7373 206f 6620 6c61 756e 6368 6564  ness of launched
-0000ebe0: 2066 6972 6562 7261 6e64 0a20 2020 2020   firebrand.     
-0000ebf0: 2020 2074 7261 6365 7220 746f 206d 6178     tracer to max
-0000ec00: 696d 756d 206c 6f66 7461 626c 6520 6669  imum loftable fi
-0000ec10: 7265 6272 616e 6420 7468 6963 6b6e 6573  rebrand thicknes
-0000ec20: 7320 5b2d 5d2e 0a20 2020 2066 6972 6562  s [-]..    fireb
-0000ec30: 7261 6e64 5f67 6572 6d69 6e61 7469 6f6e  rand_germination
-0000ec40: 5f64 656c 6179 203a 2050 6f73 6974 6976  _delay : Positiv
-0000ec50: 6549 6e74 0a20 2020 2020 2020 2054 696d  eInt.        Tim
-0000ec60: 6520 6166 7465 7220 6120 6669 7265 6272  e after a firebr
-0000ec70: 616e 6420 6861 7320 6c61 6e64 6564 2061  and has landed a
-0000ec80: 7420 7768 6963 6820 6120 6669 7265 2069  t which a fire i
-0000ec90: 7320 7374 6172 7465 6420 5b73 5d0a 2020  s started [s].  
-0000eca0: 2020 7665 7274 6963 616c 5f76 656c 6f63    vertical_veloc
-0000ecb0: 6974 795f 7363 616c 655f 6661 6374 6f72  ity_scale_factor
-0000ecc0: 203a 2050 6f73 6974 6976 6546 6c6f 6174   : PositiveFloat
-0000ecd0: 0a20 2020 2020 2020 204d 6178 696d 756d  .        Maximum
-0000ece0: 2076 616c 7565 206f 6620 7468 6520 6d75   value of the mu
-0000ecf0: 6c74 6970 6c69 6361 7469 7665 2066 6163  ltiplicative fac
-0000ed00: 746f 7220 6f66 2074 6865 2076 6572 7469  tor of the verti
-0000ed10: 6361 6c20 7665 6c6f 6369 7479 0a20 2020  cal velocity.   
-0000ed20: 2020 2020 2065 7870 6572 6965 6e63 6564       experienced
-0000ed30: 2062 7920 6120 6669 7265 6272 616e 6420   by a firebrand 
-0000ed40: 3d20 312f 2866 7261 6374 696f 6e20 6f66  = 1/(fraction of
-0000ed50: 2074 6865 2051 5549 432d 5552 4220 6f6e   the QUIC-URB on
-0000ed60: 2066 6972 6529 205b 2d5d 0a20 2020 206d   fire) [-].    m
-0000ed70: 696e 696d 756d 5f66 6972 6562 7261 6e64  inimum_firebrand
-0000ed80: 5f69 676e 6974 696f 6e73 203a 2050 6f73  _ignitions : Pos
-0000ed90: 6974 6976 6549 6e74 0a20 2020 2020 2020  itiveInt.       
-0000eda0: 204d 696e 696d 756d 206e 756d 6265 7220   Minimum number 
-0000edb0: 6f66 2069 676e 6974 696f 6e73 2074 6f20  of ignitions to 
-0000edc0: 6265 2073 616d 706c 6564 2069 6e20 6120  be sampled in a 
-0000edd0: 706f 7369 7469 6f6e 2077 6865 7265 2061  position where a
-0000ede0: 0a20 2020 2020 2020 2066 6972 6562 7261  .        firebra
-0000edf0: 6e64 206c 616e 6473 205b 2d5d 0a20 2020  nd lands [-].   
-0000ee00: 206d 6178 696d 756d 5f66 6972 6562 7261   maximum_firebra
-0000ee10: 6e64 5f69 676e 6974 696f 6e73 203a 2050  nd_ignitions : P
-0000ee20: 6f73 6974 6976 6549 6e74 0a20 2020 2020  ositiveInt.     
-0000ee30: 2020 204d 6178 696d 756d 206e 756d 6265     Maximum numbe
-0000ee40: 7220 6f66 2069 676e 6974 696f 6e73 2073  r of ignitions s
-0000ee50: 616d 706c 6564 2061 7420 706f 7369 7469  ampled at positi
-0000ee60: 6f6e 7320 6469 7374 7269 6275 7465 6420  ons distributed 
-0000ee70: 7769 7468 696e 2052 540a 2020 2020 2020  within RT.      
-0000ee80: 2020 6172 6f75 6e64 2077 6865 7265 2061    around where a
-0000ee90: 2066 6972 6562 7261 6e64 2074 7261 6365   firebrand trace
-0000eea0: 7220 6c61 6e64 7320 5b2d 5d0a 2020 2020  r lands [-].    
-0000eeb0: 6d69 6e69 6d75 6d5f 6c61 6e64 696e 675f  minimum_landing_
-0000eec0: 616e 676c 6520 3a20 506f 7369 7469 7665  angle : Positive
-0000eed0: 466c 6f61 740a 2020 2020 2020 2020 4d69  Float.        Mi
-0000eee0: 6e69 6d75 6d20 7661 6c75 6520 636f 6e73  nimum value cons
-0000eef0: 6964 6572 6564 2066 6f72 2074 6865 2061  idered for the a
-0000ef00: 6e67 6c65 2062 6574 7765 656e 2074 6865  ngle between the
-0000ef10: 2074 7261 6a65 6374 6f72 7920 6f66 2074   trajectory of t
-0000ef20: 6865 0a20 2020 2020 2020 2066 6972 6562  he.        fireb
-0000ef30: 7261 6e64 2077 6865 6e20 6974 2068 6974  rand when it hit
-0000ef40: 7320 7468 6520 6772 6f75 6e64 2061 6e64  s the ground and
-0000ef50: 2068 6f72 697a 6f6e 7461 6c20 5b72 6164   horizontal [rad
-0000ef60: 5d0a 2020 2020 6d61 7869 6d75 6d5f 6669  ].    maximum_fi
-0000ef70: 7265 6272 616e 645f 7468 6963 6b6e 6573  rebrand_thicknes
-0000ef80: 7320 3a20 506f 7369 7469 7665 466c 6f61  s : PositiveFloa
-0000ef90: 740a 2020 2020 2020 2020 4d61 7869 6d75  t.        Maximu
-0000efa0: 6d20 6669 7265 6272 616e 6427 7320 7468  m firebrand's th
-0000efb0: 6963 6b6e 6573 7320 5b6d 5d0a 2020 2020  ickness [m].    
-0000efc0: 2222 220a 0a20 2020 206e 616d 653a 2073  """..    name: s
-0000efd0: 7472 203d 2046 6965 6c64 2822 5146 6972  tr = Field("QFir
-0000efe0: 655f 4164 7661 6e63 6564 5f55 7365 725f  e_Advanced_User_
-0000eff0: 496e 7075 7473 222c 2066 726f 7a65 6e3d  Inputs", frozen=
-0000f000: 5472 7565 290a 2020 2020 5f65 7874 656e  True).    _exten
-0000f010: 7369 6f6e 3a20 7374 7220 3d20 222e 696e  sion: str = ".in
-0000f020: 7022 0a20 2020 2066 7261 6374 696f 6e5f  p".    fraction_
-0000f030: 6365 6c6c 735f 6c61 756e 6368 5f66 6972  cells_launch_fir
-0000f040: 6562 7261 6e64 733a 2050 6f73 6974 6976  ebrands: Positiv
-0000f050: 6546 6c6f 6174 203d 2046 6965 6c64 2830  eFloat = Field(0
-0000f060: 2e30 352c 2067 653d 302c 206c 743d 3129  .05, ge=0, lt=1)
-0000f070: 0a20 2020 2066 6972 6562 7261 6e64 5f72  .    firebrand_r
-0000f080: 6164 6975 735f 7363 616c 655f 6661 6374  adius_scale_fact
-0000f090: 6f72 3a20 506f 7369 7469 7665 466c 6f61  or: PositiveFloa
-0000f0a0: 7420 3d20 4669 656c 6428 3430 2e30 2c20  t = Field(40.0, 
-0000f0b0: 6765 3d31 290a 2020 2020 6669 7265 6272  ge=1).    firebr
-0000f0c0: 616e 645f 7472 616a 6563 746f 7279 5f74  and_trajectory_t
-0000f0d0: 696d 655f 7374 6570 3a20 506f 7369 7469  ime_step: Positi
-0000f0e0: 7665 496e 7420 3d20 310a 2020 2020 6669  veInt = 1.    fi
-0000f0f0: 7265 6272 616e 645f 6c61 756e 6368 5f69  rebrand_launch_i
-0000f100: 6e74 6572 7661 6c3a 2050 6f73 6974 6976  nterval: Positiv
-0000f110: 6549 6e74 203d 2031 300a 2020 2020 6669  eInt = 10.    fi
-0000f120: 7265 6272 616e 6473 5f70 6572 5f64 6570  rebrands_per_dep
-0000f130: 6f73 6974 696f 6e3a 2050 6f73 6974 6976  osition: Positiv
-0000f140: 6549 6e74 203d 2035 3030 0a20 2020 2066  eInt = 500.    f
-0000f150: 6972 6562 7261 6e64 5f61 7265 615f 7261  irebrand_area_ra
-0000f160: 7469 6f3a 2050 6f73 6974 6976 6546 6c6f  tio: PositiveFlo
-0000f170: 6174 203d 2032 302e 300a 2020 2020 6d69  at = 20.0.    mi
-0000f180: 6e69 6d75 6d5f 6275 726e 5f72 6174 655f  nimum_burn_rate_
-0000f190: 636f 6566 6669 6369 656e 743a 2050 6f73  coefficient: Pos
-0000f1a0: 6974 6976 6546 6c6f 6174 203d 2035 302e  itiveFloat = 50.
-0000f1b0: 300a 2020 2020 6d61 785f 6669 7265 6272  0.    max_firebr
-0000f1c0: 616e 645f 7468 6963 6b6e 6573 735f 6672  and_thickness_fr
-0000f1d0: 6163 7469 6f6e 3a20 506f 7369 7469 7665  action: Positive
-0000f1e0: 466c 6f61 7420 3d20 302e 3735 0a20 2020  Float = 0.75.   
-0000f1f0: 2066 6972 6562 7261 6e64 5f67 6572 6d69   firebrand_germi
-0000f200: 6e61 7469 6f6e 5f64 656c 6179 3a20 506f  nation_delay: Po
-0000f210: 7369 7469 7665 496e 7420 3d20 3138 300a  sitiveInt = 180.
-0000f220: 2020 2020 7665 7274 6963 616c 5f76 656c      vertical_vel
-0000f230: 6f63 6974 795f 7363 616c 655f 6661 6374  ocity_scale_fact
-0000f240: 6f72 3a20 506f 7369 7469 7665 466c 6f61  or: PositiveFloa
-0000f250: 7420 3d20 352e 300a 2020 2020 6d69 6e69  t = 5.0.    mini
-0000f260: 6d75 6d5f 6669 7265 6272 616e 645f 6967  mum_firebrand_ig
-0000f270: 6e69 7469 6f6e 733a 2050 6f73 6974 6976  nitions: Positiv
-0000f280: 6549 6e74 203d 2035 300a 2020 2020 6d61  eInt = 50.    ma
-0000f290: 7869 6d75 6d5f 6669 7265 6272 616e 645f  ximum_firebrand_
-0000f2a0: 6967 6e69 7469 6f6e 733a 2050 6f73 6974  ignitions: Posit
-0000f2b0: 6976 6549 6e74 203d 2031 3030 0a20 2020  iveInt = 100.   
-0000f2c0: 206d 696e 696d 756d 5f6c 616e 6469 6e67   minimum_landing
-0000f2d0: 5f61 6e67 6c65 3a20 506f 7369 7469 7665  _angle: Positive
-0000f2e0: 466c 6f61 7420 3d20 4669 656c 6428 302e  Float = Field(0.
-0000f2f0: 3532 3335 3938 2c20 6765 3d30 2c20 6c65  523598, ge=0, le
-0000f300: 3d6e 702e 7069 202f 2032 290a 2020 2020  =np.pi / 2).    
-0000f310: 6d61 7869 6d75 6d5f 6669 7265 6272 616e  maximum_firebran
-0000f320: 645f 7468 6963 6b6e 6573 733a 2050 6f73  d_thickness: Pos
-0000f330: 6974 6976 6546 6c6f 6174 203d 2030 2e30  itiveFloat = 0.0
-0000f340: 330a 0a20 2020 2040 636c 6173 736d 6574  3..    @classmet
-0000f350: 686f 640a 2020 2020 6465 6620 6672 6f6d  hod.    def from
-0000f360: 5f66 696c 6528 636c 732c 2064 6972 6563  _file(cls, direc
-0000f370: 746f 7279 3a20 7374 7220 7c20 5061 7468  tory: str | Path
-0000f380: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
-0000f390: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0000f3a0: 2049 6e69 7469 616c 697a 6573 2061 2051   Initializes a Q
-0000f3b0: 4669 7265 5f41 6476 616e 6365 645f 5573  Fire_Advanced_Us
-0000f3c0: 6572 5f49 6e70 7574 7320 6f62 6a65 6374  er_Inputs object
-0000f3d0: 2066 726f 6d20 6120 6469 7265 6374 6f72   from a director
-0000f3e0: 790a 2020 2020 2020 2020 636f 6e74 6169  y.        contai
-0000f3f0: 6e69 6e67 2061 2051 4669 7265 5f41 6476  ning a QFire_Adv
-0000f400: 616e 6365 645f 5573 6572 5f49 6e70 7574  anced_User_Input
-0000f410: 732e 696e 7020 6669 6c65 2e0a 2020 2020  s.inp file..    
-0000f420: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000f430: 6966 2069 7369 6e73 7461 6e63 6528 6469  if isinstance(di
-0000f440: 7265 6374 6f72 792c 2073 7472 293a 0a20  rectory, str):. 
-0000f450: 2020 2020 2020 2020 2020 2064 6972 6563             direc
-0000f460: 746f 7279 203d 2050 6174 6828 6469 7265  tory = Path(dire
-0000f470: 6374 6f72 7929 0a20 2020 2020 2020 2077  ctory).        w
-0000f480: 6974 6820 6f70 656e 2864 6972 6563 746f  ith open(directo
-0000f490: 7279 202f 2022 5146 6972 655f 4164 7661  ry / "QFire_Adva
-0000f4a0: 6e63 6564 5f55 7365 725f 496e 7075 7473  nced_User_Inputs
-0000f4b0: 2e69 6e70 222c 2022 7222 2920 6173 2066  .inp", "r") as f
-0000f4c0: 3a0a 2020 2020 2020 2020 2020 2020 6c69  :.            li
-0000f4d0: 6e65 7320 3d20 662e 7265 6164 6c69 6e65  nes = f.readline
-0000f4e0: 7328 290a 2020 2020 2020 2020 7265 7475  s().        retu
-0000f4f0: 726e 2063 6c73 280a 2020 2020 2020 2020  rn cls(.        
-0000f500: 2020 2020 6672 6163 7469 6f6e 5f63 656c      fraction_cel
-0000f510: 6c73 5f6c 6175 6e63 685f 6669 7265 6272  ls_launch_firebr
-0000f520: 616e 6473 3d66 6c6f 6174 286c 696e 6573  ands=float(lines
-0000f530: 5b30 5d2e 7370 6c69 7428 295b 305d 292c  [0].split()[0]),
-0000f540: 0a20 2020 2020 2020 2020 2020 2066 6972  .            fir
-0000f550: 6562 7261 6e64 5f72 6164 6975 735f 7363  ebrand_radius_sc
-0000f560: 616c 655f 6661 6374 6f72 3d66 6c6f 6174  ale_factor=float
-0000f570: 286c 696e 6573 5b31 5d2e 7370 6c69 7428  (lines[1].split(
-0000f580: 295b 305d 292c 0a20 2020 2020 2020 2020  )[0]),.         
-0000f590: 2020 2066 6972 6562 7261 6e64 5f74 7261     firebrand_tra
-0000f5a0: 6a65 6374 6f72 795f 7469 6d65 5f73 7465  jectory_time_ste
-0000f5b0: 703d 696e 7428 6c69 6e65 735b 325d 2e73  p=int(lines[2].s
-0000f5c0: 706c 6974 2829 5b30 5d29 2c0a 2020 2020  plit()[0]),.    
-0000f5d0: 2020 2020 2020 2020 6669 7265 6272 616e          firebran
-0000f5e0: 645f 6c61 756e 6368 5f69 6e74 6572 7661  d_launch_interva
-0000f5f0: 6c3d 696e 7428 6c69 6e65 735b 335d 2e73  l=int(lines[3].s
-0000f600: 706c 6974 2829 5b30 5d29 2c0a 2020 2020  plit()[0]),.    
-0000f610: 2020 2020 2020 2020 6669 7265 6272 616e          firebran
-0000f620: 6473 5f70 6572 5f64 6570 6f73 6974 696f  ds_per_depositio
-0000f630: 6e3d 696e 7428 6c69 6e65 735b 345d 2e73  n=int(lines[4].s
-0000f640: 706c 6974 2829 5b30 5d29 2c0a 2020 2020  plit()[0]),.    
-0000f650: 2020 2020 2020 2020 6669 7265 6272 616e          firebran
-0000f660: 645f 6172 6561 5f72 6174 696f 3d66 6c6f  d_area_ratio=flo
-0000f670: 6174 286c 696e 6573 5b35 5d2e 7370 6c69  at(lines[5].spli
-0000f680: 7428 295b 305d 292c 0a20 2020 2020 2020  t()[0]),.       
-0000f690: 2020 2020 206d 696e 696d 756d 5f62 7572       minimum_bur
-0000f6a0: 6e5f 7261 7465 5f63 6f65 6666 6963 6965  n_rate_coefficie
-0000f6b0: 6e74 3d66 6c6f 6174 286c 696e 6573 5b36  nt=float(lines[6
-0000f6c0: 5d2e 7370 6c69 7428 295b 305d 292c 0a20  ].split()[0]),. 
-0000f6d0: 2020 2020 2020 2020 2020 206d 6178 5f66             max_f
-0000f6e0: 6972 6562 7261 6e64 5f74 6869 636b 6e65  irebrand_thickne
-0000f6f0: 7373 5f66 7261 6374 696f 6e3d 666c 6f61  ss_fraction=floa
-0000f700: 7428 6c69 6e65 735b 375d 2e73 706c 6974  t(lines[7].split
-0000f710: 2829 5b30 5d29 2c0a 2020 2020 2020 2020  ()[0]),.        
-0000f720: 2020 2020 6669 7265 6272 616e 645f 6765      firebrand_ge
-0000f730: 726d 696e 6174 696f 6e5f 6465 6c61 793d  rmination_delay=
-0000f740: 696e 7428 6c69 6e65 735b 385d 2e73 706c  int(lines[8].spl
-0000f750: 6974 2829 5b30 5d29 2c0a 2020 2020 2020  it()[0]),.      
-0000f760: 2020 2020 2020 7665 7274 6963 616c 5f76        vertical_v
-0000f770: 656c 6f63 6974 795f 7363 616c 655f 6661  elocity_scale_fa
-0000f780: 6374 6f72 3d66 6c6f 6174 286c 696e 6573  ctor=float(lines
-0000f790: 5b39 5d2e 7370 6c69 7428 295b 305d 292c  [9].split()[0]),
-0000f7a0: 0a20 2020 2020 2020 2020 2020 206d 696e  .            min
-0000f7b0: 696d 756d 5f66 6972 6562 7261 6e64 5f69  imum_firebrand_i
-0000f7c0: 676e 6974 696f 6e73 3d69 6e74 286c 696e  gnitions=int(lin
-0000f7d0: 6573 5b31 305d 2e73 706c 6974 2829 5b30  es[10].split()[0
-0000f7e0: 5d29 2c0a 2020 2020 2020 2020 2020 2020  ]),.            
-0000f7f0: 6d61 7869 6d75 6d5f 6669 7265 6272 616e  maximum_firebran
-0000f800: 645f 6967 6e69 7469 6f6e 733d 696e 7428  d_ignitions=int(
-0000f810: 6c69 6e65 735b 3131 5d2e 7370 6c69 7428  lines[11].split(
-0000f820: 295b 305d 292c 0a20 2020 2020 2020 2020  )[0]),.         
-0000f830: 2020 206d 696e 696d 756d 5f6c 616e 6469     minimum_landi
-0000f840: 6e67 5f61 6e67 6c65 3d66 6c6f 6174 286c  ng_angle=float(l
-0000f850: 696e 6573 5b31 325d 2e73 706c 6974 2829  ines[12].split()
-0000f860: 5b30 5d29 2c0a 2020 2020 2020 2020 2020  [0]),.          
-0000f870: 2020 6d61 7869 6d75 6d5f 6669 7265 6272    maximum_firebr
-0000f880: 616e 645f 7468 6963 6b6e 6573 733d 666c  and_thickness=fl
-0000f890: 6f61 7428 6c69 6e65 735b 3133 5d2e 7370  oat(lines[13].sp
-0000f8a0: 6c69 7428 295b 305d 292c 0a20 2020 2020  lit()[0]),.     
-0000f8b0: 2020 2029 0a0a 0a63 6c61 7373 2051 5549     )...class QUI
-0000f8c0: 435f 6669 7265 2849 6e70 7574 4669 6c65  C_fire(InputFile
-0000f8d0: 293a 0a20 2020 2022 2222 0a20 2020 2043  ):.    """.    C
-0000f8e0: 6c61 7373 2072 6570 7265 7365 6e74 696e  lass representin
-0000f8f0: 6720 7468 6520 5155 4943 5f66 6972 652e  g the QUIC_fire.
-0000f900: 696e 7020 696e 7075 7420 6669 6c65 2e20  inp input file. 
-0000f910: 5468 6973 2066 696c 650a 2020 2020 636f  This file.    co
-0000f920: 6e74 6169 6e73 2074 6865 2070 6172 616d  ntains the param
-0000f930: 6574 6572 7320 7265 6c61 7469 6e67 2074  eters relating t
-0000f940: 6f20 7468 6520 6669 7265 2073 696d 756c  o the fire simul
-0000f950: 6174 696f 6e20 616e 640a 2020 2020 6f75  ation and.    ou
-0000f960: 7470 7574 732e 0a0a 2020 2020 4174 7472  tputs...    Attr
-0000f970: 6962 7574 6573 0a20 2020 202d 2d2d 2d2d  ibutes.    -----
-0000f980: 2d2d 2d2d 2d0a 2020 2020 6669 7265 5f66  -----.    fire_f
-0000f990: 6c61 6720 3a20 4c69 7465 7261 6c5b 302c  lag : Literal[0,
-0000f9a0: 2031 5d0a 2020 2020 2020 2020 4669 7265   1].        Fire
-0000f9b0: 2066 6c61 672c 2031 203d 2072 756e 2066   flag, 1 = run f
-0000f9c0: 6972 653b 2030 203d 206e 6f20 6669 7265  ire; 0 = no fire
-0000f9d0: 0a20 2020 2072 616e 646f 6d5f 7365 6564  .    random_seed
-0000f9e0: 203a 2069 6e74 0a20 2020 2020 2020 2052   : int.        R
-0000f9f0: 616e 646f 6d20 6e75 6d62 6572 2067 656e  andom number gen
-0000fa00: 6572 6174 6f72 2c20 2d31 3a20 7573 6520  erator, -1: use 
-0000fa10: 7469 6d65 2061 6e64 2064 6174 652c 2061  time and date, a
-0000fa20: 6e79 206f 7468 6572 2069 6e74 6567 6572  ny other integer
-0000fa30: 203e 2030 0a20 2020 2074 696d 655f 6e6f   > 0.    time_no
-0000fa40: 7720 3a20 506f 7369 7469 7665 496e 740a  w : PositiveInt.
-0000fa50: 2020 2020 2020 2020 5768 656e 2074 6865          When the
-0000fa60: 2066 6972 6520 6973 2069 676e 6974 6564   fire is ignited
-0000fa70: 2069 6e20 556e 6978 2045 706f 6368 2074   in Unix Epoch t
-0000fa80: 696d 6520 2869 6e74 6567 6572 2073 6563  ime (integer sec
-0000fa90: 6f6e 6473 2073 696e 6365 0a20 2020 2020  onds since.     
-0000faa0: 2020 2031 3937 302f 312f 3120 3030 3a30     1970/1/1 00:0
-0000fab0: 303a 3030 292e 204d 7573 7420 6265 2067  0:00). Must be g
-0000fac0: 7265 6174 6572 206f 7220 6571 7561 6c20  reater or equal 
-0000fad0: 746f 2074 6865 2074 696d 6520 6f66 2074  to the time of t
-0000fae0: 6865 2066 6972 7374 0a20 2020 2020 2020  he first.       
-0000faf0: 2077 696e 640a 2020 2020 7369 6d5f 7469   wind.    sim_ti
-0000fb00: 6d65 203a 2050 6f73 6974 6976 6549 6e74  me : PositiveInt
-0000fb10: 0a20 2020 2020 2020 2054 6f74 616c 2073  .        Total s
-0000fb20: 696d 756c 6174 696f 6e20 7469 6d65 2066  imulation time f
-0000fb30: 6f72 2074 6865 2066 6972 6520 5b73 5d0a  or the fire [s].
-0000fb40: 2020 2020 6669 7265 5f74 696d 655f 7374      fire_time_st
-0000fb50: 6570 203a 2050 6f73 6974 6976 6549 6e74  ep : PositiveInt
-0000fb60: 0a20 2020 2020 2020 2054 696d 6520 7374  .        Time st
-0000fb70: 6570 2066 6f72 2074 6865 2066 6972 6520  ep for the fire 
-0000fb80: 7369 6d75 6c61 7469 6f6e 205b 735d 0a20  simulation [s]. 
-0000fb90: 2020 2071 7569 635f 7469 6d65 5f73 7465     quic_time_ste
-0000fba0: 7020 3a20 506f 7369 7469 7665 496e 740a  p : PositiveInt.
-0000fbb0: 2020 2020 2020 2020 4e75 6d62 6572 206f          Number o
-0000fbc0: 6620 6669 7265 2074 696d 6520 7374 6570  f fire time step
-0000fbd0: 7320 646f 6e65 2062 6566 6f72 6520 7570  s done before up
-0000fbe0: 6461 7469 6e67 2074 6865 2071 7569 6320  dating the quic 
-0000fbf0: 7769 6e64 2066 6965 6c64 0a20 2020 2020  wind field.     
-0000fc00: 2020 2028 696e 7465 6765 722c 203e 3d20     (integer, >= 
-0000fc10: 3129 0a20 2020 206f 7574 5f74 696d 655f  1).    out_time_
-0000fc20: 6669 7265 203a 2050 6f73 6974 6976 6549  fire : PositiveI
-0000fc30: 6e74 0a20 2020 2020 2020 2041 6674 6572  nt.        After
-0000fc40: 2068 6f77 206d 616e 7920 6669 7265 2074   how many fire t
-0000fc50: 696d 6520 7374 6570 7320 746f 2070 7269  ime steps to pri
-0000fc60: 6e74 206f 7574 2066 6972 652d 7265 6c61  nt out fire-rela
-0000fc70: 7465 6420 6669 6c65 7320 2865 7863 6c75  ted files (exclu
-0000fc80: 6469 6e67 2065 6d69 7373 696f 6e73 2061  ding emissions a
-0000fc90: 6e64 2072 6164 6961 7469 6f6e 290a 2020  nd radiation).  
-0000fca0: 2020 6f75 745f 7469 6d65 5f77 696e 6420    out_time_wind 
-0000fcb0: 3a20 506f 7369 7469 7665 496e 740a 2020  : PositiveInt.  
-0000fcc0: 2020 2020 2020 4166 7465 7220 686f 7720        After how 
-0000fcd0: 6d61 6e79 2071 7569 6320 7570 6461 7465  many quic update
-0000fce0: 7320 746f 2070 7269 6e74 206f 7574 2077  s to print out w
-0000fcf0: 696e 642d 7265 6c61 7465 6420 6669 6c65  ind-related file
-0000fd00: 730a 2020 2020 6f75 745f 7469 6d65 5f65  s.    out_time_e
-0000fd10: 6d69 735f 7261 6420 3a20 506f 7369 7469  mis_rad : Positi
-0000fd20: 7665 496e 740a 2020 2020 2020 2020 4166  veInt.        Af
-0000fd30: 7465 7220 686f 7720 6d61 6e79 2066 6972  ter how many fir
-0000fd40: 6520 7469 6d65 2073 7465 7073 2074 6f20  e time steps to 
-0000fd50: 6176 6572 6167 6520 656d 6973 7369 6f6e  average emission
-0000fd60: 7320 616e 6420 7261 6469 6174 696f 6e0a  s and radiation.
-0000fd70: 2020 2020 6f75 745f 7469 6d65 5f77 696e      out_time_win
-0000fd80: 645f 6176 6720 3a20 506f 7369 7469 7665  d_avg : Positive
-0000fd90: 496e 740a 2020 2020 2020 2020 4166 7465  Int.        Afte
-0000fda0: 7220 686f 7720 6d61 6e79 2071 7569 6320  r how many quic 
-0000fdb0: 7570 6461 7465 7320 746f 2070 7269 6e74  updates to print
-0000fdc0: 206f 7574 2061 7665 7261 6765 6420 7769   out averaged wi
-0000fdd0: 6e64 2d72 656c 6174 6564 2066 696c 6573  nd-related files
-0000fde0: 0a20 2020 206e 7a20 3a20 506f 7369 7469  .    nz : Positi
-0000fdf0: 7665 496e 740a 2020 2020 2020 2020 4e75  veInt.        Nu
-0000fe00: 6d62 6572 206f 6620 6669 7265 2067 7269  mber of fire gri
-0000fe10: 6420 6365 6c6c 7320 696e 2074 6865 207a  d cells in the z
-0000fe20: 2d64 6972 6563 7469 6f6e 2e0a 2020 2020  -direction..    
-0000fe30: 7374 7265 7463 685f 6772 6964 5f66 6c61  stretch_grid_fla
-0000fe40: 6720 3a20 4c69 7465 7261 6c5b 302c 2031  g : Literal[0, 1
-0000fe50: 5d0a 2020 2020 2020 2020 5665 7274 6963  ].        Vertic
-0000fe60: 616c 2073 7472 6574 6368 696e 6720 666c  al stretching fl
-0000fe70: 6167 3a20 3020 3d20 756e 6966 6f72 6d20  ag: 0 = uniform 
-0000fe80: 647a 2c20 3120 3d20 6375 7374 6f6d 0a20  dz, 1 = custom. 
-0000fe90: 2020 2064 7a20 3a20 506f 7369 7469 7665     dz : Positive
-0000fea0: 496e 740a 2020 2020 2020 2020 4365 6c6c  Int.        Cell
-0000feb0: 2073 697a 6520 696e 2074 6865 207a 2d64   size in the z-d
-0000fec0: 6972 6563 7469 6f6e 205b 6d5d 206f 6620  irection [m] of 
-0000fed0: 7468 6520 6669 7265 2067 7269 642e 2052  the fire grid. R
-0000fee0: 6563 6f6d 6d65 6e64 6564 2076 616c 7565  ecommended value
-0000fef0: 3a20 316d 0a20 2020 2064 7a5f 6172 7261  : 1m.    dz_arra
-0000ff00: 7920 3a20 4c69 7374 5b50 6f73 6974 6976  y : List[Positiv
-0000ff10: 6546 6c6f 6174 5d0a 2020 2020 2020 2020  eFloat].        
-0000ff20: 4375 7374 6f6d 2064 7a2c 206f 6e65 2064  Custom dz, one d
-0000ff30: 7a20 7065 7220 6c69 6e65 206d 7573 7420  z per line must 
-0000ff40: 6265 2073 7065 6369 6669 6564 2c20 6672  be specified, fr
-0000ff50: 6f6d 2074 6865 2067 726f 756e 6420 746f  om the ground to
-0000ff60: 2074 6865 0a20 2020 2020 2020 2074 6f70   the.        top
-0000ff70: 206f 6620 7468 6520 646f 6d61 696e 0a20   of the domain. 
-0000ff80: 2020 2066 7565 6c5f 6465 6e73 6974 795f     fuel_density_
-0000ff90: 666c 6167 3a20 4c69 7465 7261 6c5b 312c  flag: Literal[1,
-0000ffa0: 2032 2c20 332c 2034 5d0a 2020 2020 2020   2, 3, 4].      
-0000ffb0: 2020 4675 656c 2064 656e 7369 7479 2066    Fuel density f
-0000ffc0: 6c61 6720 2864 6566 6175 6c74 7320 746f  lag (defaults to
-0000ffd0: 2031 293a 0a20 2020 2020 2020 2031 203d   1):.        1 =
-0000ffe0: 2064 656e 7369 7479 2069 7320 756e 6966   density is unif
-0000fff0: 6f72 6d20 6f76 6572 2074 6865 2064 6f6d  orm over the dom
-00010000: 6169 6e2c 0a20 2020 2020 2020 2032 203d  ain,.        2 =
-00010010: 2064 656e 7369 7479 2069 7320 7072 6f76   density is prov
-00010020: 6964 6564 2074 6872 6f75 6768 2051 465f  ided through QF_
-00010030: 4675 656c 4465 6e73 6974 792e 696e 702c  FuelDensity.inp,
-00010040: 0a20 2020 2020 2020 2033 203d 2064 656e  .        3 = den
-00010050: 7369 7479 2069 7320 7072 6f76 6964 6564  sity is provided
-00010060: 2074 6872 6f75 6768 2046 6972 6574 6563   through Firetec
-00010070: 2066 696c 6520 2874 7265 6573 7268 6f66   file (treesrhof
-00010080: 2e64 6174 2920 6d61 7463 6869 6e67 2051  .dat) matching Q
-00010090: 5549 432d 4669 7265 2067 7269 642c 0a20  UIC-Fire grid,. 
-000100a0: 2020 2020 2020 2034 203d 2064 656e 7369         4 = densi
-000100b0: 7479 2069 7320 7072 6f76 6964 6564 2074  ty is provided t
-000100c0: 6872 6f75 6768 2046 6972 6574 6563 2066  hrough Firetec f
-000100d0: 696c 6573 2066 6f72 2061 6e20 6172 6269  iles for an arbi
-000100e0: 7472 6172 7920 6772 6964 2c0a 2020 2020  trary grid,.    
-000100f0: 2020 2020 3520 3d20 4661 7374 4675 656c      5 = FastFuel
-00010100: 7320 696e 7075 7420 2861 7373 756d 696e  s input (assumin
-00010110: 6720 756e 6966 6f72 6d20 647a 206f 6620  g uniform dz of 
-00010120: 316d 290a 2020 2020 6675 656c 5f64 656e  1m).    fuel_den
-00010130: 7369 7479 203a 2050 6f73 6974 6976 6546  sity : PositiveF
-00010140: 6c6f 6174 0a20 2020 2020 2020 2046 7565  loat.        Fue
-00010150: 6c20 6465 6e73 6974 7920 286b 672f 6d33  l density (kg/m3
-00010160: 290a 2020 2020 6675 656c 5f6d 6f69 7374  ).    fuel_moist
-00010170: 7572 655f 666c 6167 203a 204c 6974 6572  ure_flag : Liter
-00010180: 616c 5b31 2c20 322c 2033 2c20 345d 0a20  al[1, 2, 3, 4]. 
-00010190: 2020 2020 2020 2046 7565 6c20 6d6f 6973         Fuel mois
-000101a0: 7475 7265 2066 6c61 6720 2864 6566 6175  ture flag (defau
-000101b0: 6c74 7320 746f 2031 293a 0a20 2020 2020  lts to 1):.     
-000101c0: 2020 2031 203d 206d 6f69 7374 7572 6520     1 = moisture 
-000101d0: 6973 2075 6e69 666f 726d 206f 7665 7220  is uniform over 
-000101e0: 7468 6520 646f 6d61 696e 2c0a 2020 2020  the domain,.    
-000101f0: 2020 2020 3220 3d20 6d6f 6973 7475 7265      2 = moisture
-00010200: 2069 7320 7072 6f76 6964 6564 2074 6872   is provided thr
-00010210: 6f75 6768 2051 465f 4675 656c 4d6f 6973  ough QF_FuelMois
-00010220: 7475 7265 2e69 6e70 2c0a 2020 2020 2020  ture.inp,.      
-00010230: 2020 3320 3d20 6d6f 6973 7475 7265 2069    3 = moisture i
-00010240: 7320 7072 6f76 6964 6564 2074 6872 6f75  s provided throu
-00010250: 6768 2046 6972 6574 6563 2066 696c 6520  gh Firetec file 
-00010260: 2874 7265 6573 6d6f 6973 742e 6461 7429  (treesmoist.dat)
-00010270: 206d 6174 6368 696e 6720 5155 4943 2d46   matching QUIC-F
-00010280: 6972 6520 6772 6964 2c0a 2020 2020 2020  ire grid,.      
-00010290: 2020 3420 3d20 6d6f 6973 7475 7265 2069    4 = moisture i
-000102a0: 7320 7072 6f76 6964 6564 2074 6872 6f75  s provided throu
-000102b0: 6768 2046 6972 6574 6563 2066 696c 6573  gh Firetec files
-000102c0: 2066 6f72 2061 6e20 6172 6269 7472 6172   for an arbitrar
-000102d0: 7920 6772 6964 2c0a 2020 2020 2020 2020  y grid,.        
-000102e0: 3520 3d20 4661 7374 4675 656c 7320 696e  5 = FastFuels in
-000102f0: 7075 7420 2861 7373 756d 696e 6720 756e  put (assuming un
-00010300: 6966 6f72 6d20 647a 206f 6620 316d 290a  iform dz of 1m).
-00010310: 2020 2020 6675 656c 5f6d 6f69 7374 7572      fuel_moistur
-00010320: 6520 3a20 506f 7369 7469 7665 466c 6f61  e : PositiveFloa
-00010330: 740a 2020 2020 2020 2020 4675 656c 206d  t.        Fuel m
-00010340: 6f69 7374 7572 6520 3d20 6d61 7373 206f  oisture = mass o
-00010350: 6620 7761 7465 722f 6d61 7373 206f 6620  f water/mass of 
-00010360: 6472 7920 6675 656c 2028 6b67 2f6b 6729  dry fuel (kg/kg)
-00010370: 2e20 4d75 7374 2062 6520 6265 7477 6565  . Must be betwee
-00010380: 6e0a 2020 2020 2020 2020 3020 616e 6420  n.        0 and 
-00010390: 312e 0a20 2020 2066 7565 6c5f 6865 6967  1..    fuel_heig
-000103a0: 6874 5f66 6c61 6720 3a20 4c69 7465 7261  ht_flag : Litera
-000103b0: 6c5b 312c 2032 2c20 332c 2034 5d0a 2020  l[1, 2, 3, 4].  
-000103c0: 2020 2020 2020 4675 656c 2068 6569 6768        Fuel heigh
-000103d0: 7420 666c 6167 2028 6465 6661 756c 7473  t flag (defaults
-000103e0: 2074 6f20 3129 3a0a 2020 2020 2020 2020   to 1):.        
-000103f0: 3120 3d20 6865 6967 6874 2069 7320 756e  1 = height is un
-00010400: 6966 6f72 6d20 6f76 6572 2074 6865 2064  iform over the d
-00010410: 6f6d 6169 6e2c 0a20 2020 2020 2020 2032  omain,.        2
-00010420: 203d 2068 6569 6768 7420 6973 2070 726f   = height is pro
-00010430: 7669 6465 6420 7468 726f 7567 6820 5146  vided through QF
-00010440: 5f46 7565 6c48 6569 6768 742e 696e 702c  _FuelHeight.inp,
-00010450: 0a20 2020 2020 2020 2033 203d 2068 6569  .        3 = hei
-00010460: 6768 7420 6973 2070 726f 7669 6465 6420  ght is provided 
-00010470: 7468 726f 7567 6820 4669 7265 7465 6320  through Firetec 
-00010480: 6669 6c65 2028 7472 6565 7368 6569 6768  file (treesheigh
-00010490: 742e 6461 7429 206d 6174 6368 696e 6720  t.dat) matching 
-000104a0: 5155 4943 2d46 6972 6520 6772 6964 2c0a  QUIC-Fire grid,.
-000104b0: 2020 2020 2020 2020 3420 3d20 6865 6967          4 = heig
-000104c0: 6874 2069 7320 7072 6f76 6964 6564 2074  ht is provided t
-000104d0: 6872 6f75 6768 2046 6972 6574 6563 2066  hrough Firetec f
-000104e0: 696c 6573 2066 6f72 2061 6e20 6172 6269  iles for an arbi
-000104f0: 7472 6172 7920 6772 6964 2c0a 2020 2020  trary grid,.    
-00010500: 2020 2020 3520 3d20 4661 7374 4675 656c      5 = FastFuel
-00010510: 7320 696e 7075 7420 2861 7373 756d 696e  s input (assumin
-00010520: 6720 756e 6966 6f72 6d20 647a 206f 6620  g uniform dz of 
-00010530: 316d 290a 2020 2020 6675 656c 5f68 6569  1m).    fuel_hei
-00010540: 6768 7420 3a20 506f 7369 7469 7665 466c  ght : PositiveFl
-00010550: 6f61 740a 2020 2020 2020 2020 4675 656c  oat.        Fuel
-00010560: 2068 6569 6768 7420 6f66 2073 7572 6661   height of surfa
-00010570: 6365 206c 6179 6572 2028 6d29 0a20 2020  ce layer (m).   
-00010580: 2073 697a 655f 7363 616c 655f 666c 6167   size_scale_flag
-00010590: 203a 204c 6974 6572 616c 5b30 2c20 312c   : Literal[0, 1,
-000105a0: 2032 2c20 332c 2034 2c20 355d 0a20 2020   2, 3, 4, 5].   
-000105b0: 2020 2020 2053 697a 6520 7363 616c 6520       Size scale 
-000105c0: 666c 6167 2028 6465 6661 756c 7473 2074  flag (defaults t
-000105d0: 6f20 3029 3a0a 2020 2020 2020 2020 3020  o 0):.        0 
-000105e0: 3d20 4465 6661 756c 7420 7661 6c75 6520  = Default value 
-000105f0: 2830 2e30 3030 3529 206f 7665 7220 656e  (0.0005) over en
-00010600: 7469 7265 2064 6f6d 6169 6e2c 0a20 2020  tire domain,.   
-00010610: 2020 2020 2031 203d 2063 7573 746f 6d20       1 = custom 
-00010620: 756e 6966 6f72 6d20 7661 6c75 6520 6f76  uniform value ov
-00010630: 6572 2074 6865 2064 6f6d 6169 6e2c 0a20  er the domain,. 
-00010640: 2020 2020 2020 2032 203d 2063 7573 746f         2 = custo
-00010650: 6d20 7661 6c75 6520 7072 6f76 6964 6564  m value provided
-00010660: 2074 6872 6f75 6768 2051 465f 5369 7a65   through QF_Size
-00010670: 5363 616c 652e 696e 702c 0a20 2020 2020  Scale.inp,.     
-00010680: 2020 2033 203d 2063 7573 746f 6d20 7661     3 = custom va
-00010690: 6c75 6520 7072 6f76 6964 6564 2074 6872  lue provided thr
-000106a0: 6f75 6768 2046 6972 6574 6563 2066 696c  ough Firetec fil
-000106b0: 6520 2874 7265 6573 7373 2e64 6174 2920  e (treesss.dat) 
-000106c0: 6d61 7463 6869 6e67 2051 5549 432d 4669  matching QUIC-Fi
-000106d0: 7265 2067 7269 642c 0a20 2020 2020 2020  re grid,.       
-000106e0: 2034 203d 2063 7573 746f 6d20 7661 6c75   4 = custom valu
-000106f0: 6520 7072 6f76 6964 6564 2074 6872 6f75  e provided throu
-00010700: 6768 2046 6972 6574 6563 2066 696c 6573  gh Firetec files
-00010710: 2066 6f72 2061 6e20 6172 6269 7472 6172   for an arbitrar
-00010720: 7920 6772 6964 2c0a 2020 2020 2020 2020  y grid,.        
-00010730: 3520 3d20 4661 7374 4675 656c 7320 696e  5 = FastFuels in
-00010740: 7075 7420 2861 7373 756d 696e 6720 756e  put (assuming un
-00010750: 6966 6f72 6d20 647a 206f 6620 316d 290a  iform dz of 1m).
-00010760: 2020 2020 7369 7a65 5f73 6361 6c65 203a      size_scale :
-00010770: 2050 6f73 6974 6976 6546 6c6f 6174 0a20   PositiveFloat. 
-00010780: 2020 2020 2020 2053 697a 6520 7363 616c         Size scal
-00010790: 6520 286d 292e 2044 6566 6175 6c74 7320  e (m). Defaults 
-000107a0: 746f 2030 2e30 3030 352e 0a20 2020 2070  to 0.0005..    p
-000107b0: 6174 6368 5f61 6e64 5f67 6170 5f66 6c61  atch_and_gap_fla
-000107c0: 6720 3a20 4c69 7465 7261 6c5b 302c 2031  g : Literal[0, 1
-000107d0: 2c20 325d 0a20 2020 2020 2020 2050 6174  , 2].        Pat
-000107e0: 6368 2061 6e64 2067 6170 2066 6c61 6720  ch and gap flag 
-000107f0: 2864 6566 6175 6c74 7320 746f 2030 293a  (defaults to 0):
-00010800: 0a20 2020 2020 2020 2030 203d 2044 6566  .        0 = Def
-00010810: 6175 6c74 2076 616c 7565 7320 2830 2c20  ault values (0, 
-00010820: 3029 206f 7665 7220 656e 7469 7265 2064  0) over entire d
-00010830: 6f6d 6169 6e2c 0a20 2020 2020 2020 2031  omain,.        1
-00010840: 203d 2063 7573 746f 6d20 756e 6966 6f72   = custom unifor
-00010850: 6d20 7661 6c75 6573 206f 7665 7220 7468  m values over th
-00010860: 6520 646f 6d61 696e 2c0a 2020 2020 2020  e domain,.      
-00010870: 2020 3220 3d20 6375 7374 6f6d 2076 616c    2 = custom val
-00010880: 7565 7320 7072 6f76 6964 6564 2062 7920  ues provided by 
-00010890: 7061 7463 682e 6461 7420 616e 6420 6761  patch.dat and ga
-000108a0: 702e 6461 740a 2020 2020 6967 6e69 7469  p.dat.    igniti
-000108b0: 6f6e 5f74 7970 653a 2049 676e 6974 696f  on_type: Ignitio
-000108c0: 6e54 7970 650a 2020 2020 2020 2020 4967  nType.        Ig
-000108d0: 6e69 7469 6f6e 2074 7970 6520 7370 6563  nition type spec
-000108e0: 6966 6965 6420 6173 2061 6e20 4967 6e69  ified as an Igni
-000108f0: 7469 6f6e 7354 7970 6520 636c 6173 7320  tionsType class 
-00010900: 6672 6f6d 2069 676e 6974 696f 6e73 2e70  from ignitions.p
-00010910: 790a 2020 2020 2020 2020 3120 3d20 7265  y.        1 = re
-00010920: 6374 616e 676c 650a 2020 2020 2020 2020  ctangle.        
-00010930: 3220 3d20 7371 7561 7265 2072 696e 670a  2 = square ring.
-00010940: 2020 2020 2020 2020 3320 3d20 6369 7263          3 = circ
-00010950: 756c 6172 2072 696e 670a 2020 2020 2020  ular ring.      
-00010960: 2020 3620 3d20 6967 6e69 7465 2e64 6174    6 = ignite.dat
-00010970: 2028 4669 7265 7465 6320 6669 6c65 290a   (Firetec file).
-00010980: 2020 2020 6967 6e69 7469 6f6e 735f 7065      ignitions_pe
-00010990: 725f 6365 6c6c 203a 2050 6f73 6974 6976  r_cell : Positiv
-000109a0: 6549 6e74 0a20 2020 2020 2020 204e 756d  eInt.        Num
-000109b0: 6265 7220 6f66 2069 676e 6974 696f 6e20  ber of ignition 
-000109c0: 7065 7220 6365 6c6c 206f 6620 7468 6520  per cell of the 
-000109d0: 6669 7265 206d 6f64 656c 2e20 5265 636f  fire model. Reco
-000109e0: 6d6d 656e 6465 6420 6d61 7820 7661 6c75  mmended max valu
-000109f0: 650a 2020 2020 2020 2020 6f66 2031 3030  e.        of 100
-00010a00: 0a20 2020 2066 6972 6562 7261 6e64 5f66  .    firebrand_f
-00010a10: 6c61 6720 3a20 4c69 7465 7261 6c5b 302c  lag : Literal[0,
-00010a20: 2031 5d0a 2020 2020 2020 2020 4669 7265   1].        Fire
-00010a30: 6272 616e 6420 666c 6167 2c20 3020 3d20  brand flag, 0 = 
-00010a40: 6f66 663b 2031 203d 206f 6e2e 2052 6563  off; 1 = on. Rec
-00010a50: 6f6d 6d65 6e64 6564 2076 616c 7565 203d  ommended value =
-00010a60: 2030 3b20 6669 7265 6272 616e 6473 0a20   0; firebrands. 
-00010a70: 2020 2020 2020 2061 7265 2075 6e74 6573         are untes
-00010a80: 7465 6420 666f 7220 736d 616c 6c20 7363  ted for small sc
-00010a90: 616c 6520 7072 6f62 6c65 6d73 0a20 2020  ale problems.   
-00010aa0: 2061 7574 6f5f 6b69 6c6c 203a 204c 6974   auto_kill : Lit
-00010ab0: 6572 616c 5b30 2c20 315d 0a20 2020 2020  eral[0, 1].     
-00010ac0: 2020 204b 696c 6c20 6966 2074 6865 2066     Kill if the f
-00010ad0: 6972 6520 6973 206f 7574 2061 6e64 2074  ire is out and t
-00010ae0: 6865 7265 2061 7265 206e 6f20 6d6f 7265  here are no more
-00010af0: 2069 676e 6974 696f 6e73 206f 7220 6669   ignitions or fi
-00010b00: 7265 6272 616e 6473 0a20 2020 2020 2020  rebrands.       
-00010b10: 2028 3020 3d20 6e6f 2c20 3120 3d20 7965   (0 = no, 1 = ye
-00010b20: 7329 0a20 2020 2065 6e67 5f74 6f5f 6174  s).    eng_to_at
-00010b30: 6d5f 6f75 7420 3a20 4c69 7465 7261 6c5b  m_out : Literal[
-00010b40: 302c 2031 5d0a 2020 2020 2020 2020 4f75  0, 1].        Ou
-00010b50: 7470 7574 2066 6c61 6720 5b30 2c20 315d  tput flag [0, 1]
-00010b60: 3a20 6772 6964 6465 6420 656e 6572 6779  : gridded energy
-00010b70: 2d74 6f2d 6174 6d6f 7370 6865 7265 0a20  -to-atmosphere. 
-00010b80: 2020 2020 2020 2028 3344 2066 6972 6520         (3D fire 
-00010b90: 6772 6964 202b 2065 7874 7261 206c 6179  grid + extra lay
-00010ba0: 6572 7329 0a20 2020 2072 6561 6374 5f72  ers).    react_r
-00010bb0: 6174 655f 6f75 7420 3a20 4c69 7465 7261  ate_out : Litera
-00010bc0: 6c5b 302c 2031 5d0a 2020 2020 2020 2020  l[0, 1].        
-00010bd0: 4f75 7470 7574 2066 6c61 6720 5b30 2c20  Output flag [0, 
-00010be0: 315d 3a20 636f 6d70 7265 7373 6564 2061  1]: compressed a
-00010bf0: 7272 6179 2072 6561 6374 696f 6e20 7261  rray reaction ra
-00010c00: 7465 2028 6669 7265 2067 7269 6429 0a20  te (fire grid). 
-00010c10: 2020 2066 7565 6c5f 6465 6e73 5f6f 7574     fuel_dens_out
-00010c20: 203a 204c 6974 6572 616c 5b30 2c20 315d   : Literal[0, 1]
-00010c30: 0a20 2020 2020 2020 204f 7574 7075 7420  .        Output 
-00010c40: 666c 6167 205b 302c 2031 5d3a 2063 6f6d  flag [0, 1]: com
-00010c50: 7072 6573 7365 6420 6172 7261 7920 6675  pressed array fu
-00010c60: 656c 2064 656e 7369 7479 2028 6669 7265  el density (fire
-00010c70: 2067 7269 6429 0a20 2020 2071 665f 7769   grid).    qf_wi
-00010c80: 6e64 5f6f 7574 203a 204c 6974 6572 616c  nd_out : Literal
-00010c90: 5b30 2c20 315d 0a20 2020 2020 2020 204f  [0, 1].        O
-00010ca0: 7574 7075 7420 666c 6167 205b 302c 2031  utput flag [0, 1
-00010cb0: 5d3a 2067 7269 6464 6564 2077 696e 6420  ]: gridded wind 
-00010cc0: 2875 2c76 2c77 2c73 6967 6d61 2920 2833  (u,v,w,sigma) (3
-00010cd0: 4420 6669 7265 2067 7269 6429 0a20 2020  D fire grid).   
-00010ce0: 2071 755f 7769 6e64 5f69 6e73 745f 6f75   qu_wind_inst_ou
-00010cf0: 7420 3a20 4c69 7465 7261 6c5b 302c 2031  t : Literal[0, 1
-00010d00: 5d0a 2020 2020 2020 2020 4f75 7470 7574  ].        Output
-00010d10: 2066 6c61 6720 5b30 2c20 315d 3a20 6772   flag [0, 1]: gr
-00010d20: 6964 6465 6420 5155 2077 696e 6473 2077  idded QU winds w
-00010d30: 6974 6820 6669 7265 2065 6666 6563 7473  ith fire effects
-00010d40: 2c20 696e 7374 616e 7461 6e65 6f75 730a  , instantaneous.
-00010d50: 2020 2020 2020 2020 2851 5549 432d 5552          (QUIC-UR
-00010d60: 4220 6772 6964 290a 2020 2020 7175 5f77  B grid).    qu_w
-00010d70: 696e 645f 6176 675f 6f75 7420 3a20 4c69  ind_avg_out : Li
-00010d80: 7465 7261 6c5b 302c 2031 5d0a 2020 2020  teral[0, 1].    
-00010d90: 2020 2020 4f75 7470 7574 2066 6c61 6720      Output flag 
-00010da0: 5b30 2c20 315d 3a20 6772 6964 6465 6420  [0, 1]: gridded 
-00010db0: 5155 2077 696e 6473 2077 6974 6820 6669  QU winds with fi
-00010dc0: 7265 2065 6666 6563 7473 2c20 6176 6572  re effects, aver
-00010dd0: 6167 6564 0a20 2020 2020 2020 2028 5155  aged.        (QU
-00010de0: 4943 2d55 5242 2067 7269 6429 0a20 2020  IC-URB grid).   
-00010df0: 2066 7565 6c5f 6d6f 6973 745f 6f75 7420   fuel_moist_out 
-00010e00: 3a20 4c69 7465 7261 6c5b 302c 2031 5d0a  : Literal[0, 1].
-00010e10: 2020 2020 2020 2020 4f75 7470 7574 2066          Output f
-00010e20: 6c61 6720 5b30 2c20 315d 3a20 636f 6d70  lag [0, 1]: comp
-00010e30: 7265 7373 6564 2061 7272 6179 2066 7565  ressed array fue
-00010e40: 6c20 6d6f 6973 7475 7265 2028 6669 7265  l moisture (fire
-00010e50: 2067 7269 6429 0a20 2020 206d 6173 735f   grid).    mass_
-00010e60: 6275 726e 745f 6f75 7420 3a20 4c69 7465  burnt_out : Lite
-00010e70: 7261 6c5b 302c 2031 5d0a 2020 2020 2020  ral[0, 1].      
-00010e80: 2020 4f75 7470 7574 2066 6c61 6720 5b30    Output flag [0
-00010e90: 2c20 315d 3a20 7665 7274 6963 616c 6c79  , 1]: vertically
-00010ea0: 2d69 6e74 6567 7261 7465 6420 2520 6d61  -integrated % ma
-00010eb0: 7373 2062 7572 6e74 2028 6669 7265 2067  ss burnt (fire g
-00010ec0: 7269 6429 0a20 2020 2066 6972 6562 7261  rid).    firebra
-00010ed0: 6e64 5f6f 7574 203a 204c 6974 6572 616c  nd_out : Literal
-00010ee0: 5b30 2c20 315d 0a20 2020 2020 2020 204f  [0, 1].        O
-00010ef0: 7574 7075 7420 666c 6167 205b 302c 2031  utput flag [0, 1
-00010f00: 5d3a 2066 6972 6562 7261 6e64 2074 7261  ]: firebrand tra
-00010f10: 6a65 6374 6f72 6965 732e 204d 7573 7420  jectories. Must 
-00010f20: 6265 2030 2077 6865 6e20 6669 7265 6272  be 0 when firebr
-00010f30: 616e 640a 2020 2020 2020 2020 666c 6167  and.        flag
-00010f40: 2069 7320 300a 2020 2020 656d 6973 7369   is 0.    emissi
-00010f50: 6f6e 735f 6f75 7420 3a20 4c69 7465 7261  ons_out : Litera
-00010f60: 6c5b 302c 2031 2c20 322c 2033 2c20 342c  l[0, 1, 2, 3, 4,
-00010f70: 2035 5d0a 2020 2020 2020 2020 4f75 7470   5].        Outp
-00010f80: 7574 2066 6c61 6720 5b30 2c20 355d 3a20  ut flag [0, 5]: 
-00010f90: 636f 6d70 7265 7373 6564 2061 7272 6179  compressed array
-00010fa0: 2065 6d69 7373 696f 6e73 2028 6669 7265   emissions (fire
-00010fb0: 2067 7269 6429 3a0a 2020 2020 2020 2020   grid):.        
-00010fc0: 2020 2020 3020 3d20 646f 206e 6f74 206f      0 = do not o
-00010fd0: 7574 7075 7420 616e 7920 656d 6973 7369  utput any emissi
-00010fe0: 6f6e 2072 656c 6174 6564 2076 6172 6961  on related varia
-00010ff0: 626c 6573 0a20 2020 2020 2020 2020 2020  bles.           
-00011000: 2031 203d 206f 7574 7075 7420 656d 6973   1 = output emis
-00011010: 7369 6f6e 7320 6669 6c65 7320 616e 6420  sions files and 
-00011020: 7369 6d75 6c61 7465 2043 4f20 696e 2051  simulate CO in Q
-00011030: 5549 432d 534d 4f4b 450a 2020 2020 2020  UIC-SMOKE.      
-00011040: 2020 2020 2020 3220 3d20 6f75 7470 7574        2 = output
-00011050: 2065 6d69 7373 696f 6e73 2066 696c 6573   emissions files
-00011060: 2061 6e64 2073 696d 756c 6174 6520 504d   and simulate PM
-00011070: 322e 3520 696e 2051 5549 432d 2053 4d4f  2.5 in QUIC- SMO
-00011080: 4b45 0a20 2020 2020 2020 2020 2020 2033  KE.            3
-00011090: 203d 206f 7574 7075 7420 656d 6973 7369   = output emissi
-000110a0: 6f6e 7320 6669 6c65 7320 616e 6420 7369  ons files and si
-000110b0: 6d75 6c61 7465 2062 6f74 6820 434f 2061  mulate both CO a
-000110c0: 6e64 2050 4d32 2e35 2069 6e0a 2020 2020  nd PM2.5 in.    
-000110d0: 2020 2020 2020 2020 2020 2020 5155 4943              QUIC
-000110e0: 2d53 4d4f 4b45 0a20 2020 2020 2020 2020  -SMOKE.         
-000110f0: 2020 2034 203d 206f 7574 7075 7420 656d     4 = output em
-00011100: 6973 7369 6f6e 7320 6669 6c65 7320 6275  issions files bu
-00011110: 7420 7573 6520 6c69 6272 6172 7920 6170  t use library ap
-00011120: 7072 6f61 6368 2069 6e20 5155 4943 2d53  proach in QUIC-S
-00011130: 4d4f 4b45 0a20 2020 2020 2020 2020 2020  MOKE.           
-00011140: 2035 203d 206f 7574 7075 7420 656d 6973   5 = output emis
-00011150: 7369 6f6e 7320 6669 6c65 7320 616e 6420  sions files and 
-00011160: 7369 6d75 6c61 7465 2062 6f74 6820 7761  simulate both wa
-00011170: 7465 7220 696e 2051 5549 432d 534d 4f4b  ter in QUIC-SMOK
-00011180: 450a 2020 2020 7261 6469 6174 696f 6e5f  E.    radiation_
-00011190: 6f75 7420 3a20 4c69 7465 7261 6c5b 302c  out : Literal[0,
-000111a0: 2031 5d0a 2020 2020 2020 2020 4f75 7470   1].        Outp
-000111b0: 7574 2066 6c61 6720 5b30 2c20 315d 3a20  ut flag [0, 1]: 
-000111c0: 6772 6964 6465 6420 7468 6572 6d61 6c20  gridded thermal 
-000111d0: 7261 6469 6174 696f 6e20 2866 6972 6520  radiation (fire 
-000111e0: 6772 6964 290a 2020 2020 696e 7465 6e73  grid).    intens
-000111f0: 6974 795f 6f75 7420 3a20 4c69 7465 7261  ity_out : Litera
-00011200: 6c5b 302c 2031 5d0a 2020 2020 2020 2020  l[0, 1].        
-00011210: 4f75 7470 7574 2066 6c61 6720 5b30 2c20  Output flag [0, 
-00011220: 315d 3a20 7375 7266 6163 6520 6669 7265  1]: surface fire
-00011230: 2069 6e74 656e 7369 7479 2061 7420 6576   intensity at ev
-00011240: 6572 7920 6669 7265 2074 696d 6520 7374  ery fire time st
-00011250: 6570 0a20 2020 2022 2222 0a0a 2020 2020  ep.    """..    
-00011260: 6e61 6d65 3a20 7374 7220 3d20 2251 5549  name: str = "QUI
-00011270: 435f 6669 7265 220a 2020 2020 5f65 7874  C_fire".    _ext
-00011280: 656e 7369 6f6e 3a20 7374 7220 3d20 222e  ension: str = ".
-00011290: 696e 7022 0a20 2020 2066 6972 655f 666c  inp".    fire_fl
-000112a0: 6167 3a20 4c69 7465 7261 6c5b 302c 2031  ag: Literal[0, 1
-000112b0: 5d20 3d20 310a 2020 2020 7261 6e64 6f6d  ] = 1.    random
-000112c0: 5f73 6565 643a 2069 6e74 203d 2046 6965  _seed: int = Fie
-000112d0: 6c64 2867 653d 2d31 2c20 6465 6661 756c  ld(ge=-1, defaul
-000112e0: 743d 2d31 290a 2020 2020 7469 6d65 5f6e  t=-1).    time_n
-000112f0: 6f77 3a20 506f 7369 7469 7665 496e 740a  ow: PositiveInt.
-00011300: 2020 2020 7369 6d5f 7469 6d65 3a20 506f      sim_time: Po
-00011310: 7369 7469 7665 496e 740a 2020 2020 6669  sitiveInt.    fi
-00011320: 7265 5f74 696d 655f 7374 6570 3a20 506f  re_time_step: Po
-00011330: 7369 7469 7665 496e 7420 3d20 310a 2020  sitiveInt = 1.  
-00011340: 2020 7175 6963 5f74 696d 655f 7374 6570    quic_time_step
-00011350: 3a20 506f 7369 7469 7665 496e 7420 3d20  : PositiveInt = 
-00011360: 310a 2020 2020 6f75 745f 7469 6d65 5f66  1.    out_time_f
-00011370: 6972 653a 2050 6f73 6974 6976 6549 6e74  ire: PositiveInt
-00011380: 203d 2033 300a 2020 2020 6f75 745f 7469   = 30.    out_ti
-00011390: 6d65 5f77 696e 643a 2050 6f73 6974 6976  me_wind: Positiv
-000113a0: 6549 6e74 203d 2033 300a 2020 2020 6f75  eInt = 30.    ou
-000113b0: 745f 7469 6d65 5f65 6d69 735f 7261 643a  t_time_emis_rad:
-000113c0: 2050 6f73 6974 6976 6549 6e74 203d 2033   PositiveInt = 3
-000113d0: 300a 2020 2020 6f75 745f 7469 6d65 5f77  0.    out_time_w
-000113e0: 696e 645f 6176 673a 2050 6f73 6974 6976  ind_avg: Positiv
-000113f0: 6549 6e74 203d 2033 300a 2020 2020 6e7a  eInt = 30.    nz
-00011400: 3a20 506f 7369 7469 7665 496e 740a 2020  : PositiveInt.  
-00011410: 2020 7374 7265 7463 685f 6772 6964 5f66    stretch_grid_f
-00011420: 6c61 673a 204c 6974 6572 616c 5b30 2c20  lag: Literal[0, 
-00011430: 315d 203d 2030 0a20 2020 2064 7a3a 2050  1] = 0.    dz: P
-00011440: 6f73 6974 6976 6549 6e74 203d 2031 0a20  ositiveInt = 1. 
-00011450: 2020 2064 7a5f 6172 7261 793a 206c 6973     dz_array: lis
-00011460: 745b 506f 7369 7469 7665 466c 6f61 745d  t[PositiveFloat]
-00011470: 203d 205b 5d0a 2020 2020 6675 656c 5f64   = [].    fuel_d
-00011480: 656e 7369 7479 5f66 6c61 673a 204c 6974  ensity_flag: Lit
-00011490: 6572 616c 5b31 2c20 322c 2033 2c20 345d  eral[1, 2, 3, 4]
-000114a0: 203d 2031 0a20 2020 2066 7565 6c5f 6465   = 1.    fuel_de
-000114b0: 6e73 6974 793a 2055 6e69 6f6e 5b50 6f73  nsity: Union[Pos
-000114c0: 6974 6976 6546 6c6f 6174 2c20 4e6f 6e65  itiveFloat, None
-000114d0: 5d20 3d20 302e 350a 2020 2020 6675 656c  ] = 0.5.    fuel
-000114e0: 5f6d 6f69 7374 7572 655f 666c 6167 3a20  _moisture_flag: 
-000114f0: 4c69 7465 7261 6c5b 312c 2032 2c20 332c  Literal[1, 2, 3,
-00011500: 2034 5d20 3d20 310a 2020 2020 6675 656c   4] = 1.    fuel
-00011510: 5f6d 6f69 7374 7572 653a 2055 6e69 6f6e  _moisture: Union
-00011520: 5b50 6f73 6974 6976 6546 6c6f 6174 2c20  [PositiveFloat, 
-00011530: 4e6f 6e65 5d20 3d20 302e 310a 2020 2020  None] = 0.1.    
-00011540: 6675 656c 5f68 6569 6768 745f 666c 6167  fuel_height_flag
-00011550: 3a20 4c69 7465 7261 6c5b 312c 2032 2c20  : Literal[1, 2, 
-00011560: 332c 2034 5d20 3d20 310a 2020 2020 6675  3, 4] = 1.    fu
-00011570: 656c 5f68 6569 6768 743a 2055 6e69 6f6e  el_height: Union
-00011580: 5b50 6f73 6974 6976 6546 6c6f 6174 2c20  [PositiveFloat, 
-00011590: 4e6f 6e65 5d20 3d20 312e 300a 2020 2020  None] = 1.0.    
-000115a0: 7369 7a65 5f73 6361 6c65 5f66 6c61 673a  size_scale_flag:
-000115b0: 204c 6974 6572 616c 5b30 2c20 312c 2032   Literal[0, 1, 2
-000115c0: 2c20 332c 2034 2c20 355d 203d 2030 0a20  , 3, 4, 5] = 0. 
-000115d0: 2020 2073 697a 655f 7363 616c 653a 2050     size_scale: P
-000115e0: 6f73 6974 6976 6546 6c6f 6174 203d 2030  ositiveFloat = 0
-000115f0: 2e30 3030 350a 2020 2020 7061 7463 685f  .0005.    patch_
-00011600: 616e 645f 6761 705f 666c 6167 3a20 4c69  and_gap_flag: Li
-00011610: 7465 7261 6c5b 302c 2031 2c20 325d 203d  teral[0, 1, 2] =
-00011620: 2030 0a20 2020 2070 6174 6368 5f73 697a   0.    patch_siz
-00011630: 653a 204e 6f6e 4e65 6761 7469 7665 466c  e: NonNegativeFl
-00011640: 6f61 7420 3d20 300a 2020 2020 6761 705f  oat = 0.    gap_
-00011650: 7369 7a65 3a20 4e6f 6e4e 6567 6174 6976  size: NonNegativ
-00011660: 6546 6c6f 6174 203d 2030 0a20 2020 2069  eFloat = 0.    i
-00011670: 676e 6974 696f 6e5f 7479 7065 3a20 556e  gnition_type: Un
-00011680: 696f 6e5b 0a20 2020 2020 2020 2052 6563  ion[.        Rec
-00011690: 7461 6e67 6c65 4967 6e69 7469 6f6e 2c20  tangleIgnition, 
-000116a0: 5371 7561 7265 5269 6e67 4967 6e69 7469  SquareRingIgniti
-000116b0: 6f6e 2c20 4369 7263 756c 6172 5269 6e67  on, CircularRing
-000116c0: 4967 6e69 7469 6f6e 2c20 4967 6e69 7469  Ignition, Igniti
-000116d0: 6f6e 5479 7065 0a20 2020 205d 0a20 2020  onType.    ].   
-000116e0: 2069 676e 6974 696f 6e73 5f70 6572 5f63   ignitions_per_c
-000116f0: 656c 6c3a 2050 6f73 6974 6976 6549 6e74  ell: PositiveInt
-00011700: 203d 2032 0a20 2020 2066 6972 6562 7261   = 2.    firebra
-00011710: 6e64 5f66 6c61 673a 204c 6974 6572 616c  nd_flag: Literal
-00011720: 5b30 2c20 315d 203d 2030 0a20 2020 2061  [0, 1] = 0.    a
-00011730: 7574 6f5f 6b69 6c6c 3a20 4c69 7465 7261  uto_kill: Litera
-00011740: 6c5b 302c 2031 5d20 3d20 310a 2020 2020  l[0, 1] = 1.    
-00011750: 656e 675f 746f 5f61 746d 5f6f 7574 3a20  eng_to_atm_out: 
-00011760: 4c69 7465 7261 6c5b 302c 2031 5d20 3d20  Literal[0, 1] = 
-00011770: 300a 2020 2020 7265 6163 745f 7261 7465  0.    react_rate
-00011780: 5f6f 7574 3a20 4c69 7465 7261 6c5b 302c  _out: Literal[0,
-00011790: 2031 5d20 3d20 300a 2020 2020 6675 656c   1] = 0.    fuel
-000117a0: 5f64 656e 735f 6f75 743a 204c 6974 6572  _dens_out: Liter
-000117b0: 616c 5b30 2c20 315d 203d 2031 0a20 2020  al[0, 1] = 1.   
-000117c0: 2071 665f 7769 6e64 5f6f 7574 3a20 4c69   qf_wind_out: Li
-000117d0: 7465 7261 6c5b 302c 2031 5d20 3d20 300a  teral[0, 1] = 0.
-000117e0: 2020 2020 7175 5f77 696e 645f 696e 7374      qu_wind_inst
-000117f0: 5f6f 7574 3a20 4c69 7465 7261 6c5b 302c  _out: Literal[0,
-00011800: 2031 5d20 3d20 310a 2020 2020 7175 5f77   1] = 1.    qu_w
-00011810: 696e 645f 6176 675f 6f75 743a 204c 6974  ind_avg_out: Lit
-00011820: 6572 616c 5b30 2c20 315d 203d 2030 0a20  eral[0, 1] = 0. 
-00011830: 2020 2066 7565 6c5f 6d6f 6973 745f 6f75     fuel_moist_ou
-00011840: 743a 204c 6974 6572 616c 5b30 2c20 315d  t: Literal[0, 1]
-00011850: 203d 2030 0a20 2020 206d 6173 735f 6275   = 0.    mass_bu
-00011860: 726e 745f 6f75 743a 204c 6974 6572 616c  rnt_out: Literal
-00011870: 5b30 2c20 315d 203d 2030 0a20 2020 2066  [0, 1] = 0.    f
-00011880: 6972 6562 7261 6e64 5f6f 7574 3a20 4c69  irebrand_out: Li
-00011890: 7465 7261 6c5b 302c 2031 5d20 3d20 300a  teral[0, 1] = 0.
-000118a0: 2020 2020 656d 6973 7369 6f6e 735f 6f75      emissions_ou
-000118b0: 743a 204c 6974 6572 616c 5b30 2c20 312c  t: Literal[0, 1,
-000118c0: 2032 2c20 332c 2034 2c20 355d 203d 2030   2, 3, 4, 5] = 0
-000118d0: 0a20 2020 2072 6164 6961 7469 6f6e 5f6f  .    radiation_o
-000118e0: 7574 3a20 4c69 7465 7261 6c5b 302c 2031  ut: Literal[0, 1
-000118f0: 5d20 3d20 300a 2020 2020 7375 7266 5f65  ] = 0.    surf_e
-00011900: 6e67 5f6f 7574 3a20 4c69 7465 7261 6c5b  ng_out: Literal[
-00011910: 302c 2031 5d20 3d20 300a 0a20 2020 2040  0, 1] = 0..    @
-00011920: 6669 656c 645f 7661 6c69 6461 746f 7228  field_validator(
-00011930: 2272 616e 646f 6d5f 7365 6564 2229 0a20  "random_seed"). 
-00011940: 2020 2040 636c 6173 736d 6574 686f 640a     @classmethod.
-00011950: 2020 2020 6465 6620 7661 6c69 6461 7465      def validate
-00011960: 5f72 616e 646f 6d5f 7365 6564 2863 6c73  _random_seed(cls
-00011970: 2c20 763a 2069 6e74 2920 2d3e 2069 6e74  , v: int) -> int
-00011980: 3a0a 2020 2020 2020 2020 6966 2076 203d  :.        if v =
-00011990: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
-000119a0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-000119b0: 7228 2251 5549 435f 6669 7265 2e69 6e70  r("QUIC_fire.inp
-000119c0: 3a20 7261 6e64 6f6d 5f73 6565 6420 6d75  : random_seed mu
-000119d0: 7374 2062 6520 6e6f 7420 6265 2030 2229  st be not be 0")
-000119e0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000119f0: 760a 0a20 2020 2040 636f 6d70 7574 6564  v..    @computed
-00011a00: 5f66 6965 6c64 0a20 2020 2040 7072 6f70  _field.    @prop
-00011a10: 6572 7479 0a20 2020 2064 6566 205f 7374  erty.    def _st
-00011a20: 7265 7463 685f 6772 6964 5f69 6e70 7574  retch_grid_input
-00011a30: 2873 656c 6629 202d 3e20 7374 723a 0a20  (self) -> str:. 
-00011a40: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00011a50: 2020 2057 7269 7465 7320 6120 6375 7374     Writes a cust
-00011a60: 6f6d 2073 7472 6574 6368 2067 7269 6420  om stretch grid 
-00011a70: 746f 2051 5549 435f 6669 7265 2e69 6e70  to QUIC_fire.inp
-00011a80: 2c20 6966 2070 726f 7669 6465 642e 0a20  , if provided.. 
-00011a90: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00011aa0: 2020 2069 6620 7365 6c66 2e73 7472 6574     if self.stret
-00011ab0: 6368 5f67 7269 645f 666c 6167 203d 3d20  ch_grid_flag == 
-00011ac0: 313a 0a20 2020 2020 2020 2020 2020 2023  1:.            #
-00011ad0: 2056 6572 6966 7920 7468 6174 2064 7a5f   Verify that dz_
-00011ae0: 6172 7261 7920 6973 206e 6f74 2065 6d70  array is not emp
-00011af0: 7479 0a20 2020 2020 2020 2020 2020 2069  ty.            i
-00011b00: 6620 6e6f 7420 7365 6c66 2e64 7a5f 6172  f not self.dz_ar
-00011b10: 7261 793a 0a20 2020 2020 2020 2020 2020  ray:.           
-00011b20: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00011b30: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-00011b40: 2020 2020 2020 2020 2020 2022 647a 5f61             "dz_a
-00011b50: 7272 6179 206d 7573 7420 6e6f 7420 6265  rray must not be
-00011b60: 2065 6d70 7479 2069 6620 7374 7265 7463   empty if stretc
-00011b70: 685f 6772 6964 5f66 6c61 6720 220a 2020  h_grid_flag ".  
-00011b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011b90: 2020 2269 7320 312e 2050 6c65 6173 6520    "is 1. Please 
-00011ba0: 7072 6f76 6964 6520 6120 647a 5f61 7272  provide a dz_arr
-00011bb0: 6179 2077 6974 6820 6e7a 2065 6c65 6d65  ay with nz eleme
-00011bc0: 6e74 7322 0a20 2020 2020 2020 2020 2020  nts".           
-00011bd0: 2020 2020 2020 2020 2022 206f 7220 7573           " or us
-00011be0: 6520 6120 6469 6666 6572 656e 7420 7374  e a different st
-00011bf0: 7265 7463 685f 6772 6964 5f66 6c61 672e  retch_grid_flag.
-00011c00: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00011c10: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
-00011c20: 2023 2056 6572 6966 7920 7468 6174 206e   # Verify that n
-00011c30: 7a20 6973 2065 7175 616c 2074 6f20 7468  z is equal to th
-00011c40: 6520 6c65 6e67 7468 206f 6620 647a 5f61  e length of dz_a
-00011c50: 7272 6179 0a20 2020 2020 2020 2020 2020  rray.           
-00011c60: 2069 6620 7365 6c66 2e6e 7a20 213d 206c   if self.nz != l
-00011c70: 656e 2873 656c 662e 647a 5f61 7272 6179  en(self.dz_array
-00011c80: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00011c90: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-00011ca0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-00011cb0: 2020 2020 2020 2020 2066 226e 7a20 6d75           f"nz mu
-00011cc0: 7374 2062 6520 6571 7561 6c20 746f 2074  st be equal to t
-00011cd0: 6865 206c 656e 6774 6820 6f66 2064 7a5f  he length of dz_
-00011ce0: 6172 7261 792e 2022 0a20 2020 2020 2020  array. ".       
-00011cf0: 2020 2020 2020 2020 2020 2020 2066 227b               f"{
-00011d00: 7365 6c66 2e6e 7a7d 2021 3d20 7b6c 656e  self.nz} != {len
-00011d10: 2873 656c 662e 647a 5f61 7272 6179 297d  (self.dz_array)}
-00011d20: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00011d30: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
-00011d40: 2023 2057 7269 7465 2064 7a5f 6172 7261   # Write dz_arra
-00011d50: 7920 6c69 6e65 730a 2020 2020 2020 2020  y lines.        
-00011d60: 2020 2020 647a 5f61 7272 6179 5f6c 696e      dz_array_lin
-00011d70: 6573 5f6c 6973 7420 3d20 5b5d 0a20 2020  es_list = [].   
-00011d80: 2020 2020 2020 2020 2066 6f72 2064 7a20           for dz 
-00011d90: 696e 2073 656c 662e 647a 5f61 7272 6179  in self.dz_array
-00011da0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00011db0: 2020 647a 5f61 7272 6179 5f6c 696e 6573    dz_array_lines
-00011dc0: 5f6c 6973 742e 6170 7065 6e64 2866 227b  _list.append(f"{
-00011dd0: 666c 6f61 7428 647a 297d 2229 0a20 2020  float(dz)}").   
-00011de0: 2020 2020 2020 2020 2064 7a5f 6172 7261           dz_arra
-00011df0: 795f 6c69 6e65 7320 3d20 225c 6e22 2e6a  y_lines = "\n".j
-00011e00: 6f69 6e28 647a 5f61 7272 6179 5f6c 696e  oin(dz_array_lin
-00011e10: 6573 5f6c 6973 7429 0a0a 2020 2020 2020  es_list)..      
-00011e20: 2020 2020 2020 7265 7475 726e 2066 227b        return f"{
-00011e30: 647a 5f61 7272 6179 5f6c 696e 6573 7d5c  dz_array_lines}\
-00011e40: 6e22 0a20 2020 2020 2020 2065 6c73 653a  n".        else:
-00011e50: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00011e60: 7572 6e20 7374 7228 7365 6c66 2e64 7a29  urn str(self.dz)
-00011e70: 0a0a 2020 2020 4063 6f6d 7075 7465 645f  ..    @computed_
-00011e80: 6669 656c 640a 2020 2020 4070 726f 7065  field.    @prope
-00011e90: 7274 790a 2020 2020 6465 6620 5f69 676e  rty.    def _ign
-00011ea0: 6974 696f 6e5f 6c69 6e65 7328 7365 6c66  ition_lines(self
-00011eb0: 2920 2d3e 2073 7472 3a0a 2020 2020 2020  ) -> str:.      
-00011ec0: 2020 7265 7475 726e 2073 7472 2873 656c    return str(sel
-00011ed0: 662e 6967 6e69 7469 6f6e 5f74 7970 6529  f.ignition_type)
-00011ee0: 0a0a 2020 2020 4063 6f6d 7075 7465 645f  ..    @computed_
-00011ef0: 6669 656c 640a 2020 2020 4070 726f 7065  field.    @prope
-00011f00: 7274 790a 2020 2020 6465 6620 5f66 7565  rty.    def _fue
-00011f10: 6c5f 6465 6e73 6974 795f 6c69 6e65 7328  l_density_lines(
-00011f20: 7365 6c66 2920 2d3e 2073 7472 3a0a 2020  self) -> str:.  
-00011f30: 2020 2020 2020 6675 656c 5f64 656e 7369        fuel_densi
-00011f40: 7479 5f66 6c61 675f 6c69 6e65 203d 2066  ty_flag_line = f
-00011f50: 227b 7365 6c66 2e66 7565 6c5f 6465 6e73  "{self.fuel_dens
-00011f60: 6974 795f 666c 6167 7d5c 7421 2066 7565  ity_flag}\t! fue
-00011f70: 6c20 6465 6e73 6974 7920 666c 6167 220a  l density flag".
-00011f80: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00011f90: 6675 656c 5f64 656e 7369 7479 5f66 6c61  fuel_density_fla
-00011fa0: 6720 3d3d 2031 3a0a 2020 2020 2020 2020  g == 1:.        
-00011fb0: 2020 2020 7265 7475 726e 2066 7565 6c5f      return fuel_
-00011fc0: 6465 6e73 6974 795f 666c 6167 5f6c 696e  density_flag_lin
-00011fd0: 6520 2b20 6622 5c6e 7b73 656c 662e 6675  e + f"\n{self.fu
-00011fe0: 656c 5f64 656e 7369 7479 7d22 0a20 2020  el_density}".   
-00011ff0: 2020 2020 2072 6574 7572 6e20 6675 656c       return fuel
-00012000: 5f64 656e 7369 7479 5f66 6c61 675f 6c69  _density_flag_li
-00012010: 6e65 0a0a 2020 2020 4063 6f6d 7075 7465  ne..    @compute
-00012020: 645f 6669 656c 640a 2020 2020 4070 726f  d_field.    @pro
-00012030: 7065 7274 790a 2020 2020 6465 6620 5f66  perty.    def _f
-00012040: 7565 6c5f 6d6f 6973 7475 7265 5f6c 696e  uel_moisture_lin
-00012050: 6573 2873 656c 6629 202d 3e20 7374 723a  es(self) -> str:
-00012060: 0a20 2020 2020 2020 2066 7565 6c5f 6d6f  .        fuel_mo
-00012070: 6973 745f 666c 6167 5f6c 696e 6520 3d20  ist_flag_line = 
-00012080: 6622 5c6e 7b73 656c 662e 6675 656c 5f6d  f"\n{self.fuel_m
-00012090: 6f69 7374 7572 655f 666c 6167 7d5c 7421  oisture_flag}\t!
-000120a0: 2066 7565 6c20 6d6f 6973 7475 7265 2066   fuel moisture f
-000120b0: 6c61 6722 0a20 2020 2020 2020 2069 6620  lag".        if 
-000120c0: 7365 6c66 2e66 7565 6c5f 6d6f 6973 7475  self.fuel_moistu
-000120d0: 7265 5f66 6c61 6720 3d3d 2031 3a0a 2020  re_flag == 1:.  
-000120e0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-000120f0: 2066 7565 6c5f 6d6f 6973 745f 666c 6167   fuel_moist_flag
-00012100: 5f6c 696e 6520 2b20 6622 5c6e 7b73 656c  _line + f"\n{sel
-00012110: 662e 6675 656c 5f6d 6f69 7374 7572 657d  f.fuel_moisture}
-00012120: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
-00012130: 2066 7565 6c5f 6d6f 6973 745f 666c 6167   fuel_moist_flag
-00012140: 5f6c 696e 650a 0a20 2020 2040 636f 6d70  _line..    @comp
-00012150: 7574 6564 5f66 6965 6c64 0a20 2020 2040  uted_field.    @
-00012160: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-00012170: 205f 6675 656c 5f68 6569 6768 745f 6c69   _fuel_height_li
-00012180: 6e65 7328 7365 6c66 2920 2d3e 2073 7472  nes(self) -> str
-00012190: 3a0a 2020 2020 2020 2020 6966 2073 656c  :.        if sel
-000121a0: 662e 6675 656c 5f64 656e 7369 7479 5f66  f.fuel_density_f
-000121b0: 6c61 6720 3d3d 2031 3a0a 2020 2020 2020  lag == 1:.      
-000121c0: 2020 2020 2020 6675 656c 5f68 6569 6768        fuel_heigh
-000121d0: 745f 666c 6167 5f6c 696e 6520 3d20 6622  t_flag_line = f"
-000121e0: 5c6e 7b73 656c 662e 6675 656c 5f68 6569  \n{self.fuel_hei
-000121f0: 6768 745f 666c 6167 7d5c 7421 2066 7565  ght_flag}\t! fue
-00012200: 6c20 6865 6967 6874 2066 6c61 6722 0a20  l height flag". 
-00012210: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-00012220: 6c66 2e66 7565 6c5f 6865 6967 6874 5f66  lf.fuel_height_f
-00012230: 6c61 6720 3d3d 2031 3a0a 2020 2020 2020  lag == 1:.      
-00012240: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00012250: 2066 7565 6c5f 6865 6967 6874 5f66 6c61   fuel_height_fla
-00012260: 675f 6c69 6e65 202b 2066 225c 6e7b 7365  g_line + f"\n{se
-00012270: 6c66 2e66 7565 6c5f 6865 6967 6874 7d22  lf.fuel_height}"
-00012280: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00012290: 7572 6e20 6675 656c 5f68 6569 6768 745f  urn fuel_height_
-000122a0: 666c 6167 5f6c 696e 650a 2020 2020 2020  flag_line.      
-000122b0: 2020 7265 7475 726e 2022 220a 0a20 2020    return ""..   
-000122c0: 2040 636f 6d70 7574 6564 5f66 6965 6c64   @computed_field
-000122d0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-000122e0: 2020 2064 6566 205f 7369 7a65 5f73 6361     def _size_sca
-000122f0: 6c65 5f6c 696e 6573 2873 656c 6629 202d  le_lines(self) -
-00012300: 3e20 7374 723a 0a20 2020 2020 2020 2073  > str:.        s
-00012310: 697a 655f 7363 616c 655f 666c 6167 5f6c  ize_scale_flag_l
-00012320: 696e 6520 3d20 6622 5c6e 7b73 656c 662e  ine = f"\n{self.
-00012330: 7369 7a65 5f73 6361 6c65 5f66 6c61 677d  size_scale_flag}
-00012340: 5c74 2120 7369 7a65 2073 6361 6c65 2066  \t! size scale f
-00012350: 6c61 6722 0a20 2020 2020 2020 2069 6620  lag".        if 
-00012360: 7365 6c66 2e73 697a 655f 7363 616c 655f  self.size_scale_
-00012370: 666c 6167 203d 3d20 313a 0a20 2020 2020  flag == 1:.     
-00012380: 2020 2020 2020 2072 6574 7572 6e20 7369         return si
-00012390: 7a65 5f73 6361 6c65 5f66 6c61 675f 6c69  ze_scale_flag_li
-000123a0: 6e65 202b 2066 225c 6e7b 7365 6c66 2e73  ne + f"\n{self.s
-000123b0: 697a 655f 7363 616c 657d 220a 2020 2020  ize_scale}".    
-000123c0: 2020 2020 7265 7475 726e 2073 697a 655f      return size_
-000123d0: 7363 616c 655f 666c 6167 5f6c 696e 650a  scale_flag_line.
-000123e0: 0a20 2020 2040 636f 6d70 7574 6564 5f66  .    @computed_f
-000123f0: 6965 6c64 0a20 2020 2040 7072 6f70 6572  ield.    @proper
-00012400: 7479 0a20 2020 2064 6566 205f 7061 7463  ty.    def _patc
-00012410: 685f 616e 645f 6761 705f 6c69 6e65 7328  h_and_gap_lines(
-00012420: 7365 6c66 2920 2d3e 2073 7472 3a0a 2020  self) -> str:.  
-00012430: 2020 2020 2020 7061 7463 685f 616e 645f        patch_and_
-00012440: 6761 705f 666c 6167 5f6c 696e 6520 3d20  gap_flag_line = 
-00012450: 6622 5c6e 7b73 656c 662e 7061 7463 685f  f"\n{self.patch_
-00012460: 616e 645f 6761 705f 666c 6167 7d5c 7421  and_gap_flag}\t!
-00012470: 2070 6174 6368 2061 6e64 2067 6170 2066   patch and gap f
-00012480: 6c61 6722 0a20 2020 2020 2020 2069 6620  lag".        if 
-00012490: 7365 6c66 2e70 6174 6368 5f61 6e64 5f67  self.patch_and_g
-000124a0: 6170 5f66 6c61 6720 3d3d 2031 3a0a 2020  ap_flag == 1:.  
-000124b0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-000124c0: 2070 6174 6368 5f61 6e64 5f67 6170 5f66   patch_and_gap_f
-000124d0: 6c61 675f 6c69 6e65 202b 2066 225c 6e7b  lag_line + f"\n{
-000124e0: 7365 6c66 2e70 6174 6368 5f73 697a 657d  self.patch_size}
-000124f0: 5c6e 7b73 656c 662e 6761 705f 7369 7a65  \n{self.gap_size
-00012500: 7d22 0a20 2020 2020 2020 2072 6574 7572  }".        retur
-00012510: 6e20 7061 7463 685f 616e 645f 6761 705f  n patch_and_gap_
-00012520: 666c 6167 5f6c 696e 650a 0a20 2020 2040  flag_line..    @
-00012530: 636c 6173 736d 6574 686f 640a 2020 2020  classmethod.    
-00012540: 6465 6620 6672 6f6d 5f66 696c 6528 636c  def from_file(cl
-00012550: 732c 2064 6972 6563 746f 7279 3a20 7374  s, directory: st
-00012560: 7220 7c20 5061 7468 2c20 2a2a 6b77 6172  r | Path, **kwar
-00012570: 6773 293a 0a20 2020 2020 2020 2022 2222  gs):.        """
-00012580: 0a20 2020 2020 2020 2049 6e69 7469 616c  .        Initial
-00012590: 697a 6573 2061 2051 5549 435f 6669 7265  izes a QUIC_fire
-000125a0: 206f 626a 6563 7420 6672 6f6d 2061 2064   object from a d
-000125b0: 6972 6563 746f 7279 2063 6f6e 7461 696e  irectory contain
-000125c0: 696e 6720 610a 2020 2020 2020 2020 5155  ing a.        QU
-000125d0: 4943 5f46 6972 652e 696e 7020 6669 6c65  IC_Fire.inp file
-000125e0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-000125f0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-00012600: 6e63 6528 6469 7265 6374 6f72 792c 2073  nce(directory, s
-00012610: 7472 293a 0a20 2020 2020 2020 2020 2020  tr):.           
-00012620: 2064 6972 6563 746f 7279 203d 2050 6174   directory = Pat
-00012630: 6828 6469 7265 6374 6f72 7929 0a0a 2020  h(directory)..  
-00012640: 2020 2020 2020 7665 7273 696f 6e20 3d20        version = 
-00012650: 5f76 616c 6964 6174 655f 616e 645f 7265  _validate_and_re
-00012660: 7475 726e 5f76 6572 7369 6f6e 286b 7761  turn_version(kwa
-00012670: 7267 732e 6765 7428 2276 6572 7369 6f6e  rgs.get("version
-00012680: 222c 2022 2229 290a 0a20 2020 2020 2020  ", ""))..       
-00012690: 2077 6974 6820 6f70 656e 2864 6972 6563   with open(direc
-000126a0: 746f 7279 202f 2022 5155 4943 5f66 6972  tory / "QUIC_fir
-000126b0: 652e 696e 7022 2c20 2272 2229 2061 7320  e.inp", "r") as 
-000126c0: 663a 0a20 2020 2020 2020 2020 2020 206c  f:.            l
-000126d0: 696e 6573 203d 2066 2e72 6561 646c 696e  ines = f.readlin
-000126e0: 6573 2829 0a0a 2020 2020 2020 2020 2320  es()..        # 
-000126f0: 5265 6164 2066 6972 6520 666c 6167 2061  Read fire flag a
-00012700: 6e64 2072 616e 646f 6d20 7365 6564 0a20  nd random seed. 
-00012710: 2020 2020 2020 2066 6972 655f 666c 6167         fire_flag
-00012720: 203d 2069 6e74 286c 696e 6573 5b30 5d2e   = int(lines[0].
-00012730: 7374 7269 7028 292e 7370 6c69 7428 2221  strip().split("!
-00012740: 2229 5b30 5d29 0a20 2020 2020 2020 2072  ")[0]).        r
-00012750: 616e 646f 6d5f 7365 6564 203d 2069 6e74  andom_seed = int
-00012760: 286c 696e 6573 5b31 5d2e 7374 7269 7028  (lines[1].strip(
-00012770: 292e 7370 6c69 7428 2221 2229 5b30 5d29  ).split("!")[0])
-00012780: 0a0a 2020 2020 2020 2020 2320 5265 6164  ..        # Read
-00012790: 2066 6972 6520 7469 6d65 730a 2020 2020   fire times.    
-000127a0: 2020 2020 7469 6d65 5f6e 6f77 203d 2069      time_now = i
-000127b0: 6e74 286c 696e 6573 5b33 5d2e 7374 7269  nt(lines[3].stri
-000127c0: 7028 292e 7370 6c69 7428 2221 2229 5b30  p().split("!")[0
-000127d0: 5d29 0a20 2020 2020 2020 2073 696d 5f74  ]).        sim_t
-000127e0: 696d 6520 3d20 696e 7428 6c69 6e65 735b  ime = int(lines[
-000127f0: 345d 2e73 7472 6970 2829 2e73 706c 6974  4].strip().split
-00012800: 2822 2122 295b 305d 290a 2020 2020 2020  ("!")[0]).      
-00012810: 2020 6669 7265 5f74 696d 655f 7374 6570    fire_time_step
-00012820: 203d 2069 6e74 286c 696e 6573 5b35 5d2e   = int(lines[5].
-00012830: 7374 7269 7028 292e 7370 6c69 7428 2221  strip().split("!
-00012840: 2229 5b30 5d29 0a20 2020 2020 2020 2071  ")[0]).        q
-00012850: 7569 635f 7469 6d65 5f73 7465 7020 3d20  uic_time_step = 
-00012860: 696e 7428 6c69 6e65 735b 365d 2e73 7472  int(lines[6].str
-00012870: 6970 2829 2e73 706c 6974 2822 2122 295b  ip().split("!")[
-00012880: 305d 290a 2020 2020 2020 2020 6f75 745f  0]).        out_
-00012890: 7469 6d65 5f66 6972 6520 3d20 696e 7428  time_fire = int(
-000128a0: 6c69 6e65 735b 375d 2e73 7472 6970 2829  lines[7].strip()
-000128b0: 2e73 706c 6974 2822 2122 295b 305d 290a  .split("!")[0]).
-000128c0: 2020 2020 2020 2020 6f75 745f 7469 6d65          out_time
-000128d0: 5f77 696e 6420 3d20 696e 7428 6c69 6e65  _wind = int(line
-000128e0: 735b 385d 2e73 7472 6970 2829 2e73 706c  s[8].strip().spl
-000128f0: 6974 2822 2122 295b 305d 290a 2020 2020  it("!")[0]).    
-00012900: 2020 2020 6f75 745f 7469 6d65 5f65 6d69      out_time_emi
-00012910: 735f 7261 6420 3d20 696e 7428 6c69 6e65  s_rad = int(line
-00012920: 735b 395d 2e73 7472 6970 2829 2e73 706c  s[9].strip().spl
-00012930: 6974 2822 2122 295b 305d 290a 2020 2020  it("!")[0]).    
-00012940: 2020 2020 6f75 745f 7469 6d65 5f77 696e      out_time_win
-00012950: 645f 6176 6720 3d20 696e 7428 6c69 6e65  d_avg = int(line
-00012960: 735b 3130 5d2e 7374 7269 7028 292e 7370  s[10].strip().sp
-00012970: 6c69 7428 2221 2229 5b30 5d29 0a0a 2020  lit("!")[0])..  
-00012980: 2020 2020 2020 2320 5265 6164 2066 6972        # Read fir
-00012990: 6520 6772 6964 2070 6172 616d 6574 6572  e grid parameter
-000129a0: 730a 2020 2020 2020 2020 6e7a 203d 2069  s.        nz = i
-000129b0: 6e74 286c 696e 6573 5b31 325d 2e73 7472  nt(lines[12].str
-000129c0: 6970 2829 2e73 706c 6974 2822 2122 295b  ip().split("!")[
-000129d0: 305d 290a 2020 2020 2020 2020 7374 7265  0]).        stre
-000129e0: 7463 685f 6772 6964 5f66 6c61 6720 3d20  tch_grid_flag = 
-000129f0: 696e 7428 6c69 6e65 735b 3133 5d2e 7374  int(lines[13].st
-00012a00: 7269 7028 292e 7370 6c69 7428 2221 2229  rip().split("!")
-00012a10: 5b30 5d29 0a20 2020 2020 2020 2064 7a5f  [0]).        dz_
-00012a20: 6172 7261 7920 3d20 5b5d 0a20 2020 2020  array = [].     
-00012a30: 2020 2069 6620 7374 7265 7463 685f 6772     if stretch_gr
-00012a40: 6964 5f66 6c61 6720 3d3d 2030 3a0a 2020  id_flag == 0:.  
-00012a50: 2020 2020 2020 2020 2020 647a 203d 2069            dz = i
-00012a60: 6e74 286c 696e 6573 5b31 345d 2e73 7472  nt(lines[14].str
-00012a70: 6970 2829 2e73 706c 6974 2822 2122 295b  ip().split("!")[
-00012a80: 305d 290a 2020 2020 2020 2020 2020 2020  0]).            
-00012a90: 6375 7272 656e 745f 6c69 6e65 203d 2031  current_line = 1
-00012aa0: 350a 2020 2020 2020 2020 656c 7365 3a0a  5.        else:.
-00012ab0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00012ac0: 6920 696e 2072 616e 6765 2831 342c 2031  i in range(14, 1
-00012ad0: 3420 2b20 6c65 6e28 647a 5f61 7272 6179  4 + len(dz_array
-00012ae0: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
-00012af0: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
-00012b00: 2020 2020 2020 2020 2020 2020 2066 6c6f               flo
-00012b10: 6174 286c 696e 6573 5b69 5d2e 7374 7269  at(lines[i].stri
-00012b20: 7028 2929 0a20 2020 2020 2020 2020 2020  p()).           
-00012b30: 2020 2020 2065 7863 6570 7420 5661 6c75       except Valu
-00012b40: 6545 7272 6f72 3a0a 2020 2020 2020 2020  eError:.        
-00012b50: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00012b60: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-00012b70: 2020 2020 2020 2020 2020 2022 5155 4943             "QUIC
-00012b80: 5f66 6972 652e 696e 703a 2064 7a20 696e  _fire.inp: dz in
-00012b90: 7075 7420 7661 6c75 6520 6973 206e 6f74  put value is not
-00012ba0: 2061 2066 6c6f 6174 2e20 446f 6573 2074   a float. Does t
-00012bb0: 6865 206e 756d 6265 7220 6f66 2064 7a20  he number of dz 
-00012bc0: 6461 7461 206d 6174 6368 206e 7a3f 220a  data match nz?".
-00012bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012be0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00012bf0: 2020 2020 2020 647a 5f61 7272 6179 2e61        dz_array.a
-00012c00: 7070 656e 6428 666c 6f61 7428 6c69 6e65  ppend(float(line
-00012c10: 735b 695d 2e73 7472 6970 2829 2929 0a20  s[i].strip())). 
-00012c20: 2020 2020 2020 2020 2020 2063 7572 7265             curre
-00012c30: 6e74 5f6c 696e 6520 3d20 3135 202b 206c  nt_line = 15 + l
-00012c40: 656e 2864 7a5f 6172 7261 7929 0a0a 2020  en(dz_array)..  
-00012c50: 2020 2020 2020 6375 7272 656e 745f 6c69        current_li
-00012c60: 6e65 202b 3d20 3420 2023 2073 6b69 7020  ne += 4  # skip 
-00012c70: 756e 7573 6564 206c 696e 6573 0a0a 2020  unused lines..  
-00012c80: 2020 2020 2020 2320 5265 6164 2066 7565        # Read fue
-00012c90: 6c20 6461 7461 0a20 2020 2020 2020 2063  l data.        c
-00012ca0: 7572 7265 6e74 5f6c 696e 6520 2b3d 2031  urrent_line += 1
-00012cb0: 2020 2320 736b 6970 2021 4655 454c 206c    # skip !FUEL l
-00012cc0: 696e 650a 0a20 2020 2020 2020 2023 2052  ine..        # R
-00012cd0: 6561 6420 6675 656c 2064 656e 7369 7479  ead fuel density
-00012ce0: 0a20 2020 2020 2020 2066 7565 6c5f 6465  .        fuel_de
-00012cf0: 6e73 6974 795f 666c 6167 203d 2069 6e74  nsity_flag = int
-00012d00: 286c 696e 6573 5b63 7572 7265 6e74 5f6c  (lines[current_l
-00012d10: 696e 655d 2e73 7472 6970 2829 2e73 706c  ine].strip().spl
-00012d20: 6974 2822 2122 295b 305d 290a 2020 2020  it("!")[0]).    
-00012d30: 2020 2020 6675 656c 5f64 656e 7369 7479      fuel_density
-00012d40: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
-00012d50: 6966 2066 7565 6c5f 6465 6e73 6974 795f  if fuel_density_
-00012d60: 666c 6167 203d 3d20 313a 0a20 2020 2020  flag == 1:.     
-00012d70: 2020 2020 2020 2063 7572 7265 6e74 5f6c         current_l
-00012d80: 696e 6520 2b3d 2031 0a20 2020 2020 2020  ine += 1.       
-00012d90: 2020 2020 2066 7565 6c5f 6465 6e73 6974       fuel_densit
-00012da0: 7920 3d20 666c 6f61 7428 6c69 6e65 735b  y = float(lines[
-00012db0: 6375 7272 656e 745f 6c69 6e65 5d2e 7374  current_line].st
-00012dc0: 7269 7028 2929 0a0a 2020 2020 2020 2020  rip())..        
-00012dd0: 2320 5265 6164 2066 7565 6c20 6d6f 6973  # Read fuel mois
-00012de0: 7475 7265 0a20 2020 2020 2020 2063 7572  ture.        cur
-00012df0: 7265 6e74 5f6c 696e 6520 2b3d 2031 0a20  rent_line += 1. 
-00012e00: 2020 2020 2020 2066 7565 6c5f 6d6f 6973         fuel_mois
-00012e10: 7475 7265 5f66 6c61 6720 3d20 696e 7428  ture_flag = int(
-00012e20: 6c69 6e65 735b 6375 7272 656e 745f 6c69  lines[current_li
-00012e30: 6e65 5d2e 7374 7269 7028 292e 7370 6c69  ne].strip().spli
-00012e40: 7428 2221 2229 5b30 5d29 0a20 2020 2020  t("!")[0]).     
-00012e50: 2020 2066 7565 6c5f 6d6f 6973 7475 7265     fuel_moisture
-00012e60: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
-00012e70: 6966 2066 7565 6c5f 6d6f 6973 7475 7265  if fuel_moisture
-00012e80: 5f66 6c61 6720 3d3d 2031 3a0a 2020 2020  _flag == 1:.    
-00012e90: 2020 2020 2020 2020 6375 7272 656e 745f          current_
-00012ea0: 6c69 6e65 202b 3d20 310a 2020 2020 2020  line += 1.      
-00012eb0: 2020 2020 2020 6675 656c 5f6d 6f69 7374        fuel_moist
-00012ec0: 7572 6520 3d20 666c 6f61 7428 6c69 6e65  ure = float(line
-00012ed0: 735b 6375 7272 656e 745f 6c69 6e65 5d2e  s[current_line].
-00012ee0: 7374 7269 7028 2929 0a0a 2020 2020 2020  strip())..      
-00012ef0: 2020 2320 5265 6164 2066 7565 6c20 6865    # Read fuel he
-00012f00: 6967 6874 0a20 2020 2020 2020 2063 7572  ight.        cur
-00012f10: 7265 6e74 5f6c 696e 6520 2b3d 2031 0a20  rent_line += 1. 
-00012f20: 2020 2020 2020 2069 6620 6675 656c 5f64         if fuel_d
-00012f30: 656e 7369 7479 5f66 6c61 6720 3d3d 2031  ensity_flag == 1
-00012f40: 3a0a 2020 2020 2020 2020 2020 2020 6675  :.            fu
-00012f50: 656c 5f68 6569 6768 745f 666c 6167 203d  el_height_flag =
-00012f60: 2069 6e74 286c 696e 6573 5b63 7572 7265   int(lines[curre
-00012f70: 6e74 5f6c 696e 655d 2e73 7472 6970 2829  nt_line].strip()
-00012f80: 2e73 706c 6974 2822 2122 295b 305d 290a  .split("!")[0]).
-00012f90: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00012fa0: 2020 2020 2020 2020 2020 6675 656c 5f68            fuel_h
-00012fb0: 6569 6768 745f 666c 6167 203d 2066 7565  eight_flag = fue
-00012fc0: 6c5f 6465 6e73 6974 795f 666c 6167 0a20  l_density_flag. 
-00012fd0: 2020 2020 2020 2066 7565 6c5f 6865 6967         fuel_heig
-00012fe0: 6874 203d 204e 6f6e 650a 2020 2020 2020  ht = None.      
-00012ff0: 2020 6966 2066 7565 6c5f 6465 6e73 6974    if fuel_densit
-00013000: 795f 666c 6167 203d 3d20 3120 616e 6420  y_flag == 1 and 
-00013010: 6675 656c 5f6d 6f69 7374 7572 655f 666c  fuel_moisture_fl
-00013020: 6167 203d 3d20 313a 0a20 2020 2020 2020  ag == 1:.       
-00013030: 2020 2020 2063 7572 7265 6e74 5f6c 696e       current_lin
-00013040: 6520 2b3d 2031 0a20 2020 2020 2020 2020  e += 1.         
-00013050: 2020 2066 7565 6c5f 6865 6967 6874 203d     fuel_height =
-00013060: 2066 6c6f 6174 286c 696e 6573 5b63 7572   float(lines[cur
-00013070: 7265 6e74 5f6c 696e 655d 2e73 7472 6970  rent_line].strip
-00013080: 2829 290a 0a20 2020 2020 2020 2023 2052  ())..        # R
-00013090: 6561 6420 7369 7a65 2073 6361 6c65 2061  ead size scale a
-000130a0: 6e64 2070 6174 6368 2f67 6170 2028 5375  nd patch/gap (Su
-000130b0: 7070 6f72 7465 6420 666f 7220 7636 2061  pported for v6 a
-000130c0: 6e64 2061 626f 7665 290a 2020 2020 2020  nd above).      
-000130d0: 2020 6966 2076 6572 7369 6f6e 2069 6e20    if version in 
-000130e0: 2822 7636 2229 3a0a 2020 2020 2020 2020  ("v6"):.        
-000130f0: 2020 2020 2320 4368 6563 6b20 6966 2074      # Check if t
-00013100: 6865 206e 6578 7420 6c69 6e65 2069 7320  he next line is 
-00013110: 7468 6520 6967 6e69 7469 6f6e 2068 6561  the ignition hea
-00013120: 6465 720a 2020 2020 2020 2020 2020 2020  der.            
-00013130: 6e65 7874 5f6c 696e 6520 3d20 6c69 6e65  next_line = line
-00013140: 735b 6375 7272 656e 745f 6c69 6e65 202b  s[current_line +
-00013150: 2031 5d2e 7374 7269 7028 290a 2020 2020   1].strip().    
-00013160: 2020 2020 2020 2020 6966 206e 6578 745f          if next_
-00013170: 6c69 6e65 2e73 7461 7274 7377 6974 6828  line.startswith(
-00013180: 2221 2049 474e 4954 494f 4e20 4c4f 4341  "! IGNITION LOCA
-00013190: 5449 4f4e 5322 293a 0a20 2020 2020 2020  TIONS"):.       
-000131a0: 2020 2020 2020 2020 2023 2054 7279 696e           # Tryin
-000131b0: 6720 746f 2072 6561 6420 6120 7635 2066  g to read a v5 f
-000131c0: 696c 6520 7769 7468 2076 3620 7265 6164  ile with v6 read
-000131d0: 6572 2073 6f20 7468 726f 7720 6572 726f  er so throw erro
-000131e0: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
-000131f0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00013200: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-00013210: 2020 2020 2020 2020 2249 6e76 616c 6964          "Invalid
-00013220: 2066 696c 6520 7665 7273 696f 6e2e 2053   file version. S
-00013230: 656c 6563 7465 6420 7265 6164 6572 2066  elected reader f
-00013240: 6f72 2051 5549 432d 4669 7265 2076 362c  or QUIC-Fire v6,
-00013250: 2062 7574 2066 696c 6520 6973 2076 352e   but file is v5.
-00013260: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00013270: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
-00013280: 2023 2052 6561 6420 7369 7a65 2073 6361   # Read size sca
-00013290: 6c65 0a20 2020 2020 2020 2020 2020 2063  le.            c
-000132a0: 7572 7265 6e74 5f6c 696e 6520 2b3d 2031  urrent_line += 1
-000132b0: 0a20 2020 2020 2020 2020 2020 2073 697a  .            siz
-000132c0: 655f 7363 616c 655f 666c 6167 203d 2069  e_scale_flag = i
-000132d0: 6e74 286c 696e 6573 5b63 7572 7265 6e74  nt(lines[current
-000132e0: 5f6c 696e 655d 2e73 7472 6970 2829 2e73  _line].strip().s
-000132f0: 706c 6974 2822 2122 295b 305d 290a 2020  plit("!")[0]).  
-00013300: 2020 2020 2020 2020 2020 7369 7a65 5f73            size_s
-00013310: 6361 6c65 203d 2030 2e30 3030 350a 2020  cale = 0.0005.  
-00013320: 2020 2020 2020 2020 2020 6966 2073 697a            if siz
-00013330: 655f 7363 616c 655f 666c 6167 203d 3d20  e_scale_flag == 
-00013340: 313a 0a20 2020 2020 2020 2020 2020 2020  1:.             
-00013350: 2020 2063 7572 7265 6e74 5f6c 696e 6520     current_line 
-00013360: 2b3d 2031 0a20 2020 2020 2020 2020 2020  += 1.           
-00013370: 2020 2020 2073 697a 655f 7363 616c 6520       size_scale 
-00013380: 3d20 666c 6f61 7428 6c69 6e65 735b 6375  = float(lines[cu
-00013390: 7272 656e 745f 6c69 6e65 5d2e 7374 7269  rrent_line].stri
-000133a0: 7028 2929 0a0a 2020 2020 2020 2020 2020  p())..          
-000133b0: 2020 2320 5265 6164 2070 6174 6368 2061    # Read patch a
-000133c0: 6e64 2067 6170 0a20 2020 2020 2020 2020  nd gap.         
-000133d0: 2020 2063 7572 7265 6e74 5f6c 696e 6520     current_line 
-000133e0: 2b3d 2031 0a20 2020 2020 2020 2020 2020  += 1.           
-000133f0: 2070 6174 6368 5f61 6e64 5f67 6170 5f66   patch_and_gap_f
-00013400: 6c61 6720 3d20 696e 7428 6c69 6e65 735b  lag = int(lines[
-00013410: 6375 7272 656e 745f 6c69 6e65 5d2e 7374  current_line].st
-00013420: 7269 7028 292e 7370 6c69 7428 2221 2229  rip().split("!")
-00013430: 5b30 5d29 0a20 2020 2020 2020 2020 2020  [0]).           
-00013440: 2070 6174 6368 5f73 697a 6520 3d20 302e   patch_size = 0.
-00013450: 300a 2020 2020 2020 2020 2020 2020 6761  0.            ga
-00013460: 705f 7369 7a65 203d 2030 2e30 0a20 2020  p_size = 0.0.   
-00013470: 2020 2020 2020 2020 2069 6620 7061 7463           if patc
-00013480: 685f 616e 645f 6761 705f 666c 6167 203d  h_and_gap_flag =
-00013490: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
-000134a0: 2020 2020 2063 7572 7265 6e74 5f6c 696e       current_lin
-000134b0: 6520 2b3d 2031 0a20 2020 2020 2020 2020  e += 1.         
-000134c0: 2020 2020 2020 2070 6174 6368 5f73 697a         patch_siz
-000134d0: 6520 3d20 666c 6f61 7428 6c69 6e65 735b  e = float(lines[
-000134e0: 6375 7272 656e 745f 6c69 6e65 5d2e 7374  current_line].st
-000134f0: 7269 7028 2929 0a20 2020 2020 2020 2020  rip()).         
-00013500: 2020 2020 2020 2063 7572 7265 6e74 5f6c         current_l
-00013510: 696e 6520 2b3d 2031 0a20 2020 2020 2020  ine += 1.       
-00013520: 2020 2020 2020 2020 2067 6170 5f73 697a           gap_siz
-00013530: 6520 3d20 666c 6f61 7428 6c69 6e65 735b  e = float(lines[
-00013540: 6375 7272 656e 745f 6c69 6e65 5d2e 7374  current_line].st
-00013550: 7269 7028 2929 0a20 2020 2020 2020 2065  rip()).        e
-00013560: 6c69 6620 7665 7273 696f 6e20 3d3d 2022  lif version == "
-00013570: 7635 223a 0a20 2020 2020 2020 2020 2020  v5":.           
-00013580: 2023 2054 6865 206e 6578 7420 6c69 6e65   # The next line
-00013590: 2073 686f 756c 6420 6265 2074 6865 2069   should be the i
-000135a0: 676e 6974 696f 6e20 6865 6164 6572 2e20  gnition header. 
-000135b0: 4966 2069 7420 6973 206e 6f74 2c20 7468  If it is not, th
-000135c0: 656e 0a20 2020 2020 2020 2020 2020 2023  en.            #
-000135d0: 2074 6865 2066 696c 6520 6973 206e 6f74   the file is not
-000135e0: 2061 2076 3520 6669 6c65 2c20 616e 6420   a v5 file, and 
-000135f0: 7765 2073 686f 756c 6420 7468 726f 7720  we should throw 
-00013600: 616e 2065 7272 6f72 2e0a 2020 2020 2020  an error..      
-00013610: 2020 2020 2020 6e65 7874 5f6c 696e 6520        next_line 
-00013620: 3d20 6c69 6e65 735b 6375 7272 656e 745f  = lines[current_
-00013630: 6c69 6e65 202b 2031 5d2e 7374 7269 7028  line + 1].strip(
-00013640: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-00013650: 206e 6f74 206e 6578 745f 6c69 6e65 2e73   not next_line.s
-00013660: 7461 7274 7377 6974 6828 2221 2049 474e  tartswith("! IGN
-00013670: 4954 494f 4e20 4c4f 4341 5449 4f4e 5322  ITION LOCATIONS"
-00013680: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00013690: 2020 2023 2054 7279 696e 6720 746f 2072     # Trying to r
-000136a0: 6561 6420 6120 7636 2066 696c 6520 7769  ead a v6 file wi
-000136b0: 7468 2076 3520 7265 6164 6572 2073 6f20  th v5 reader so 
-000136c0: 7468 726f 7720 6572 726f 720a 2020 2020  throw error.    
-000136d0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-000136e0: 6520 5661 6c75 6545 7272 6f72 280a 2020  e ValueError(.  
-000136f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013700: 2020 2249 6e76 616c 6964 2066 696c 6520    "Invalid file 
-00013710: 7665 7273 696f 6e2e 2053 656c 6563 7465  version. Selecte
-00013720: 6420 7265 6164 6572 2066 6f72 2051 5549  d reader for QUI
-00013730: 432d 4669 7265 2076 352c 2062 7574 2066  C-Fire v5, but f
-00013740: 696c 6520 6973 2076 362e 220a 2020 2020  ile is v6.".    
-00013750: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00013760: 2020 2020 2020 2020 2020 2023 2053 6574             # Set
-00013770: 2073 697a 6520 7363 616c 6520 616e 6420   size scale and 
-00013780: 7061 7463 6820 616e 6420 6761 7020 746f  patch and gap to
-00013790: 2064 6566 6175 6c74 730a 2020 2020 2020   defaults.      
-000137a0: 2020 2020 2020 7369 7a65 5f73 6361 6c65        size_scale
-000137b0: 5f66 6c61 6720 3d20 300a 2020 2020 2020  _flag = 0.      
-000137c0: 2020 2020 2020 7369 7a65 5f73 6361 6c65        size_scale
-000137d0: 203d 2030 2e30 3030 350a 2020 2020 2020   = 0.0005.      
-000137e0: 2020 2020 2020 7061 7463 685f 616e 645f        patch_and_
-000137f0: 6761 705f 666c 6167 203d 2030 0a20 2020  gap_flag = 0.   
-00013800: 2020 2020 2020 2020 2070 6174 6368 5f73           patch_s
-00013810: 697a 6520 3d20 302e 300a 2020 2020 2020  ize = 0.0.      
-00013820: 2020 2020 2020 6761 705f 7369 7a65 203d        gap_size =
-00013830: 2030 2e30 0a20 2020 2020 2020 2065 6c73   0.0.        els
-00013840: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-00013850: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-00013860: 6622 556e 7375 7070 6f72 7465 6420 7665  f"Unsupported ve
-00013870: 7273 696f 6e3a 207b 7665 7273 696f 6e7d  rsion: {version}
-00013880: 2229 0a0a 2020 2020 2020 2020 2320 5265  ")..        # Re
-00013890: 6164 2069 676e 6974 696f 6e20 6461 7461  ad ignition data
-000138a0: 0a20 2020 2020 2020 2063 7572 7265 6e74  .        current
-000138b0: 5f6c 696e 6520 2b3d 2032 2020 2320 736b  _line += 2  # sk
-000138c0: 6970 2021 2049 474e 4954 494f 4e20 4c4f  ip ! IGNITION LO
-000138d0: 4341 5449 4f4e 5320 6865 6164 6572 0a20  CATIONS header. 
-000138e0: 2020 2020 2020 2069 676e 6974 696f 6e5f         ignition_
-000138f0: 666c 6167 203d 2069 6e74 286c 696e 6573  flag = int(lines
-00013900: 5b63 7572 7265 6e74 5f6c 696e 655d 2e73  [current_line].s
-00013910: 7472 6970 2829 2e73 706c 6974 2822 2122  trip().split("!"
-00013920: 295b 305d 290a 2020 2020 2020 2020 6164  )[0]).        ad
-00013930: 645f 6c69 6e65 7320 3d20 7b31 3a20 342c  d_lines = {1: 4,
-00013940: 2032 3a20 362c 2033 3a20 352c 2034 3a20   2: 6, 3: 5, 4: 
-00013950: 302c 2035 3a20 302c 2036 3a20 302c 2037  0, 5: 0, 6: 0, 7
-00013960: 3a20 307d 0a20 2020 2020 2020 2061 6464  : 0}.        add
-00013970: 203d 2061 6464 5f6c 696e 6573 2e67 6574   = add_lines.get
-00013980: 2869 676e 6974 696f 6e5f 666c 6167 290a  (ignition_flag).
-00013990: 2020 2020 2020 2020 6967 6e69 7469 6f6e          ignition
-000139a0: 5f70 6172 616d 7320 3d20 5b5d 0a20 2020  _params = [].   
-000139b0: 2020 2020 2063 7572 7265 6e74 5f6c 696e       current_lin
-000139c0: 6520 2b3d 2031 0a20 2020 2020 2020 2066  e += 1.        f
-000139d0: 6f72 2069 2069 6e20 7261 6e67 6528 6375  or i in range(cu
-000139e0: 7272 656e 745f 6c69 6e65 2c20 6375 7272  rrent_line, curr
-000139f0: 656e 745f 6c69 6e65 202b 2061 6464 293a  ent_line + add):
-00013a00: 0a20 2020 2020 2020 2020 2020 2069 676e  .            ign
-00013a10: 6974 696f 6e5f 6c69 6e65 203d 2066 6c6f  ition_line = flo
-00013a20: 6174 286c 696e 6573 5b69 5d2e 7370 6c69  at(lines[i].spli
-00013a30: 7428 2221 2229 5b30 5d2e 7374 7269 7028  t("!")[0].strip(
-00013a40: 2929 0a20 2020 2020 2020 2020 2020 2069  )).            i
-00013a50: 676e 6974 696f 6e5f 7061 7261 6d73 2e61  gnition_params.a
-00013a60: 7070 656e 6428 6967 6e69 7469 6f6e 5f6c  ppend(ignition_l
-00013a70: 696e 6529 0a20 2020 2020 2020 2069 6620  ine).        if 
-00013a80: 6967 6e69 7469 6f6e 5f66 6c61 6720 3d3d  ignition_flag ==
-00013a90: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
-00013aa0: 785f 6d69 6e2c 2079 5f6d 696e 2c20 785f  x_min, y_min, x_
-00013ab0: 6c65 6e67 7468 2c20 795f 6c65 6e67 7468  length, y_length
-00013ac0: 203d 2069 676e 6974 696f 6e5f 7061 7261   = ignition_para
-00013ad0: 6d73 0a20 2020 2020 2020 2020 2020 2069  ms.            i
-00013ae0: 676e 6974 696f 6e5f 7479 7065 203d 2052  gnition_type = R
-00013af0: 6563 7461 6e67 6c65 4967 6e69 7469 6f6e  ectangleIgnition
-00013b00: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00013b10: 2020 785f 6d69 6e3d 785f 6d69 6e2c 2079    x_min=x_min, y
-00013b20: 5f6d 696e 3d79 5f6d 696e 2c20 785f 6c65  _min=y_min, x_le
-00013b30: 6e67 7468 3d78 5f6c 656e 6774 682c 2079  ngth=x_length, y
-00013b40: 5f6c 656e 6774 683d 795f 6c65 6e67 7468  _length=y_length
-00013b50: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-00013b60: 2020 2020 2020 2065 6c69 6620 6967 6e69         elif igni
-00013b70: 7469 6f6e 5f66 6c61 6720 3d3d 2032 3a0a  tion_flag == 2:.
-00013b80: 2020 2020 2020 2020 2020 2020 785f 6d69              x_mi
-00013b90: 6e2c 2079 5f6d 696e 2c20 785f 6c65 6e67  n, y_min, x_leng
-00013ba0: 7468 2c20 795f 6c65 6e67 7468 2c20 785f  th, y_length, x_
-00013bb0: 7769 6474 682c 2079 5f77 6964 7468 203d  width, y_width =
-00013bc0: 2069 676e 6974 696f 6e5f 7061 7261 6d73   ignition_params
-00013bd0: 0a20 2020 2020 2020 2020 2020 2069 676e  .            ign
-00013be0: 6974 696f 6e5f 7479 7065 203d 2053 7175  ition_type = Squ
-00013bf0: 6172 6552 696e 6749 676e 6974 696f 6e28  areRingIgnition(
-00013c00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013c10: 2078 5f6d 696e 3d78 5f6d 696e 2c0a 2020   x_min=x_min,.  
-00013c20: 2020 2020 2020 2020 2020 2020 2020 795f                y_
-00013c30: 6d69 6e3d 795f 6d69 6e2c 0a20 2020 2020  min=y_min,.     
-00013c40: 2020 2020 2020 2020 2020 2078 5f6c 656e             x_len
-00013c50: 6774 683d 785f 6c65 6e67 7468 2c0a 2020  gth=x_length,.  
-00013c60: 2020 2020 2020 2020 2020 2020 2020 795f                y_
-00013c70: 6c65 6e67 7468 3d79 5f6c 656e 6774 682c  length=y_length,
-00013c80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013c90: 2078 5f77 6964 7468 3d78 5f77 6964 7468   x_width=x_width
-00013ca0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00013cb0: 2020 795f 7769 6474 683d 795f 7769 6474    y_width=y_widt
-00013cc0: 682c 0a20 2020 2020 2020 2020 2020 2029  h,.            )
-00013cd0: 0a20 2020 2020 2020 2065 6c69 6620 6967  .        elif ig
-00013ce0: 6e69 7469 6f6e 5f66 6c61 6720 3d3d 2033  nition_flag == 3
-00013cf0: 3a0a 2020 2020 2020 2020 2020 2020 785f  :.            x_
-00013d00: 6d69 6e2c 2079 5f6d 696e 2c20 785f 6c65  min, y_min, x_le
-00013d10: 6e67 7468 2c20 795f 6c65 6e67 7468 2c20  ngth, y_length, 
-00013d20: 7269 6e67 5f77 6964 7468 203d 2069 676e  ring_width = ign
-00013d30: 6974 696f 6e5f 7061 7261 6d73 0a20 2020  ition_params.   
-00013d40: 2020 2020 2020 2020 2069 676e 6974 696f           ignitio
-00013d50: 6e5f 7479 7065 203d 2043 6972 6375 6c61  n_type = Circula
-00013d60: 7252 696e 6749 676e 6974 696f 6e28 0a20  rRingIgnition(. 
-00013d70: 2020 2020 2020 2020 2020 2020 2020 2078                 x
-00013d80: 5f6d 696e 3d78 5f6d 696e 2c0a 2020 2020  _min=x_min,.    
-00013d90: 2020 2020 2020 2020 2020 2020 795f 6d69              y_mi
-00013da0: 6e3d 795f 6d69 6e2c 0a20 2020 2020 2020  n=y_min,.       
-00013db0: 2020 2020 2020 2020 2078 5f6c 656e 6774           x_lengt
-00013dc0: 683d 785f 6c65 6e67 7468 2c0a 2020 2020  h=x_length,.    
-00013dd0: 2020 2020 2020 2020 2020 2020 795f 6c65              y_le
-00013de0: 6e67 7468 3d79 5f6c 656e 6774 682c 0a20  ngth=y_length,. 
-00013df0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00013e00: 696e 675f 7769 6474 683d 7269 6e67 5f77  ing_width=ring_w
-00013e10: 6964 7468 2c0a 2020 2020 2020 2020 2020  idth,.          
-00013e20: 2020 290a 2020 2020 2020 2020 656c 7365    ).        else
-00013e30: 3a0a 2020 2020 2020 2020 2020 2020 6967  :.            ig
-00013e40: 6e69 7469 6f6e 5f74 7970 6520 3d20 4967  nition_type = Ig
-00013e50: 6e69 7469 6f6e 5479 7065 2869 676e 6974  nitionType(ignit
-00013e60: 696f 6e5f 666c 6167 3d69 676e 6974 696f  ion_flag=ignitio
-00013e70: 6e5f 666c 6167 290a 0a20 2020 2020 2020  n_flag)..       
-00013e80: 2063 7572 7265 6e74 5f6c 696e 6520 2b3d   current_line +=
-00013e90: 2061 6464 0a20 2020 2020 2020 2069 676e   add.        ign
-00013ea0: 6974 696f 6e73 5f70 6572 5f63 656c 6c20  itions_per_cell 
-00013eb0: 3d20 696e 7428 6c69 6e65 735b 6375 7272  = int(lines[curr
-00013ec0: 656e 745f 6c69 6e65 5d2e 7374 7269 7028  ent_line].strip(
-00013ed0: 292e 7370 6c69 7428 2221 2229 5b30 5d29  ).split("!")[0])
-00013ee0: 0a20 2020 2020 2020 2063 7572 7265 6e74  .        current
-00013ef0: 5f6c 696e 6520 2b3d 2031 0a0a 2020 2020  _line += 1..    
-00013f00: 2020 2020 2320 5265 6164 2066 6972 6562      # Read fireb
-00013f10: 7261 6e64 730a 2020 2020 2020 2020 2320  rands.        # 
-00013f20: 6375 7272 656e 745f 6c69 6e65 203d 2021  current_line = !
-00013f30: 2046 4952 4542 5241 4e44 530a 2020 2020   FIREBRANDS.    
-00013f40: 2020 2020 6375 7272 656e 745f 6c69 6e65      current_line
-00013f50: 202b 3d20 3120 2023 2068 6561 6465 720a   += 1  # header.
-00013f60: 2020 2020 2020 2020 6669 7265 6272 616e          firebran
-00013f70: 645f 666c 6167 203d 2069 6e74 286c 696e  d_flag = int(lin
-00013f80: 6573 5b63 7572 7265 6e74 5f6c 696e 655d  es[current_line]
-00013f90: 2e73 7472 6970 2829 2e73 706c 6974 2822  .strip().split("
-00013fa0: 2122 295b 305d 290a 2020 2020 2020 2020  !")[0]).        
-00013fb0: 6375 7272 656e 745f 6c69 6e65 202b 3d20  current_line += 
-00013fc0: 310a 0a20 2020 2020 2020 2023 2052 6561  1..        # Rea
-00013fd0: 6420 6f75 7470 7574 2066 6c61 6773 0a20  d output flags. 
-00013fe0: 2020 2020 2020 2023 2063 7572 7265 6e74         # current
-00013ff0: 5f6c 696e 6520 3d20 214f 5554 5055 545f  _line = !OUTPUT_
-00014000: 4649 4c45 530a 2020 2020 2020 2020 656e  FILES.        en
-00014010: 675f 746f 5f61 746d 5f6f 7574 203d 2069  g_to_atm_out = i
-00014020: 6e74 286c 696e 6573 5b63 7572 7265 6e74  nt(lines[current
-00014030: 5f6c 696e 6520 2b20 315d 2e73 7472 6970  _line + 1].strip
-00014040: 2829 2e73 706c 6974 2822 2122 295b 305d  ().split("!")[0]
-00014050: 290a 2020 2020 2020 2020 7265 6163 745f  ).        react_
-00014060: 7261 7465 5f6f 7574 203d 2069 6e74 286c  rate_out = int(l
-00014070: 696e 6573 5b63 7572 7265 6e74 5f6c 696e  ines[current_lin
-00014080: 6520 2b20 325d 2e73 7472 6970 2829 2e73  e + 2].strip().s
-00014090: 706c 6974 2822 2122 295b 305d 290a 2020  plit("!")[0]).  
-000140a0: 2020 2020 2020 6675 656c 5f64 656e 735f        fuel_dens_
-000140b0: 6f75 7420 3d20 696e 7428 6c69 6e65 735b  out = int(lines[
-000140c0: 6375 7272 656e 745f 6c69 6e65 202b 2033  current_line + 3
-000140d0: 5d2e 7374 7269 7028 292e 7370 6c69 7428  ].strip().split(
-000140e0: 2221 2229 5b30 5d29 0a20 2020 2020 2020  "!")[0]).       
-000140f0: 2071 665f 7769 6e64 5f6f 7574 203d 2069   qf_wind_out = i
-00014100: 6e74 286c 696e 6573 5b63 7572 7265 6e74  nt(lines[current
-00014110: 5f6c 696e 6520 2b20 345d 2e73 7472 6970  _line + 4].strip
-00014120: 2829 2e73 706c 6974 2822 2122 295b 305d  ().split("!")[0]
-00014130: 290a 2020 2020 2020 2020 7175 5f77 696e  ).        qu_win
-00014140: 645f 696e 7374 5f6f 7574 203d 2069 6e74  d_inst_out = int
-00014150: 286c 696e 6573 5b63 7572 7265 6e74 5f6c  (lines[current_l
-00014160: 696e 6520 2b20 355d 2e73 7472 6970 2829  ine + 5].strip()
-00014170: 2e73 706c 6974 2822 2122 295b 305d 290a  .split("!")[0]).
-00014180: 2020 2020 2020 2020 7175 5f77 696e 645f          qu_wind_
-00014190: 6176 675f 6f75 7420 3d20 696e 7428 6c69  avg_out = int(li
-000141a0: 6e65 735b 6375 7272 656e 745f 6c69 6e65  nes[current_line
-000141b0: 202b 2036 5d2e 7374 7269 7028 292e 7370   + 6].strip().sp
-000141c0: 6c69 7428 2221 2229 5b30 5d29 0a20 2020  lit("!")[0]).   
-000141d0: 2020 2020 2023 2021 204f 7574 7075 7420       # ! Output 
-000141e0: 706c 756d 6520 7472 616a 6563 746f 7269  plume trajectori
-000141f0: 6573 0a20 2020 2020 2020 2066 7565 6c5f  es.        fuel_
-00014200: 6d6f 6973 745f 6f75 7420 3d20 696e 7428  moist_out = int(
-00014210: 6c69 6e65 735b 6375 7272 656e 745f 6c69  lines[current_li
-00014220: 6e65 202b 2038 5d2e 7374 7269 7028 292e  ne + 8].strip().
-00014230: 7370 6c69 7428 2221 2229 5b30 5d29 0a20  split("!")[0]). 
-00014240: 2020 2020 2020 206d 6173 735f 6275 726e         mass_burn
-00014250: 745f 6f75 7420 3d20 696e 7428 6c69 6e65  t_out = int(line
-00014260: 735b 6375 7272 656e 745f 6c69 6e65 202b  s[current_line +
-00014270: 2039 5d2e 7374 7269 7028 292e 7370 6c69   9].strip().spli
-00014280: 7428 2221 2229 5b30 5d29 0a20 2020 2020  t("!")[0]).     
-00014290: 2020 2066 6972 6562 7261 6e64 5f6f 7574     firebrand_out
-000142a0: 203d 2069 6e74 286c 696e 6573 5b63 7572   = int(lines[cur
-000142b0: 7265 6e74 5f6c 696e 6520 2b20 3130 5d2e  rent_line + 10].
-000142c0: 7374 7269 7028 292e 7370 6c69 7428 2221  strip().split("!
-000142d0: 2229 5b30 5d29 0a20 2020 2020 2020 2065  ")[0]).        e
-000142e0: 6d69 7373 696f 6e73 5f6f 7574 203d 2069  missions_out = i
-000142f0: 6e74 286c 696e 6573 5b63 7572 7265 6e74  nt(lines[current
-00014300: 5f6c 696e 6520 2b20 3131 5d2e 7374 7269  _line + 11].stri
-00014310: 7028 292e 7370 6c69 7428 2221 2229 5b30  p().split("!")[0
-00014320: 5d29 0a20 2020 2020 2020 2072 6164 6961  ]).        radia
-00014330: 7469 6f6e 5f6f 7574 203d 2069 6e74 286c  tion_out = int(l
-00014340: 696e 6573 5b63 7572 7265 6e74 5f6c 696e  ines[current_lin
-00014350: 6520 2b20 3132 5d2e 7374 7269 7028 292e  e + 12].strip().
-00014360: 7370 6c69 7428 2221 2229 5b30 5d29 0a20  split("!")[0]). 
-00014370: 2020 2020 2020 2069 6e74 656e 7369 7479         intensity
-00014380: 5f6f 7574 203d 2069 6e74 286c 696e 6573  _out = int(lines
-00014390: 5b63 7572 7265 6e74 5f6c 696e 6520 2b20  [current_line + 
-000143a0: 3133 5d2e 7374 7269 7028 292e 7370 6c69  13].strip().spli
-000143b0: 7428 2221 2229 5b30 5d29 0a20 2020 2020  t("!")[0]).     
-000143c0: 2020 2023 2021 2041 5554 4f4b 494c 4c0a     # ! AUTOKILL.
-000143d0: 2020 2020 2020 2020 6175 746f 5f6b 696c          auto_kil
-000143e0: 6c20 3d20 696e 7428 6c69 6e65 735b 6375  l = int(lines[cu
-000143f0: 7272 656e 745f 6c69 6e65 202b 2031 355d  rrent_line + 15]
-00014400: 2e73 7472 6970 2829 2e73 706c 6974 2822  .strip().split("
-00014410: 2122 295b 305d 290a 0a20 2020 2020 2020  !")[0])..       
-00014420: 2072 6574 7572 6e20 636c 7328 0a20 2020   return cls(.   
-00014430: 2020 2020 2020 2020 2066 6972 655f 666c           fire_fl
-00014440: 6167 3d66 6972 655f 666c 6167 2c0a 2020  ag=fire_flag,.  
-00014450: 2020 2020 2020 2020 2020 7261 6e64 6f6d            random
-00014460: 5f73 6565 643d 7261 6e64 6f6d 5f73 6565  _seed=random_see
-00014470: 642c 0a20 2020 2020 2020 2020 2020 2074  d,.            t
-00014480: 696d 655f 6e6f 773d 7469 6d65 5f6e 6f77  ime_now=time_now
-00014490: 2c0a 2020 2020 2020 2020 2020 2020 7369  ,.            si
-000144a0: 6d5f 7469 6d65 3d73 696d 5f74 696d 652c  m_time=sim_time,
-000144b0: 0a20 2020 2020 2020 2020 2020 2066 6972  .            fir
-000144c0: 655f 7469 6d65 5f73 7465 703d 6669 7265  e_time_step=fire
-000144d0: 5f74 696d 655f 7374 6570 2c0a 2020 2020  _time_step,.    
-000144e0: 2020 2020 2020 2020 7175 6963 5f74 696d          quic_tim
-000144f0: 655f 7374 6570 3d71 7569 635f 7469 6d65  e_step=quic_time
-00014500: 5f73 7465 702c 0a20 2020 2020 2020 2020  _step,.         
-00014510: 2020 206f 7574 5f74 696d 655f 6669 7265     out_time_fire
-00014520: 3d6f 7574 5f74 696d 655f 6669 7265 2c0a  =out_time_fire,.
-00014530: 2020 2020 2020 2020 2020 2020 6f75 745f              out_
-00014540: 7469 6d65 5f77 696e 643d 6f75 745f 7469  time_wind=out_ti
-00014550: 6d65 5f77 696e 642c 0a20 2020 2020 2020  me_wind,.       
-00014560: 2020 2020 206f 7574 5f74 696d 655f 656d       out_time_em
-00014570: 6973 5f72 6164 3d6f 7574 5f74 696d 655f  is_rad=out_time_
-00014580: 656d 6973 5f72 6164 2c0a 2020 2020 2020  emis_rad,.      
-00014590: 2020 2020 2020 6f75 745f 7469 6d65 5f77        out_time_w
-000145a0: 696e 645f 6176 673d 6f75 745f 7469 6d65  ind_avg=out_time
-000145b0: 5f77 696e 645f 6176 672c 0a20 2020 2020  _wind_avg,.     
-000145c0: 2020 2020 2020 206e 7a3d 6e7a 2c0a 2020         nz=nz,.  
-000145d0: 2020 2020 2020 2020 2020 7374 7265 7463            stretc
-000145e0: 685f 6772 6964 5f66 6c61 673d 7374 7265  h_grid_flag=stre
-000145f0: 7463 685f 6772 6964 5f66 6c61 672c 0a20  tch_grid_flag,. 
-00014600: 2020 2020 2020 2020 2020 2064 7a3d 647a             dz=dz
-00014610: 2c0a 2020 2020 2020 2020 2020 2020 647a  ,.            dz
-00014620: 5f61 7272 6179 3d64 7a5f 6172 7261 792c  _array=dz_array,
-00014630: 0a20 2020 2020 2020 2020 2020 2066 7565  .            fue
-00014640: 6c5f 6465 6e73 6974 795f 666c 6167 3d66  l_density_flag=f
-00014650: 7565 6c5f 6465 6e73 6974 795f 666c 6167  uel_density_flag
-00014660: 2c0a 2020 2020 2020 2020 2020 2020 6675  ,.            fu
-00014670: 656c 5f64 656e 7369 7479 3d66 7565 6c5f  el_density=fuel_
-00014680: 6465 6e73 6974 792c 0a20 2020 2020 2020  density,.       
-00014690: 2020 2020 2066 7565 6c5f 6d6f 6973 7475       fuel_moistu
-000146a0: 7265 5f66 6c61 673d 6675 656c 5f6d 6f69  re_flag=fuel_moi
-000146b0: 7374 7572 655f 666c 6167 2c0a 2020 2020  sture_flag,.    
-000146c0: 2020 2020 2020 2020 6675 656c 5f6d 6f69          fuel_moi
-000146d0: 7374 7572 653d 6675 656c 5f6d 6f69 7374  sture=fuel_moist
-000146e0: 7572 652c 0a20 2020 2020 2020 2020 2020  ure,.           
-000146f0: 2066 7565 6c5f 6865 6967 6874 5f66 6c61   fuel_height_fla
-00014700: 673d 6675 656c 5f68 6569 6768 745f 666c  g=fuel_height_fl
-00014710: 6167 2c0a 2020 2020 2020 2020 2020 2020  ag,.            
-00014720: 6675 656c 5f68 6569 6768 743d 6675 656c  fuel_height=fuel
-00014730: 5f68 6569 6768 742c 0a20 2020 2020 2020  _height,.       
-00014740: 2020 2020 2073 697a 655f 7363 616c 655f       size_scale_
-00014750: 666c 6167 3d73 697a 655f 7363 616c 655f  flag=size_scale_
-00014760: 666c 6167 2c0a 2020 2020 2020 2020 2020  flag,.          
-00014770: 2020 7369 7a65 5f73 6361 6c65 3d73 697a    size_scale=siz
-00014780: 655f 7363 616c 652c 0a20 2020 2020 2020  e_scale,.       
-00014790: 2020 2020 2070 6174 6368 5f61 6e64 5f67       patch_and_g
-000147a0: 6170 5f66 6c61 673d 7061 7463 685f 616e  ap_flag=patch_an
-000147b0: 645f 6761 705f 666c 6167 2c0a 2020 2020  d_gap_flag,.    
-000147c0: 2020 2020 2020 2020 7061 7463 685f 7369          patch_si
-000147d0: 7a65 3d70 6174 6368 5f73 697a 652c 0a20  ze=patch_size,. 
-000147e0: 2020 2020 2020 2020 2020 2067 6170 5f73             gap_s
-000147f0: 697a 653d 6761 705f 7369 7a65 2c0a 2020  ize=gap_size,.  
-00014800: 2020 2020 2020 2020 2020 6967 6e69 7469            igniti
-00014810: 6f6e 5f74 7970 653d 6967 6e69 7469 6f6e  on_type=ignition
-00014820: 5f74 7970 652c 0a20 2020 2020 2020 2020  _type,.         
-00014830: 2020 2069 676e 6974 696f 6e73 5f70 6572     ignitions_per
-00014840: 5f63 656c 6c3d 6967 6e69 7469 6f6e 735f  _cell=ignitions_
-00014850: 7065 725f 6365 6c6c 2c0a 2020 2020 2020  per_cell,.      
-00014860: 2020 2020 2020 6669 7265 6272 616e 645f        firebrand_
-00014870: 666c 6167 3d66 6972 6562 7261 6e64 5f66  flag=firebrand_f
-00014880: 6c61 672c 0a20 2020 2020 2020 2020 2020  lag,.           
-00014890: 2065 6e67 5f74 6f5f 6174 6d5f 6f75 743d   eng_to_atm_out=
-000148a0: 656e 675f 746f 5f61 746d 5f6f 7574 2c0a  eng_to_atm_out,.
-000148b0: 2020 2020 2020 2020 2020 2020 7265 6163              reac
-000148c0: 745f 7261 7465 5f6f 7574 3d72 6561 6374  t_rate_out=react
-000148d0: 5f72 6174 655f 6f75 742c 0a20 2020 2020  _rate_out,.     
-000148e0: 2020 2020 2020 2066 7565 6c5f 6465 6e73         fuel_dens
-000148f0: 5f6f 7574 3d66 7565 6c5f 6465 6e73 5f6f  _out=fuel_dens_o
-00014900: 7574 2c0a 2020 2020 2020 2020 2020 2020  ut,.            
-00014910: 7166 5f77 696e 645f 6f75 743d 7166 5f77  qf_wind_out=qf_w
-00014920: 696e 645f 6f75 742c 0a20 2020 2020 2020  ind_out,.       
-00014930: 2020 2020 2071 755f 7769 6e64 5f69 6e73       qu_wind_ins
-00014940: 745f 6f75 743d 7175 5f77 696e 645f 696e  t_out=qu_wind_in
-00014950: 7374 5f6f 7574 2c0a 2020 2020 2020 2020  st_out,.        
-00014960: 2020 2020 7175 5f77 696e 645f 6176 675f      qu_wind_avg_
-00014970: 6f75 743d 7175 5f77 696e 645f 6176 675f  out=qu_wind_avg_
-00014980: 6f75 742c 0a20 2020 2020 2020 2020 2020  out,.           
-00014990: 2066 7565 6c5f 6d6f 6973 745f 6f75 743d   fuel_moist_out=
-000149a0: 6675 656c 5f6d 6f69 7374 5f6f 7574 2c0a  fuel_moist_out,.
-000149b0: 2020 2020 2020 2020 2020 2020 6d61 7373              mass
-000149c0: 5f62 7572 6e74 5f6f 7574 3d6d 6173 735f  _burnt_out=mass_
-000149d0: 6275 726e 745f 6f75 742c 0a20 2020 2020  burnt_out,.     
-000149e0: 2020 2020 2020 2066 6972 6562 7261 6e64         firebrand
-000149f0: 5f6f 7574 3d66 6972 6562 7261 6e64 5f6f  _out=firebrand_o
-00014a00: 7574 2c0a 2020 2020 2020 2020 2020 2020  ut,.            
-00014a10: 656d 6973 7369 6f6e 735f 6f75 743d 656d  emissions_out=em
-00014a20: 6973 7369 6f6e 735f 6f75 742c 0a20 2020  issions_out,.   
-00014a30: 2020 2020 2020 2020 2072 6164 6961 7469           radiati
-00014a40: 6f6e 5f6f 7574 3d72 6164 6961 7469 6f6e  on_out=radiation
-00014a50: 5f6f 7574 2c0a 2020 2020 2020 2020 2020  _out,.          
-00014a60: 2020 696e 7465 6e73 6974 795f 6f75 743d    intensity_out=
-00014a70: 696e 7465 6e73 6974 795f 6f75 742c 0a20  intensity_out,. 
-00014a80: 2020 2020 2020 2020 2020 2061 7574 6f5f             auto_
-00014a90: 6b69 6c6c 3d61 7574 6f5f 6b69 6c6c 2c0a  kill=auto_kill,.
-00014aa0: 2020 2020 2020 2020 290a 0a0a 636c 6173          )...clas
-00014ab0: 7320 5146 6972 655f 426c 6467 5f41 6476  s QFire_Bldg_Adv
-00014ac0: 616e 6365 645f 5573 6572 5f49 6e70 7574  anced_User_Input
-00014ad0: 7328 496e 7075 7446 696c 6529 3a0a 2020  s(InputFile):.  
-00014ae0: 2020 2222 220a 2020 2020 436c 6173 7320    """.    Class 
-00014af0: 7265 7072 6573 656e 7469 6e67 2074 6865  representing the
-00014b00: 2051 4669 7265 5f42 6c64 675f 4164 7661   QFire_Bldg_Adva
-00014b10: 6e63 6564 5f55 7365 725f 496e 7075 7473  nced_User_Inputs
-00014b20: 2e69 6e70 2069 6e70 7574 2066 696c 652e  .inp input file.
-00014b30: 2054 6869 730a 2020 2020 6669 6c65 2063   This.    file c
-00014b40: 6f6e 7461 696e 7320 6164 7661 6e63 6564  ontains advanced
-00014b50: 2070 6172 616d 6574 6572 7320 7265 6c61   parameters rela
-00014b60: 7465 6420 746f 2062 7569 6c64 696e 6773  ted to buildings
-00014b70: 2061 6e64 2066 7565 6c2e 0a0a 2020 2020   and fuel...    
-00014b80: 4174 7472 6962 7574 6573 0a20 2020 202d  Attributes.    -
-00014b90: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 636f  ---------.    co
-00014ba0: 6e76 6572 745f 6275 696c 6469 6e67 735f  nvert_buildings_
-00014bb0: 746f 5f66 7565 6c5f 666c 6167 203a 2069  to_fuel_flag : i
-00014bc0: 6e74 0a20 2020 2020 2020 2046 6c61 6720  nt.        Flag 
-00014bd0: 746f 2063 6f6e 7665 7274 2051 5549 432d  to convert QUIC-
-00014be0: 5552 4220 6275 696c 6469 6e67 7320 746f  URB buildings to
-00014bf0: 2066 7565 6c2e 2030 203d 2064 6f20 6e6f   fuel. 0 = do no
-00014c00: 7420 636f 6e76 6572 742c 0a20 2020 2020  t convert,.     
-00014c10: 2020 2031 203d 2063 6f6e 7665 7274 2e20     1 = convert. 
-00014c20: 5265 636f 6d6d 656e 6465 6420 7661 6c75  Recommended valu
-00014c30: 653a 2030 2e0a 2020 2020 6275 696c 6469  e: 0..    buildi
-00014c40: 6e67 5f66 7565 6c5f 6465 6e73 6974 7920  ng_fuel_density 
-00014c50: 3a20 506f 7369 7469 7665 466c 6f61 740a  : PositiveFloat.
-00014c60: 2020 2020 2020 2020 5468 696e 2066 7565          Thin fue
-00014c70: 6c20 6465 6e73 6974 7920 7769 7468 696e  l density within
-00014c80: 2062 7569 6c64 696e 6773 2069 6620 6e6f   buildings if no
-00014c90: 2066 7565 6c20 6973 2073 7065 6369 6669   fuel is specifi
-00014ca0: 6564 2061 6e64 2062 7569 6c64 696e 6773  ed and buildings
-00014cb0: 0a20 2020 2020 2020 2061 7265 2063 6f6e  .        are con
-00014cc0: 7665 7274 6564 2074 6f20 6675 656c 2e20  verted to fuel. 
-00014cd0: 4869 6768 6572 2076 616c 7565 203d 206d  Higher value = m
-00014ce0: 6f72 6520 6675 656c 2e20 5265 636f 6d6d  ore fuel. Recomm
-00014cf0: 656e 6465 6420 7661 6c75 653a 2030 2e35  ended value: 0.5
-00014d00: 2e0a 2020 2020 2020 2020 556e 6974 733a  ..        Units:
-00014d10: 205b 6b67 2f6d 5e33 5d0a 2020 2020 6275   [kg/m^3].    bu
-00014d20: 696c 6469 6e67 5f61 7474 656e 7561 7469  ilding_attenuati
-00014d30: 6f6e 5f63 6f65 6666 6963 6965 6e74 203a  on_coefficient :
-00014d40: 2050 6f73 6974 6976 6546 6c6f 6174 0a20   PositiveFloat. 
-00014d50: 2020 2020 2020 2041 7474 656e 7561 7469         Attenuati
-00014d60: 6f6e 2063 6f65 6666 6963 6965 6e74 2077  on coefficient w
-00014d70: 6974 6869 6e20 6275 696c 6469 6e67 7320  ithin buildings 
-00014d80: 6966 2062 7569 6c64 696e 6773 2061 7265  if buildings are
-00014d90: 2063 6f6e 7665 7274 6564 2074 6f0a 2020   converted to.  
-00014da0: 2020 2020 2020 6675 656c 2e20 4869 6768        fuel. High
-00014db0: 6572 2076 616c 7565 203d 206d 6f72 6520  er value = more 
-00014dc0: 6472 6167 2e20 5265 636f 6d6d 656e 6465  drag. Recommende
-00014dd0: 6420 7661 6c75 653a 2032 2e0a 2020 2020  d value: 2..    
-00014de0: 6275 696c 6469 6e67 5f73 7572 6661 6365  building_surface
-00014df0: 5f72 6f75 6768 6e65 7373 203a 2050 6f73  _roughness : Pos
-00014e00: 6974 6976 6546 6c6f 6174 0a20 2020 2020  itiveFloat.     
-00014e10: 2020 2053 7572 6661 6365 2072 6f75 6768     Surface rough
-00014e20: 6e65 7373 2077 6974 6869 6e20 6275 696c  ness within buil
-00014e30: 6469 6e67 7320 6966 2062 7569 6c64 696e  dings if buildin
-00014e40: 6773 2061 7265 2063 6f6e 7665 7274 6564  gs are converted
-00014e50: 2074 6f20 6675 656c 2e0a 2020 2020 2020   to fuel..      
-00014e60: 2020 4869 6768 6572 2076 616c 7565 203d    Higher value =
-00014e70: 206c 6f77 6572 2077 696e 6420 7370 6565   lower wind spee
-00014e80: 642e 2052 6563 6f6d 6d65 6e64 6564 2076  d. Recommended v
-00014e90: 616c 7565 3a20 302e 3031 206d 2e20 556e  alue: 0.01 m. Un
-00014ea0: 6974 733a 205b 6d5d 0a20 2020 2063 6f6e  its: [m].    con
-00014eb0: 7665 7274 5f66 7565 6c5f 746f 5f63 616e  vert_fuel_to_can
-00014ec0: 6f70 795f 666c 6167 203a 2069 6e74 0a20  opy_flag : int. 
-00014ed0: 2020 2020 2020 2046 6c61 6720 746f 2063         Flag to c
-00014ee0: 6f6e 7665 7274 2066 7565 6c20 746f 2063  onvert fuel to c
-00014ef0: 616e 6f70 7920 666f 7220 7769 6e64 732e  anopy for winds.
-00014f00: 2030 203d 2064 6f20 6e6f 7420 636f 6e76   0 = do not conv
-00014f10: 6572 742c 0a20 2020 2020 2020 2031 203d  ert,.        1 =
-00014f20: 2063 6f6e 7665 7274 2e20 5265 636f 6d6d   convert. Recomm
-00014f30: 656e 6465 6420 7661 6c75 653a 2031 2e0a  ended value: 1..
-00014f40: 2020 2020 7570 6461 7465 5f63 616e 6f70      update_canop
-00014f50: 795f 7769 6e64 735f 666c 6167 203a 2069  y_winds_flag : i
-00014f60: 6e74 0a20 2020 2020 2020 2046 6c61 6720  nt.        Flag 
-00014f70: 746f 2075 7064 6174 6520 6361 6e6f 7079  to update canopy
-00014f80: 2077 696e 6473 2077 6865 6e20 6675 656c   winds when fuel
-00014f90: 2069 7320 636f 6e73 756d 6564 2e20 3020   is consumed. 0 
-00014fa0: 3d20 646f 206e 6f74 2075 7064 6174 652c  = do not update,
-00014fb0: 0a20 2020 2020 2020 2031 203d 2075 7064  .        1 = upd
-00014fc0: 6174 652e 2052 6563 6f6d 6d65 6e64 6564  ate. Recommended
-00014fd0: 2076 616c 7565 3a20 312e 0a20 2020 2066   value: 1..    f
-00014fe0: 7565 6c5f 6174 7465 6e75 6174 696f 6e5f  uel_attenuation_
-00014ff0: 636f 6566 6669 6369 656e 7420 3a20 506f  coefficient : Po
-00015000: 7369 7469 7665 466c 6f61 740a 2020 2020  sitiveFloat.    
-00015010: 2020 2020 4174 7465 6e75 6174 696f 6e20      Attenuation 
-00015020: 636f 6566 6669 6369 656e 7420 7769 7468  coefficient with
-00015030: 696e 2066 7565 6c20 666f 7220 7468 6520  in fuel for the 
-00015040: 7769 6e64 2070 726f 6669 6c65 2e20 4869  wind profile. Hi
-00015050: 6768 6572 0a20 2020 2020 2020 2076 616c  gher.        val
-00015060: 7565 203d 206d 6f72 6520 6472 6167 2e20  ue = more drag. 
-00015070: 5265 636f 6d6d 656e 6465 6420 7661 6c75  Recommended valu
-00015080: 653a 2031 2e0a 2020 2020 6675 656c 5f73  e: 1..    fuel_s
-00015090: 7572 6661 6365 5f72 6f75 6768 6e65 7373  urface_roughness
-000150a0: 203a 2050 6f73 6974 6976 6546 6c6f 6174   : PositiveFloat
-000150b0: 0a20 2020 2020 2020 2053 7572 6661 6365  .        Surface
-000150c0: 2072 6f75 6768 6e65 7373 2077 6974 6869   roughness withi
-000150d0: 6e20 6675 656c 2e20 4869 6768 6572 2076  n fuel. Higher v
-000150e0: 616c 7565 203d 206c 6f77 6572 2077 696e  alue = lower win
-000150f0: 6420 7370 6565 642e 0a20 2020 2020 2020  d speed..       
-00015100: 2052 6563 6f6d 6d65 6e64 6564 2076 616c   Recommended val
-00015110: 7565 3a20 302e 3120 6d2e 2055 6e69 7473  ue: 0.1 m. Units
-00015120: 3a20 5b6d 5d0a 2020 2020 2222 220a 0a20  : [m].    """.. 
-00015130: 2020 206e 616d 653a 2073 7472 203d 2046     name: str = F
-00015140: 6965 6c64 2822 5146 6972 655f 426c 6467  ield("QFire_Bldg
-00015150: 5f41 6476 616e 6365 645f 5573 6572 5f49  _Advanced_User_I
-00015160: 6e70 7574 7322 2c20 6672 6f7a 656e 3d54  nputs", frozen=T
-00015170: 7275 6529 0a20 2020 205f 6578 7465 6e73  rue).    _extens
-00015180: 696f 6e3a 2073 7472 203d 2022 2e69 6e70  ion: str = ".inp
-00015190: 220a 2020 2020 636f 6e76 6572 745f 6275  ".    convert_bu
-000151a0: 696c 6469 6e67 735f 746f 5f66 7565 6c5f  ildings_to_fuel_
-000151b0: 666c 6167 3a20 4c69 7465 7261 6c5b 302c  flag: Literal[0,
-000151c0: 2031 5d20 3d20 300a 2020 2020 6275 696c   1] = 0.    buil
-000151d0: 6469 6e67 5f66 7565 6c5f 6465 6e73 6974  ding_fuel_densit
-000151e0: 793a 2050 6f73 6974 6976 6546 6c6f 6174  y: PositiveFloat
-000151f0: 203d 2046 6965 6c64 2830 2e35 2c20 6765   = Field(0.5, ge
-00015200: 3d30 290a 2020 2020 6275 696c 6469 6e67  =0).    building
-00015210: 5f61 7474 656e 7561 7469 6f6e 5f63 6f65  _attenuation_coe
-00015220: 6666 6963 6965 6e74 3a20 506f 7369 7469  fficient: Positi
-00015230: 7665 466c 6f61 7420 3d20 4669 656c 6428  veFloat = Field(
-00015240: 322e 302c 2067 653d 3029 0a20 2020 2062  2.0, ge=0).    b
-00015250: 7569 6c64 696e 675f 7375 7266 6163 655f  uilding_surface_
-00015260: 726f 7567 686e 6573 733a 2050 6f73 6974  roughness: Posit
-00015270: 6976 6546 6c6f 6174 203d 2046 6965 6c64  iveFloat = Field
-00015280: 2830 2e30 312c 2067 653d 3029 0a20 2020  (0.01, ge=0).   
-00015290: 2063 6f6e 7665 7274 5f66 7565 6c5f 746f   convert_fuel_to
-000152a0: 5f63 616e 6f70 795f 666c 6167 3a20 4c69  _canopy_flag: Li
-000152b0: 7465 7261 6c5b 302c 2031 5d20 3d20 310a  teral[0, 1] = 1.
-000152c0: 2020 2020 7570 6461 7465 5f63 616e 6f70      update_canop
-000152d0: 795f 7769 6e64 735f 666c 6167 3a20 4c69  y_winds_flag: Li
-000152e0: 7465 7261 6c5b 302c 2031 5d20 3d20 310a  teral[0, 1] = 1.
-000152f0: 2020 2020 6675 656c 5f61 7474 656e 7561      fuel_attenua
-00015300: 7469 6f6e 5f63 6f65 6666 6963 6965 6e74  tion_coefficient
-00015310: 3a20 506f 7369 7469 7665 466c 6f61 7420  : PositiveFloat 
-00015320: 3d20 4669 656c 6428 312e 302c 2067 653d  = Field(1.0, ge=
-00015330: 3029 0a20 2020 2066 7565 6c5f 7375 7266  0).    fuel_surf
-00015340: 6163 655f 726f 7567 686e 6573 733a 2050  ace_roughness: P
-00015350: 6f73 6974 6976 6546 6c6f 6174 203d 2046  ositiveFloat = F
-00015360: 6965 6c64 2830 2e31 2c20 6765 3d30 290a  ield(0.1, ge=0).
-00015370: 0a20 2020 2040 636c 6173 736d 6574 686f  .    @classmetho
-00015380: 640a 2020 2020 6465 6620 6672 6f6d 5f66  d.    def from_f
-00015390: 696c 6528 636c 732c 2064 6972 6563 746f  ile(cls, directo
-000153a0: 7279 3a20 7374 7220 7c20 5061 7468 2c20  ry: str | Path, 
-000153b0: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
-000153c0: 2020 2022 2222 0a20 2020 2020 2020 2049     """.        I
-000153d0: 6e69 7469 616c 697a 6573 2061 2051 4669  nitializes a QFi
-000153e0: 7265 5f42 6c64 675f 4164 7661 6e63 6564  re_Bldg_Advanced
-000153f0: 5f55 7365 725f 496e 7075 7473 206f 626a  _User_Inputs obj
-00015400: 6563 7420 6672 6f6d 2061 2064 6972 6563  ect from a direc
-00015410: 746f 7279 0a20 2020 2020 2020 2063 6f6e  tory.        con
-00015420: 7461 696e 696e 6720 6120 5146 6972 655f  taining a QFire_
-00015430: 426c 6467 5f41 6476 616e 6365 645f 5573  Bldg_Advanced_Us
-00015440: 6572 5f49 6e70 7574 732e 696e 7020 6669  er_Inputs.inp fi
-00015450: 6c65 2e0a 2020 2020 2020 2020 2222 220a  le..        """.
-00015460: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-00015470: 7461 6e63 6528 6469 7265 6374 6f72 792c  tance(directory,
-00015480: 2073 7472 293a 0a20 2020 2020 2020 2020   str):.         
-00015490: 2020 2064 6972 6563 746f 7279 203d 2050     directory = P
-000154a0: 6174 6828 6469 7265 6374 6f72 7929 0a20  ath(directory). 
-000154b0: 2020 2020 2020 2077 6974 6820 6f70 656e         with open
-000154c0: 2864 6972 6563 746f 7279 202f 2022 5146  (directory / "QF
-000154d0: 6972 655f 426c 6467 5f41 6476 616e 6365  ire_Bldg_Advance
-000154e0: 645f 5573 6572 5f49 6e70 7574 732e 696e  d_User_Inputs.in
-000154f0: 7022 2c20 2272 2229 2061 7320 663a 0a20  p", "r") as f:. 
-00015500: 2020 2020 2020 2020 2020 206c 696e 6573             lines
-00015510: 203d 2066 2e72 6561 646c 696e 6573 2829   = f.readlines()
-00015520: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00015530: 636c 7328 0a20 2020 2020 2020 2020 2020  cls(.           
-00015540: 2063 6f6e 7665 7274 5f62 7569 6c64 696e   convert_buildin
-00015550: 6773 5f74 6f5f 6675 656c 5f66 6c61 673d  gs_to_fuel_flag=
-00015560: 696e 7428 6c69 6e65 735b 305d 2e73 706c  int(lines[0].spl
-00015570: 6974 2829 5b30 5d29 2c0a 2020 2020 2020  it()[0]),.      
-00015580: 2020 2020 2020 6275 696c 6469 6e67 5f66        building_f
-00015590: 7565 6c5f 6465 6e73 6974 793d 666c 6f61  uel_density=floa
-000155a0: 7428 6c69 6e65 735b 315d 2e73 706c 6974  t(lines[1].split
-000155b0: 2829 5b30 5d29 2c0a 2020 2020 2020 2020  ()[0]),.        
-000155c0: 2020 2020 6275 696c 6469 6e67 5f61 7474      building_att
-000155d0: 656e 7561 7469 6f6e 5f63 6f65 6666 6963  enuation_coeffic
-000155e0: 6965 6e74 3d66 6c6f 6174 286c 696e 6573  ient=float(lines
-000155f0: 5b32 5d2e 7370 6c69 7428 295b 305d 292c  [2].split()[0]),
-00015600: 0a20 2020 2020 2020 2020 2020 2062 7569  .            bui
-00015610: 6c64 696e 675f 7375 7266 6163 655f 726f  lding_surface_ro
-00015620: 7567 686e 6573 733d 666c 6f61 7428 6c69  ughness=float(li
-00015630: 6e65 735b 335d 2e73 706c 6974 2829 5b30  nes[3].split()[0
-00015640: 5d29 2c0a 2020 2020 2020 2020 2020 2020  ]),.            
-00015650: 636f 6e76 6572 745f 6675 656c 5f74 6f5f  convert_fuel_to_
-00015660: 6361 6e6f 7079 5f66 6c61 673d 696e 7428  canopy_flag=int(
-00015670: 6c69 6e65 735b 345d 2e73 706c 6974 2829  lines[4].split()
-00015680: 5b30 5d29 2c0a 2020 2020 2020 2020 2020  [0]),.          
-00015690: 2020 7570 6461 7465 5f63 616e 6f70 795f    update_canopy_
-000156a0: 7769 6e64 735f 666c 6167 3d69 6e74 286c  winds_flag=int(l
-000156b0: 696e 6573 5b35 5d2e 7370 6c69 7428 295b  ines[5].split()[
-000156c0: 305d 292c 0a20 2020 2020 2020 2020 2020  0]),.           
-000156d0: 2066 7565 6c5f 6174 7465 6e75 6174 696f   fuel_attenuatio
-000156e0: 6e5f 636f 6566 6669 6369 656e 743d 666c  n_coefficient=fl
-000156f0: 6f61 7428 6c69 6e65 735b 365d 2e73 706c  oat(lines[6].spl
-00015700: 6974 2829 5b30 5d29 2c0a 2020 2020 2020  it()[0]),.      
-00015710: 2020 2020 2020 6675 656c 5f73 7572 6661        fuel_surfa
-00015720: 6365 5f72 6f75 6768 6e65 7373 3d66 6c6f  ce_roughness=flo
-00015730: 6174 286c 696e 6573 5b37 5d2e 7370 6c69  at(lines[7].spli
-00015740: 7428 295b 305d 292c 0a20 2020 2020 2020  t()[0]),.       
-00015750: 2029 0a0a 0a63 6c61 7373 2051 4669 7265   )...class QFire
-00015760: 5f50 6c75 6d65 5f41 6476 616e 6365 645f  _Plume_Advanced_
-00015770: 5573 6572 5f49 6e70 7574 7328 496e 7075  User_Inputs(Inpu
-00015780: 7446 696c 6529 3a0a 2020 2020 2222 220a  tFile):.    """.
-00015790: 2020 2020 436c 6173 7320 7265 7072 6573      Class repres
-000157a0: 656e 7469 6e67 2074 6865 2051 4669 7265  enting the QFire
-000157b0: 5f50 6c75 6d65 5f41 6476 616e 6365 645f  _Plume_Advanced_
-000157c0: 5573 6572 5f49 6e70 7574 732e 696e 7020  User_Inputs.inp 
-000157d0: 696e 7075 7420 6669 6c65 2e0a 2020 2020  input file..    
-000157e0: 5468 6973 2066 696c 6520 636f 6e74 6169  This file contai
-000157f0: 6e73 2061 6476 616e 6365 6420 7061 7261  ns advanced para
-00015800: 6d65 7465 7273 2072 656c 6174 6564 2074  meters related t
-00015810: 6f20 6d6f 6465 6c69 6e67 2062 756f 7961  o modeling buoya
-00015820: 6e74 2070 6c75 6d65 732e 0a0a 2020 2020  nt plumes...    
-00015830: 4174 7472 6962 7574 6573 0a20 2020 202d  Attributes.    -
-00015840: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 6d61  ---------.    ma
-00015850: 785f 706c 756d 6573 5f70 6572 5f74 696d  x_plumes_per_tim
-00015860: 6573 7465 7020 3a20 506f 7369 7469 7665  estep : Positive
-00015870: 496e 740a 2020 2020 2020 2020 4d61 7869  Int.        Maxi
-00015880: 6d75 6d20 6e75 6d62 6572 206f 6620 706c  mum number of pl
-00015890: 756d 6573 2061 6c6c 6f77 6564 2061 7420  umes allowed at 
-000158a0: 6561 6368 2074 696d 6520 7374 6570 2e20  each time step. 
-000158b0: 4869 6768 6572 2076 616c 7565 7320 736c  Higher values sl
-000158c0: 6f77 0a20 2020 2020 2020 2064 6f77 6e20  ow.        down 
-000158d0: 7468 6520 7369 6d75 6c61 7469 6f6e 2e20  the simulation. 
-000158e0: 4465 6661 756c 7420 7661 6c75 653a 2031  Default value: 1
-000158f0: 3530 2c30 3030 2e20 5265 636f 6d6d 656e  50,000. Recommen
-00015900: 6465 6420 7261 6e67 653a 0a20 2020 2020  ded range:.     
-00015910: 2020 2035 302c 3030 3020 2d20 3530 302c     50,000 - 500,
-00015920: 3030 302e 0a20 2020 206d 696e 5f70 6c75  000..    min_plu
-00015930: 6d65 5f75 7064 7261 6674 5f76 656c 6f63  me_updraft_veloc
-00015940: 6974 7920 3a20 506f 7369 7469 7665 466c  ity : PositiveFl
-00015950: 6f61 740a 2020 2020 2020 2020 4d69 6e69  oat.        Mini
-00015960: 6d75 6d20 706c 756d 6520 7570 6472 6166  mum plume updraf
-00015970: 7420 7665 6c6f 6369 7479 205b 6d2f 735d  t velocity [m/s]
-00015980: 2e20 4966 2070 6c75 6d65 2076 656c 6f63  . If plume veloc
-00015990: 6974 7920 6472 6f70 7320 6265 6c6f 7720  ity drops below 
-000159a0: 7468 6973 0a20 2020 2020 2020 2076 616c  this.        val
-000159b0: 7565 2c20 7468 6520 706c 756d 6520 6973  ue, the plume is
-000159c0: 2072 656d 6f76 6564 2e20 4869 6768 6572   removed. Higher
-000159d0: 2076 616c 7565 7320 7265 6475 6365 206e   values reduce n
-000159e0: 756d 6265 7220 6f66 2070 6c75 6d65 732e  umber of plumes.
-000159f0: 0a20 2020 2020 2020 2044 6566 6175 6c74  .        Default
-00015a00: 2076 616c 7565 3a20 302e 3120 6d2f 732e   value: 0.1 m/s.
-00015a10: 0a20 2020 206d 6178 5f70 6c75 6d65 5f75  .    max_plume_u
-00015a20: 7064 7261 6674 5f76 656c 6f63 6974 7920  pdraft_velocity 
-00015a30: 3a20 506f 7369 7469 7665 466c 6f61 740a  : PositiveFloat.
-00015a40: 2020 2020 2020 2020 4d61 7869 6d75 6d20          Maximum 
-00015a50: 616c 6c6f 7765 6420 706c 756d 6520 7570  allowed plume up
-00015a60: 6472 6166 7420 7665 6c6f 6369 7479 205b  draft velocity [
-00015a70: 6d2f 735d 2e20 4465 6661 756c 7420 7661  m/s]. Default va
-00015a80: 6c75 653a 2031 3030 206d 2f73 2e0a 2020  lue: 100 m/s..  
-00015a90: 2020 6d69 6e5f 7665 6c6f 6369 7479 5f72    min_velocity_r
-00015aa0: 6174 696f 203a 2050 6f73 6974 6976 6546  atio : PositiveF
-00015ab0: 6c6f 6174 0a20 2020 2020 2020 204d 696e  loat.        Min
-00015ac0: 696d 756d 2072 6174 696f 2062 6574 7765  imum ratio betwe
-00015ad0: 656e 2070 6c75 6d65 2075 7064 7261 6674  en plume updraft
-00015ae0: 2076 656c 6f63 6974 7920 616e 6420 7769   velocity and wi
-00015af0: 6e64 2073 7065 6564 2e20 4966 2072 6174  nd speed. If rat
-00015b00: 696f 0a20 2020 2020 2020 2064 726f 7073  io.        drops
-00015b10: 2062 656c 6f77 2074 6869 7320 7661 6c75   below this valu
-00015b20: 652c 2070 6c75 6d65 2069 7320 7265 6d6f  e, plume is remo
-00015b30: 7665 642e 2048 6967 6865 7220 7661 6c75  ved. Higher valu
-00015b40: 6573 2072 6564 7563 6520 706c 756d 6573  es reduce plumes
-00015b50: 2e0a 2020 2020 2020 2020 4465 6661 756c  ..        Defaul
-00015b60: 7420 7661 6c75 653a 2030 2e31 2e0a 2020  t value: 0.1..  
-00015b70: 2020 6272 756e 745f 7661 6973 616c 615f    brunt_vaisala_
-00015b80: 6672 6571 5f73 7175 6172 6564 203a 204e  freq_squared : N
-00015b90: 6f6e 4e65 6761 7469 7665 466c 6f61 740a  onNegativeFloat.
-00015ba0: 2020 2020 2020 2020 496e 7665 7273 6520          Inverse 
-00015bb0: 6f66 2074 6865 2042 7275 6e74 2d56 6169  of the Brunt-Vai
-00015bc0: 7361 6c61 2066 7265 7175 656e 6379 2073  sala frequency s
-00015bd0: 7175 6172 6564 205b 312f 735e 325d 2c20  quared [1/s^2], 
-00015be0: 6120 6d65 6173 7572 6520 6f66 0a20 2020  a measure of.   
-00015bf0: 2020 2020 2061 746d 6f73 7068 6572 6963       atmospheric
-00015c00: 2073 7461 6269 6c69 7479 2e20 4465 6661   stability. Defa
-00015c10: 756c 7420 7661 6c75 653a 2030 2031 2f73  ult value: 0 1/s
-00015c20: 5e32 2e0a 2020 2020 6372 6565 7069 6e67  ^2..    creeping
-00015c30: 5f66 6c61 6720 3a20 4c69 7465 7261 6c5b  _flag : Literal[
-00015c40: 302c 2031 5d0a 2020 2020 2020 2020 466c  0, 1].        Fl
-00015c50: 6167 2074 6f20 656e 6162 6c65 2028 3129  ag to enable (1)
-00015c60: 206f 7220 6469 7361 626c 6520 2830 2920   or disable (0) 
-00015c70: 6669 7265 2073 7072 6561 6420 6279 2063  fire spread by c
-00015c80: 7265 6570 696e 672e 0a20 2020 2020 2020  reeping..       
-00015c90: 2044 6566 6175 6c74 2076 616c 7565 3a20   Default value: 
-00015ca0: 312e 0a20 2020 2061 6461 7074 6976 655f  1..    adaptive_
-00015cb0: 7469 6d65 7374 6570 5f66 6c61 6720 3a20  timestep_flag : 
-00015cc0: 4c69 7465 7261 6c5b 302c 2031 5d0a 2020  Literal[0, 1].  
-00015cd0: 2020 2020 2020 456e 6162 6c65 2028 3129        Enable (1)
-00015ce0: 206f 7220 6469 7361 626c 6520 2830 2920   or disable (0) 
-00015cf0: 6164 6170 7469 7665 2074 696d 6520 7374  adaptive time st
-00015d00: 6570 7069 6e67 2e20 4164 6170 7469 7665  epping. Adaptive
-00015d10: 2074 696d 6520 7374 6570 7069 6e67 0a20   time stepping. 
-00015d20: 2020 2020 2020 2069 6d70 726f 7665 7320         improves 
-00015d30: 6163 6375 7261 6379 2062 7574 2069 6e63  accuracy but inc
-00015d40: 7265 6173 6573 2073 696d 756c 6174 696f  reases simulatio
-00015d50: 6e20 7469 6d65 2e20 4465 6661 756c 7420  n time. Default 
-00015d60: 7661 6c75 653a 2030 2e0a 2020 2020 706c  value: 0..    pl
-00015d70: 756d 655f 7469 6d65 7374 6570 203a 2050  ume_timestep : P
-00015d80: 6f73 6974 6976 6546 6c6f 6174 0a20 2020  ositiveFloat.   
-00015d90: 2020 2020 2054 696d 6520 7374 6570 205b       Time step [
-00015da0: 735d 2075 7365 6420 746f 2063 6f6d 7075  s] used to compu
-00015db0: 7465 2062 756f 7961 6e74 2070 6c75 6d65  te buoyant plume
-00015dc0: 2074 7261 6a65 6374 6f72 6965 732e 2048   trajectories. H
-00015dd0: 6967 6865 7220 7661 6c75 6573 0a20 2020  igher values.   
-00015de0: 2020 2020 2072 6564 7563 6520 6163 6375       reduce accu
-00015df0: 7261 6379 2e20 4465 6661 756c 7420 7661  racy. Default va
-00015e00: 6c75 653a 2031 732e 0a20 2020 2073 6f72  lue: 1s..    sor
-00015e10: 5f6f 7074 696f 6e5f 666c 6167 203a 204c  _option_flag : L
-00015e20: 6974 6572 616c 5b30 2c20 315d 0a20 2020  iteral[0, 1].   
-00015e30: 2020 2020 2053 4f52 2073 6f6c 7665 7220       SOR solver 
-00015e40: 6f70 7469 6f6e 2e20 3020 3d20 7374 616e  option. 0 = stan
-00015e50: 6461 7264 2053 4f52 2c20 3120 3d20 6d65  dard SOR, 1 = me
-00015e60: 6d6f 7279 2053 4f52 2e20 4465 6661 756c  mory SOR. Defaul
-00015e70: 7420 7661 6c75 653a 2031 2e0a 2020 2020  t value: 1..    
-00015e80: 736f 725f 616c 7068 615f 706c 756d 655f  sor_alpha_plume_
-00015e90: 6365 6e74 6572 203a 2050 6f73 6974 6976  center : Positiv
-00015ea0: 6546 6c6f 6174 0a20 2020 2020 2020 2053  eFloat.        S
-00015eb0: 4f52 2061 6c70 6861 2076 616c 7565 2061  OR alpha value a
-00015ec0: 7420 706c 756d 6520 6365 6e74 6572 6c69  t plume centerli
-00015ed0: 6e65 2e20 4869 6768 6572 2076 616c 7565  ne. Higher value
-00015ee0: 7320 7265 6475 6365 2069 6e66 6c75 656e  s reduce influen
-00015ef0: 6365 206f 660a 2020 2020 2020 2020 706c  ce of.        pl
-00015f00: 756d 6573 206f 6e20 7769 6e64 732e 2044  umes on winds. D
-00015f10: 6566 6175 6c74 2076 616c 7565 3a20 3130  efault value: 10
-00015f20: 2e0a 2020 2020 736f 725f 616c 7068 615f  ..    sor_alpha_
-00015f30: 706c 756d 655f 6564 6765 203a 2050 6f73  plume_edge : Pos
-00015f40: 6974 6976 6546 6c6f 6174 0a20 2020 2020  itiveFloat.     
-00015f50: 2020 2053 4f52 2061 6c70 6861 2076 616c     SOR alpha val
-00015f60: 7565 2061 7420 706c 756d 6520 6564 6765  ue at plume edge
-00015f70: 2e20 4869 6768 6572 2076 616c 7565 7320  . Higher values 
-00015f80: 7265 6475 6365 2069 6e66 6c75 656e 6365  reduce influence
-00015f90: 206f 6620 706c 756d 6573 0a20 2020 2020   of plumes.     
-00015fa0: 2020 206f 6e20 7769 6e64 732e 2044 6566     on winds. Def
-00015fb0: 6175 6c74 2076 616c 7565 3a20 312e 0a20  ault value: 1.. 
-00015fc0: 2020 2020 2020 206d 6178 5f70 6c75 6d65         max_plume
-00015fd0: 5f6d 6572 6769 6e67 5f61 6e67 6c65 203a  _merging_angle :
-00015fe0: 2050 6f73 6974 6976 6546 6c6f 6174 0a20   PositiveFloat. 
-00015ff0: 2020 2020 2020 204d 6178 696d 756d 2061         Maximum a
-00016000: 6e67 6c65 205b 6465 6772 6565 735d 2062  ngle [degrees] b
-00016010: 6574 7765 656e 2070 6c75 6d65 7320 746f  etween plumes to
-00016020: 2064 6574 6572 6d69 6e65 206d 6572 6769   determine mergi
-00016030: 6e67 2065 6c69 6769 6269 6c69 7479 2e0a  ng eligibility..
-00016040: 2020 2020 2020 2020 4869 6768 6572 2076          Higher v
-00016050: 616c 7565 7320 696e 6372 6561 7365 2070  alues increase p
-00016060: 6c75 6d65 206d 6572 6769 6e67 2e20 4465  lume merging. De
-00016070: 6661 756c 7420 7661 6c75 653a 2033 3020  fault value: 30 
-00016080: 6465 6772 6565 732e 0a20 2020 206d 6178  degrees..    max
-00016090: 5f70 6c75 6d65 5f6f 7665 726c 6170 5f66  _plume_overlap_f
-000160a0: 7261 6374 696f 6e20 3a20 506f 7369 7469  raction : Positi
-000160b0: 7665 466c 6f61 740a 2020 2020 2020 2020  veFloat.        
-000160c0: 4d61 7869 6d75 6d20 6672 6163 7469 6f6e  Maximum fraction
-000160d0: 206f 6620 736d 616c 6c65 7220 706c 756d   of smaller plum
-000160e0: 6520 7472 616a 6563 746f 7279 206f 7665  e trajectory ove
-000160f0: 726c 6170 7065 6420 6279 206c 6172 6765  rlapped by large
-00016100: 7220 706c 756d 650a 2020 2020 2020 2020  r plume.        
-00016110: 746f 2062 6520 636f 6e73 6964 6572 6564  to be considered
-00016120: 2066 6f72 206d 6572 6769 6e67 2e20 4869   for merging. Hi
-00016130: 6768 6572 2076 616c 7565 7320 696e 6372  gher values incr
-00016140: 6561 7365 206d 6572 6769 6e67 2e0a 2020  ease merging..  
-00016150: 2020 706c 756d 655f 746f 5f67 7269 645f    plume_to_grid_
-00016160: 7570 6472 6166 7473 5f66 6c61 6720 3a20  updrafts_flag : 
-00016170: 4c69 7465 7261 6c5b 302c 2031 5d0a 2020  Literal[0, 1].  
-00016180: 2020 2020 2020 4d65 7468 6f64 2074 6f20        Method to 
-00016190: 6d61 7020 706c 756d 6520 7570 6472 6166  map plume updraf
-000161a0: 7473 2074 6f20 6772 6964 2e20 3020 3d20  ts to grid. 0 = 
-000161b0: 6e65 7720 6d65 7468 6f64 2c20 3120 3d20  new method, 1 = 
-000161c0: 6f6c 6420 6d65 7468 6f64 2e0a 2020 2020  old method..    
-000161d0: 2020 2020 4e65 7720 6d65 7468 6f64 2069      New method i
-000161e0: 6d70 726f 7665 7320 6163 6375 7261 6379  mproves accuracy
-000161f0: 2e20 4465 6661 756c 7420 7661 6c75 653a  . Default value:
-00016200: 2031 2e20 4e65 7720 6d65 7468 6f64 2074   1. New method t
-00016210: 616b 6573 206c 6f6e 6765 722c 0a20 2020  akes longer,.   
-00016220: 2020 2020 2062 7574 2069 7320 6e65 6564       but is need
-00016230: 6564 2069 6620 736d 6f6b 6520 6973 2073  ed if smoke is s
-00016240: 696d 756c 6174 6564 2061 6674 6572 7761  imulated afterwa
-00016250: 7264 732e 0a20 2020 206d 6178 5f70 6f69  rds..    max_poi
-00016260: 6e74 735f 616c 6f6e 675f 706c 756d 655f  nts_along_plume_
-00016270: 6564 6765 203a 2050 6f73 6974 6976 6549  edge : PositiveI
-00016280: 6e74 0a20 2020 2020 2020 204d 6178 696d  nt.        Maxim
-00016290: 756d 2070 6f69 6e74 7320 746f 2073 616d  um points to sam
-000162a0: 706c 6520 616c 6f6e 6720 6772 6964 2063  ple along grid c
-000162b0: 656c 6c20 6564 6765 2066 6f72 206e 6577  ell edge for new
-000162c0: 2070 6c75 6d65 2d74 6f2d 6772 6964 0a20   plume-to-grid. 
-000162d0: 2020 2020 2020 206d 6574 686f 642e 2044         method. D
-000162e0: 6566 6175 6c74 2076 616c 7565 3a20 3130  efault value: 10
-000162f0: 2e0a 2020 2020 706c 756d 655f 746f 5f67  ..    plume_to_g
-00016300: 7269 645f 696e 7465 7273 6563 7469 6f6e  rid_intersection
-00016310: 5f66 6c61 6720 3a20 4c69 7465 7261 6c5b  _flag : Literal[
-00016320: 302c 2031 5d0a 2020 2020 2020 2020 5363  0, 1].        Sc
-00016330: 6865 6d65 2074 6f20 7375 6d20 706c 756d  heme to sum plum
-00016340: 652d 746f 2d67 7269 6420 7570 6472 6166  e-to-grid updraf
-00016350: 7473 2077 6865 6e20 6d75 6c74 6970 6c65  ts when multiple
-00016360: 2070 6c75 6d65 7320 696e 7465 7273 6563   plumes intersec
-00016370: 7420 610a 2020 2020 2020 2020 6772 6964  t a.        grid
-00016380: 2063 656c 6c2e 2030 203d 2063 7562 6520   cell. 0 = cube 
-00016390: 6d65 7468 6f64 2c20 3120 3d20 6d61 7820  method, 1 = max 
-000163a0: 7661 6c75 6520 6d65 7468 6f64 2e20 4465  value method. De
-000163b0: 6661 756c 7420 7661 6c75 653a 2031 2e0a  fault value: 1..
-000163c0: 2020 2020 2222 220a 0a20 2020 206e 616d      """..    nam
-000163d0: 653a 2073 7472 203d 2046 6965 6c64 2822  e: str = Field("
-000163e0: 5146 6972 655f 506c 756d 655f 4164 7661  QFire_Plume_Adva
-000163f0: 6e63 6564 5f55 7365 725f 496e 7075 7473  nced_User_Inputs
-00016400: 222c 2066 726f 7a65 6e3d 5472 7565 290a  ", frozen=True).
-00016410: 2020 2020 5f65 7874 656e 7369 6f6e 3a20      _extension: 
-00016420: 7374 7220 3d20 222e 696e 7022 0a20 2020  str = ".inp".   
-00016430: 206d 6178 5f70 6c75 6d65 735f 7065 725f   max_plumes_per_
-00016440: 7469 6d65 7374 6570 3a20 506f 7369 7469  timestep: Positi
-00016450: 7665 496e 7420 3d20 4669 656c 6428 3135  veInt = Field(15
-00016460: 3030 3030 2c20 6774 3d30 290a 2020 2020  0000, gt=0).    
-00016470: 6d69 6e5f 706c 756d 655f 7570 6472 6166  min_plume_updraf
-00016480: 745f 7665 6c6f 6369 7479 3a20 506f 7369  t_velocity: Posi
-00016490: 7469 7665 466c 6f61 7420 3d20 4669 656c  tiveFloat = Fiel
-000164a0: 6428 302e 312c 2067 743d 3029 0a20 2020  d(0.1, gt=0).   
-000164b0: 206d 6178 5f70 6c75 6d65 5f75 7064 7261   max_plume_updra
-000164c0: 6674 5f76 656c 6f63 6974 793a 2050 6f73  ft_velocity: Pos
-000164d0: 6974 6976 6546 6c6f 6174 203d 2046 6965  itiveFloat = Fie
-000164e0: 6c64 2831 3030 2e30 2c20 6774 3d30 290a  ld(100.0, gt=0).
-000164f0: 2020 2020 6d69 6e5f 7665 6c6f 6369 7479      min_velocity
-00016500: 5f72 6174 696f 3a20 506f 7369 7469 7665  _ratio: Positive
-00016510: 466c 6f61 7420 3d20 4669 656c 6428 302e  Float = Field(0.
-00016520: 312c 2067 743d 3029 0a20 2020 2062 7275  1, gt=0).    bru
-00016530: 6e74 5f76 6169 7361 6c61 5f66 7265 715f  nt_vaisala_freq_
-00016540: 7371 7561 7265 643a 204e 6f6e 4e65 6761  squared: NonNega
-00016550: 7469 7665 466c 6f61 7420 3d20 4669 656c  tiveFloat = Fiel
-00016560: 6428 302e 302c 2067 653d 3029 0a20 2020  d(0.0, ge=0).   
-00016570: 2063 7265 6570 696e 675f 666c 6167 3a20   creeping_flag: 
-00016580: 4c69 7465 7261 6c5b 302c 2031 5d20 3d20  Literal[0, 1] = 
-00016590: 310a 2020 2020 6164 6170 7469 7665 5f74  1.    adaptive_t
-000165a0: 696d 6573 7465 705f 666c 6167 3a20 4c69  imestep_flag: Li
-000165b0: 7465 7261 6c5b 302c 2031 5d20 3d20 300a  teral[0, 1] = 0.
-000165c0: 2020 2020 706c 756d 655f 7469 6d65 7374      plume_timest
-000165d0: 6570 3a20 506f 7369 7469 7665 466c 6f61  ep: PositiveFloa
-000165e0: 7420 3d20 4669 656c 6428 312e 302c 2067  t = Field(1.0, g
-000165f0: 743d 3029 0a20 2020 2073 6f72 5f6f 7074  t=0).    sor_opt
-00016600: 696f 6e5f 666c 6167 3a20 4c69 7465 7261  ion_flag: Litera
-00016610: 6c5b 302c 2031 5d20 3d20 310a 2020 2020  l[0, 1] = 1.    
-00016620: 736f 725f 616c 7068 615f 706c 756d 655f  sor_alpha_plume_
-00016630: 6365 6e74 6572 3a20 506f 7369 7469 7665  center: Positive
-00016640: 466c 6f61 7420 3d20 4669 656c 6428 3130  Float = Field(10
-00016650: 2e30 2c20 6774 3d30 290a 2020 2020 736f  .0, gt=0).    so
-00016660: 725f 616c 7068 615f 706c 756d 655f 6564  r_alpha_plume_ed
-00016670: 6765 3a20 506f 7369 7469 7665 466c 6f61  ge: PositiveFloa
-00016680: 7420 3d20 4669 656c 6428 312e 302c 2067  t = Field(1.0, g
-00016690: 743d 3029 0a20 2020 206d 6178 5f70 6c75  t=0).    max_plu
-000166a0: 6d65 5f6d 6572 6769 6e67 5f61 6e67 6c65  me_merging_angle
-000166b0: 3a20 506f 7369 7469 7665 466c 6f61 7420  : PositiveFloat 
-000166c0: 3d20 4669 656c 6428 3330 2e30 2c20 6774  = Field(30.0, gt
-000166d0: 3d30 2c20 6c65 3d31 3830 290a 2020 2020  =0, le=180).    
-000166e0: 6d61 785f 706c 756d 655f 6f76 6572 6c61  max_plume_overla
-000166f0: 705f 6672 6163 7469 6f6e 3a20 506f 7369  p_fraction: Posi
-00016700: 7469 7665 466c 6f61 7420 3d20 4669 656c  tiveFloat = Fiel
-00016710: 6428 302e 372c 2067 743d 302c 206c 653d  d(0.7, gt=0, le=
-00016720: 3129 0a20 2020 2070 6c75 6d65 5f74 6f5f  1).    plume_to_
-00016730: 6772 6964 5f75 7064 7261 6674 735f 666c  grid_updrafts_fl
-00016740: 6167 3a20 4c69 7465 7261 6c5b 302c 2031  ag: Literal[0, 1
-00016750: 5d20 3d20 310a 2020 2020 6d61 785f 706f  ] = 1.    max_po
-00016760: 696e 7473 5f61 6c6f 6e67 5f70 6c75 6d65  ints_along_plume
-00016770: 5f65 6467 653a 2050 6f73 6974 6976 6549  _edge: PositiveI
-00016780: 6e74 203d 2046 6965 6c64 2831 302c 2067  nt = Field(10, g
-00016790: 653d 312c 206c 653d 3130 3029 0a20 2020  e=1, le=100).   
-000167a0: 2070 6c75 6d65 5f74 6f5f 6772 6964 5f69   plume_to_grid_i
-000167b0: 6e74 6572 7365 6374 696f 6e5f 666c 6167  ntersection_flag
-000167c0: 3a20 4c69 7465 7261 6c5b 302c 2031 5d20  : Literal[0, 1] 
-000167d0: 3d20 310a 0a20 2020 2040 636c 6173 736d  = 1..    @classm
-000167e0: 6574 686f 640a 2020 2020 6465 6620 6672  ethod.    def fr
-000167f0: 6f6d 5f66 696c 6528 636c 732c 2064 6972  om_file(cls, dir
-00016800: 6563 746f 7279 3a20 7374 7220 7c20 5061  ectory: str | Pa
-00016810: 7468 2c20 2a2a 6b77 6172 6773 293a 0a20  th, **kwargs):. 
-00016820: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-00016830: 616e 6365 2864 6972 6563 746f 7279 2c20  ance(directory, 
-00016840: 7374 7229 3a0a 2020 2020 2020 2020 2020  str):.          
-00016850: 2020 6469 7265 6374 6f72 7920 3d20 5061    directory = Pa
-00016860: 7468 2864 6972 6563 746f 7279 290a 0a20  th(directory).. 
-00016870: 2020 2020 2020 2077 6974 6820 6f70 656e         with open
-00016880: 2864 6972 6563 746f 7279 202f 2022 5146  (directory / "QF
-00016890: 6972 655f 506c 756d 655f 4164 7661 6e63  ire_Plume_Advanc
-000168a0: 6564 5f55 7365 725f 496e 7075 7473 2e69  ed_User_Inputs.i
-000168b0: 6e70 222c 2022 7222 2920 6173 2066 3a0a  np", "r") as f:.
-000168c0: 2020 2020 2020 2020 2020 2020 6c69 6e65              line
-000168d0: 7320 3d20 662e 7265 6164 6c69 6e65 7328  s = f.readlines(
-000168e0: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-000168f0: 6e20 636c 7328 0a20 2020 2020 2020 2020  n cls(.         
-00016900: 2020 206d 6178 5f70 6c75 6d65 735f 7065     max_plumes_pe
-00016910: 725f 7469 6d65 7374 6570 3d69 6e74 286c  r_timestep=int(l
-00016920: 696e 6573 5b30 5d2e 7370 6c69 7428 295b  ines[0].split()[
-00016930: 305d 292c 0a20 2020 2020 2020 2020 2020  0]),.           
-00016940: 206d 696e 5f70 6c75 6d65 5f75 7064 7261   min_plume_updra
-00016950: 6674 5f76 656c 6f63 6974 793d 666c 6f61  ft_velocity=floa
-00016960: 7428 6c69 6e65 735b 315d 2e73 706c 6974  t(lines[1].split
-00016970: 2829 5b30 5d29 2c0a 2020 2020 2020 2020  ()[0]),.        
-00016980: 2020 2020 6d61 785f 706c 756d 655f 7570      max_plume_up
-00016990: 6472 6166 745f 7665 6c6f 6369 7479 3d66  draft_velocity=f
-000169a0: 6c6f 6174 286c 696e 6573 5b32 5d2e 7370  loat(lines[2].sp
-000169b0: 6c69 7428 295b 305d 292c 0a20 2020 2020  lit()[0]),.     
-000169c0: 2020 2020 2020 206d 696e 5f76 656c 6f63         min_veloc
-000169d0: 6974 795f 7261 7469 6f3d 666c 6f61 7428  ity_ratio=float(
-000169e0: 6c69 6e65 735b 335d 2e73 706c 6974 2829  lines[3].split()
-000169f0: 5b30 5d29 2c0a 2020 2020 2020 2020 2020  [0]),.          
-00016a00: 2020 6272 756e 745f 7661 6973 616c 615f    brunt_vaisala_
-00016a10: 6672 6571 5f73 7175 6172 6564 3d66 6c6f  freq_squared=flo
-00016a20: 6174 286c 696e 6573 5b34 5d2e 7370 6c69  at(lines[4].spli
-00016a30: 7428 295b 305d 292c 0a20 2020 2020 2020  t()[0]),.       
-00016a40: 2020 2020 2063 7265 6570 696e 675f 666c       creeping_fl
-00016a50: 6167 3d69 6e74 286c 696e 6573 5b35 5d2e  ag=int(lines[5].
-00016a60: 7370 6c69 7428 295b 305d 292c 0a20 2020  split()[0]),.   
-00016a70: 2020 2020 2020 2020 2061 6461 7074 6976           adaptiv
-00016a80: 655f 7469 6d65 7374 6570 5f66 6c61 673d  e_timestep_flag=
-00016a90: 696e 7428 6c69 6e65 735b 365d 2e73 706c  int(lines[6].spl
-00016aa0: 6974 2829 5b30 5d29 2c0a 2020 2020 2020  it()[0]),.      
-00016ab0: 2020 2020 2020 706c 756d 655f 7469 6d65        plume_time
-00016ac0: 7374 6570 3d66 6c6f 6174 286c 696e 6573  step=float(lines
-00016ad0: 5b37 5d2e 7370 6c69 7428 295b 305d 292c  [7].split()[0]),
-00016ae0: 0a20 2020 2020 2020 2020 2020 2073 6f72  .            sor
-00016af0: 5f6f 7074 696f 6e5f 666c 6167 3d69 6e74  _option_flag=int
-00016b00: 286c 696e 6573 5b38 5d2e 7370 6c69 7428  (lines[8].split(
-00016b10: 295b 305d 292c 0a20 2020 2020 2020 2020  )[0]),.         
-00016b20: 2020 2073 6f72 5f61 6c70 6861 5f70 6c75     sor_alpha_plu
-00016b30: 6d65 5f63 656e 7465 723d 666c 6f61 7428  me_center=float(
-00016b40: 6c69 6e65 735b 395d 2e73 706c 6974 2829  lines[9].split()
-00016b50: 5b30 5d29 2c0a 2020 2020 2020 2020 2020  [0]),.          
-00016b60: 2020 736f 725f 616c 7068 615f 706c 756d    sor_alpha_plum
-00016b70: 655f 6564 6765 3d66 6c6f 6174 286c 696e  e_edge=float(lin
-00016b80: 6573 5b31 305d 2e73 706c 6974 2829 5b30  es[10].split()[0
-00016b90: 5d29 2c0a 2020 2020 2020 2020 2020 2020  ]),.            
-00016ba0: 6d61 785f 706c 756d 655f 6d65 7267 696e  max_plume_mergin
-00016bb0: 675f 616e 676c 653d 666c 6f61 7428 6c69  g_angle=float(li
-00016bc0: 6e65 735b 3131 5d2e 7370 6c69 7428 295b  nes[11].split()[
-00016bd0: 305d 292c 0a20 2020 2020 2020 2020 2020  0]),.           
-00016be0: 206d 6178 5f70 6c75 6d65 5f6f 7665 726c   max_plume_overl
-00016bf0: 6170 5f66 7261 6374 696f 6e3d 666c 6f61  ap_fraction=floa
-00016c00: 7428 6c69 6e65 735b 3132 5d2e 7370 6c69  t(lines[12].spli
-00016c10: 7428 295b 305d 292c 0a20 2020 2020 2020  t()[0]),.       
-00016c20: 2020 2020 2070 6c75 6d65 5f74 6f5f 6772       plume_to_gr
-00016c30: 6964 5f75 7064 7261 6674 735f 666c 6167  id_updrafts_flag
-00016c40: 3d69 6e74 286c 696e 6573 5b31 335d 2e73  =int(lines[13].s
-00016c50: 706c 6974 2829 5b30 5d29 2c0a 2020 2020  plit()[0]),.    
-00016c60: 2020 2020 2020 2020 6d61 785f 706f 696e          max_poin
-00016c70: 7473 5f61 6c6f 6e67 5f70 6c75 6d65 5f65  ts_along_plume_e
-00016c80: 6467 653d 696e 7428 6c69 6e65 735b 3134  dge=int(lines[14
-00016c90: 5d2e 7370 6c69 7428 295b 305d 292c 0a20  ].split()[0]),. 
-00016ca0: 2020 2020 2020 2020 2020 2070 6c75 6d65             plume
-00016cb0: 5f74 6f5f 6772 6964 5f69 6e74 6572 7365  _to_grid_interse
-00016cc0: 6374 696f 6e5f 666c 6167 3d69 6e74 286c  ction_flag=int(l
-00016cd0: 696e 6573 5b31 355d 2e73 706c 6974 2829  ines[15].split()
-00016ce0: 5b30 5d29 2c0a 2020 2020 2020 2020 290a  [0]),.        ).
-00016cf0: 0a0a 636c 6173 7320 5155 5f54 6f70 6f49  ..class QU_TopoI
-00016d00: 6e70 7574 7328 496e 7075 7446 696c 6529  nputs(InputFile)
-00016d10: 3a0a 2020 2020 2222 220a 2020 2020 436c  :.    """.    Cl
-00016d20: 6173 7320 7265 7072 6573 656e 7469 6e67  ass representing
-00016d30: 2074 6865 2051 555f 546f 706f 496e 7075   the QU_TopoInpu
-00016d40: 7473 2e69 6e70 2069 6e70 7574 2066 696c  ts.inp input fil
-00016d50: 652e 2054 6869 7320 6669 6c65 0a20 2020  e. This file.   
-00016d60: 2063 6f6e 7461 696e 7320 6164 7661 6e63   contains advanc
-00016d70: 6564 2064 6174 6120 7065 7274 6169 6e69  ed data pertaini
-00016d80: 6e67 2074 6f20 746f 706f 6772 6170 6879  ng to topography
-00016d90: 2e0a 0a20 2020 2041 7474 7269 6275 7465  ...    Attribute
-00016da0: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
-00016db0: 0a20 2020 2066 696c 656e 616d 6520 3a20  .    filename : 
-00016dc0: 7374 720a 2020 2020 2020 2020 5061 7468  str.        Path
-00016dd0: 2074 6f20 7468 6520 6375 7374 6f6d 2074   to the custom t
-00016de0: 6f70 6f20 6669 6c65 2028 6f6e 6c79 2075  opo file (only u
-00016df0: 7365 6420 7769 7468 206f 7074 696f 6e20  sed with option 
-00016e00: 3529 2e20 4361 6e6e 6f74 2062 6520 2e62  5). Cannot be .b
-00016e10: 696e 2e20 5573 6520 2e64 6174 206f 7220  in. Use .dat or 
-00016e20: 2e69 6e70 0a20 2020 2074 6f70 6f5f 7479  .inp.    topo_ty
-00016e30: 7065 203a 2054 6f70 6f54 7970 650a 2020  pe : TopoType.  
-00016e40: 2020 2020 2020 546f 706f 6772 6170 6879        Topography
-00016e50: 2074 7970 6520 7370 6563 6966 6965 6420   type specified 
-00016e60: 6173 2061 2054 6f70 6f54 7970 6520 636c  as a TopoType cl
-00016e70: 6173 7320 6672 6f6d 2074 6f70 6f67 7261  ass from topogra
-00016e80: 7068 792e 7079 0a20 2020 2020 2020 2030  phy.py.        0
-00016e90: 203d 206e 6f20 7465 7272 6169 6e20 6669   = no terrain fi
-00016ea0: 6c65 2070 726f 7669 6465 642c 2051 5549  le provided, QUI
-00016eb0: 432d 4669 7265 2069 7320 7275 6e20 7769  C-Fire is run wi
-00016ec0: 7468 2066 6c61 7420 7465 7272 6169 6e0a  th flat terrain.
-00016ed0: 2020 2020 2020 2020 3120 3d20 4761 7573          1 = Gaus
-00016ee0: 7369 616e 2068 696c 6c0a 2020 2020 2020  sian hill.      
-00016ef0: 2020 3220 3d20 6869 6c6c 2070 6173 730a    2 = hill pass.
-00016f00: 2020 2020 2020 2020 3320 3d20 736c 6f70          3 = slop
-00016f10: 6520 6d65 7361 0a20 2020 2020 2020 2034  e mesa.        4
-00016f20: 203d 2063 616e 796f 6e0a 2020 2020 2020   = canyon.      
-00016f30: 2020 3520 3d20 6375 7374 6f6d 0a20 2020    5 = custom.   
-00016f40: 2020 2020 2036 203d 2068 616c 6620 6369       6 = half ci
-00016f50: 7263 6c65 0a20 2020 2020 2020 2037 203d  rcle.        7 =
-00016f60: 2073 696e 7573 6f69 640a 2020 2020 2020   sinusoid.      
-00016f70: 2020 3820 3d20 636f 7320 6869 6c6c 0a20    8 = cos hill. 
-00016f80: 2020 2020 2020 2039 203d 2074 6572 7261         9 = terra
-00016f90: 696e 2069 7320 7072 6f76 6964 6564 2076  in is provided v
-00016fa0: 6961 2051 505f 656c 6576 6174 696f 6e2e  ia QP_elevation.
-00016fb0: 6269 6e20 2873 6565 2053 6563 7469 6f6e  bin (see Section
-00016fc0: 2032 2e37 290a 2020 2020 2020 2020 3130   2.7).        10
-00016fd0: 203d 2074 6572 7261 696e 2069 7320 7072   = terrain is pr
-00016fe0: 6f76 6964 6564 2076 6961 2074 6572 7261  ovided via terra
-00016ff0: 696e 4f75 7470 7574 2e74 7874 0a20 2020  inOutput.txt.   
-00017000: 2020 2020 2031 3120 3d20 7465 7272 6169       11 = terrai
-00017010: 6e2e 6461 7420 2866 6972 6574 6563 290a  n.dat (firetec).
-00017020: 2020 2020 736d 6f6f 7468 696e 675f 6d65      smoothing_me
-00017030: 7468 6f64 203a 2069 6e74 0a20 2020 2020  thod : int.     
-00017040: 2020 2030 203d 206e 6f6e 6520 2864 6566     0 = none (def
-00017050: 6175 6c74 2066 6f72 2069 6465 616c 697a  ault for idealiz
-00017060: 6564 2074 6f70 6f29 0a20 2020 2020 2020  ed topo).       
-00017070: 2031 203d 2042 6c75 720a 2020 2020 2020   1 = Blur.      
-00017080: 2020 3220 3d20 4461 7669 6420 526f 6269    2 = David Robi
-00017090: 6e73 6f6e e280 9973 206d 6574 686f 6420  nson...s method 
-000170a0: 6261 7365 6420 6f6e 2073 6563 6f6e 6420  based on second 
-000170b0: 6465 7269 7661 7469 7665 0a20 2020 2073  derivative.    s
-000170c0: 6d6f 6f74 6869 6e67 5f70 6173 7365 7320  moothing_passes 
-000170d0: 3a20 696e 740a 2020 2020 2020 2020 4e75  : int.        Nu
-000170e0: 6d62 6572 206f 6620 736d 6f6f 7468 696e  mber of smoothin
-000170f0: 6720 7061 7373 6573 2e20 5265 616c 2074  g passes. Real t
-00017100: 6572 7261 696e 204d 5553 5420 6265 2073  errain MUST be s
-00017110: 6d6f 6f74 6865 640a 2020 2020 736f 725f  moothed.    sor_
-00017120: 6974 6572 6174 696f 6e73 203a 2069 6e74  iterations : int
-00017130: 0a20 2020 2020 2020 204e 756d 6265 7220  .        Number 
-00017140: 6f66 2053 4f52 2069 7465 7261 7469 6f6e  of SOR iteration
-00017150: 2074 6f20 6465 6669 6e65 2062 6163 6b67   to define backg
-00017160: 726f 756e 6420 7769 6e64 7320 6265 666f  round winds befo
-00017170: 7265 2073 7461 7274 696e 6720 7468 6520  re starting the 
-00017180: 6669 7265 0a20 2020 2073 6f72 5f63 7963  fire.    sor_cyc
-00017190: 6c65 7320 3a20 696e 740a 2020 2020 2020  les : int.      
-000171a0: 2020 4e75 6d62 6572 206f 6620 7469 6d65    Number of time
-000171b0: 7320 7468 6520 534f 5220 736f 6c76 6572  s the SOR solver
-000171c0: 2069 6e69 7469 616c 2066 6965 6c64 7320   initial fields 
-000171d0: 6973 2072 6573 6574 2074 6f20 6465 6669  is reset to defi
-000171e0: 6e65 0a20 2020 2020 2020 2062 6163 6b67  ne.        backg
-000171f0: 726f 756e 6420 7769 6e64 7320 6265 666f  round winds befo
-00017200: 7265 2073 7461 7274 696e 6720 7468 6520  re starting the 
-00017210: 6669 7265 0a20 2020 2073 6f72 5f72 656c  fire.    sor_rel
-00017220: 6178 203a 2066 6c6f 6174 0a20 2020 2020  ax : float.     
-00017230: 2020 2053 4f52 206f 7665 7272 656c 6178     SOR overrelax
-00017240: 6174 696f 6e20 636f 6566 6669 6369 656e  ation coefficien
-00017250: 742e 204f 6e6c 7920 7573 6564 2069 6620  t. Only used if 
-00017260: 7468 6572 6520 6973 2074 6f70 6f2e 0a20  there is topo.. 
-00017270: 2020 2022 2222 0a0a 2020 2020 6e61 6d65     """..    name
-00017280: 3a20 7374 7220 3d20 2251 555f 546f 706f  : str = "QU_Topo
-00017290: 496e 7075 7473 220a 2020 2020 5f65 7874  Inputs".    _ext
-000172a0: 656e 7369 6f6e 3a20 7374 7220 3d20 222e  ension: str = ".
-000172b0: 696e 7022 0a20 2020 2066 696c 656e 616d  inp".    filenam
-000172c0: 653a 2073 7472 203d 2022 746f 706f 2e64  e: str = "topo.d
-000172d0: 6174 220a 2020 2020 746f 706f 5f74 7970  at".    topo_typ
-000172e0: 653a 2053 6572 6961 6c69 7a65 4173 416e  e: SerializeAsAn
-000172f0: 795b 546f 706f 5479 7065 5d20 3d20 546f  y[TopoType] = To
-00017300: 706f 5479 7065 2874 6f70 6f5f 666c 6167  poType(topo_flag
-00017310: 3d54 6f70 6f53 6f75 7263 6573 2830 2929  =TopoSources(0))
-00017320: 0a20 2020 2073 6d6f 6f74 6869 6e67 5f6d  .    smoothing_m
-00017330: 6574 686f 643a 204c 6974 6572 616c 5b30  ethod: Literal[0
-00017340: 2c20 312c 2032 5d20 3d20 320a 2020 2020  , 1, 2] = 2.    
-00017350: 736d 6f6f 7468 696e 675f 7061 7373 6573  smoothing_passes
-00017360: 3a20 506f 7369 7469 7665 496e 7420 3d20  : PositiveInt = 
-00017370: 4669 656c 6428 6c65 3d35 3030 2c20 6465  Field(le=500, de
-00017380: 6661 756c 743d 3530 3029 0a20 2020 2073  fault=500).    s
-00017390: 6f72 5f69 7465 7261 7469 6f6e 733a 2050  or_iterations: P
-000173a0: 6f73 6974 6976 6549 6e74 203d 2046 6965  ositiveInt = Fie
-000173b0: 6c64 286c 653d 3530 302c 2064 6566 6175  ld(le=500, defau
-000173c0: 6c74 3d32 3030 290a 2020 2020 736f 725f  lt=200).    sor_
-000173d0: 6379 636c 6573 3a20 4c69 7465 7261 6c5b  cycles: Literal[
-000173e0: 302c 2031 2c20 322c 2033 2c20 345d 203d  0, 1, 2, 3, 4] =
-000173f0: 2034 0a20 2020 2073 6f72 5f72 656c 6178   4.    sor_relax
-00017400: 3a20 506f 7369 7469 7665 466c 6f61 7420  : PositiveFloat 
-00017410: 3d20 4669 656c 6428 6c65 3d32 2c20 6465  = Field(le=2, de
-00017420: 6661 756c 743d 302e 3929 0a0a 2020 2020  fault=0.9)..    
-00017430: 4063 6f6d 7075 7465 645f 6669 656c 640a  @computed_field.
-00017440: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-00017450: 2020 6465 6620 5f74 6f70 6f5f 6c69 6e65    def _topo_line
-00017460: 7328 7365 6c66 2920 2d3e 2073 7472 3a0a  s(self) -> str:.
-00017470: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00017480: 7472 2873 656c 662e 746f 706f 5f74 7970  tr(self.topo_typ
-00017490: 6529 0a0a 2020 2020 4063 6c61 7373 6d65  e)..    @classme
-000174a0: 7468 6f64 0a20 2020 2064 6566 2066 726f  thod.    def fro
-000174b0: 6d5f 6669 6c65 2863 6c73 2c20 6469 7265  m_file(cls, dire
-000174c0: 6374 6f72 793a 2073 7472 207c 2050 6174  ctory: str | Pat
-000174d0: 682c 202a 2a6b 7761 7267 7329 3a0a 2020  h, **kwargs):.  
-000174e0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-000174f0: 6e63 6528 6469 7265 6374 6f72 792c 2073  nce(directory, s
-00017500: 7472 293a 0a20 2020 2020 2020 2020 2020  tr):.           
-00017510: 2064 6972 6563 746f 7279 203d 2050 6174   directory = Pat
-00017520: 6828 6469 7265 6374 6f72 7929 0a20 2020  h(directory).   
-00017530: 2020 2020 2077 6974 6820 6f70 656e 2864       with open(d
-00017540: 6972 6563 746f 7279 202f 2022 5155 5f54  irectory / "QU_T
-00017550: 6f70 6f49 6e70 7574 732e 696e 7022 2c20  opoInputs.inp", 
-00017560: 2272 2229 2061 7320 663a 0a20 2020 2020  "r") as f:.     
-00017570: 2020 2020 2020 206c 696e 6573 203d 2066         lines = f
-00017580: 2e72 6561 646c 696e 6573 2829 0a0a 2020  .readlines()..  
-00017590: 2020 2020 2020 2320 4c69 6e65 2030 2069        # Line 0 i
-000175a0: 7320 4865 6164 6572 0a20 2020 2020 2020  s Header.       
-000175b0: 2066 696c 656e 616d 6520 3d20 7374 7228   filename = str(
-000175c0: 6c69 6e65 735b 315d 2e73 7472 6970 2829  lines[1].strip()
-000175d0: 290a 2020 2020 2020 2020 2320 4765 7420  ).        # Get 
-000175e0: 746f 706f 206c 696e 6573 0a20 2020 2020  topo lines.     
-000175f0: 2020 2074 6f70 6f5f 666c 6167 203d 2069     topo_flag = i
-00017600: 6e74 286c 696e 6573 5b32 5d2e 7374 7269  nt(lines[2].stri
-00017610: 7028 292e 7370 6c69 7428 2221 2229 5b30  p().split("!")[0
-00017620: 5d29 0a20 2020 2020 2020 2061 6464 5f64  ]).        add_d
-00017630: 6963 7420 3d20 7b0a 2020 2020 2020 2020  ict = {.        
-00017640: 2020 2020 303a 2030 2c0a 2020 2020 2020      0: 0,.      
-00017650: 2020 2020 2020 313a 2034 2c0a 2020 2020        1: 4,.    
-00017660: 2020 2020 2020 2020 323a 2032 2c0a 2020          2: 2,.  
-00017670: 2020 2020 2020 2020 2020 333a 2033 2c0a            3: 3,.
-00017680: 2020 2020 2020 2020 2020 2020 343a 2035              4: 5
-00017690: 2c0a 2020 2020 2020 2020 2020 2020 353a  ,.            5:
-000176a0: 2030 2c0a 2020 2020 2020 2020 2020 2020   0,.            
-000176b0: 363a 2033 2c0a 2020 2020 2020 2020 2020  6: 3,.          
-000176c0: 2020 373a 2032 2c0a 2020 2020 2020 2020    7: 2,.        
-000176d0: 2020 2020 383a 2032 2c0a 2020 2020 2020      8: 2,.      
-000176e0: 2020 2020 2020 393a 2030 2c0a 2020 2020        9: 0,.    
-000176f0: 2020 2020 2020 2020 3130 3a20 302c 0a20          10: 0,. 
-00017700: 2020 2020 2020 2020 2020 2031 313a 2030             11: 0
-00017710: 2c0a 2020 2020 2020 2020 7d0a 2020 2020  ,.        }.    
-00017720: 2020 2020 6164 6420 3d20 6164 645f 6469      add = add_di
-00017730: 6374 2e67 6574 2874 6f70 6f5f 666c 6167  ct.get(topo_flag
-00017740: 290a 2020 2020 2020 2020 746f 706f 5f70  ).        topo_p
-00017750: 6172 616d 7320 3d20 5b5d 0a20 2020 2020  arams = [].     
-00017760: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
-00017770: 6528 332c 2033 202b 2061 6464 293a 0a20  e(3, 3 + add):. 
-00017780: 2020 2020 2020 2020 2020 2074 6f70 6f5f             topo_
-00017790: 7061 7261 6d73 2e61 7070 656e 6428 666c  params.append(fl
-000177a0: 6f61 7428 6c69 6e65 735b 695d 2e73 7472  oat(lines[i].str
-000177b0: 6970 2829 2e73 706c 6974 2822 2122 295b  ip().split("!")[
-000177c0: 305d 2929 0a20 2020 2020 2020 2069 6620  0])).        if 
-000177d0: 746f 706f 5f66 6c61 6720 3d3d 2031 3a0a  topo_flag == 1:.
-000177e0: 2020 2020 2020 2020 2020 2020 785f 6869              x_hi
-000177f0: 6c6c 746f 702c 2079 5f68 696c 6c74 6f70  lltop, y_hilltop
-00017800: 2c20 656c 6576 6174 696f 6e5f 6d61 782c  , elevation_max,
-00017810: 2065 6c65 7661 7469 6f6e 5f73 7464 203d   elevation_std =
-00017820: 2074 6f70 6f5f 7061 7261 6d73 0a20 2020   topo_params.   
-00017830: 2020 2020 2020 2020 2074 6f70 6f5f 7479           topo_ty
-00017840: 7065 203d 2047 6175 7373 6961 6e48 696c  pe = GaussianHil
-00017850: 6c54 6f70 6f28 0a20 2020 2020 2020 2020  lTopo(.         
-00017860: 2020 2020 2020 2078 5f68 696c 6c74 6f70         x_hilltop
-00017870: 3d69 6e74 2878 5f68 696c 6c74 6f70 292c  =int(x_hilltop),
-00017880: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017890: 2079 5f68 696c 6c74 6f70 3d69 6e74 2879   y_hilltop=int(y
-000178a0: 5f68 696c 6c74 6f70 292c 0a20 2020 2020  _hilltop),.     
-000178b0: 2020 2020 2020 2020 2020 2065 6c65 7661             eleva
-000178c0: 7469 6f6e 5f6d 6178 3d69 6e74 2865 6c65  tion_max=int(ele
-000178d0: 7661 7469 6f6e 5f6d 6178 292c 0a20 2020  vation_max),.   
-000178e0: 2020 2020 2020 2020 2020 2020 2065 6c65               ele
-000178f0: 7661 7469 6f6e 5f73 7464 3d65 6c65 7661  vation_std=eleva
-00017900: 7469 6f6e 5f73 7464 2c0a 2020 2020 2020  tion_std,.      
-00017910: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00017920: 656c 6966 2074 6f70 6f5f 666c 6167 203d  elif topo_flag =
-00017930: 3d20 323a 0a20 2020 2020 2020 2020 2020  = 2:.           
-00017940: 206d 6178 5f68 6569 6768 742c 206c 6f63   max_height, loc
-00017950: 6174 696f 6e5f 7061 7261 6d20 3d20 746f  ation_param = to
-00017960: 706f 5f70 6172 616d 730a 2020 2020 2020  po_params.      
-00017970: 2020 2020 2020 746f 706f 5f74 7970 6520        topo_type 
-00017980: 3d20 4869 6c6c 5061 7373 546f 706f 280a  = HillPassTopo(.
-00017990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000179a0: 6d61 785f 6865 6967 6874 3d69 6e74 286d  max_height=int(m
-000179b0: 6178 5f68 6569 6768 7429 2c20 6c6f 6361  ax_height), loca
-000179c0: 7469 6f6e 5f70 6172 616d 3d6c 6f63 6174  tion_param=locat
-000179d0: 696f 6e5f 7061 7261 6d0a 2020 2020 2020  ion_param.      
-000179e0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-000179f0: 656c 6966 2074 6f70 6f5f 666c 6167 203d  elif topo_flag =
-00017a00: 3d20 333a 0a20 2020 2020 2020 2020 2020  = 3:.           
-00017a10: 2073 6c6f 7065 5f61 7869 732c 2073 6c6f   slope_axis, slo
-00017a20: 7065 5f76 616c 7565 2c20 666c 6174 5f66  pe_value, flat_f
-00017a30: 7261 6374 696f 6e20 3d20 746f 706f 5f70  raction = topo_p
-00017a40: 6172 616d 730a 2020 2020 2020 2020 2020  arams.          
-00017a50: 2020 746f 706f 5f74 7970 6520 3d20 536c    topo_type = Sl
-00017a60: 6f70 654d 6573 6154 6f70 6f28 0a20 2020  opeMesaTopo(.   
-00017a70: 2020 2020 2020 2020 2020 2020 2073 6c6f               slo
-00017a80: 7065 5f61 7869 733d 696e 7428 736c 6f70  pe_axis=int(slop
-00017a90: 655f 6178 6973 292c 0a20 2020 2020 2020  e_axis),.       
-00017aa0: 2020 2020 2020 2020 2073 6c6f 7065 5f76           slope_v
-00017ab0: 616c 7565 3d73 6c6f 7065 5f76 616c 7565  alue=slope_value
-00017ac0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00017ad0: 2020 666c 6174 5f66 7261 6374 696f 6e3d    flat_fraction=
-00017ae0: 666c 6174 5f66 7261 6374 696f 6e2c 0a20  flat_fraction,. 
-00017af0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00017b00: 2020 2020 2065 6c69 6620 746f 706f 5f66       elif topo_f
-00017b10: 6c61 6720 3d3d 2034 3a0a 2020 2020 2020  lag == 4:.      
-00017b20: 2020 2020 2020 785f 7374 6172 742c 2079        x_start, y
-00017b30: 5f63 656e 7465 722c 2073 6c6f 7065 5f76  _center, slope_v
-00017b40: 616c 7565 2c20 6361 6e79 6f6e 5f73 7464  alue, canyon_std
-00017b50: 2c20 7665 7274 6963 616c 5f6f 6666 7365  , vertical_offse
-00017b60: 7420 3d20 746f 706f 5f70 6172 616d 730a  t = topo_params.
-00017b70: 2020 2020 2020 2020 2020 2020 746f 706f              topo
-00017b80: 5f74 7970 6520 3d20 4361 6e79 6f6e 546f  _type = CanyonTo
-00017b90: 706f 280a 2020 2020 2020 2020 2020 2020  po(.            
-00017ba0: 2020 2020 785f 7374 6172 743d 696e 7428      x_start=int(
-00017bb0: 785f 7374 6172 7429 2c0a 2020 2020 2020  x_start),.      
-00017bc0: 2020 2020 2020 2020 2020 795f 6365 6e74            y_cent
-00017bd0: 6572 3d69 6e74 2879 5f63 656e 7465 7229  er=int(y_center)
-00017be0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00017bf0: 2020 736c 6f65 5f76 616c 7565 3d73 6c6f    sloe_value=slo
-00017c00: 7065 5f76 616c 7565 2c0a 2020 2020 2020  pe_value,.      
-00017c10: 2020 2020 2020 2020 2020 6361 6e79 6f6e            canyon
-00017c20: 5f73 7464 3d63 616e 796f 6e5f 7374 642c  _std=canyon_std,
-00017c30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017c40: 2076 6572 7469 6361 6c5f 6f66 6673 6574   vertical_offset
-00017c50: 3d76 6572 7469 6361 6c5f 6f66 6673 6574  =vertical_offset
-00017c60: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-00017c70: 2020 2020 2020 2020 656c 6966 2074 6f70          elif top
-00017c80: 6f5f 666c 6167 203d 3d20 363a 0a20 2020  o_flag == 6:.   
-00017c90: 2020 2020 2020 2020 2078 5f6c 6f63 6174           x_locat
-00017ca0: 696f 6e2c 2079 5f6c 6f63 6174 696f 6e2c  ion, y_location,
-00017cb0: 2072 6164 6975 7320 3d20 746f 706f 5f70   radius = topo_p
-00017cc0: 6172 616d 730a 2020 2020 2020 2020 2020  arams.          
-00017cd0: 2020 746f 706f 5f74 7970 6520 3d20 4861    topo_type = Ha
-00017ce0: 6c66 4369 7263 6c65 546f 706f 280a 2020  lfCircleTopo(.  
-00017cf0: 2020 2020 2020 2020 2020 2020 2020 785f                x_
-00017d00: 6c6f 6361 7469 6f6e 3d69 6e74 2878 5f6c  location=int(x_l
-00017d10: 6f63 6174 696f 6e29 2c20 795f 6c6f 6361  ocation), y_loca
-00017d20: 7469 6f6e 3d69 6e74 2879 5f6c 6f63 6174  tion=int(y_locat
-00017d30: 696f 6e29 2c20 7261 6469 7573 3d72 6164  ion), radius=rad
-00017d40: 6975 730a 2020 2020 2020 2020 2020 2020  ius.            
-00017d50: 290a 2020 2020 2020 2020 656c 6966 2074  ).        elif t
-00017d60: 6f70 6f5f 666c 6167 203d 3d20 373a 0a20  opo_flag == 7:. 
-00017d70: 2020 2020 2020 2020 2020 2070 6572 696f             perio
-00017d80: 642c 2061 6d70 6c69 7475 6465 203d 2074  d, amplitude = t
-00017d90: 6f70 6f5f 7061 7261 6d73 0a20 2020 2020  opo_params.     
-00017da0: 2020 2020 2020 2074 6f70 6f5f 7479 7065         topo_type
-00017db0: 203d 2053 696e 7573 6f69 6454 6f70 6f28   = SinusoidTopo(
-00017dc0: 7065 7269 6f64 3d70 6572 696f 642c 2061  period=period, a
-00017dd0: 6d70 6c69 7475 6465 3d61 6d70 6c69 7475  mplitude=amplitu
-00017de0: 6465 290a 2020 2020 2020 2020 656c 6966  de).        elif
-00017df0: 2074 6f70 6f5f 666c 6167 203d 3d20 383a   topo_flag == 8:
-00017e00: 0a20 2020 2020 2020 2020 2020 2061 7370  .            asp
-00017e10: 6563 742c 2068 6569 6768 7420 3d20 746f  ect, height = to
-00017e20: 706f 5f70 6172 616d 730a 2020 2020 2020  po_params.      
-00017e30: 2020 2020 2020 746f 706f 5f74 7970 6520        topo_type 
-00017e40: 3d20 436f 7348 696c 6c54 6f70 6f28 6173  = CosHillTopo(as
-00017e50: 7065 6374 3d61 7370 6563 742c 2068 6569  pect=aspect, hei
-00017e60: 6768 743d 6865 6967 6874 290a 2020 2020  ght=height).    
-00017e70: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00017e80: 2020 2020 2020 746f 706f 5f74 7970 6520        topo_type 
-00017e90: 3d20 546f 706f 5479 7065 2874 6f70 6f5f  = TopoType(topo_
-00017ea0: 666c 6167 3d74 6f70 6f5f 666c 6167 290a  flag=topo_flag).
-00017eb0: 2020 2020 2020 2020 6375 7272 656e 745f          current_
-00017ec0: 6c69 6e65 203d 2033 202b 2061 6464 0a20  line = 3 + add. 
-00017ed0: 2020 2020 2020 2023 2053 6d6f 6f74 6869         # Smoothi
-00017ee0: 6e67 2061 6e64 2053 4f52 0a20 2020 2020  ng and SOR.     
-00017ef0: 2020 2073 6d6f 6f74 6869 6e67 5f6d 6574     smoothing_met
-00017f00: 686f 6420 3d20 696e 7428 6c69 6e65 735b  hod = int(lines[
-00017f10: 6375 7272 656e 745f 6c69 6e65 5d2e 7374  current_line].st
-00017f20: 7269 7028 292e 7370 6c69 7428 2221 2229  rip().split("!")
-00017f30: 5b30 5d29 0a20 2020 2020 2020 2073 6d6f  [0]).        smo
-00017f40: 6f74 6869 6e67 5f70 6173 7365 7320 3d20  othing_passes = 
-00017f50: 696e 7428 6c69 6e65 735b 6375 7272 656e  int(lines[curren
-00017f60: 745f 6c69 6e65 202b 2031 5d2e 7374 7269  t_line + 1].stri
-00017f70: 7028 292e 7370 6c69 7428 2221 2229 5b30  p().split("!")[0
-00017f80: 5d29 0a20 2020 2020 2020 2073 6f72 5f69  ]).        sor_i
-00017f90: 7465 7261 7469 6f6e 7320 3d20 696e 7428  terations = int(
-00017fa0: 6c69 6e65 735b 6375 7272 656e 745f 6c69  lines[current_li
-00017fb0: 6e65 202b 2032 5d2e 7374 7269 7028 292e  ne + 2].strip().
-00017fc0: 7370 6c69 7428 2221 2229 5b30 5d29 0a20  split("!")[0]). 
-00017fd0: 2020 2020 2020 2073 6f72 5f63 7963 6c65         sor_cycle
-00017fe0: 7320 3d20 696e 7428 6c69 6e65 735b 6375  s = int(lines[cu
-00017ff0: 7272 656e 745f 6c69 6e65 202b 2033 5d2e  rrent_line + 3].
-00018000: 7374 7269 7028 292e 7370 6c69 7428 2221  strip().split("!
-00018010: 2229 5b30 5d29 0a20 2020 2020 2020 2073  ")[0]).        s
-00018020: 6f72 5f72 656c 6178 203d 2066 6c6f 6174  or_relax = float
-00018030: 286c 696e 6573 5b63 7572 7265 6e74 5f6c  (lines[current_l
-00018040: 696e 6520 2b20 345d 2e73 7472 6970 2829  ine + 4].strip()
-00018050: 2e73 706c 6974 2822 2122 295b 305d 290a  .split("!")[0]).
-00018060: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00018070: 636c 7328 0a20 2020 2020 2020 2020 2020  cls(.           
-00018080: 2066 696c 656e 616d 653d 6669 6c65 6e61   filename=filena
-00018090: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
-000180a0: 746f 706f 5f74 7970 653d 746f 706f 5f74  topo_type=topo_t
-000180b0: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
-000180c0: 2073 6d6f 6f74 6869 6e67 5f6d 6574 686f   smoothing_metho
-000180d0: 643d 736d 6f6f 7468 696e 675f 6d65 7468  d=smoothing_meth
-000180e0: 6f64 2c0a 2020 2020 2020 2020 2020 2020  od,.            
-000180f0: 736d 6f6f 7468 696e 675f 7061 7373 6573  smoothing_passes
-00018100: 3d73 6d6f 6f74 6869 6e67 5f70 6173 7365  =smoothing_passe
-00018110: 732c 0a20 2020 2020 2020 2020 2020 2073  s,.            s
-00018120: 6f72 5f69 7465 7261 7469 6f6e 733d 736f  or_iterations=so
-00018130: 725f 6974 6572 6174 696f 6e73 2c0a 2020  r_iterations,.  
-00018140: 2020 2020 2020 2020 2020 736f 725f 6379            sor_cy
-00018150: 636c 6573 3d73 6f72 5f63 7963 6c65 732c  cles=sor_cycles,
-00018160: 0a20 2020 2020 2020 2020 2020 2073 6f72  .            sor
-00018170: 5f72 656c 6178 3d73 6f72 5f72 656c 6178  _relax=sor_relax
-00018180: 2c0a 2020 2020 2020 2020 290a 0a0a 636c  ,.        )...cl
-00018190: 6173 7320 5275 6e74 696d 6541 6476 616e  ass RuntimeAdvan
-000181a0: 6365 6455 7365 7249 6e70 7574 7328 496e  cedUserInputs(In
-000181b0: 7075 7446 696c 6529 3a0a 2020 2020 2222  putFile):.    ""
-000181c0: 220a 2020 2020 436c 6173 7320 7265 7072  ".    Class repr
-000181d0: 6573 656e 7469 6e67 2074 6865 2052 756e  esenting the Run
-000181e0: 7469 6d65 5f41 6476 616e 6365 645f 5573  time_Advanced_Us
-000181f0: 6572 5f49 6e70 7574 732e 696e 7020 696e  er_Inputs.inp in
-00018200: 7075 7420 6669 6c65 2e0a 2020 2020 5468  put file..    Th
-00018210: 6973 2066 696c 6520 636f 6e74 6169 6e73  is file contains
-00018220: 2061 6476 616e 6365 6420 7061 7261 6d65   advanced parame
-00018230: 7465 7273 2072 656c 6174 6564 2074 6f20  ters related to 
-00018240: 636f 6d70 7574 6572 206d 656d 6f72 7920  computer memory 
-00018250: 7573 6167 652e 0a0a 2020 2020 4174 7472  usage...    Attr
-00018260: 6962 7574 6573 0a20 2020 202d 2d2d 2d2d  ibutes.    -----
-00018270: 2d2d 2d2d 2d0a 2020 2020 6e75 6d5f 6370  -----.    num_cp
-00018280: 7573 203a 2050 6f73 6974 6976 6549 6e74  us : PositiveInt
-00018290: 0a20 2020 2020 2020 204d 6178 696d 756d  .        Maximum
-000182a0: 206e 756d 6265 7220 6f66 2043 5055 2074   number of CPU t
-000182b0: 6f20 7573 652e 2044 6f20 6e6f 7420 6578  o use. Do not ex
-000182c0: 6365 6564 2038 2e20 5573 6520 3120 666f  ceed 8. Use 1 fo
-000182d0: 7220 656e 7365 6d62 6c65 0a20 2020 2020  r ensemble.     
-000182e0: 2020 2073 696d 756c 6174 696f 6e73 2e20     simulations. 
-000182f0: 4465 6661 756c 7473 2074 6f20 312e 0a20  Defaults to 1.. 
-00018300: 2020 2075 7365 5f61 6377 203a 204c 6974     use_acw : Lit
-00018310: 6572 616c 5b30 2c31 5d0a 2020 2020 2020  eral[0,1].      
-00018320: 2020 5573 6520 4164 6170 7469 7665 2043    Use Adaptive C
-00018330: 6f6d 7075 7461 7469 6f6e 2057 696e 646f  omputation Windo
-00018340: 7720 2830 3d44 6973 6162 6c65 6420 313d  w (0=Disabled 1=
-00018350: 456e 6162 6c65 6429 2e20 4465 6661 756c  Enabled). Defaul
-00018360: 7473 2074 6f20 302e 0a20 2020 2022 2222  ts to 0..    """
-00018370: 0a0a 2020 2020 6e61 6d65 3a20 7374 7220  ..    name: str 
-00018380: 3d20 2252 756e 7469 6d65 5f41 6476 616e  = "Runtime_Advan
-00018390: 6365 645f 5573 6572 5f49 6e70 7574 7322  ced_User_Inputs"
-000183a0: 0a20 2020 205f 6578 7465 6e73 696f 6e3a  .    _extension:
-000183b0: 2073 7472 203d 2022 2e69 6e70 220a 2020   str = ".inp".  
-000183c0: 2020 6e75 6d5f 6370 7573 3a20 506f 7369    num_cpus: Posi
-000183d0: 7469 7665 496e 7420 3d20 4669 656c 6428  tiveInt = Field(
-000183e0: 6c65 3d38 2c20 6465 6661 756c 743d 3129  le=8, default=1)
-000183f0: 0a20 2020 2075 7365 5f61 6377 3a20 4c69  .    use_acw: Li
-00018400: 7465 7261 6c5b 302c 2031 5d20 3d20 300a  teral[0, 1] = 0.
-00018410: 0a20 2020 2040 636c 6173 736d 6574 686f  .    @classmetho
-00018420: 640a 2020 2020 6465 6620 6672 6f6d 5f66  d.    def from_f
-00018430: 696c 6528 636c 732c 2064 6972 6563 746f  ile(cls, directo
-00018440: 7279 3a20 7374 7220 7c20 5061 7468 2c20  ry: str | Path, 
-00018450: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
-00018460: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00018470: 2864 6972 6563 746f 7279 2c20 7374 7229  (directory, str)
-00018480: 3a0a 2020 2020 2020 2020 2020 2020 6469  :.            di
-00018490: 7265 6374 6f72 7920 3d20 5061 7468 2864  rectory = Path(d
-000184a0: 6972 6563 746f 7279 290a 2020 2020 2020  irectory).      
-000184b0: 2020 7769 7468 206f 7065 6e28 6469 7265    with open(dire
-000184c0: 6374 6f72 7920 2f20 2252 756e 7469 6d65  ctory / "Runtime
-000184d0: 5f41 6476 616e 6365 645f 5573 6572 5f49  _Advanced_User_I
-000184e0: 6e70 7574 732e 696e 7022 2c20 2272 2229  nputs.inp", "r")
-000184f0: 2061 7320 663a 0a20 2020 2020 2020 2020   as f:.         
-00018500: 2020 206c 696e 6573 203d 2066 2e72 6561     lines = f.rea
-00018510: 646c 696e 6573 2829 0a0a 2020 2020 2020  dlines()..      
-00018520: 2020 7265 7475 726e 2063 6c73 280a 2020    return cls(.  
-00018530: 2020 2020 2020 2020 2020 6e75 6d5f 6370            num_cp
-00018540: 7573 3d69 6e74 286c 696e 6573 5b30 5d2e  us=int(lines[0].
-00018550: 7374 7269 7028 292e 7370 6c69 7428 2221  strip().split("!
-00018560: 2229 5b30 5d29 2c0a 2020 2020 2020 2020  ")[0]),.        
-00018570: 2020 2020 7573 655f 6163 773d 696e 7428      use_acw=int(
-00018580: 6c69 6e65 735b 315d 2e73 7472 6970 2829  lines[1].strip()
-00018590: 2e73 706c 6974 2822 2122 295b 305d 292c  .split("!")[0]),
-000185a0: 0a20 2020 2020 2020 2029 0a0a 0a63 6c61  .        )...cla
-000185b0: 7373 2051 555f 6d6f 7669 6e67 636f 6f72  ss QU_movingcoor
-000185c0: 6473 2849 6e70 7574 4669 6c65 293a 0a20  ds(InputFile):. 
-000185d0: 2020 2022 2222 0a20 2020 2043 6c61 7373     """.    Class
-000185e0: 2072 6570 7265 7365 6e74 696e 6720 7468   representing th
-000185f0: 6520 5155 5f6d 6f76 696e 6763 6f6f 7264  e QU_movingcoord
-00018600: 732e 696e 7020 696e 7075 7420 6669 6c65  s.inp input file
-00018610: 2e0a 2020 2020 5468 6973 2069 7320 6120  ..    This is a 
-00018620: 5155 4943 206c 6567 6163 7920 6669 6c65  QUIC legacy file
-00018630: 2074 6861 7420 6973 206e 6f74 206d 6f64   that is not mod
-00018640: 6966 6965 6420 666f 7220 5155 4943 2d46  ified for QUIC-F
-00018650: 6972 6520 7573 652e 0a20 2020 2022 2222  ire use..    """
-00018660: 0a0a 2020 2020 6e61 6d65 3a20 7374 7220  ..    name: str 
-00018670: 3d20 2251 555f 6d6f 7669 6e67 636f 6f72  = "QU_movingcoor
-00018680: 6473 220a 2020 2020 5f65 7874 656e 7369  ds".    _extensi
-00018690: 6f6e 3a20 7374 7220 3d20 222e 696e 7022  on: str = ".inp"
-000186a0: 0a0a 2020 2020 4063 6c61 7373 6d65 7468  ..    @classmeth
-000186b0: 6f64 0a20 2020 2064 6566 2066 726f 6d5f  od.    def from_
-000186c0: 6669 6c65 2863 6c73 2c20 6469 7265 6374  file(cls, direct
-000186d0: 6f72 793a 2073 7472 207c 2050 6174 682c  ory: str | Path,
-000186e0: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
-000186f0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00018700: 6528 6469 7265 6374 6f72 792c 2073 7472  e(directory, str
-00018710: 293a 0a20 2020 2020 2020 2020 2020 2064  ):.            d
-00018720: 6972 6563 746f 7279 203d 2050 6174 6828  irectory = Path(
-00018730: 6469 7265 6374 6f72 7929 0a0a 2020 2020  directory)..    
-00018740: 2020 2020 7769 7468 206f 7065 6e28 6469      with open(di
-00018750: 7265 6374 6f72 7920 2f20 2251 555f 6d6f  rectory / "QU_mo
-00018760: 7669 6e67 636f 6f72 6473 2e69 6e70 222c  vingcoords.inp",
-00018770: 2022 7222 2920 6173 2066 3a0a 2020 2020   "r") as f:.    
-00018780: 2020 2020 2020 2020 6c69 6e65 7320 3d20          lines = 
-00018790: 662e 7265 6164 6c69 6e65 7328 290a 0a20  f.readlines().. 
-000187a0: 2020 2020 2020 2069 6620 696e 7428 6c69         if int(li
-000187b0: 6e65 735b 315d 2e73 7472 6970 2829 2e73  nes[1].strip().s
-000187c0: 706c 6974 2822 2122 295b 305d 2920 3d3d  plit("!")[0]) ==
-000187d0: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
-000187e0: 7072 696e 7428 0a20 2020 2020 2020 2020  print(.         
-000187f0: 2020 2020 2020 2022 5741 524e 494e 473a         "WARNING:
-00018800: 2051 555f 6d6f 7669 6e67 636f 6f72 6473   QU_movingcoords
-00018810: 2e69 6e70 3a20 4d6f 7669 6e67 2063 6f6f  .inp: Moving coo
-00018820: 7264 696e 6174 6573 2066 6c61 6720 3d3d  rdinates flag ==
-00018830: 2031 206e 6f74 2073 7570 706f 7274 6564   1 not supported
-00018840: 2e22 0a20 2020 2020 2020 2020 2020 2029  .".            )
-00018850: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00018860: 2063 6c73 2829 0a0a 0a63 6c61 7373 2051   cls()...class Q
-00018870: 505f 6275 696c 646f 7574 2849 6e70 7574  P_buildout(Input
-00018880: 4669 6c65 293a 0a20 2020 2022 2222 0a20  File):.    """. 
-00018890: 2020 2043 6c61 7373 2072 6570 7265 7365     Class represe
-000188a0: 6e74 696e 6720 7468 6520 5155 5f62 7569  nting the QU_bui
-000188b0: 6c64 6f75 742e 696e 7020 696e 7075 7420  ldout.inp input 
-000188c0: 6669 6c65 2e0a 2020 2020 5468 6973 2069  file..    This i
-000188d0: 7320 6120 5155 4943 206c 6567 6163 7920  s a QUIC legacy 
-000188e0: 6669 6c65 2074 6861 7420 6973 206e 6f74  file that is not
-000188f0: 206d 6f64 6966 6965 6420 666f 7220 5155   modified for QU
-00018900: 4943 2d46 6972 6520 7573 652e 0a20 2020  IC-Fire use..   
-00018910: 2022 2222 0a0a 2020 2020 6e61 6d65 3a20   """..    name: 
-00018920: 7374 7220 3d20 2251 505f 6275 696c 646f  str = "QP_buildo
-00018930: 7574 220a 2020 2020 5f65 7874 656e 7369  ut".    _extensi
-00018940: 6f6e 3a20 7374 7220 3d20 222e 696e 7022  on: str = ".inp"
-00018950: 0a0a 2020 2020 4063 6c61 7373 6d65 7468  ..    @classmeth
-00018960: 6f64 0a20 2020 2064 6566 2066 726f 6d5f  od.    def from_
-00018970: 6669 6c65 2863 6c73 2c20 6469 7265 6374  file(cls, direct
-00018980: 6f72 793a 2073 7472 207c 2050 6174 682c  ory: str | Path,
-00018990: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
-000189a0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-000189b0: 6528 6469 7265 6374 6f72 792c 2073 7472  e(directory, str
-000189c0: 293a 0a20 2020 2020 2020 2020 2020 2064  ):.            d
-000189d0: 6972 6563 746f 7279 203d 2050 6174 6828  irectory = Path(
-000189e0: 6469 7265 6374 6f72 7929 0a0a 2020 2020  directory)..    
-000189f0: 2020 2020 7769 7468 206f 7065 6e28 6469      with open(di
-00018a00: 7265 6374 6f72 7920 2f20 2251 505f 6275  rectory / "QP_bu
-00018a10: 696c 646f 7574 2e69 6e70 222c 2022 7222  ildout.inp", "r"
-00018a20: 2920 6173 2066 3a0a 2020 2020 2020 2020  ) as f:.        
-00018a30: 2020 2020 6c69 6e65 7320 3d20 662e 7265      lines = f.re
-00018a40: 6164 6c69 6e65 7328 290a 0a20 2020 2020  adlines()..     
-00018a50: 2020 2069 6620 696e 7428 6c69 6e65 735b     if int(lines[
-00018a60: 305d 2e73 7472 6970 2829 2e73 706c 6974  0].strip().split
-00018a70: 2822 2122 295b 305d 2920 3d3d 2031 3a0a  ("!")[0]) == 1:.
-00018a80: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00018a90: 7428 2257 4152 4e49 4e47 3a20 5150 5f62  t("WARNING: QP_b
-00018aa0: 7569 6c64 6f75 742e 696e 703a 206e 756d  uildout.inp: num
-00018ab0: 6265 7220 6f66 2062 7569 6c64 696e 6773  ber of buildings
-00018ac0: 2077 696c 6c20 6265 2073 6574 2074 6f20   will be set to 
-00018ad0: 302e 2229 0a20 2020 2020 2020 2069 6620  0.").        if 
-00018ae0: 696e 7428 6c69 6e65 735b 315d 2e73 7472  int(lines[1].str
-00018af0: 6970 2829 2e73 706c 6974 2822 2122 295b  ip().split("!")[
-00018b00: 305d 2920 3d3d 2031 3a0a 2020 2020 2020  0]) == 1:.      
-00018b10: 2020 2020 2020 7072 696e 7428 0a20 2020        print(.   
-00018b20: 2020 2020 2020 2020 2020 2020 2022 5741               "WA
-00018b30: 524e 494e 473a 2051 505f 6275 696c 646f  RNING: QP_buildo
-00018b40: 7574 2e69 6e70 3a20 6e75 6d62 6572 206f  ut.inp: number o
-00018b50: 6620 7665 6765 7461 7469 7665 2063 616e  f vegetative can
-00018b60: 6f70 6965 7320 7769 6c6c 2062 6520 7365  opies will be se
-00018b70: 7420 746f 2030 2e22 0a20 2020 2020 2020  t to 0.".       
-00018b80: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-00018b90: 7265 7475 726e 2063 6c73 2829 0a0a 0a63  return cls()...c
-00018ba0: 6c61 7373 2051 555f 6d65 7470 6172 616d  lass QU_metparam
-00018bb0: 7328 496e 7075 7446 696c 6529 3a0a 2020  s(InputFile):.  
-00018bc0: 2020 2222 220a 2020 2020 436c 6173 7320    """.    Class 
-00018bd0: 7265 7072 6573 656e 7469 6e67 2074 6865  representing the
-00018be0: 2051 555f 6d65 7470 6172 616d 732e 696e   QU_metparams.in
-00018bf0: 7020 696e 7075 7420 6669 6c65 2e0a 2020  p input file..  
-00018c00: 2020 5468 6973 2066 696c 6520 636f 6e74    This file cont
-00018c10: 6169 6e73 2069 6e66 6f72 6d61 7469 6f6e  ains information
-00018c20: 2061 626f 7574 2077 696e 6420 7072 6f66   about wind prof
-00018c30: 696c 6573 0a0a 2020 2020 4174 7472 6962  iles..    Attrib
-00018c40: 7574 6573 0a20 2020 202d 2d2d 2d2d 2d2d  utes.    -------
-00018c50: 2d2d 2d0a 2020 2020 6e75 6d5f 7365 6e73  ---.    num_sens
-00018c60: 6f72 7320 3a20 696e 740a 2020 2020 2020  ors : int.      
-00018c70: 2020 4e75 6d62 6572 206f 6620 6d65 6173    Number of meas
-00018c80: 7572 696e 6720 7369 7465 732e 204d 756c  uring sites. Mul
-00018c90: 7469 706c 6520 7769 6e64 2070 726f 6669  tiple wind profi
-00018ca0: 6c65 7320 6172 6520 6e6f 7420 7965 7420  les are not yet 
-00018cb0: 7375 7070 6f72 7465 642e 0a20 2020 2073  supported..    s
-00018cc0: 656e 736f 725f 6e61 6d65 203a 2073 7472  ensor_name : str
-00018cd0: 0a20 2020 2020 2020 204e 616d 6520 6f66  .        Name of
-00018ce0: 2074 6865 2077 696e 6420 7072 6f66 696c   the wind profil
-00018cf0: 652e 2054 6869 7320 7769 6c6c 2063 6f72  e. This will cor
-00018d00: 7265 7370 6f6e 6420 746f 2074 6865 2066  respond to the f
-00018d10: 696c 656e 616d 6520 6f66 2074 6865 2077  ilename of the w
-00018d20: 696e 6420 7072 6f66 696c 652c 2065 2e67  ind profile, e.g
-00018d30: 2e20 7365 6e73 6f72 312e 696e 700a 2020  . sensor1.inp.  
-00018d40: 2020 2222 220a 0a20 2020 206e 616d 653a    """..    name:
-00018d50: 2073 7472 203d 2022 5155 5f6d 6574 7061   str = "QU_metpa
-00018d60: 7261 6d73 220a 2020 2020 5f65 7874 656e  rams".    _exten
-00018d70: 7369 6f6e 3a20 7374 7220 3d20 222e 696e  sion: str = ".in
-00018d80: 7022 0a20 2020 206e 756d 5f73 656e 736f  p".    num_senso
-00018d90: 7273 3a20 506f 7369 7469 7665 496e 7420  rs: PositiveInt 
-00018da0: 3d20 310a 0a20 2020 2040 636f 6d70 7574  = 1..    @comput
-00018db0: 6564 5f66 6965 6c64 0a20 2020 2040 7072  ed_field.    @pr
-00018dc0: 6f70 6572 7479 0a20 2020 2064 6566 205f  operty.    def _
-00018dd0: 7365 6e73 6f72 5f6c 696e 6573 2873 656c  sensor_lines(sel
-00018de0: 6629 202d 3e20 7374 723a 0a20 2020 2020  f) -> str:.     
-00018df0: 2020 2073 656e 736f 725f 6c69 6e65 7320     sensor_lines 
-00018e00: 3d20 5b5d 0a20 2020 2020 2020 2066 6f72  = [].        for
-00018e10: 2069 2069 6e20 7261 6e67 6528 312c 2073   i in range(1, s
-00018e20: 656c 662e 6e75 6d5f 7365 6e73 6f72 7320  elf.num_sensors 
-00018e30: 2b20 3129 3a0a 2020 2020 2020 2020 2020  + 1):.          
-00018e40: 2020 7365 6e73 6f72 5f6c 696e 6573 2e61    sensor_lines.a
-00018e50: 7070 656e 6428 0a20 2020 2020 2020 2020  ppend(.         
-00018e60: 2020 2020 2020 2066 2273 656e 736f 727b         f"sensor{
-00018e70: 7374 7228 6929 7d20 2153 6974 6520 4e61  str(i)} !Site Na
-00018e80: 6d65 5c6e 2220 6622 2146 696c 6520 6e61  me\n" f"!File na
-00018e90: 6d65 5c6e 2220 6622 7365 6e73 6f72 7b73  me\n" f"sensor{s
-00018ea0: 7472 2869 297d 2e69 6e70 220a 2020 2020  tr(i)}.inp".    
-00018eb0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00018ec0: 2020 7265 7475 726e 2022 5c6e 222e 6a6f    return "\n".jo
-00018ed0: 696e 2873 656e 736f 725f 6c69 6e65 7329  in(sensor_lines)
-00018ee0: 0a0a 2020 2020 4063 6c61 7373 6d65 7468  ..    @classmeth
-00018ef0: 6f64 0a20 2020 2064 6566 2066 726f 6d5f  od.    def from_
-00018f00: 6669 6c65 2863 6c73 2c20 6469 7265 6374  file(cls, direct
-00018f10: 6f72 793a 2073 7472 207c 2050 6174 682c  ory: str | Path,
-00018f20: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
-00018f30: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00018f40: 6528 6469 7265 6374 6f72 792c 2073 7472  e(directory, str
-00018f50: 293a 0a20 2020 2020 2020 2020 2020 2064  ):.            d
-00018f60: 6972 6563 746f 7279 203d 2050 6174 6828  irectory = Path(
-00018f70: 6469 7265 6374 6f72 7929 0a20 2020 2020  directory).     
-00018f80: 2020 2077 6974 6820 6f70 656e 2864 6972     with open(dir
-00018f90: 6563 746f 7279 202f 2022 5155 5f6d 6574  ectory / "QU_met
-00018fa0: 7061 7261 6d73 2e69 6e70 222c 2022 7222  params.inp", "r"
-00018fb0: 2920 6173 2066 3a0a 2020 2020 2020 2020  ) as f:.        
-00018fc0: 2020 2020 6c69 6e65 7320 3d20 662e 7265      lines = f.re
-00018fd0: 6164 6c69 6e65 7328 290a 2020 2020 2020  adlines().      
-00018fe0: 2020 7365 6e73 6f72 5f6e 616d 6520 3d20    sensor_name = 
-00018ff0: 7374 7228 6c69 6e65 735b 345d 2e73 7472  str(lines[4].str
-00019000: 6970 2829 2e73 706c 6974 2829 5b30 5d2e  ip().split()[0].
-00019010: 7374 7269 7028 2929 0a20 2020 2020 2020  strip()).       
-00019020: 2069 6620 7365 6e73 6f72 5f6e 616d 6520   if sensor_name 
-00019030: 213d 2022 7365 6e73 6f72 3122 3a0a 2020  != "sensor1":.  
-00019040: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-00019050: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019060: 2066 2257 4152 4e49 4e47 3a20 7769 6e64   f"WARNING: wind
-00019070: 2073 656e 736f 7220 6669 6c65 7320 6d75   sensor files mu
-00019080: 7374 2062 6520 6e61 6d65 6420 2773 656e  st be named 'sen
-00019090: 736f 722a 2e69 6e70 275c 6e22 0a20 2020  sor*.inp'\n".   
-000190a0: 2020 2020 2020 2020 2020 2020 2066 2243               f"C
-000190b0: 7572 7265 6e74 2073 656e 736f 7220 6e61  urrent sensor na
-000190c0: 6d65 203d 207b 7365 6e73 6f72 5f6e 616d  me = {sensor_nam
-000190d0: 657d 220a 2020 2020 2020 2020 2020 2020  e}".            
-000190e0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-000190f0: 2063 6c73 280a 2020 2020 2020 2020 2020   cls(.          
-00019100: 2020 6e75 6d5f 7365 6e73 6f72 733d 696e    num_sensors=in
-00019110: 7428 6c69 6e65 735b 325d 2e73 7472 6970  t(lines[2].strip
-00019120: 2829 2e73 706c 6974 2829 5b30 5d29 2c0a  ().split()[0]),.
-00019130: 2020 2020 2020 2020 290a 0a0a 636c 6173          )...clas
-00019140: 7320 5769 6e64 5365 6e73 6f72 2842 6173  s WindSensor(Bas
-00019150: 654d 6f64 656c 2c20 7661 6c69 6461 7465  eModel, validate
-00019160: 5f61 7373 6967 6e6d 656e 743d 5472 7565  _assignment=True
-00019170: 293a 0a20 2020 2022 2222 0a20 2020 2043  ):.    """.    C
-00019180: 6c61 7373 2072 6570 7265 7365 6e74 696e  lass representin
-00019190: 6720 6120 7365 6e73 6f72 2a2e 696e 7020  g a sensor*.inp 
-000191a0: 696e 7075 7420 6669 6c65 2e0a 2020 2020  input file..    
-000191b0: 5468 6973 2066 696c 6520 636f 6e74 6169  This file contai
-000191c0: 6e73 2069 6e66 6f72 6d61 7469 6f6e 206f  ns information o
-000191d0: 6e20 7769 6e64 732c 2061 6e64 2073 6572  n winds, and ser
-000191e0: 7665 7320 6173 2074 6865 0a20 2020 2070  ves as the.    p
-000191f0: 7269 6d61 7279 2073 6f75 7263 6520 666f  rimary source fo
-00019200: 7220 7769 6e64 2073 7065 6564 2873 2920  r wind speed(s) 
-00019210: 616e 6420 6469 7265 6374 696f 6e28 7329  and direction(s)
-00019220: 2e0a 2020 2020 4d75 6c74 6970 6c65 2073  ..    Multiple s
-00019230: 656e 736f 722a 2e69 6e70 2066 696c 6573  ensor*.inp files
-00019240: 206d 6179 2062 6520 6372 6561 7465 642e   may be created.
-00019250: 0a0a 2020 2020 4174 7472 6962 7574 6573  ..    Attributes
-00019260: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
-00019270: 2020 2020 7365 6e73 6f72 5f6e 756d 6265      sensor_numbe
-00019280: 7220 3a20 506f 7369 7469 7665 496e 740a  r : PositiveInt.
-00019290: 2020 2020 2020 2020 4e75 6d62 6572 2072          Number r
-000192a0: 6570 7265 7365 6e74 696e 6720 7468 6520  epresenting the 
-000192b0: 7769 6e64 2073 656e 736f 720a 2020 2020  wind sensor.    
-000192c0: 7769 6e64 5f74 696d 6573 203a 204e 6f6e  wind_times : Non
-000192d0: 4e65 6761 7469 7665 466c 6f61 7420 7c20  NegativeFloat | 
-000192e0: 6c69 7374 284e 6f6e 4e65 6761 7469 7665  list(NonNegative
-000192f0: 466c 6f61 7429 0a20 2020 2020 2020 2054  Float).        T
-00019300: 696d 6520 696e 2073 6563 6f6e 6473 2073  ime in seconds s
-00019310: 696e 6365 2074 6865 2073 7461 7274 206f  ince the start o
-00019320: 6620 7468 6520 6669 7265 2066 6f72 2065  f the fire for e
-00019330: 6163 6820 7769 6e64 2073 6869 6674 2e0a  ach wind shift..
-00019340: 2020 2020 2020 2020 4669 7273 7420 7469          First ti
-00019350: 6d65 206d 7573 7420 6265 207a 6572 6f2e  me must be zero.
-00019360: 0a20 2020 2077 696e 645f 7370 6565 6473  .    wind_speeds
-00019370: 203a 2050 6f73 6974 6976 6546 6c6f 6174   : PositiveFloat
-00019380: 207c 206c 6973 7428 506f 7369 7469 7665   | list(Positive
-00019390: 466c 6f61 7429 0a20 2020 2020 2020 2057  Float).        W
-000193a0: 696e 6420 7370 6565 6420 6f72 206c 6973  ind speed or lis
-000193b0: 7420 6f66 2077 696e 6420 7370 6565 6473  t of wind speeds
-000193c0: 2028 6d2f 7329 0a20 2020 2077 696e 645f   (m/s).    wind_
-000193d0: 6469 7265 6374 696f 6e73 203a 204e 6f6e  directions : Non
-000193e0: 4e65 6761 7469 7665 496e 7420 3c20 3336  NegativeInt < 36
-000193f0: 3020 7c20 6c69 7374 284e 6f6e 4e65 6761  0 | list(NonNega
-00019400: 7469 7665 496e 7420 3c20 3336 3029 0a20  tiveInt < 360). 
-00019410: 2020 2020 2020 2057 696e 6420 6469 7265         Wind dire
-00019420: 6374 696f 6e20 6f72 206c 6973 7420 6f66  ction or list of
-00019430: 2064 6972 6563 7469 6f6e 7320 2864 6567   directions (deg
-00019440: 7265 6573 292e 2055 7365 2030 c2b0 2066  rees). Use 0.. f
-00019450: 6f72 204e 6f72 7468 0a20 2020 2073 656e  or North.    sen
-00019460: 736f 725f 6865 6967 6874 203a 2050 6f73  sor_height : Pos
-00019470: 6974 6976 6546 6c6f 6174 0a20 2020 2020  itiveFloat.     
-00019480: 2020 2057 696e 6420 6d65 6173 7572 656d     Wind measurem
-00019490: 656e 7420 6865 6967 6874 2028 6d29 2e20  ent height (m). 
-000194a0: 4465 6661 756c 7420 6973 2036 2e31 6d20  Default is 6.1m 
-000194b0: 2832 3066 7429 0a20 2020 2078 5f6c 6f63  (20ft).    x_loc
-000194c0: 6174 696f 6e20 3a20 506f 7369 7469 7665  ation : Positive
-000194d0: 496e 740a 2020 2020 2020 2020 4c6f 6361  Int.        Loca
-000194e0: 7469 6f6e 206f 6620 7468 6520 7365 6e73  tion of the sens
-000194f0: 6f72 2069 6e20 7468 6520 782d 6469 7265  or in the x-dire
-00019500: 6374 696f 6e0a 2020 2020 795f 6c6f 6361  ction.    y_loca
-00019510: 7469 6f6e 203a 2050 6f73 6974 6976 6549  tion : PositiveI
-00019520: 6e74 0a20 2020 2020 2020 204c 6f63 6174  nt.        Locat
-00019530: 696f 6e20 6f66 2074 6865 2073 656e 736f  ion of the senso
-00019540: 7220 696e 2074 6865 2079 2d64 6972 6563  r in the y-direc
-00019550: 7469 6f6e 0a20 2020 2022 2222 0a0a 2020  tion.    """..  
-00019560: 2020 6e61 6d65 3a20 7374 720a 2020 2020    name: str.    
-00019570: 5f65 7874 656e 7369 6f6e 3a20 7374 7220  _extension: str 
-00019580: 3d20 222e 696e 7022 0a20 2020 2077 696e  = ".inp".    win
-00019590: 645f 7469 6d65 733a 2055 6e69 6f6e 5b4e  d_times: Union[N
-000195a0: 6f6e 4e65 6761 7469 7665 466c 6f61 742c  onNegativeFloat,
-000195b0: 204c 6973 745b 4e6f 6e4e 6567 6174 6976   List[NonNegativ
-000195c0: 6546 6c6f 6174 5d5d 203d 2030 0a20 2020  eFloat]] = 0.   
-000195d0: 2077 696e 645f 7370 6565 6473 3a20 556e   wind_speeds: Un
-000195e0: 696f 6e5b 506f 7369 7469 7665 466c 6f61  ion[PositiveFloa
-000195f0: 742c 204c 6973 745b 506f 7369 7469 7665  t, List[Positive
-00019600: 466c 6f61 745d 5d0a 2020 2020 7769 6e64  Float]].    wind
-00019610: 5f64 6972 6563 7469 6f6e 733a 2055 6e69  _directions: Uni
-00019620: 6f6e 5b4e 6f6e 4e65 6761 7469 7665 496e  on[NonNegativeIn
-00019630: 742c 204c 6973 745b 4e6f 6e4e 6567 6174  t, List[NonNegat
-00019640: 6976 6549 6e74 5d5d 0a20 2020 2073 656e  iveInt]].    sen
-00019650: 736f 725f 6865 6967 6874 3a20 506f 7369  sor_height: Posi
-00019660: 7469 7665 466c 6f61 7420 3d20 362e 310a  tiveFloat = 6.1.
-00019670: 2020 2020 785f 6c6f 6361 7469 6f6e 3a20      x_location: 
-00019680: 506f 7369 7469 7665 496e 7420 3d20 310a  PositiveInt = 1.
-00019690: 2020 2020 795f 6c6f 6361 7469 6f6e 3a20      y_location: 
-000196a0: 506f 7369 7469 7665 496e 7420 3d20 310a  PositiveInt = 1.
-000196b0: 0a20 2020 2040 6669 656c 645f 7661 6c69  .    @field_vali
-000196c0: 6461 746f 7228 2277 696e 645f 7469 6d65  dator("wind_time
-000196d0: 7322 2c20 6d6f 6465 3d22 6265 666f 7265  s", mode="before
-000196e0: 2229 0a20 2020 2040 636c 6173 736d 6574  ").    @classmet
-000196f0: 686f 640a 2020 2020 6465 6620 7661 6c69  hod.    def vali
-00019700: 6461 7465 5f77 696e 645f 7469 6d65 7328  date_wind_times(
-00019710: 636c 732c 2076 3a20 6c69 7374 2c20 7661  cls, v: list, va
-00019720: 6c75 6573 2920 2d3e 206c 6973 743a 0a20  lues) -> list:. 
-00019730: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-00019740: 616e 6365 2876 2c20 2866 6c6f 6174 2c20  ance(v, (float, 
-00019750: 696e 7429 293a 0a20 2020 2020 2020 2020  int)):.         
-00019760: 2020 2076 203d 205b 765d 0a20 2020 2020     v = [v].     
-00019770: 2020 2069 6620 765b 305d 2021 3d20 303a     if v[0] != 0:
-00019780: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00019790: 7365 2056 616c 7565 4572 726f 7228 2277  se ValueError("w
-000197a0: 696e 645f 7469 6d65 733a 2066 6972 7374  ind_times: first
-000197b0: 2065 6c65 6d65 6e74 206f 6620 7365 6e73   element of sens
-000197c0: 6f72 2e77 696e 645f 7469 6d65 7320 6d75  or.wind_times mu
-000197d0: 7374 2062 6520 3022 290a 2020 2020 2020  st be 0").      
-000197e0: 2020 7265 7475 726e 2076 0a0a 2020 2020    return v..    
-000197f0: 4066 6965 6c64 5f76 616c 6964 6174 6f72  @field_validator
-00019800: 2822 7769 6e64 5f73 7065 6564 7322 2c20  ("wind_speeds", 
-00019810: 2277 696e 645f 6469 7265 6374 696f 6e73  "wind_directions
-00019820: 2229 0a20 2020 2040 636c 6173 736d 6574  ").    @classmet
-00019830: 686f 640a 2020 2020 6465 6620 7661 6c69  hod.    def vali
-00019840: 6461 7465 5f77 696e 645f 6c69 7374 7328  date_wind_lists(
-00019850: 636c 732c 2076 2c20 7661 6c75 6573 2920  cls, v, values) 
-00019860: 2d3e 206c 6973 743a 0a20 2020 2020 2020  -> list:.       
-00019870: 2069 6620 6973 696e 7374 616e 6365 2876   if isinstance(v
-00019880: 2c20 2866 6c6f 6174 2c20 696e 7429 293a  , (float, int)):
-00019890: 0a20 2020 2020 2020 2020 2020 2076 203d  .            v =
-000198a0: 205b 765d 0a20 2020 2020 2020 2069 6620   [v].        if 
-000198b0: 7620 616e 6420 6c65 6e28 7661 6c75 6573  v and len(values
-000198c0: 2e64 6174 615b 2277 696e 645f 7469 6d65  .data["wind_time
-000198d0: 7322 5d29 2021 3d20 6c65 6e28 7629 3a0a  s"]) != len(v):.
-000198e0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-000198f0: 6520 5661 6c75 6545 7272 6f72 280a 2020  e ValueError(.  
-00019900: 2020 2020 2020 2020 2020 2020 2020 2257                "W
-00019910: 696e 6453 656e 736f 723a 206c 6973 7473  indSensor: lists
-00019920: 206f 6620 7769 6e64 2074 696d 6573 2c20   of wind times, 
-00019930: 7370 6565 6473 2c20 616e 6420 6469 7265  speeds, and dire
-00019940: 6374 696f 6e73 206d 7573 7420 6265 2074  ctions must be t
-00019950: 6865 2073 616d 6520 6c65 6e67 7468 2e5c  he same length.\
-00019960: 6e22 0a20 2020 2020 2020 2020 2020 2029  n".            )
-00019970: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00019980: 760a 0a20 2020 2040 7072 6f70 6572 7479  v..    @property
-00019990: 0a20 2020 2064 6566 205f 6669 6c65 6e61  .    def _filena
-000199a0: 6d65 2873 656c 6629 3a0a 2020 2020 2020  me(self):.      
-000199b0: 2020 7265 7475 726e 2066 227b 7365 6c66    return f"{self
-000199c0: 2e6e 616d 657d 7b73 656c 662e 5f65 7874  .name}{self._ext
-000199d0: 656e 7369 6f6e 7d22 0a0a 2020 2020 4070  ension}"..    @p
-000199e0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-000199f0: 646f 6375 6d65 6e74 6174 696f 6e5f 6469  documentation_di
-00019a00: 6374 2873 656c 6629 202d 3e20 6469 6374  ct(self) -> dict
-00019a10: 3a0a 2020 2020 2020 2020 2320 5265 7475  :.        # Retu
-00019a20: 726e 2074 6865 2064 6f63 756d 656e 7461  rn the documenta
-00019a30: 7469 6f6e 2064 6963 7469 6f6e 6172 790a  tion dictionary.
-00019a40: 2020 2020 2020 2020 7769 7468 206f 7065          with ope
-00019a50: 6e28 444f 4353 5f50 4154 4820 2f20 6622  n(DOCS_PATH / f"
-00019a60: 7b73 656c 662e 5f66 696c 656e 616d 657d  {self._filename}
-00019a70: 2e6a 736f 6e22 2c20 2272 2229 2061 7320  .json", "r") as 
-00019a80: 663a 0a20 2020 2020 2020 2020 2020 2072  f:.            r
-00019a90: 6574 7572 6e20 6a73 6f6e 2e6c 6f61 6428  eturn json.load(
-00019aa0: 6629 0a0a 2020 2020 6465 6620 5f66 696e  f)..    def _fin
-00019ab0: 645f 7461 7267 6574 5f74 696d 655f 696e  d_target_time_in
-00019ac0: 6465 7828 7365 6c66 2c20 7461 7267 6574  dex(self, target
-00019ad0: 5f76 616c 7565 293a 0a20 2020 2020 2020  _value):.       
-00019ae0: 2069 6e64 6578 203d 2062 6973 6563 742e   index = bisect.
-00019af0: 6269 7365 6374 5f6c 6566 7428 7365 6c66  bisect_left(self
-00019b00: 2e77 696e 645f 7469 6d65 732c 2074 6172  .wind_times, tar
-00019b10: 6765 745f 7661 6c75 6529 0a20 2020 2020  get_value).     
-00019b20: 2020 2069 6620 7461 7267 6574 5f76 616c     if target_val
-00019b30: 7565 206e 6f74 2069 6e20 7365 6c66 2e77  ue not in self.w
-00019b40: 696e 645f 7469 6d65 733a 0a20 2020 2020  ind_times:.     
-00019b50: 2020 2020 2020 2069 6e64 6578 203d 2069         index = i
-00019b60: 6e64 6578 202d 2031 0a20 2020 2020 2020  ndex - 1.       
-00019b70: 2072 6574 7572 6e20 696e 6465 780a 0a20   return index.. 
-00019b80: 2020 2064 6566 2067 6574 5f77 696e 645f     def get_wind_
-00019b90: 6c69 6e65 7328 7365 6c66 2c20 676c 6f62  lines(self, glob
-00019ba0: 616c 5f74 696d 6573 2c20 7469 6d65 5f6e  al_times, time_n
-00019bb0: 6f77 2920 2d3e 2073 7472 3a0a 2020 2020  ow) -> str:.    
-00019bc0: 2020 2020 6c6f 6361 7469 6f6e 5f6c 696e      location_lin
-00019bd0: 6573 203d 2028 0a20 2020 2020 2020 2020  es = (.         
-00019be0: 2020 2066 227b 7365 6c66 2e78 5f6c 6f63     f"{self.x_loc
-00019bf0: 6174 696f 6e7d 2021 5820 636f 6f72 6469  ation} !X coordi
-00019c00: 6e61 7465 2028 6d65 7465 7273 295c 6e22  nate (meters)\n"
-00019c10: 0a20 2020 2020 2020 2020 2020 2066 227b  .            f"{
-00019c20: 7365 6c66 2e79 5f6c 6f63 6174 696f 6e7d  self.y_location}
-00019c30: 2021 5920 636f 6f72 6469 6e61 7465 2028   !Y coordinate (
-00019c40: 6d65 7465 7273 2922 0a20 2020 2020 2020  meters)".       
-00019c50: 2029 0a20 2020 2020 2020 2077 696e 6473   ).        winds
-00019c60: 6869 6674 7320 3d20 5b5d 0a20 2020 2020  hifts = [].     
-00019c70: 2020 2066 6f72 2077 696e 645f 7469 6d65     for wind_time
-00019c80: 2069 6e20 676c 6f62 616c 5f74 696d 6573   in global_times
-00019c90: 3a0a 2020 2020 2020 2020 2020 2020 7469  :.            ti
-00019ca0: 6d65 5f69 6478 203d 2073 656c 662e 5f66  me_idx = self._f
-00019cb0: 696e 645f 7461 7267 6574 5f74 696d 655f  ind_target_time_
-00019cc0: 696e 6465 7828 7769 6e64 5f74 696d 6529  index(wind_time)
-00019cd0: 0a20 2020 2020 2020 2020 2020 2077 696e  .            win
-00019ce0: 645f 7370 6565 6420 3d20 7365 6c66 2e77  d_speed = self.w
-00019cf0: 696e 645f 7370 6565 6473 5b74 696d 655f  ind_speeds[time_
-00019d00: 6964 785d 0a20 2020 2020 2020 2020 2020  idx].           
-00019d10: 2077 696e 645f 6469 7265 6374 696f 6e20   wind_direction 
-00019d20: 3d20 7365 6c66 2e77 696e 645f 6469 7265  = self.wind_dire
-00019d30: 6374 696f 6e73 5b74 696d 655f 6964 785d  ctions[time_idx]
-00019d40: 0a20 2020 2020 2020 2020 2020 2073 6869  .            shi
-00019d50: 6674 203d 2028 0a20 2020 2020 2020 2020  ft = (.         
-00019d60: 2020 2020 2020 2066 225c 6e7b 7469 6d65         f"\n{time
-00019d70: 5f6e 6f77 202b 2077 696e 645f 7469 6d65  _now + wind_time
-00019d80: 7d20 2142 6567 696e 696e 6720 6f66 2074  } !Begining of t
-00019d90: 696d 6520 7374 6570 2069 6e20 556e 6978  ime step in Unix
-00019da0: 2045 706f 6368 2074 696d 6520 2869 6e74   Epoch time (int
-00019db0: 6567 6572 2073 6563 6f6e 6473 2073 696e  eger seconds sin
-00019dc0: 6365 2031 3937 302f 312f 3120 3030 3a30  ce 1970/1/1 00:0
-00019dd0: 303a 3030 295c 6e22 0a20 2020 2020 2020  0:00)\n".       
-00019de0: 2020 2020 2020 2020 2066 2231 2021 7369           f"1 !si
-00019df0: 7465 2062 6f75 6e64 6172 7920 6c61 7965  te boundary laye
-00019e00: 7220 666c 6167 2028 3120 3d20 6c6f 672c  r flag (1 = log,
-00019e10: 2032 203d 2065 7870 2c20 3320 3d20 7572   2 = exp, 3 = ur
-00019e20: 6261 6e20 6361 6e6f 7079 2c20 3420 3d20  ban canopy, 4 = 
-00019e30: 6469 7363 7265 7465 2064 6174 6120 706f  discrete data po
-00019e40: 696e 7473 295c 6e22 0a20 2020 2020 2020  ints)\n".       
-00019e50: 2020 2020 2020 2020 2066 2230 2e31 2021           f"0.1 !
-00019e60: 7369 7465 207a 6f5c 6e22 0a20 2020 2020  site zo\n".     
-00019e70: 2020 2020 2020 2020 2020 2066 2230 2e20             f"0. 
-00019e80: 2120 312f 4c20 2864 6566 6175 6c74 203d  ! 1/L (default =
-00019e90: 2030 295c 6e22 0a20 2020 2020 2020 2020   0)\n".         
-00019ea0: 2020 2020 2020 2066 2221 4865 6967 6874         f"!Height
-00019eb0: 2028 6d29 2c20 5370 6565 6420 286d 2f73   (m), Speed (m/s
-00019ec0: 292c 2044 6972 6563 7469 6f6e 2028 6465  ), Direction (de
-00019ed0: 6720 7265 6c61 7469 7665 2074 6f20 7472  g relative to tr
-00019ee0: 7565 204e 295c 6e22 0a20 2020 2020 2020  ue N)\n".       
-00019ef0: 2020 2020 2020 2020 2066 227b 7365 6c66           f"{self
-00019f00: 2e73 656e 736f 725f 6865 6967 6874 7d20  .sensor_height} 
-00019f10: 7b77 696e 645f 7370 6565 647d 207b 7769  {wind_speed} {wi
-00019f20: 6e64 5f64 6972 6563 7469 6f6e 7d22 0a20  nd_direction}". 
-00019f30: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00019f40: 2020 2020 2020 2020 2077 696e 6473 6869           windshi
-00019f50: 6674 732e 6170 7065 6e64 2873 6869 6674  fts.append(shift
-00019f60: 290a 2020 2020 2020 2020 7769 6e64 5f6c  ).        wind_l
-00019f70: 696e 6573 203d 2022 222e 6a6f 696e 2877  ines = "".join(w
-00019f80: 696e 6473 6869 6674 7329 0a0a 2020 2020  indshifts)..    
-00019f90: 2020 2020 7265 7475 726e 206c 6f63 6174      return locat
-00019fa0: 696f 6e5f 6c69 6e65 7320 2b20 7769 6e64  ion_lines + wind
-00019fb0: 5f6c 696e 6573 0a0a 2020 2020 6465 6620  _lines..    def 
-00019fc0: 746f 5f66 696c 6528 0a20 2020 2020 2020  to_file(.       
-00019fd0: 2073 656c 662c 2067 6c6f 6261 6c5f 7469   self, global_ti
-00019fe0: 6d65 733a 206c 6973 742c 2074 696d 655f  mes: list, time_
-00019ff0: 6e6f 773a 2069 6e74 2c20 6469 7265 6374  now: int, direct
-0001a000: 6f72 793a 2050 6174 6820 7c20 7374 722c  ory: Path | str,
-0001a010: 2076 6572 7369 6f6e 3a20 7374 720a 2020   version: str.  
-0001a020: 2020 293a 0a20 2020 2020 2020 2069 6620    ):.        if 
-0001a030: 6973 696e 7374 616e 6365 2864 6972 6563  isinstance(direc
-0001a040: 746f 7279 2c20 7374 7229 3a0a 2020 2020  tory, str):.    
-0001a050: 2020 2020 2020 2020 6469 7265 6374 6f72          director
-0001a060: 7920 3d20 5061 7468 2864 6972 6563 746f  y = Path(directo
-0001a070: 7279 290a 0a20 2020 2020 2020 2076 6572  ry)..        ver
-0001a080: 7369 6f6e 203d 205f 7661 6c69 6461 7465  sion = _validate
-0001a090: 5f61 6e64 5f72 6574 7572 6e5f 7665 7273  _and_return_vers
-0001a0a0: 696f 6e28 7665 7273 696f 6e29 0a20 2020  ion(version).   
-0001a0b0: 2020 2020 2074 656d 706c 6174 655f 6669       template_fi
-0001a0c0: 6c65 5f70 6174 6820 3d20 5445 4d50 4c41  le_path = TEMPLA
-0001a0d0: 5445 535f 5041 5448 202f 2076 6572 7369  TES_PATH / versi
-0001a0e0: 6f6e 202f 2022 7365 6e73 6f72 2e69 6e70  on / "sensor.inp
-0001a0f0: 220a 2020 2020 2020 2020 7769 7468 206f  ".        with o
-0001a100: 7065 6e28 7465 6d70 6c61 7465 5f66 696c  pen(template_fil
-0001a110: 655f 7061 7468 2c20 2272 2229 2061 7320  e_path, "r") as 
-0001a120: 6674 656d 703a 0a20 2020 2020 2020 2020  ftemp:.         
-0001a130: 2020 2073 7263 203d 2054 656d 706c 6174     src = Templat
-0001a140: 6528 6674 656d 702e 7265 6164 2829 290a  e(ftemp.read()).
-0001a150: 0a20 2020 2020 2020 2064 6963 745f 7265  .        dict_re
-0001a160: 7072 6573 656e 7461 7469 6f6e 203d 2073  presentation = s
-0001a170: 656c 662e 746f 5f64 6963 7428 696e 636c  elf.to_dict(incl
-0001a180: 7564 655f 7072 6976 6174 653d 5472 7565  ude_private=True
-0001a190: 290a 2020 2020 2020 2020 6469 6374 5f72  ).        dict_r
-0001a1a0: 6570 7265 7365 6e74 6174 696f 6e5b 225f  epresentation["_
-0001a1b0: 7769 6e64 5f6c 696e 6573 225d 203d 2073  wind_lines"] = s
-0001a1c0: 656c 662e 6765 745f 7769 6e64 5f6c 696e  elf.get_wind_lin
-0001a1d0: 6573 2867 6c6f 6261 6c5f 7469 6d65 732c  es(global_times,
-0001a1e0: 2074 696d 655f 6e6f 7729 0a20 2020 2020   time_now).     
-0001a1f0: 2020 2072 6573 756c 7420 3d20 7372 632e     result = src.
-0001a200: 7375 6273 7469 7475 7465 2864 6963 745f  substitute(dict_
-0001a210: 7265 7072 6573 656e 7461 7469 6f6e 290a  representation).
-0001a220: 0a20 2020 2020 2020 206f 7574 7075 745f  .        output_
-0001a230: 6669 6c65 5f70 6174 6820 3d20 6469 7265  file_path = dire
-0001a240: 6374 6f72 7920 2f20 7365 6c66 2e5f 6669  ctory / self._fi
-0001a250: 6c65 6e61 6d65 0a20 2020 2020 2020 2077  lename.        w
-0001a260: 6974 6820 6f70 656e 286f 7574 7075 745f  ith open(output_
-0001a270: 6669 6c65 5f70 6174 682c 2022 7722 2920  file_path, "w") 
-0001a280: 6173 2066 6f75 743a 0a20 2020 2020 2020  as fout:.       
-0001a290: 2020 2020 2066 6f75 742e 7772 6974 6528       fout.write(
-0001a2a0: 7265 7375 6c74 290a 0a20 2020 2040 636c  result)..    @cl
-0001a2b0: 6173 736d 6574 686f 640a 2020 2020 6465  assmethod.    de
-0001a2c0: 6620 6672 6f6d 5f66 696c 6528 636c 732c  f from_file(cls,
-0001a2d0: 2064 6972 6563 746f 7279 3a20 7374 7220   directory: str 
-0001a2e0: 7c20 5061 7468 2c20 7365 6e73 6f72 5f6e  | Path, sensor_n
-0001a2f0: 616d 653a 2073 7472 293a 0a20 2020 2020  ame: str):.     
-0001a300: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-0001a310: 2864 6972 6563 746f 7279 2c20 7374 7229  (directory, str)
-0001a320: 3a0a 2020 2020 2020 2020 2020 2020 6469  :.            di
-0001a330: 7265 6374 6f72 7920 3d20 5061 7468 2864  rectory = Path(d
-0001a340: 6972 6563 746f 7279 290a 2020 2020 2020  irectory).      
-0001a350: 2020 7365 6e73 6f72 5f66 696c 6520 3d20    sensor_file = 
-0001a360: 7365 6e73 6f72 5f6e 616d 6520 2b20 222e  sensor_name + ".
-0001a370: 696e 7022 0a20 2020 2020 2020 2077 6974  inp".        wit
-0001a380: 6820 6f70 656e 2864 6972 6563 746f 7279  h open(directory
-0001a390: 202f 2073 656e 736f 725f 6669 6c65 2c20   / sensor_file, 
-0001a3a0: 2272 2229 2061 7320 663a 0a20 2020 2020  "r") as f:.     
-0001a3b0: 2020 2020 2020 206c 696e 6573 203d 2066         lines = f
-0001a3c0: 2e72 6561 646c 696e 6573 2829 0a20 2020  .readlines().   
-0001a3d0: 2020 2020 2077 696e 645f 7469 6d65 7320       wind_times 
-0001a3e0: 3d20 5b30 5d0a 2020 2020 2020 2020 7769  = [0].        wi
-0001a3f0: 6e64 5f73 7065 6564 7320 3d20 5b5d 0a20  nd_speeds = []. 
-0001a400: 2020 2020 2020 2077 696e 645f 6469 7265         wind_dire
-0001a410: 6374 696f 6e73 203d 205b 5d0a 2020 2020  ctions = [].    
-0001a420: 2020 2020 785f 6c6f 6361 7469 6f6e 203d      x_location =
-0001a430: 2069 6e74 286c 696e 6573 5b34 5d2e 7374   int(lines[4].st
-0001a440: 7269 7028 292e 7370 6c69 7428 2221 2229  rip().split("!")
-0001a450: 5b30 5d29 0a20 2020 2020 2020 2079 5f6c  [0]).        y_l
-0001a460: 6f63 6174 696f 6e20 3d20 696e 7428 6c69  ocation = int(li
-0001a470: 6e65 735b 355d 2e73 7472 6970 2829 2e73  nes[5].strip().s
-0001a480: 706c 6974 2822 2122 295b 305d 290a 2020  plit("!")[0]).  
-0001a490: 2020 2020 2020 7469 6d65 5f6e 6f77 203d        time_now =
-0001a4a0: 2066 6c6f 6174 286c 696e 6573 5b36 5d2e   float(lines[6].
-0001a4b0: 7374 7269 7028 292e 7370 6c69 7428 2221  strip().split("!
-0001a4c0: 2229 5b30 5d29 0a20 2020 2020 2020 2073  ")[0]).        s
-0001a4d0: 656e 736f 725f 6865 6967 6874 203d 2066  ensor_height = f
-0001a4e0: 6c6f 6174 286c 696e 6573 5b31 315d 2e73  loat(lines[11].s
-0001a4f0: 706c 6974 2822 2022 295b 305d 290a 2020  plit(" ")[0]).  
-0001a500: 2020 2020 2020 7769 6e64 5f73 7065 6564        wind_speed
-0001a510: 732e 6170 7065 6e64 2866 6c6f 6174 286c  s.append(float(l
-0001a520: 696e 6573 5b31 315d 2e73 706c 6974 2822  ines[11].split("
-0001a530: 2022 295b 315d 2929 0a20 2020 2020 2020   ")[1])).       
-0001a540: 2077 696e 645f 6469 7265 6374 696f 6e73   wind_directions
-0001a550: 2e61 7070 656e 6428 696e 7428 666c 6f61  .append(int(floa
-0001a560: 7428 6c69 6e65 735b 3131 5d2e 7370 6c69  t(lines[11].spli
-0001a570: 7428 2220 2229 5b32 5d2e 7374 7269 7028  t(" ")[2].strip(
-0001a580: 2929 2929 0a20 2020 2020 2020 206e 6578  )))).        nex
-0001a590: 745f 7368 6966 7420 3d20 3132 0a20 2020  t_shift = 12.   
-0001a5a0: 2020 2020 2077 6869 6c65 2028 6e65 7874       while (next
-0001a5b0: 5f73 6869 6674 202b 2036 2920 3c3d 206c  _shift + 6) <= l
-0001a5c0: 656e 286c 696e 6573 293a 0a20 2020 2020  en(lines):.     
-0001a5d0: 2020 2020 2020 2077 696e 645f 7469 6d65         wind_time
-0001a5e0: 732e 6170 7065 6e64 2866 6c6f 6174 286c  s.append(float(l
-0001a5f0: 696e 6573 5b6e 6578 745f 7368 6966 745d  ines[next_shift]
-0001a600: 2e73 7472 6970 2829 2e73 706c 6974 2822  .strip().split("
-0001a610: 2122 295b 305d 2920 2d20 7469 6d65 5f6e  !")[0]) - time_n
-0001a620: 6f77 290a 2020 2020 2020 2020 2020 2020  ow).            
-0001a630: 7769 6e64 5f73 7065 6564 732e 6170 7065  wind_speeds.appe
-0001a640: 6e64 2866 6c6f 6174 286c 696e 6573 5b6e  nd(float(lines[n
-0001a650: 6578 745f 7368 6966 7420 2b20 355d 2e73  ext_shift + 5].s
-0001a660: 706c 6974 2822 2022 295b 315d 2929 0a20  plit(" ")[1])). 
-0001a670: 2020 2020 2020 2020 2020 2077 696e 645f             wind_
-0001a680: 6469 7265 6374 696f 6e73 2e61 7070 656e  directions.appen
-0001a690: 6428 0a20 2020 2020 2020 2020 2020 2020  d(.             
-0001a6a0: 2020 2069 6e74 2866 6c6f 6174 286c 696e     int(float(lin
-0001a6b0: 6573 5b6e 6578 745f 7368 6966 7420 2b20  es[next_shift + 
-0001a6c0: 355d 2e73 706c 6974 2822 2022 295b 325d  5].split(" ")[2]
-0001a6d0: 2e73 7472 6970 2829 2929 0a20 2020 2020  .strip())).     
-0001a6e0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0001a6f0: 2020 2020 206e 6578 745f 7368 6966 7420       next_shift 
-0001a700: 2b3d 2036 0a20 2020 2020 2020 2072 6574  += 6.        ret
-0001a710: 7572 6e20 636c 7328 0a20 2020 2020 2020  urn cls(.       
-0001a720: 2020 2020 206e 616d 653d 7365 6e73 6f72       name=sensor
-0001a730: 5f6e 616d 652c 0a20 2020 2020 2020 2020  _name,.         
-0001a740: 2020 2073 656e 736f 725f 6865 6967 6874     sensor_height
-0001a750: 3d73 656e 736f 725f 6865 6967 6874 2c0a  =sensor_height,.
-0001a760: 2020 2020 2020 2020 2020 2020 7769 6e64              wind
-0001a770: 5f74 696d 6573 3d77 696e 645f 7469 6d65  _times=wind_time
-0001a780: 732c 0a20 2020 2020 2020 2020 2020 2077  s,.            w
-0001a790: 696e 645f 7370 6565 6473 3d77 696e 645f  ind_speeds=wind_
-0001a7a0: 7370 6565 6473 2c0a 2020 2020 2020 2020  speeds,.        
-0001a7b0: 2020 2020 7769 6e64 5f64 6972 6563 7469      wind_directi
-0001a7c0: 6f6e 733d 7769 6e64 5f64 6972 6563 7469  ons=wind_directi
-0001a7d0: 6f6e 732c 0a20 2020 2020 2020 2020 2020  ons,.           
-0001a7e0: 2078 5f6c 6f63 6174 696f 6e3d 785f 6c6f   x_location=x_lo
-0001a7f0: 6361 7469 6f6e 2c0a 2020 2020 2020 2020  cation,.        
-0001a800: 2020 2020 795f 6c6f 6361 7469 6f6e 3d79      y_location=y
-0001a810: 5f6c 6f63 6174 696f 6e2c 0a20 2020 2020  _location,.     
-0001a820: 2020 2029 0a0a 2020 2020 4063 6c61 7373     )..    @class
-0001a830: 6d65 7468 6f64 0a20 2020 2064 6566 2066  method.    def f
-0001a840: 726f 6d5f 6469 6374 2863 6c73 2c20 6461  rom_dict(cls, da
-0001a850: 7461 3a20 6469 6374 293a 0a20 2020 2020  ta: dict):.     
-0001a860: 2020 2072 6574 7572 6e20 636c 7328 2a2a     return cls(**
-0001a870: 6461 7461 290a 0a20 2020 2064 6566 206c  data)..    def l
-0001a880: 6973 745f 7061 7261 6d65 7465 7273 2873  ist_parameters(s
-0001a890: 656c 6629 202d 3e20 6c69 7374 5b73 7472  elf) -> list[str
-0001a8a0: 5d3a 0a20 2020 2020 2020 2022 2222 0a20  ]:.        """. 
-0001a8b0: 2020 2020 2020 2047 6574 2061 206c 6973         Get a lis
-0001a8c0: 7420 6f66 2074 6865 206e 616d 6573 206f  t of the names o
-0001a8d0: 6620 616c 6c20 7061 7261 6d65 7465 7273  f all parameters
-0001a8e0: 2069 6e20 7468 6520 696e 7075 7420 6669   in the input fi
-0001a8f0: 6c65 2e0a 2020 2020 2020 2020 2222 220a  le..        """.
-0001a900: 2020 2020 2020 2020 7265 7475 726e 206c          return l
-0001a910: 6973 7428 7365 6c66 2e64 6f63 756d 656e  ist(self.documen
-0001a920: 7461 7469 6f6e 5f64 6963 742e 6b65 7973  tation_dict.keys
-0001a930: 2829 290a 0a20 2020 2064 6566 2067 6574  ())..    def get
-0001a940: 5f64 6f63 756d 656e 7461 7469 6f6e 2873  _documentation(s
-0001a950: 656c 662c 2070 6172 616d 6574 6572 3a20  elf, parameter: 
-0001a960: 7374 7220 3d20 4e6f 6e65 2920 2d3e 2064  str = None) -> d
-0001a970: 6963 743a 0a20 2020 2020 2020 2022 2222  ict:.        """
-0001a980: 0a20 2020 2020 2020 2052 6574 7269 6576  .        Retriev
-0001a990: 6520 646f 6375 6d65 6e74 6174 696f 6e20  e documentation 
-0001a9a0: 666f 7220 6120 7061 7261 6d65 7465 722e  for a parameter.
-0001a9b0: 2049 6620 6e6f 2070 6172 616d 6574 6572   If no parameter
-0001a9c0: 2069 7320 7370 6563 6966 6965 642c 0a20   is specified,. 
-0001a9d0: 2020 2020 2020 2072 6574 7572 6e20 646f         return do
-0001a9e0: 6375 6d65 6e74 6174 696f 6e20 666f 7220  cumentation for 
-0001a9f0: 616c 6c20 7061 7261 6d65 7465 7273 2e0a  all parameters..
-0001aa00: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0001aa10: 2020 2020 6966 2070 6172 616d 6574 6572      if parameter
-0001aa20: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-0001aa30: 7475 726e 2073 656c 662e 646f 6375 6d65  turn self.docume
-0001aa40: 6e74 6174 696f 6e5f 6469 6374 2e67 6574  ntation_dict.get
-0001aa50: 2870 6172 616d 6574 6572 2c20 7b7d 290a  (parameter, {}).
-0001aa60: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0001aa70: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0001aa80: 2073 656c 662e 646f 6375 6d65 6e74 6174   self.documentat
-0001aa90: 696f 6e5f 6469 6374 0a0a 2020 2020 6465  ion_dict..    de
-0001aaa0: 6620 7072 696e 745f 646f 6375 6d65 6e74  f print_document
-0001aab0: 6174 696f 6e5f 7461 626c 6528 7365 6c66  ation_table(self
-0001aac0: 2c20 7061 7261 6d65 7465 723a 2073 7472  , parameter: str
-0001aad0: 203d 204e 6f6e 6529 202d 3e20 4e6f 6e65   = None) -> None
-0001aae0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-0001aaf0: 2020 2020 2020 5072 696e 7420 646f 6375        Print docu
-0001ab00: 6d65 6e74 6174 696f 6e20 666f 7220 6120  mentation for a 
-0001ab10: 7061 7261 6d65 7465 722e 2049 6620 6e6f  parameter. If no
-0001ab20: 2070 6172 616d 6574 6572 2069 7320 7370   parameter is sp
-0001ab30: 6563 6966 6965 642c 0a20 2020 2020 2020  ecified,.       
-0001ab40: 2070 7269 6e74 2064 6f63 756d 656e 7461   print documenta
-0001ab50: 7469 6f6e 2066 6f72 2061 6c6c 2070 6172  tion for all par
-0001ab60: 616d 6574 6572 732e 0a20 2020 2020 2020  ameters..       
-0001ab70: 2022 2222 0a20 2020 2020 2020 2069 6620   """.        if 
-0001ab80: 7061 7261 6d65 7465 723a 0a20 2020 2020  parameter:.     
-0001ab90: 2020 2020 2020 2069 6e66 6f20 3d20 7365         info = se
-0001aba0: 6c66 2e67 6574 5f64 6f63 756d 656e 7461  lf.get_documenta
-0001abb0: 7469 6f6e 2870 6172 616d 6574 6572 290a  tion(parameter).
-0001abc0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0001abd0: 2020 2020 2020 2020 2020 696e 666f 203d            info =
-0001abe0: 2073 656c 662e 6765 745f 646f 6375 6d65   self.get_docume
-0001abf0: 6e74 6174 696f 6e28 290a 2020 2020 2020  ntation().      
-0001ac00: 2020 666f 7220 6b65 792c 2076 616c 7565    for key, value
-0001ac10: 2069 6e20 696e 666f 2e69 7465 6d73 2829   in info.items()
-0001ac20: 3a0a 2020 2020 2020 2020 2020 2020 6b65  :.            ke
-0001ac30: 7920 3d20 6b65 792e 7265 706c 6163 6528  y = key.replace(
-0001ac40: 225f 222c 2022 2022 292e 6361 7069 7461  "_", " ").capita
-0001ac50: 6c69 7a65 2829 0a20 2020 2020 2020 2020  lize().         
-0001ac60: 2020 2070 7269 6e74 2866 222d 207b 6b65     print(f"- {ke
-0001ac70: 797d 3a20 7b76 616c 7565 7d22 290a 0a20  y}: {value}").. 
-0001ac80: 2020 2064 6566 2074 6f5f 6469 6374 2873     def to_dict(s
-0001ac90: 656c 662c 2069 6e63 6c75 6465 5f70 7269  elf, include_pri
-0001aca0: 7661 7465 3a20 626f 6f6c 203d 2046 616c  vate: bool = Fal
-0001acb0: 7365 2920 2d3e 2064 6963 743a 0a20 2020  se) -> dict:.   
-0001acc0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0001acd0: 2043 6f6e 7665 7274 2074 6865 206f 626a   Convert the obj
-0001ace0: 6563 7420 746f 2061 2064 6963 7469 6f6e  ect to a diction
-0001acf0: 6172 792c 2065 7863 6c75 6469 6e67 2061  ary, excluding a
-0001ad00: 7474 7269 6275 7465 7320 7468 6174 2073  ttributes that s
-0001ad10: 7461 7274 0a20 2020 2020 2020 2077 6974  tart.        wit
-0001ad20: 6820 616e 2075 6e64 6572 7363 6f72 652e  h an underscore.
-0001ad30: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-0001ad40: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-0001ad50: 2d0a 2020 2020 2020 2020 6469 6374 0a20  -.        dict. 
-0001ad60: 2020 2020 2020 2020 2020 2044 6963 7469             Dicti
-0001ad70: 6f6e 6172 7920 7265 7072 6573 656e 7461  onary representa
-0001ad80: 7469 6f6e 206f 6620 7468 6520 6f62 6a65  tion of the obje
-0001ad90: 6374 2e0a 2020 2020 2020 2020 2222 220a  ct..        """.
-0001ada0: 2020 2020 2020 2020 616c 6c5f 6669 656c          all_fiel
-0001adb0: 6473 203d 2073 656c 662e 6d6f 6465 6c5f  ds = self.model_
-0001adc0: 6475 6d70 280a 2020 2020 2020 2020 2020  dump(.          
-0001add0: 2020 6578 636c 7564 653d 7b22 5f65 7874    exclude={"_ext
-0001ade0: 656e 7369 6f6e 222c 2022 5f66 696c 656e  ension", "_filen
-0001adf0: 616d 6522 2c20 2264 6f63 756d 656e 7461  ame", "documenta
-0001ae00: 7469 6f6e 5f64 6963 7422 7d0a 2020 2020  tion_dict"}.    
-0001ae10: 2020 2020 290a 2020 2020 2020 2020 6966      ).        if
-0001ae20: 2069 6e63 6c75 6465 5f70 7269 7661 7465   include_private
-0001ae30: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-0001ae40: 7475 726e 2061 6c6c 5f66 6965 6c64 730a  turn all_fields.
-0001ae50: 2020 2020 2020 2020 7265 7475 726e 207b          return {
-0001ae60: 0a20 2020 2020 2020 2020 2020 206b 6579  .            key
-0001ae70: 3a20 7661 6c75 6520 666f 7220 6b65 792c  : value for key,
-0001ae80: 2076 616c 7565 2069 6e20 616c 6c5f 6669   value in all_fi
-0001ae90: 656c 6473 2e69 7465 6d73 2829 2069 6620  elds.items() if 
-0001aea0: 6e6f 7420 6b65 792e 7374 6172 7473 7769  not key.startswi
-0001aeb0: 7468 2822 5f22 290a 2020 2020 2020 2020  th("_").        
-0001aec0: 7d0a 0a0a 636c 6173 7320 5769 6e64 5365  }...class WindSe
-0001aed0: 6e73 6f72 4172 7261 7928 4261 7365 4d6f  nsorArray(BaseMo
-0001aee0: 6465 6c29 3a0a 2020 2020 2222 220a 2020  del):.    """.  
-0001aef0: 2020 436c 6173 7320 636f 6e74 6169 6e69    Class containi
-0001af00: 6e67 2061 6c6c 2057 696e 6453 656e 736f  ng all WindSenso
-0001af10: 7220 696e 7075 7420 6669 6c65 7320 616e  r input files an
-0001af20: 6420 7368 6172 6564 2061 7474 7269 6275  d shared attribu
-0001af30: 7465 732e 0a0a 2020 2020 5061 7261 6d65  tes...    Parame
-0001af40: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
-0001af50: 2d2d 2d0a 2020 2020 7469 6d65 5f6e 6f77  ---.    time_now
-0001af60: 203a 2050 6f73 6974 6976 6549 6e74 0a20   : PositiveInt. 
-0001af70: 2020 2020 2020 2057 6865 6e20 7468 6520         When the 
-0001af80: 6669 7265 2069 7320 6967 6e69 7465 6420  fire is ignited 
-0001af90: 696e 2055 6e69 7820 4570 6f63 6820 7469  in Unix Epoch ti
-0001afa0: 6d65 2028 696e 7465 6765 7220 7365 636f  me (integer seco
-0001afb0: 6e64 7320 7369 6e63 650a 2020 2020 2020  nds since.      
-0001afc0: 2020 3139 3730 2f31 2f31 2030 303a 3030    1970/1/1 00:00
-0001afd0: 3a30 3029 2e20 4d75 7374 2062 6520 6772  :00). Must be gr
-0001afe0: 6561 7465 7220 6f72 2065 7175 616c 2074  eater or equal t
-0001aff0: 6f20 7468 6520 7469 6d65 206f 6620 7468  o the time of th
-0001b000: 6520 6669 7273 740a 2020 2020 2020 2020  e first.        
-0001b010: 7769 6e64 0a20 2020 2077 696e 645f 7469  wind.    wind_ti
-0001b020: 6d65 7320 3a20 4e6f 6e4e 6567 6174 6976  mes : NonNegativ
-0001b030: 6546 6c6f 6174 207c 206c 6973 7428 4e6f  eFloat | list(No
-0001b040: 6e4e 6567 6174 6976 6546 6c6f 6174 290a  nNegativeFloat).
-0001b050: 2020 2020 2020 2020 5469 6d65 2069 6e20          Time in 
-0001b060: 7365 636f 6e64 7320 7369 6e63 6520 7468  seconds since th
-0001b070: 6520 7374 6172 7420 6f66 2074 6865 2066  e start of the f
-0001b080: 6972 6520 666f 7220 6561 6368 2077 696e  ire for each win
-0001b090: 6420 7368 6966 742e 0a20 2020 2020 2020  d shift..       
-0001b0a0: 2046 6972 7374 2074 696d 6520 6d75 7374   First time must
-0001b0b0: 2062 6520 7a65 726f 2e0a 2020 2020 7365   be zero..    se
-0001b0c0: 6e73 6f72 5f61 7272 6179 203a 206c 6973  nsor_array : lis
-0001b0d0: 7428 5769 6e64 5365 6e73 6f72 290a 2020  t(WindSensor).  
-0001b0e0: 2020 2020 2020 4c69 7374 206f 6620 616c        List of al
-0001b0f0: 6c20 5769 6e64 5365 6e73 6f72 2069 6e70  l WindSensor inp
-0001b100: 7574 2066 696c 6573 206d 616e 6167 6564  ut files managed
-0001b110: 2062 7920 7468 6520 5769 6e64 5365 6e73   by the WindSens
-0001b120: 6f72 4172 7261 792e 0a0a 2020 2020 2222  orArray...    ""
-0001b130: 220a 0a20 2020 2073 656e 736f 725f 6172  "..    sensor_ar
-0001b140: 7261 793a 204c 6973 745b 5769 6e64 5365  ray: List[WindSe
-0001b150: 6e73 6f72 5d20 3d20 5b5d 0a0a 2020 2020  nsor] = []..    
-0001b160: 4063 6f6d 7075 7465 645f 6669 656c 640a  @computed_field.
-0001b170: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-0001b180: 2020 6465 6620 7769 6e64 5f74 696d 6573    def wind_times
-0001b190: 2873 656c 6629 202d 3e20 6c69 7374 3a0a  (self) -> list:.
-0001b1a0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0001b1b0: 2020 2020 4372 6561 7465 7320 6120 676c      Creates a gl
-0001b1c0: 6f62 616c 2077 696e 6420 7469 6d65 7320  obal wind times 
-0001b1d0: 6c69 7374 2062 7920 636f 6d62 696e 696e  list by combinin
-0001b1e0: 6720 7468 6520 7769 6e64 2074 696d 6573  g the wind times
-0001b1f0: 206c 6973 7473 206f 6620 6561 6368 2073   lists of each s
-0001b200: 656e 736f 722e 0a20 2020 2020 2020 2022  ensor..        "
-0001b210: 2222 0a20 2020 2020 2020 2074 696d 6573  "".        times
-0001b220: 5f6c 6973 7473 203d 205b 5d0a 2020 2020  _lists = [].    
-0001b230: 2020 2020 666f 7220 7365 6e73 6f72 2069      for sensor i
-0001b240: 6e20 7365 6c66 2e73 656e 736f 725f 6172  n self.sensor_ar
-0001b250: 7261 793a 0a20 2020 2020 2020 2020 2020  ray:.           
-0001b260: 2074 696d 6573 5f6c 6973 7473 2e61 7070   times_lists.app
-0001b270: 656e 6428 7365 6e73 6f72 2e77 696e 645f  end(sensor.wind_
-0001b280: 7469 6d65 7329 0a20 2020 2020 2020 2063  times).        c
-0001b290: 6f6d 6269 6e65 645f 7469 6d65 7320 3d20  ombined_times = 
-0001b2a0: 736f 7274 6564 280a 2020 2020 2020 2020  sorted(.        
-0001b2b0: 2020 2020 7365 7428 7661 6c75 6520 666f      set(value fo
-0001b2c0: 7220 7375 626c 6973 7420 696e 2074 696d  r sublist in tim
-0001b2d0: 6573 5f6c 6973 7473 2066 6f72 2076 616c  es_lists for val
-0001b2e0: 7565 2069 6e20 7375 626c 6973 7429 0a20  ue in sublist). 
-0001b2f0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0001b300: 2072 6574 7572 6e20 636f 6d62 696e 6564   return combined
-0001b310: 5f74 696d 6573 0a0a 2020 2020 6465 6620  _times..    def 
-0001b320: 5f5f 6765 7461 7474 725f 5f28 7365 6c66  __getattr__(self
-0001b330: 2c20 6e61 6d65 293a 0a20 2020 2020 2020  , name):.       
-0001b340: 2066 6f72 2073 656e 736f 7220 696e 2073   for sensor in s
-0001b350: 656c 662e 7365 6e73 6f72 5f61 7272 6179  elf.sensor_array
-0001b360: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-0001b370: 206e 616d 6520 3d3d 2073 656e 736f 722e   name == sensor.
-0001b380: 6e61 6d65 3a0a 2020 2020 2020 2020 2020  name:.          
-0001b390: 2020 2020 2020 7265 7475 726e 2073 656e        return sen
-0001b3a0: 736f 720a 2020 2020 2020 2020 7261 6973  sor.        rais
-0001b3b0: 6520 4174 7472 6962 7574 6545 7272 6f72  e AttributeError
-0001b3c0: 2866 2241 7474 7269 6275 7465 207b 6e61  (f"Attribute {na
-0001b3d0: 6d65 7d20 6e6f 7420 666f 756e 6422 290a  me} not found").
-0001b3e0: 0a20 2020 2023 2054 4f44 4f3a 206d 616b  .    # TODO: mak
-0001b3f0: 6520 7375 7265 2077 696e 6420 7365 6e73  e sure wind sens
-0001b400: 6f72 7320 646f 6e27 7420 6765 7420 7075  ors don't get pu
-0001b410: 7420 696e 2074 6865 2073 616d 6520 6c6f  t in the same lo
-0001b420: 6361 7469 6f6e 3f0a 2020 2020 2320 4066  cation?.    # @f
-0001b430: 6965 6c64 5f76 616c 6964 6174 6f72 2822  ield_validator("
-0001b440: 7365 6e73 6f72 5f61 7272 6179 2229 0a20  sensor_array"). 
-0001b450: 2020 2023 2040 636c 6173 736d 6574 686f     # @classmetho
-0001b460: 640a 2020 2020 2320 6465 6620 7661 6c69  d.    # def vali
-0001b470: 6461 7465 5f73 656e 736f 725f 6c6f 6361  date_sensor_loca
-0001b480: 7469 6f6e 2863 6c73 2c20 762c 2076 616c  tion(cls, v, val
-0001b490: 7565 7329 202d 3e20 6c69 7374 3a0a 2020  ues) -> list:.  
-0001b4a0: 2020 2320 2020 2020 7365 6e73 6f72 5f64    #     sensor_d
-0001b4b0: 6963 7420 3d20 7b7d 0a20 2020 2023 2020  ict = {}.    #  
-0001b4c0: 2020 2066 6f72 2073 656e 736f 7220 696e     for sensor in
-0001b4d0: 2076 3a0a 2020 2020 2320 2020 2020 2020   v:.    #       
-0001b4e0: 2020 7365 6e73 6f72 5f64 6963 745b 7365    sensor_dict[se
-0001b4f0: 6e73 6f72 2e6e 616d 655d 203d 205b 0a20  nsor.name] = [. 
-0001b500: 2020 2023 2020 2020 2020 2020 2020 2020     #            
-0001b510: 2073 656e 736f 722e 7365 6e73 6f72 5f68   sensor.sensor_h
-0001b520: 6569 6768 742c 0a20 2020 2023 2020 2020  eight,.    #    
-0001b530: 2020 2020 2020 2020 2073 656e 736f 722e           sensor.
-0001b540: 785f 6c6f 6361 7469 6f6e 2c0a 2020 2020  x_location,.    
-0001b550: 2320 2020 2020 2020 2020 2020 2020 7365  #             se
-0001b560: 6e73 6f72 2e79 5f6c 6f63 6174 696f 6e2c  nsor.y_location,
-0001b570: 0a20 2020 2023 2020 2020 2020 2020 205d  .    #         ]
-0001b580: 0a20 2020 2023 2020 2020 2073 616d 655f  .    #     same_
-0001b590: 7365 7420 3d20 7365 7428 290a 2020 2020  set = set().    
-0001b5a0: 2320 2020 2020 666f 7220 6b65 792c 2076  #     for key, v
-0001b5b0: 616c 2069 6e20 7365 6e73 6f72 5f64 6963  al in sensor_dic
-0001b5c0: 742e 6974 656d 7328 293a 0a20 2020 2023  t.items():.    #
-0001b5d0: 2020 2020 2020 2020 2074 7570 6c65 5f76           tuple_v
-0001b5e0: 616c 203d 2074 7570 6c65 2876 616c 290a  al = tuple(val).
-0001b5f0: 2020 2020 2320 2020 2020 2020 2020 6966      #         if
-0001b600: 2074 7570 6c65 5f76 616c 2069 6e20 7361   tuple_val in sa
-0001b610: 6d65 5f73 6574 3a0a 2020 2020 2320 2020  me_set:.    #   
-0001b620: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0001b630: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
-0001b640: 2320 2020 2020 2020 2020 2020 2020 2020  #               
-0001b650: 2020 2257 696e 6420 7365 6e73 6f72 7320    "Wind sensors 
-0001b660: 6d75 7374 206e 6f74 2062 6520 706c 6163  must not be plac
-0001b670: 6564 2061 7420 7468 6520 7361 6d65 206c  ed at the same l
-0001b680: 6f63 6174 696f 6e20 616e 6420 6865 6967  ocation and heig
-0001b690: 6874 220a 2020 2020 2320 2020 2020 2020  ht".    #       
-0001b6a0: 2020 2020 2020 290a 2020 2020 2320 2020        ).    #   
-0001b6b0: 2020 2020 2020 7361 6d65 5f73 6574 2e61        same_set.a
-0001b6c0: 6464 2874 7570 6c65 5f76 616c 290a 2020  dd(tuple_val).  
-0001b6d0: 2020 2320 2020 2020 7265 7475 726e 2076    #     return v
-0001b6e0: 0a0a 2020 2020 6465 6620 5f66 696e 645f  ..    def _find_
-0001b6f0: 7365 6e73 6f72 5f62 795f 6e61 6d65 2873  sensor_by_name(s
-0001b700: 656c 662c 2073 656e 736f 725f 6e61 6d65  elf, sensor_name
-0001b710: 3a20 7374 7229 202d 3e20 5769 6e64 5365  : str) -> WindSe
-0001b720: 6e73 6f72 207c 204e 6f6e 653a 0a20 2020  nsor | None:.   
-0001b730: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0001b740: 2046 696e 6420 616e 6420 7265 7475 726e   Find and return
-0001b750: 2073 656e 736f 7220 6279 206e 616d 652e   sensor by name.
-0001b760: 2052 6574 7572 6e73 204e 6f6e 6520 6966   Returns None if
-0001b770: 2074 6865 7265 2069 7320 6e6f 206d 6174   there is no mat
-0001b780: 6368 696e 6720 7365 6e73 6f72 206e 616d  ching sensor nam
-0001b790: 652e 0a20 2020 2020 2020 2022 2222 0a20  e..        """. 
-0001b7a0: 2020 2020 2020 2066 6f72 2073 656e 736f         for senso
-0001b7b0: 7220 696e 2073 656c 662e 7365 6e73 6f72  r in self.sensor
-0001b7c0: 5f61 7272 6179 3a0a 2020 2020 2020 2020  _array:.        
-0001b7d0: 2020 2020 6966 2073 656e 736f 722e 6e61      if sensor.na
-0001b7e0: 6d65 203d 3d20 7365 6e73 6f72 5f6e 616d  me == sensor_nam
-0001b7f0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-0001b800: 2020 2072 6574 7572 6e20 7365 6e73 6f72     return sensor
-0001b810: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0001b820: 4e6f 6e65 0a0a 2020 2020 4063 6c61 7373  None..    @class
-0001b830: 6d65 7468 6f64 0a20 2020 2064 6566 2066  method.    def f
-0001b840: 726f 6d5f 6669 6c65 2863 6c73 2c20 6469  rom_file(cls, di
-0001b850: 7265 6374 6f72 793a 2073 7472 207c 2050  rectory: str | P
-0001b860: 6174 6829 3a0a 2020 2020 2020 2020 6966  ath):.        if
-0001b870: 2069 7369 6e73 7461 6e63 6528 6469 7265   isinstance(dire
-0001b880: 6374 6f72 792c 2073 7472 293a 0a20 2020  ctory, str):.   
-0001b890: 2020 2020 2020 2020 2064 6972 6563 746f           directo
-0001b8a0: 7279 203d 2050 6174 6828 6469 7265 6374  ry = Path(direct
-0001b8b0: 6f72 7929 0a20 2020 2020 2020 2073 656e  ory).        sen
-0001b8c0: 736f 725f 6172 7261 7920 3d20 5b5d 0a20  sor_array = []. 
-0001b8d0: 2020 2020 2020 2023 2067 6574 2061 206c         # get a l
-0001b8e0: 6973 7420 6f66 2061 6c6c 2074 6865 2073  ist of all the s
-0001b8f0: 656e 736f 722a 2e69 6e70 2066 696c 6573  ensor*.inp files
-0001b900: 2074 6861 7420 6d61 7463 6820 7468 6520   that match the 
-0001b910: 7265 6775 6c61 7220 6578 7072 6573 7369  regular expressi
-0001b920: 6f6e 0a20 2020 2020 2020 2070 6174 7465  on.        patte
-0001b930: 726e 203d 2072 652e 636f 6d70 696c 6528  rn = re.compile(
-0001b940: 7222 7365 6e73 6f72 5c64 2b5c 2e69 6e70  r"sensor\d+\.inp
-0001b950: 2422 290a 2020 2020 2020 2020 7365 6e73  $").        sens
-0001b960: 6f72 5f6c 6973 7420 3d20 5b0a 2020 2020  or_list = [.    
-0001b970: 2020 2020 2020 2020 6669 6c65 2e73 7465          file.ste
-0001b980: 6d20 666f 7220 6669 6c65 2069 6e20 6469  m for file in di
-0001b990: 7265 6374 6f72 792e 6974 6572 6469 7228  rectory.iterdir(
-0001b9a0: 2920 6966 2070 6174 7465 726e 2e6d 6174  ) if pattern.mat
-0001b9b0: 6368 2866 696c 652e 6e61 6d65 290a 2020  ch(file.name).  
-0001b9c0: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
-0001b9d0: 666f 7220 7365 6e73 6f72 5f6e 616d 6520  for sensor_name 
-0001b9e0: 696e 2073 656e 736f 725f 6c69 7374 3a0a  in sensor_list:.
-0001b9f0: 2020 2020 2020 2020 2020 2020 7365 6e73              sens
-0001ba00: 6f72 203d 2057 696e 6453 656e 736f 722e  or = WindSensor.
-0001ba10: 6672 6f6d 5f66 696c 6528 6469 7265 6374  from_file(direct
-0001ba20: 6f72 792c 2073 656e 736f 725f 6e61 6d65  ory, sensor_name
-0001ba30: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-0001ba40: 6e73 6f72 5f61 7272 6179 2e61 7070 656e  nsor_array.appen
-0001ba50: 6428 7365 6e73 6f72 290a 2020 2020 2020  d(sensor).      
-0001ba60: 2020 7769 6e64 6172 7261 7920 3d20 636c    windarray = cl
-0001ba70: 7328 7365 6e73 6f72 5f61 7272 6179 3d73  s(sensor_array=s
-0001ba80: 656e 736f 725f 6172 7261 7929 0a20 2020  ensor_array).   
-0001ba90: 2020 2020 2072 6574 7572 6e20 7769 6e64       return wind
-0001baa0: 6172 7261 790a 0a20 2020 2040 636c 6173  array..    @clas
-0001bab0: 736d 6574 686f 640a 2020 2020 6465 6620  smethod.    def 
-0001bac0: 6672 6f6d 5f64 6963 7428 636c 732c 2064  from_dict(cls, d
-0001bad0: 6174 613a 2064 6963 7429 3a0a 2020 2020  ata: dict):.    
-0001bae0: 2020 2020 7769 6e64 6172 7261 7920 3d20      windarray = 
-0001baf0: 636c 7328 2a2a 6461 7461 290a 2020 2020  cls(**data).    
-0001bb00: 2020 2020 7265 7475 726e 2077 696e 6461      return winda
-0001bb10: 7272 6179 0a0a 2020 2020 6465 6620 746f  rray..    def to
-0001bb20: 5f64 6963 7428 7365 6c66 2c20 696e 636c  _dict(self, incl
-0001bb30: 7564 655f 7072 6976 6174 653a 2062 6f6f  ude_private: boo
-0001bb40: 6c20 3d20 4661 6c73 6529 3a0a 2020 2020  l = False):.    
-0001bb50: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0001bb60: 436f 6e76 6572 7420 7468 6520 6f62 6a65  Convert the obje
-0001bb70: 6374 2074 6f20 6120 6469 6374 696f 6e61  ct to a dictiona
-0001bb80: 7279 2c20 6578 636c 7564 696e 6720 6174  ry, excluding at
-0001bb90: 7472 6962 7574 6573 2074 6861 7420 7374  tributes that st
-0001bba0: 6172 740a 2020 2020 2020 2020 7769 7468  art.        with
-0001bbb0: 2061 6e20 756e 6465 7273 636f 7265 2e0a   an underscore..
-0001bbc0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-0001bbd0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0001bbe0: 0a20 2020 2020 2020 2064 6963 740a 2020  .        dict.  
-0001bbf0: 2020 2020 2020 2020 2020 4469 6374 696f            Dictio
-0001bc00: 6e61 7279 2072 6570 7265 7365 6e74 6174  nary representat
-0001bc10: 696f 6e20 6f66 2074 6865 206f 626a 6563  ion of the objec
-0001bc20: 742e 0a20 2020 2020 2020 2022 2222 0a20  t..        """. 
-0001bc30: 2020 2020 2020 2061 6c6c 5f66 6965 6c64         all_field
-0001bc40: 7320 3d20 7365 6c66 2e6d 6f64 656c 5f64  s = self.model_d
-0001bc50: 756d 7028 0a20 2020 2020 2020 2020 2020  ump(.           
-0001bc60: 2065 7863 6c75 6465 3d7b 226e 616d 6522   exclude={"name"
-0001bc70: 2c20 225f 6578 7465 6e73 696f 6e22 2c20  , "_extension", 
-0001bc80: 225f 6669 6c65 6e61 6d65 222c 2022 7061  "_filename", "pa
-0001bc90: 7261 6d5f 696e 666f 227d 0a20 2020 2020  ram_info"}.     
-0001bca0: 2020 2029 0a0a 2020 2020 2020 2020 6966     )..        if
-0001bcb0: 2069 6e63 6c75 6465 5f70 7269 7661 7465   include_private
-0001bcc0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-0001bcd0: 7475 726e 2061 6c6c 5f66 6965 6c64 730a  turn all_fields.
-0001bce0: 2020 2020 2020 2020 7265 7475 726e 207b          return {
-0001bcf0: 0a20 2020 2020 2020 2020 2020 206b 6579  .            key
-0001bd00: 3a20 7661 6c75 6520 666f 7220 6b65 792c  : value for key,
-0001bd10: 2076 616c 7565 2069 6e20 616c 6c5f 6669   value in all_fi
-0001bd20: 656c 6473 2e69 7465 6d73 2829 2069 6620  elds.items() if 
-0001bd30: 6e6f 7420 6b65 792e 7374 6172 7473 7769  not key.startswi
-0001bd40: 7468 2822 5f22 290a 2020 2020 2020 2020  th("_").        
-0001bd50: 7d0a 0a20 2020 2064 6566 2074 6f5f 6669  }..    def to_fi
-0001bd60: 6c65 2873 656c 662c 2074 696d 655f 6e6f  le(self, time_no
-0001bd70: 773a 2069 6e74 2c20 6469 7265 6374 6f72  w: int, director
-0001bd80: 793a 2050 6174 6820 7c20 7374 722c 2076  y: Path | str, v
-0001bd90: 6572 7369 6f6e 3a20 7374 7220 3d20 226c  ersion: str = "l
-0001bda0: 6174 6573 7422 293a 0a20 2020 2020 2020  atest"):.       
-0001bdb0: 2069 6620 6973 696e 7374 616e 6365 2864   if isinstance(d
-0001bdc0: 6972 6563 746f 7279 2c20 7374 7229 3a0a  irectory, str):.
-0001bdd0: 2020 2020 2020 2020 2020 2020 6469 7265              dire
-0001bde0: 6374 6f72 7920 3d20 5061 7468 2864 6972  ctory = Path(dir
-0001bdf0: 6563 746f 7279 290a 0a20 2020 2020 2020  ectory)..       
-0001be00: 2066 6f72 2073 656e 736f 7220 696e 2073   for sensor in s
-0001be10: 656c 662e 7365 6e73 6f72 5f61 7272 6179  elf.sensor_array
-0001be20: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-0001be30: 6e73 6f72 2e74 6f5f 6669 6c65 2873 656c  nsor.to_file(sel
-0001be40: 662e 7769 6e64 5f74 696d 6573 2c20 7469  f.wind_times, ti
-0001be50: 6d65 5f6e 6f77 2c20 6469 7265 6374 6f72  me_now, director
-0001be60: 792c 2076 6572 7369 6f6e 290a 0a20 2020  y, version)..   
-0001be70: 2064 6566 2061 6464 5f73 656e 736f 7228   def add_sensor(
-0001be80: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-0001be90: 2020 2020 2020 2077 696e 645f 7370 6565         wind_spee
-0001bea0: 6473 3a20 556e 696f 6e5b 506f 7369 7469  ds: Union[Positi
-0001beb0: 7665 466c 6f61 742c 206c 6973 7428 506f  veFloat, list(Po
-0001bec0: 7369 7469 7665 466c 6f61 7429 5d2c 0a20  sitiveFloat)],. 
-0001bed0: 2020 2020 2020 2077 696e 645f 6469 7265         wind_dire
-0001bee0: 6374 696f 6e73 3a20 556e 696f 6e5b 4e6f  ctions: Union[No
-0001bef0: 6e4e 6567 6174 6976 6549 6e74 2c20 6c69  nNegativeInt, li
-0001bf00: 7374 284e 6f6e 4e65 6761 7469 7665 496e  st(NonNegativeIn
-0001bf10: 7429 5d2c 0a20 2020 2020 2020 2077 696e  t)],.        win
-0001bf20: 645f 7469 6d65 733a 2055 6e69 6f6e 5b4e  d_times: Union[N
-0001bf30: 6f6e 4e65 6761 7469 7665 466c 6f61 742c  onNegativeFloat,
-0001bf40: 206c 6973 7428 4e6f 6e4e 6567 6174 6976   list(NonNegativ
-0001bf50: 6546 6c6f 6174 295d 2c0a 2020 2020 2020  eFloat)],.      
-0001bf60: 2020 7365 6e73 6f72 5f68 6569 6768 743a    sensor_height:
-0001bf70: 2050 6f73 6974 6976 6546 6c6f 6174 2c0a   PositiveFloat,.
-0001bf80: 2020 2020 2020 2020 785f 6c6f 6361 7469          x_locati
-0001bf90: 6f6e 3a20 506f 7369 7469 7665 496e 742c  on: PositiveInt,
-0001bfa0: 0a20 2020 2020 2020 2079 5f6c 6f63 6174  .        y_locat
-0001bfb0: 696f 6e3a 2050 6f73 6974 6976 6549 6e74  ion: PositiveInt
-0001bfc0: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
-0001bfd0: 2022 2222 0a20 2020 2020 2020 2041 6464   """.        Add
-0001bfe0: 2061 2077 696e 6420 7365 6e73 6f72 2074   a wind sensor t
-0001bff0: 6f20 7468 6520 7769 6e64 2073 656e 736f  o the wind senso
-0001c000: 7220 6172 7261 792e 2045 7869 7374 696e  r array. Existin
-0001c010: 6720 7365 6e73 6f72 7320 7769 6c6c 2062  g sensors will b
-0001c020: 6520 756e 6368 616e 6765 642e 0a0a 2020  e unchanged...  
-0001c030: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-0001c040: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0001c050: 2d2d 2d0a 2020 2020 2020 2020 7769 6e64  ---.        wind
-0001c060: 5f73 7065 6564 7320 3a20 506f 7369 7469  _speeds : Positi
-0001c070: 7665 466c 6f61 7420 7c20 6c69 7374 2850  veFloat | list(P
-0001c080: 6f73 6974 6976 6546 6c6f 6174 290a 2020  ositiveFloat).  
-0001c090: 2020 2020 2020 2020 2020 4f70 7469 6f6e            Option
-0001c0a0: 616c 2e20 5570 6461 7465 6420 7769 6e64  al. Updated wind
-0001c0b0: 2073 7065 6564 206f 7220 6c69 7374 206f   speed or list o
-0001c0c0: 6620 7769 6e64 2073 7065 6564 7320 696e  f wind speeds in
-0001c0d0: 206d 2f73 0a20 2020 2020 2020 2077 696e   m/s.        win
-0001c0e0: 645f 6469 7265 6374 696f 6e73 3a20 506f  d_directions: Po
-0001c0f0: 7369 7469 7665 496e 7420 7c20 6c69 7374  sitiveInt | list
-0001c100: 2850 6f73 6974 6976 6549 6e74 290a 2020  (PositiveInt).  
-0001c110: 2020 2020 2020 2020 2020 4f70 7469 6f6e            Option
-0001c120: 616c 2e20 5570 6461 7465 6420 7769 6e64  al. Updated wind
-0001c130: 2064 6972 6563 7469 6f6e 206f 7220 6c69   direction or li
-0001c140: 7374 206f 6620 7769 6e64 2064 6972 6563  st of wind direc
-0001c150: 7469 6f6e 7320 696e 2064 6567 7265 6573  tions in degrees
-0001c160: 2e20 5573 6520 3020 666f 7220 6e6f 7274  . Use 0 for nort
-0001c170: 682e 0a20 2020 2020 2020 2077 696e 645f  h..        wind_
-0001c180: 7469 6d65 7320 3a20 4e6f 6e4e 6567 6174  times : NonNegat
-0001c190: 6976 6549 6e74 207c 206c 6973 7428 4e6f  iveInt | list(No
-0001c1a0: 6e4e 6567 6174 6976 6549 6e74 290a 2020  nNegativeInt).  
-0001c1b0: 2020 2020 2020 2020 2020 4f70 7469 6f6e            Option
-0001c1c0: 616c 2e20 5570 6461 7465 6420 6c69 7374  al. Updated list
-0001c1d0: 206f 6620 7469 6d65 7320 666f 7220 6561   of times for ea
-0001c1e0: 6368 2077 696e 6473 6869 6674 2e20 5573  ch windshift. Us
-0001c1f0: 6520 3020 666f 7220 7369 6e67 6c65 2077  e 0 for single w
-0001c200: 696e 6473 6869 6674 2e20 4669 7273 7420  indshift. First 
-0001c210: 7661 6c75 6520 6d75 7374 2062 6520 302e  value must be 0.
-0001c220: 0a20 2020 2020 2020 2073 656e 736f 725f  .        sensor_
-0001c230: 6865 6967 6874 203a 2050 6f73 6974 6976  height : Positiv
-0001c240: 6546 6c6f 6174 0a20 2020 2020 2020 2020  eFloat.         
-0001c250: 2020 204f 7074 696f 6e61 6c2e 2055 7064     Optional. Upd
-0001c260: 6174 6564 2068 6569 6768 7420 6f66 2074  ated height of t
-0001c270: 6865 2077 696e 6420 7365 6e73 6f72 2069  he wind sensor i
-0001c280: 6e20 6d65 7465 7273 0a20 2020 2020 2020  n meters.       
-0001c290: 2078 5f6c 6f63 6174 696f 6e20 3a20 506f   x_location : Po
-0001c2a0: 7369 7469 7665 496e 740a 2020 2020 2020  sitiveInt.      
-0001c2b0: 2020 2020 2020 4f70 7469 6f6e 616c 2e20        Optional. 
-0001c2c0: 5570 6461 7465 6420 6c6f 6361 7469 6f6e  Updated location
-0001c2d0: 206f 6620 7468 6520 7769 6e64 2073 656e   of the wind sen
-0001c2e0: 736f 7220 696e 2074 6865 2078 2d64 6972  sor in the x-dir
-0001c2f0: 6563 7469 6f6e 2028 6d29 0a20 2020 2020  ection (m).     
-0001c300: 2020 2079 5f6c 6f63 6174 696f 6e20 3a20     y_location : 
-0001c310: 506f 7369 7469 7665 496e 740a 2020 2020  PositiveInt.    
-0001c320: 2020 2020 2020 2020 4f70 7469 6f6e 616c          Optional
-0001c330: 2e20 5570 6461 7465 6420 6c6f 6361 7469  . Updated locati
-0001c340: 6f6e 206f 6620 7468 6520 7769 6e64 2073  on of the wind s
-0001c350: 656e 736f 7220 696e 2074 6865 2079 2d64  ensor in the y-d
-0001c360: 6972 6563 7469 6f6e 2028 6d29 0a20 2020  irection (m).   
-0001c370: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0001c380: 2073 656e 736f 725f 6e75 6d62 6572 203d   sensor_number =
-0001c390: 206c 656e 2873 656c 662e 7365 6e73 6f72   len(self.sensor
-0001c3a0: 5f61 7272 6179 2920 2b20 310a 2020 2020  _array) + 1.    
-0001c3b0: 2020 2020 7365 6e73 6f72 5f6e 616d 6520      sensor_name 
-0001c3c0: 3d20 2222 2e6a 6f69 6e28 5b22 7365 6e73  = "".join(["sens
-0001c3d0: 6f72 222c 2073 7472 2873 656e 736f 725f  or", str(sensor_
-0001c3e0: 6e75 6d62 6572 295d 290a 2020 2020 2020  number)]).      
-0001c3f0: 2020 7365 6e73 6f72 203d 2057 696e 6453    sensor = WindS
-0001c400: 656e 736f 7228 0a20 2020 2020 2020 2020  ensor(.         
-0001c410: 2020 206e 616d 653d 7365 6e73 6f72 5f6e     name=sensor_n
-0001c420: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
-0001c430: 2078 5f6c 6f63 6174 696f 6e3d 785f 6c6f   x_location=x_lo
-0001c440: 6361 7469 6f6e 2c0a 2020 2020 2020 2020  cation,.        
-0001c450: 2020 2020 795f 6c6f 6361 7469 6f6e 3d79      y_location=y
-0001c460: 5f6c 6f63 6174 696f 6e2c 0a20 2020 2020  _location,.     
-0001c470: 2020 2020 2020 2077 696e 645f 7469 6d65         wind_time
-0001c480: 733d 7769 6e64 5f74 696d 6573 2c0a 2020  s=wind_times,.  
-0001c490: 2020 2020 2020 2020 2020 7365 6e73 6f72            sensor
-0001c4a0: 5f68 6569 6768 743d 7365 6e73 6f72 5f68  _height=sensor_h
-0001c4b0: 6569 6768 742c 0a20 2020 2020 2020 2020  eight,.         
-0001c4c0: 2020 2077 696e 645f 7370 6565 6473 3d77     wind_speeds=w
-0001c4d0: 696e 645f 7370 6565 6473 2c0a 2020 2020  ind_speeds,.    
-0001c4e0: 2020 2020 2020 2020 7769 6e64 5f64 6972          wind_dir
-0001c4f0: 6563 7469 6f6e 733d 7769 6e64 5f64 6972  ections=wind_dir
-0001c500: 6563 7469 6f6e 732c 0a20 2020 2020 2020  ections,.       
-0001c510: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
-0001c520: 7365 6e73 6f72 5f61 7272 6179 2e61 7070  sensor_array.app
-0001c530: 656e 6428 7365 6e73 6f72 290a 0a20 2020  end(sensor)..   
-0001c540: 2020 2020 2072 6574 7572 6e20 7365 6e73       return sens
-0001c550: 6f72 0a0a 2020 2020 6465 6620 7570 6461  or..    def upda
-0001c560: 7465 5f73 656e 736f 7228 0a20 2020 2020  te_sensor(.     
-0001c570: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-0001c580: 2073 656e 736f 725f 6e61 6d65 3a20 7374   sensor_name: st
-0001c590: 722c 0a20 2020 2020 2020 2078 5f6c 6f63  r,.        x_loc
-0001c5a0: 6174 696f 6e3a 204f 7074 696f 6e61 6c5b  ation: Optional[
-0001c5b0: 506f 7369 7469 7665 496e 745d 203d 204e  PositiveInt] = N
-0001c5c0: 6f6e 652c 0a20 2020 2020 2020 2079 5f6c  one,.        y_l
-0001c5d0: 6f63 6174 696f 6e3a 204f 7074 696f 6e61  ocation: Optiona
-0001c5e0: 6c5b 506f 7369 7469 7665 496e 745d 203d  l[PositiveInt] =
-0001c5f0: 204e 6f6e 652c 0a20 2020 2020 2020 2077   None,.        w
-0001c600: 696e 645f 7370 6565 6473 3a20 4f70 7469  ind_speeds: Opti
-0001c610: 6f6e 616c 5b55 6e69 6f6e 5b50 6f73 6974  onal[Union[Posit
-0001c620: 6976 6546 6c6f 6174 2c20 6c69 7374 2850  iveFloat, list(P
-0001c630: 6f73 6974 6976 6546 6c6f 6174 295d 5d20  ositiveFloat)]] 
-0001c640: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-0001c650: 7769 6e64 5f64 6972 6563 7469 6f6e 733a  wind_directions:
-0001c660: 204f 7074 696f 6e61 6c5b 556e 696f 6e5b   Optional[Union[
-0001c670: 4e6f 6e4e 6567 6174 6976 6549 6e74 2c20  NonNegativeInt, 
-0001c680: 6c69 7374 284e 6f6e 4e65 6761 7469 7665  list(NonNegative
-0001c690: 496e 7429 5d5d 203d 204e 6f6e 652c 0a20  Int)]] = None,. 
-0001c6a0: 2020 2020 2020 2077 696e 645f 7469 6d65         wind_time
-0001c6b0: 733a 204f 7074 696f 6e61 6c5b 556e 696f  s: Optional[Unio
-0001c6c0: 6e5b 4e6f 6e4e 6567 6174 6976 6549 6e74  n[NonNegativeInt
-0001c6d0: 2c20 6c69 7374 284e 6f6e 4e65 6761 7469  , list(NonNegati
-0001c6e0: 7665 496e 7429 5d5d 203d 204e 6f6e 652c  veInt)]] = None,
-0001c6f0: 0a20 2020 2020 2020 2073 656e 736f 725f  .        sensor_
-0001c700: 6865 6967 6874 3a20 4f70 7469 6f6e 616c  height: Optional
-0001c710: 5b50 6f73 6974 6976 6546 6c6f 6174 5d20  [PositiveFloat] 
-0001c720: 3d20 4e6f 6e65 2c0a 2020 2020 293a 0a20  = None,.    ):. 
-0001c730: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0001c740: 2020 2055 7064 6174 6520 7061 7261 6d65     Update parame
-0001c750: 7465 7273 2066 6f72 2061 2073 696e 676c  ters for a singl
-0001c760: 6520 7769 6e64 2073 656e 736f 722e 2041  e wind sensor. A
-0001c770: 6e79 2070 6172 616d 6574 6572 7320 6e6f  ny parameters no
-0001c780: 7420 7072 6f76 6964 6564 2077 696c 6c0a  t provided will.
-0001c790: 2020 2020 2020 2020 7265 6d61 696e 2075          remain u
-0001c7a0: 6e63 6861 6e67 6564 2e0a 0a20 2020 2020  nchanged...     
-0001c7b0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-0001c7c0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-0001c7d0: 0a20 2020 2020 2020 2075 7064 6174 653a  .        update:
-0001c7e0: 2073 7472 0a20 2020 2020 2020 2020 2020   str.           
-0001c7f0: 204e 616d 6520 6f66 2074 6865 2077 696e   Name of the win
-0001c800: 6420 7365 6e73 6f72 2c20 652e 672e 2022  d sensor, e.g. "
-0001c810: 7365 6e73 6f72 3122 2e20 5365 6e73 6f72  sensor1". Sensor
-0001c820: 206d 7573 7420 616c 7265 6164 7920 6578   must already ex
-0001c830: 6973 7420 696e 2077 696e 6473 656e 736f  ist in windsenso
-0001c840: 7273 2e0a 2020 2020 2020 2020 785f 6c6f  rs..        x_lo
-0001c850: 6361 7469 6f6e 203a 2050 6f73 6974 6976  cation : Positiv
-0001c860: 6549 6e74 0a20 2020 2020 2020 2020 2020  eInt.           
-0001c870: 204f 7074 696f 6e61 6c2e 2055 7064 6174   Optional. Updat
-0001c880: 6564 206c 6f63 6174 696f 6e20 6f66 2074  ed location of t
-0001c890: 6865 2077 696e 6420 7365 6e73 6f72 2069  he wind sensor i
-0001c8a0: 6e20 7468 6520 782d 6469 7265 6374 696f  n the x-directio
-0001c8b0: 6e20 286d 290a 2020 2020 2020 2020 795f  n (m).        y_
-0001c8c0: 6c6f 6361 7469 6f6e 203a 2050 6f73 6974  location : Posit
-0001c8d0: 6976 6549 6e74 0a20 2020 2020 2020 2020  iveInt.         
-0001c8e0: 2020 204f 7074 696f 6e61 6c2e 2055 7064     Optional. Upd
-0001c8f0: 6174 6564 206c 6f63 6174 696f 6e20 6f66  ated location of
-0001c900: 2074 6865 2077 696e 6420 7365 6e73 6f72   the wind sensor
-0001c910: 2069 6e20 7468 6520 792d 6469 7265 6374   in the y-direct
-0001c920: 696f 6e20 286d 290a 2020 2020 2020 2020  ion (m).        
-0001c930: 7769 6e64 5f73 7065 6564 7320 3a20 506f  wind_speeds : Po
-0001c940: 7369 7469 7665 466c 6f61 7420 7c20 6c69  sitiveFloat | li
-0001c950: 7374 2850 6f73 6974 6976 6546 6c6f 6174  st(PositiveFloat
-0001c960: 290a 2020 2020 2020 2020 2020 2020 4f70  ).            Op
-0001c970: 7469 6f6e 616c 2e20 5570 6461 7465 6420  tional. Updated 
-0001c980: 7769 6e64 2073 7065 6564 206f 7220 6c69  wind speed or li
-0001c990: 7374 206f 6620 7769 6e64 2073 7065 6564  st of wind speed
-0001c9a0: 7320 696e 206d 2f73 0a20 2020 2020 2020  s in m/s.       
-0001c9b0: 2077 696e 645f 6469 7265 6374 696f 6e73   wind_directions
-0001c9c0: 3a20 506f 7369 7469 7665 496e 7420 7c20  : PositiveInt | 
-0001c9d0: 6c69 7374 2850 6f73 6974 6976 6549 6e74  list(PositiveInt
-0001c9e0: 290a 2020 2020 2020 2020 2020 2020 4f70  ).            Op
-0001c9f0: 7469 6f6e 616c 2e20 5570 6461 7465 6420  tional. Updated 
-0001ca00: 7769 6e64 2064 6972 6563 7469 6f6e 206f  wind direction o
-0001ca10: 7220 6c69 7374 206f 6620 7769 6e64 2064  r list of wind d
-0001ca20: 6972 6563 7469 6f6e 7320 696e 2064 6567  irections in deg
-0001ca30: 7265 6573 2e20 5573 6520 3020 666f 7220  rees. Use 0 for 
-0001ca40: 6e6f 7274 682e 0a20 2020 2020 2020 2077  north..        w
-0001ca50: 696e 645f 7469 6d65 7320 3a20 4e6f 6e4e  ind_times : NonN
-0001ca60: 6567 6174 6976 6549 6e74 207c 206c 6973  egativeInt | lis
-0001ca70: 7428 4e6f 6e4e 6567 6174 6976 6549 6e74  t(NonNegativeInt
-0001ca80: 290a 2020 2020 2020 2020 2020 2020 4f70  ).            Op
-0001ca90: 7469 6f6e 616c 2e20 5570 6461 7465 6420  tional. Updated 
-0001caa0: 6c69 7374 206f 6620 7469 6d65 7320 666f  list of times fo
-0001cab0: 7220 6561 6368 2077 696e 6473 6869 6674  r each windshift
-0001cac0: 2e20 5573 6520 3020 666f 7220 7369 6e67  . Use 0 for sing
-0001cad0: 6c65 2077 696e 6473 6869 6674 2e20 4669  le windshift. Fi
-0001cae0: 7273 7420 7661 6c75 6520 6d75 7374 2062  rst value must b
-0001caf0: 6520 302e 0a20 2020 2020 2020 2073 656e  e 0..        sen
-0001cb00: 736f 725f 6865 6967 6874 203a 2050 6f73  sor_height : Pos
-0001cb10: 6974 6976 6546 6c6f 6174 0a20 2020 2020  itiveFloat.     
-0001cb20: 2020 2020 2020 204f 7074 696f 6e61 6c2e         Optional.
-0001cb30: 2055 7064 6174 6564 2068 6569 6768 7420   Updated height 
-0001cb40: 6f66 2074 6865 2077 696e 6420 7365 6e73  of the wind sens
-0001cb50: 6f72 2069 6e20 6d65 7465 7273 0a20 2020  or in meters.   
-0001cb60: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0001cb70: 2066 6f72 2061 7267 2069 6e20 5b77 696e   for arg in [win
-0001cb80: 645f 7469 6d65 732c 2077 696e 645f 7370  d_times, wind_sp
-0001cb90: 6565 6473 2c20 7769 6e64 5f64 6972 6563  eeds, wind_direc
-0001cba0: 7469 6f6e 735d 3a0a 2020 2020 2020 2020  tions]:.        
-0001cbb0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-0001cbc0: 6528 6172 672c 2028 666c 6f61 742c 2069  e(arg, (float, i
-0001cbd0: 6e74 2929 3a0a 2020 2020 2020 2020 2020  nt)):.          
-0001cbe0: 2020 2020 2020 6172 6720 3d20 5b61 7267        arg = [arg
-0001cbf0: 5d0a 2020 2020 2020 2020 7570 6461 7465  ].        update
-0001cc00: 7220 3d20 7365 6c66 2e5f 6669 6e64 5f73  r = self._find_s
-0001cc10: 656e 736f 725f 6279 5f6e 616d 6528 7365  ensor_by_name(se
-0001cc20: 6e73 6f72 5f6e 616d 6529 0a20 2020 2020  nsor_name).     
-0001cc30: 2020 2069 6620 6e6f 7420 7570 6461 7465     if not update
-0001cc40: 723a 0a20 2020 2020 2020 2020 2020 2072  r:.            r
-0001cc50: 6169 7365 2041 7474 7269 6275 7465 4572  aise AttributeEr
-0001cc60: 726f 7228 6622 7b73 656e 736f 725f 6e61  ror(f"{sensor_na
-0001cc70: 6d65 7d20 6e6f 7420 666f 756e 6422 290a  me} not found").
-0001cc80: 0a20 2020 2020 2020 2075 7064 6174 6572  .        updater
-0001cc90: 2e77 696e 645f 7469 6d65 7320 3d20 280a  .wind_times = (.
-0001cca0: 2020 2020 2020 2020 2020 2020 7769 6e64              wind
-0001ccb0: 5f74 696d 6573 2069 6620 7769 6e64 5f74  _times if wind_t
-0001ccc0: 696d 6573 2069 7320 6e6f 7420 4e6f 6e65  imes is not None
-0001ccd0: 2065 6c73 6520 7570 6461 7465 722e 7769   else updater.wi
-0001cce0: 6e64 5f74 696d 6573 0a20 2020 2020 2020  nd_times.       
-0001ccf0: 2029 0a20 2020 2020 2020 2075 7064 6174   ).        updat
-0001cd00: 6572 2e77 696e 645f 7370 6565 6473 203d  er.wind_speeds =
-0001cd10: 2028 0a20 2020 2020 2020 2020 2020 2077   (.            w
-0001cd20: 696e 645f 7370 6565 6473 2069 6620 7769  ind_speeds if wi
-0001cd30: 6e64 5f73 7065 6564 7320 6973 206e 6f74  nd_speeds is not
-0001cd40: 204e 6f6e 6520 656c 7365 2075 7064 6174   None else updat
-0001cd50: 6572 2e77 696e 645f 7370 6565 6473 0a20  er.wind_speeds. 
-0001cd60: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0001cd70: 2075 7064 6174 6572 2e77 696e 645f 6469   updater.wind_di
-0001cd80: 7265 6374 696f 6e73 203d 2028 0a20 2020  rections = (.   
-0001cd90: 2020 2020 2020 2020 2077 696e 645f 6469           wind_di
-0001cda0: 7265 6374 696f 6e73 2069 6620 7769 6e64  rections if wind
-0001cdb0: 5f64 6972 6563 7469 6f6e 7320 6973 206e  _directions is n
-0001cdc0: 6f74 204e 6f6e 6520 656c 7365 2075 7064  ot None else upd
-0001cdd0: 6174 6572 2e77 696e 645f 6469 7265 6374  ater.wind_direct
-0001cde0: 696f 6e73 0a20 2020 2020 2020 2029 0a20  ions.        ). 
-0001cdf0: 2020 2020 2020 2075 7064 6174 6572 2e73         updater.s
-0001ce00: 656e 736f 725f 6865 6967 6874 203d 2028  ensor_height = (
-0001ce10: 0a20 2020 2020 2020 2020 2020 2073 656e  .            sen
-0001ce20: 736f 725f 6865 6967 6874 2069 6620 7365  sor_height if se
-0001ce30: 6e73 6f72 5f68 6569 6768 7420 6973 206e  nsor_height is n
-0001ce40: 6f74 204e 6f6e 6520 656c 7365 2075 7064  ot None else upd
-0001ce50: 6174 6572 2e73 656e 736f 725f 6865 6967  ater.sensor_heig
-0001ce60: 6874 0a20 2020 2020 2020 2029 0a20 2020  ht.        ).   
-0001ce70: 2020 2020 2075 7064 6174 6572 2e78 5f6c       updater.x_l
-0001ce80: 6f63 6174 696f 6e20 3d20 280a 2020 2020  ocation = (.    
-0001ce90: 2020 2020 2020 2020 785f 6c6f 6361 7469          x_locati
-0001cea0: 6f6e 2069 6620 785f 6c6f 6361 7469 6f6e  on if x_location
-0001ceb0: 2069 7320 6e6f 7420 4e6f 6e65 2065 6c73   is not None els
-0001cec0: 6520 7570 6461 7465 722e 785f 6c6f 6361  e updater.x_loca
-0001ced0: 7469 6f6e 0a20 2020 2020 2020 2029 0a20  tion.        ). 
-0001cee0: 2020 2020 2020 2075 7064 6174 6572 2e79         updater.y
-0001cef0: 5f6c 6f63 6174 696f 6e20 3d20 280a 2020  _location = (.  
-0001cf00: 2020 2020 2020 2020 2020 795f 6c6f 6361            y_loca
-0001cf10: 7469 6f6e 2069 6620 795f 6c6f 6361 7469  tion if y_locati
-0001cf20: 6f6e 2069 7320 6e6f 7420 4e6f 6e65 2065  on is not None e
-0001cf30: 6c73 6520 7570 6461 7465 722e 795f 6c6f  lse updater.y_lo
-0001cf40: 6361 7469 6f6e 0a20 2020 2020 2020 2029  cation.        )
-0001cf50: 0a0a 0a64 6566 205f 7661 6c69 6461 7465  ...def _validate
-0001cf60: 5f61 6e64 5f72 6574 7572 6e5f 7665 7273  _and_return_vers
-0001cf70: 696f 6e28 7665 7273 696f 6e3a 2073 7472  ion(version: str
-0001cf80: 2920 2d3e 2073 7472 3a0a 2020 2020 6966  ) -> str:.    if
-0001cf90: 2076 6572 7369 6f6e 206e 6f74 2069 6e20   version not in 
-0001cfa0: 2822 6c61 7465 7374 222c 2022 7635 222c  ("latest", "v5",
-0001cfb0: 2022 7636 2229 3a0a 2020 2020 2020 2020   "v6"):.        
-0001cfc0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-0001cfd0: 280a 2020 2020 2020 2020 2020 2020 6622  (.            f"
-0001cfe0: 5665 7273 696f 6e20 7b76 6572 7369 6f6e  Version {version
-0001cff0: 7d20 6973 206e 6f74 2073 7570 706f 7274  } is not support
-0001d000: 6564 2e20 5375 7070 6f72 7465 6420 7665  ed. Supported ve
-0001d010: 7273 696f 6e73 3a20 276c 6174 6573 7427  rsions: 'latest'
-0001d020: 2c20 2776 3527 2c20 2776 3627 220a 2020  , 'v5', 'v6'".  
-0001d030: 2020 2020 2020 290a 2020 2020 7265 7475        ).    retu
-0001d040: 726e 204c 4154 4553 545f 5645 5253 494f  rn LATEST_VERSIO
-0001d050: 4e20 6966 2076 6572 7369 6f6e 203d 3d20  N if version == 
-0001d060: 226c 6174 6573 7422 2065 6c73 6520 7665  "latest" else ve
-0001d070: 7273 696f 6e0a                           rsion.
+000022d0: 3d72 756e 7469 6d65 5f61 6476 616e 6365  =runtime_advance
+000022e0: 645f 7573 6572 5f69 6e70 7574 732c 0a20  d_user_inputs,. 
+000022f0: 2020 2020 2020 2020 2020 2071 755f 6d6f             qu_mo
+00002300: 7669 6e67 636f 6f72 6473 3d71 755f 6d6f  vingcoords=qu_mo
+00002310: 7669 6e67 636f 6f72 6473 2c0a 2020 2020  vingcoords,.    
+00002320: 2020 2020 2020 2020 7170 5f62 7569 6c64          qp_build
+00002330: 6f75 743d 7170 5f62 7569 6c64 6f75 742c  out=qp_buildout,
+00002340: 0a20 2020 2020 2020 2020 2020 2071 755f  .            qu_
+00002350: 6d65 7470 6172 616d 733d 7175 5f6d 6574  metparams=qu_met
+00002360: 7061 7261 6d73 2c0a 2020 2020 2020 2020  params,.        
+00002370: 2020 2020 7175 6963 5f66 6972 653d 7175      quic_fire=qu
+00002380: 6963 5f66 6972 652c 0a20 2020 2020 2020  ic_fire,.       
+00002390: 2020 2020 2067 7269 646c 6973 743d 6772       gridlist=gr
+000023a0: 6964 6c69 7374 2c0a 2020 2020 2020 2020  idlist,.        
+000023b0: 2020 2020 7769 6e64 7365 6e73 6f72 733d      windsensors=
+000023c0: 7769 6e64 7365 6e73 6f72 732c 0a20 2020  windsensors,.   
+000023d0: 2020 2020 2020 2020 2071 755f 746f 706f           qu_topo
+000023e0: 696e 7075 7473 3d71 755f 746f 706f 696e  inputs=qu_topoin
+000023f0: 7075 7473 2c0a 2020 2020 2020 2020 2020  puts,.          
+00002400: 2020 7175 5f73 696d 7061 7261 6d73 3d71    qu_simparams=q
+00002410: 755f 7369 6d70 6172 616d 732c 0a20 2020  u_simparams,.   
+00002420: 2020 2020 2029 0a0a 2020 2020 4063 6c61       )..    @cla
+00002430: 7373 6d65 7468 6f64 0a20 2020 2064 6566  ssmethod.    def
+00002440: 2066 726f 6d5f 6469 7265 6374 6f72 7928   from_directory(
+00002450: 0a20 2020 2020 2020 2063 6c73 2c20 6469  .        cls, di
+00002460: 7265 6374 6f72 793a 2073 7472 207c 2050  rectory: str | P
+00002470: 6174 682c 2076 6572 7369 6f6e 3a20 7374  ath, version: st
+00002480: 7220 3d20 226c 6174 6573 7422 0a20 2020  r = "latest".   
+00002490: 2029 202d 3e20 5369 6d75 6c61 7469 6f6e   ) -> Simulation
+000024a0: 496e 7075 7473 3a0a 2020 2020 2020 2020  Inputs:.        
+000024b0: 2222 220a 2020 2020 2020 2020 496e 6974  """.        Init
+000024c0: 6961 6c69 7a65 7320 6120 5369 6d75 6c61  ializes a Simula
+000024d0: 7469 6f6e 496e 7075 7473 206f 626a 6563  tionInputs objec
+000024e0: 7420 6672 6f6d 2061 2064 6972 6563 746f  t from a directo
+000024f0: 7279 2063 6f6e 7461 696e 696e 6720 610a  ry containing a.
+00002500: 2020 2020 2020 2020 5155 4943 2d46 6972          QUIC-Fir
+00002510: 6520 696e 7075 7420 6669 6c65 2064 6563  e input file dec
+00002520: 6b2e 2054 6865 2066 756e 6374 696f 6e20  k. The function 
+00002530: 6c6f 6f6b 7320 666f 7220 6561 6368 2069  looks for each i
+00002540: 6e70 7574 2066 696c 6520 696e 2074 6865  nput file in the
+00002550: 0a20 2020 2020 2020 2051 5549 432d 4669  .        QUIC-Fi
+00002560: 7265 2069 6e70 7574 2066 696c 6520 6465  re input file de
+00002570: 636b 2c20 7265 6164 7320 696e 2074 6865  ck, reads in the
+00002580: 2066 696c 6520 746f 2061 6e20 6f62 6a65   file to an obje
+00002590: 6374 2c20 616e 6420 636f 6d70 696c 6573  ct, and compiles
+000025a0: 0a20 2020 2020 2020 2074 6865 206f 626a  .        the obj
+000025b0: 6563 7473 2074 6f20 6120 5369 6d75 6c61  ects to a Simula
+000025c0: 7469 6f6e 496e 7075 7473 206f 626a 6563  tionInputs objec
+000025d0: 7420 7468 6174 2072 6570 7265 7365 6e74  t that represent
+000025e0: 7320 7468 6520 636f 6d70 6c65 7465 0a20  s the complete. 
+000025f0: 2020 2020 2020 2073 7461 7465 206f 6620         state of 
+00002600: 7468 6520 5155 4943 2d46 6972 6520 7369  the QUIC-Fire si
+00002610: 6d75 6c61 7469 6f6e 2e0a 0a20 2020 2020  mulation...     
+00002620: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+00002630: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00002640: 0a20 2020 2020 2020 2064 6972 6563 746f  .        directo
+00002650: 7279 3a20 7374 7220 7c20 5061 7468 0a20  ry: str | Path. 
+00002660: 2020 2020 2020 2020 2020 2044 6972 6563             Direc
+00002670: 746f 7279 2063 6f6e 7461 696e 696e 6720  tory containing 
+00002680: 6120 5155 4943 2d46 6972 6520 696e 7075  a QUIC-Fire inpu
+00002690: 7420 6669 6c65 2064 6563 6b2e 0a20 2020  t file deck..   
+000026a0: 2020 2020 2076 6572 7369 6f6e 3a20 7374       version: st
+000026b0: 720a 2020 2020 2020 2020 2020 2020 5155  r.            QU
+000026c0: 4943 2d46 6972 6520 7665 7273 696f 6e20  IC-Fire version 
+000026d0: 6f66 2074 6865 2069 6e70 7574 2066 696c  of the input fil
+000026e0: 6573 2074 6f20 7265 6164 2e20 4375 7272  es to read. Curr
+000026f0: 656e 746c 7920 7375 7070 6f72 7465 640a  ently supported.
+00002700: 2020 2020 2020 2020 2020 2020 7665 7273              vers
+00002710: 696f 6e73 2061 7265 2022 7635 222c 2022  ions are "v5", "
+00002720: 7636 222c 2061 6e64 2022 6c61 7465 7374  v6", and "latest
+00002730: 222e 2044 6566 6175 6c74 2069 7320 226c  ". Default is "l
+00002740: 6174 6573 7422 2e0a 0a20 2020 2020 2020  atest"...       
+00002750: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
+00002760: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
+00002770: 2053 696d 756c 6174 696f 6e49 6e70 7574   SimulationInput
+00002780: 730a 2020 2020 2020 2020 2020 2020 436c  s.            Cl
+00002790: 6173 7320 636f 6e74 6169 6e69 6e67 2074  ass containing t
+000027a0: 6865 2069 6e70 7574 2066 696c 6573 2069  he input files i
+000027b0: 6e20 7468 6520 5155 4943 2d46 6972 6520  n the QUIC-Fire 
+000027c0: 696e 7075 7420 6669 6c65 2064 6563 6b2e  input file deck.
+000027d0: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
+000027e0: 6573 0a20 2020 2020 2020 202d 2d2d 2d2d  es.        -----
+000027f0: 2d2d 2d0a 2020 2020 2020 2020 3e3e 3e20  ---.        >>> 
+00002800: 6672 6f6d 2071 7569 6366 6972 655f 746f  from quicfire_to
+00002810: 6f6c 7320 696d 706f 7274 2053 696d 756c  ols import Simul
+00002820: 6174 696f 6e49 6e70 7574 730a 2020 2020  ationInputs.    
+00002830: 2020 2020 3e3e 3e20 7369 6d75 6c61 7469      >>> simulati
+00002840: 6f6e 5f70 6174 6820 3d20 2270 6174 682f  on_path = "path/
+00002850: 746f 2f73 696d 756c 6174 696f 6e2f 6469  to/simulation/di
+00002860: 7265 6374 6f72 7922 0a20 2020 2020 2020  rectory".       
+00002870: 203e 3e3e 2073 696d 5f69 6e70 7574 7320   >>> sim_inputs 
+00002880: 3d20 5369 6d75 6c61 7469 6f6e 496e 7075  = SimulationInpu
+00002890: 7473 2e66 726f 6d5f 6469 7265 6374 6f72  ts.from_director
+000028a0: 7928 7369 6d75 6c61 7469 6f6e 5f70 6174  y(simulation_pat
+000028b0: 6829 0a20 2020 2020 2020 2022 2222 0a20  h).        """. 
+000028c0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+000028d0: 616e 6365 2864 6972 6563 746f 7279 2c20  ance(directory, 
+000028e0: 7374 7229 3a0a 2020 2020 2020 2020 2020  str):.          
+000028f0: 2020 6469 7265 6374 6f72 7920 3d20 5061    directory = Pa
+00002900: 7468 2864 6972 6563 746f 7279 290a 0a20  th(directory).. 
+00002910: 2020 2020 2020 2076 6572 7369 6f6e 203d         version =
+00002920: 205f 7661 6c69 6461 7465 5f61 6e64 5f72   _validate_and_r
+00002930: 6574 7572 6e5f 7665 7273 696f 6e28 7665  eturn_version(ve
+00002940: 7273 696f 6e29 0a0a 2020 2020 2020 2020  rsion)..        
+00002950: 2320 5265 6164 2074 6865 2072 6571 7569  # Read the requi
+00002960: 7265 6420 696e 7075 7420 6669 6c65 730a  red input files.
+00002970: 2020 2020 2020 2020 7175 5f66 696c 656f          qu_fileo
+00002980: 7074 696f 6e73 203d 2051 555f 4669 6c65  ptions = QU_File
+00002990: 6f70 7469 6f6e 732e 6672 6f6d 5f66 696c  options.from_fil
+000029a0: 6528 6469 7265 6374 6f72 7929 0a20 2020  e(directory).   
+000029b0: 2020 2020 2071 6669 7265 5f61 6476 616e       qfire_advan
+000029c0: 6365 645f 7573 6572 5f69 6e70 7574 7320  ced_user_inputs 
+000029d0: 3d20 5146 6972 655f 4164 7661 6e63 6564  = QFire_Advanced
+000029e0: 5f55 7365 725f 496e 7075 7473 2e66 726f  _User_Inputs.fro
+000029f0: 6d5f 6669 6c65 2864 6972 6563 746f 7279  m_file(directory
+00002a00: 290a 2020 2020 2020 2020 7166 6972 655f  ).        qfire_
+00002a10: 626c 6467 5f61 6476 616e 6365 645f 7573  bldg_advanced_us
+00002a20: 6572 5f69 6e70 7574 7320 3d20 5146 6972  er_inputs = QFir
+00002a30: 655f 426c 6467 5f41 6476 616e 6365 645f  e_Bldg_Advanced_
+00002a40: 5573 6572 5f49 6e70 7574 732e 6672 6f6d  User_Inputs.from
+00002a50: 5f66 696c 6528 0a20 2020 2020 2020 2020  _file(.         
+00002a60: 2020 2064 6972 6563 746f 7279 0a20 2020     directory.   
+00002a70: 2020 2020 2029 0a20 2020 2020 2020 2071       ).        q
+00002a80: 6669 7265 5f70 6c75 6d65 5f61 6476 616e  fire_plume_advan
+00002a90: 6365 645f 7573 6572 5f69 6e70 7574 7320  ced_user_inputs 
+00002aa0: 3d20 5146 6972 655f 506c 756d 655f 4164  = QFire_Plume_Ad
+00002ab0: 7661 6e63 6564 5f55 7365 725f 496e 7075  vanced_User_Inpu
+00002ac0: 7473 2e66 726f 6d5f 6669 6c65 280a 2020  ts.from_file(.  
+00002ad0: 2020 2020 2020 2020 2020 6469 7265 6374            direct
+00002ae0: 6f72 790a 2020 2020 2020 2020 290a 2020  ory.        ).  
+00002af0: 2020 2020 2020 7275 6e74 696d 655f 6164        runtime_ad
+00002b00: 7661 6e63 6564 5f75 7365 725f 696e 7075  vanced_user_inpu
+00002b10: 7473 203d 2052 756e 7469 6d65 4164 7661  ts = RuntimeAdva
+00002b20: 6e63 6564 5573 6572 496e 7075 7473 2e66  ncedUserInputs.f
+00002b30: 726f 6d5f 6669 6c65 2864 6972 6563 746f  rom_file(directo
+00002b40: 7279 290a 2020 2020 2020 2020 7175 5f6d  ry).        qu_m
+00002b50: 6574 7061 7261 6d73 203d 2051 555f 6d65  etparams = QU_me
+00002b60: 7470 6172 616d 732e 6672 6f6d 5f66 696c  tparams.from_fil
+00002b70: 6528 6469 7265 6374 6f72 7929 0a20 2020  e(directory).   
+00002b80: 2020 2020 2071 7569 635f 6669 7265 203d       quic_fire =
+00002b90: 2051 5549 435f 6669 7265 2e66 726f 6d5f   QUIC_fire.from_
+00002ba0: 6669 6c65 2864 6972 6563 746f 7279 2c20  file(directory, 
+00002bb0: 7665 7273 696f 6e3d 7665 7273 696f 6e29  version=version)
+00002bc0: 0a20 2020 2020 2020 2077 696e 6473 656e  .        windsen
+00002bd0: 736f 7273 203d 2057 696e 6453 656e 736f  sors = WindSenso
+00002be0: 7241 7272 6179 2e66 726f 6d5f 6669 6c65  rArray.from_file
+00002bf0: 2864 6972 6563 746f 7279 290a 2020 2020  (directory).    
+00002c00: 2020 2020 7175 5f74 6f70 6f69 6e70 7574      qu_topoinput
+00002c10: 7320 3d20 5155 5f54 6f70 6f49 6e70 7574  s = QU_TopoInput
+00002c20: 732e 6672 6f6d 5f66 696c 6528 6469 7265  s.from_file(dire
+00002c30: 6374 6f72 7929 0a20 2020 2020 2020 2071  ctory).        q
+00002c40: 755f 7369 6d70 6172 616d 7320 3d20 5155  u_simparams = QU
+00002c50: 5f53 696d 7061 7261 6d73 2e66 726f 6d5f  _Simparams.from_
+00002c60: 6669 6c65 2864 6972 6563 746f 7279 290a  file(directory).
+00002c70: 0a20 2020 2020 2020 2023 2054 7279 2061  .        # Try a
+00002c80: 6e64 2072 6561 6420 6f70 7469 6f6e 616c  nd read optional
+00002c90: 2069 6e70 7574 2066 696c 6573 2e20 5265   input files. Re
+00002ca0: 7475 726e 2064 6566 6175 6c74 7320 6966  turn defaults if
+00002cb0: 206e 6f74 2066 6f75 6e64 2e0a 2020 2020   not found..    
+00002cc0: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+00002cd0: 2020 2020 2072 6173 7465 725f 6f72 6967       raster_orig
+00002ce0: 696e 203d 2052 6173 7465 724f 7269 6769  in = RasterOrigi
+00002cf0: 6e2e 6672 6f6d 5f66 696c 6528 6469 7265  n.from_file(dire
+00002d00: 6374 6f72 7929 0a20 2020 2020 2020 2065  ctory).        e
+00002d10: 7863 6570 7420 4669 6c65 4e6f 7446 6f75  xcept FileNotFou
+00002d20: 6e64 4572 726f 723a 0a20 2020 2020 2020  ndError:.       
+00002d30: 2020 2020 2072 6173 7465 725f 6f72 6967       raster_orig
+00002d40: 696e 203d 2052 6173 7465 724f 7269 6769  in = RasterOrigi
+00002d50: 6e28 290a 0a20 2020 2020 2020 2023 2049  n()..        # I
+00002d60: 6e73 7461 6e74 6961 7465 2066 696c 6520  nstantiate file 
+00002d70: 6f62 6a65 6374 7320 7468 6174 2061 7265  objects that are
+00002d80: 2061 6c6c 2064 6566 6175 6c74 2076 616c   all default val
+00002d90: 7565 730a 2020 2020 2020 2020 7175 5f62  ues.        qu_b
+00002da0: 7569 6c64 696e 6773 203d 2051 555f 4275  uildings = QU_Bu
+00002db0: 696c 6469 6e67 7328 290a 2020 2020 2020  ildings().      
+00002dc0: 2020 7170 5f62 7569 6c64 6f75 7420 3d20    qp_buildout = 
+00002dd0: 5150 5f62 7569 6c64 6f75 7428 290a 2020  QP_buildout().  
+00002de0: 2020 2020 2020 7175 5f6d 6f76 696e 6763        qu_movingc
+00002df0: 6f6f 7264 7320 3d20 5155 5f6d 6f76 696e  oords = QU_movin
+00002e00: 6763 6f6f 7264 7328 290a 0a20 2020 2020  gcoords()..     
+00002e10: 2020 2023 2049 6e73 7461 6e74 6961 7465     # Instantiate
+00002e20: 2064 6572 6976 6174 6976 6520 6669 6c65   derivative file
+00002e30: 732e 2045 7665 6e74 7561 6c6c 7920 6765  s. Eventually ge
+00002e40: 7420 7269 6420 6f66 2074 6865 7365 2e2e  t rid of these..
+00002e50: 2e0a 2020 2020 2020 2020 6772 6964 6c69  ..        gridli
+00002e60: 7374 203d 2047 7269 646c 6973 7428 0a20  st = Gridlist(. 
+00002e70: 2020 2020 2020 2020 2020 206e 3d71 755f             n=qu_
+00002e80: 7369 6d70 6172 616d 732e 6e78 2c0a 2020  simparams.nx,.  
+00002e90: 2020 2020 2020 2020 2020 6d3d 7175 5f73            m=qu_s
+00002ea0: 696d 7061 7261 6d73 2e6e 792c 0a20 2020  imparams.ny,.   
+00002eb0: 2020 2020 2020 2020 206c 3d71 7569 635f           l=quic_
+00002ec0: 6669 7265 2e6e 7a2c 0a20 2020 2020 2020  fire.nz,.       
+00002ed0: 2020 2020 2064 783d 7175 5f73 696d 7061       dx=qu_simpa
+00002ee0: 7261 6d73 2e64 782c 0a20 2020 2020 2020  rams.dx,.       
+00002ef0: 2020 2020 2064 793d 7175 5f73 696d 7061       dy=qu_simpa
+00002f00: 7261 6d73 2e64 792c 0a20 2020 2020 2020  rams.dy,.       
+00002f10: 2020 2020 2064 7a3d 7175 6963 5f66 6972       dz=quic_fir
+00002f20: 652e 647a 2c0a 2020 2020 2020 2020 290a  e.dz,.        ).
+00002f30: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00002f40: 636c 7328 0a20 2020 2020 2020 2020 2020  cls(.           
+00002f50: 2072 6173 7465 726f 7269 6769 6e3d 7261   rasterorigin=ra
+00002f60: 7374 6572 5f6f 7269 6769 6e2c 0a20 2020  ster_origin,.   
+00002f70: 2020 2020 2020 2020 2071 755f 6275 696c           qu_buil
+00002f80: 6469 6e67 733d 7175 5f62 7569 6c64 696e  dings=qu_buildin
+00002f90: 6773 2c0a 2020 2020 2020 2020 2020 2020  gs,.            
+00002fa0: 7175 5f66 696c 656f 7074 696f 6e73 3d71  qu_fileoptions=q
+00002fb0: 755f 6669 6c65 6f70 7469 6f6e 732c 0a20  u_fileoptions,. 
+00002fc0: 2020 2020 2020 2020 2020 2071 6669 7265             qfire
+00002fd0: 5f61 6476 616e 6365 645f 7573 6572 5f69  _advanced_user_i
+00002fe0: 6e70 7574 733d 7166 6972 655f 6164 7661  nputs=qfire_adva
+00002ff0: 6e63 6564 5f75 7365 725f 696e 7075 7473  nced_user_inputs
+00003000: 2c0a 2020 2020 2020 2020 2020 2020 7166  ,.            qf
+00003010: 6972 655f 626c 6467 5f61 6476 616e 6365  ire_bldg_advance
+00003020: 645f 7573 6572 5f69 6e70 7574 733d 7166  d_user_inputs=qf
+00003030: 6972 655f 626c 6467 5f61 6476 616e 6365  ire_bldg_advance
+00003040: 645f 7573 6572 5f69 6e70 7574 732c 0a20  d_user_inputs,. 
+00003050: 2020 2020 2020 2020 2020 2071 6669 7265             qfire
+00003060: 5f70 6c75 6d65 5f61 6476 616e 6365 645f  _plume_advanced_
+00003070: 7573 6572 5f69 6e70 7574 733d 7166 6972  user_inputs=qfir
+00003080: 655f 706c 756d 655f 6164 7661 6e63 6564  e_plume_advanced
+00003090: 5f75 7365 725f 696e 7075 7473 2c0a 2020  _user_inputs,.  
+000030a0: 2020 2020 2020 2020 2020 7275 6e74 696d            runtim
+000030b0: 655f 6164 7661 6e63 6564 5f75 7365 725f  e_advanced_user_
+000030c0: 696e 7075 7473 3d72 756e 7469 6d65 5f61  inputs=runtime_a
+000030d0: 6476 616e 6365 645f 7573 6572 5f69 6e70  dvanced_user_inp
+000030e0: 7574 732c 0a20 2020 2020 2020 2020 2020  uts,.           
+000030f0: 2071 755f 6d6f 7669 6e67 636f 6f72 6473   qu_movingcoords
+00003100: 3d71 755f 6d6f 7669 6e67 636f 6f72 6473  =qu_movingcoords
+00003110: 2c0a 2020 2020 2020 2020 2020 2020 7170  ,.            qp
+00003120: 5f62 7569 6c64 6f75 743d 7170 5f62 7569  _buildout=qp_bui
+00003130: 6c64 6f75 742c 0a20 2020 2020 2020 2020  ldout,.         
+00003140: 2020 2071 755f 6d65 7470 6172 616d 733d     qu_metparams=
+00003150: 7175 5f6d 6574 7061 7261 6d73 2c0a 2020  qu_metparams,.  
+00003160: 2020 2020 2020 2020 2020 7175 6963 5f66            quic_f
+00003170: 6972 653d 7175 6963 5f66 6972 652c 0a20  ire=quic_fire,. 
+00003180: 2020 2020 2020 2020 2020 2067 7269 646c             gridl
+00003190: 6973 743d 6772 6964 6c69 7374 2c0a 2020  ist=gridlist,.  
+000031a0: 2020 2020 2020 2020 2020 7769 6e64 7365            windse
+000031b0: 6e73 6f72 733d 7769 6e64 7365 6e73 6f72  nsors=windsensor
+000031c0: 732c 0a20 2020 2020 2020 2020 2020 2071  s,.            q
+000031d0: 755f 746f 706f 696e 7075 7473 3d71 755f  u_topoinputs=qu_
+000031e0: 746f 706f 696e 7075 7473 2c0a 2020 2020  topoinputs,.    
+000031f0: 2020 2020 2020 2020 7175 5f73 696d 7061          qu_simpa
+00003200: 7261 6d73 3d71 755f 7369 6d70 6172 616d  rams=qu_simparam
+00003210: 732c 0a20 2020 2020 2020 2029 0a0a 2020  s,.        )..  
+00003220: 2020 4063 6c61 7373 6d65 7468 6f64 0a20    @classmethod. 
+00003230: 2020 2064 6566 2066 726f 6d5f 6469 6374     def from_dict
+00003240: 2863 6c73 2c20 6461 7461 3a20 6469 6374  (cls, data: dict
+00003250: 2920 2d3e 2053 696d 756c 6174 696f 6e49  ) -> SimulationI
+00003260: 6e70 7574 733a 0a20 2020 2020 2020 2022  nputs:.        "
+00003270: 2222 0a20 2020 2020 2020 2049 6e69 7469  "".        Initi
+00003280: 616c 697a 6573 2061 2053 696d 756c 6174  alizes a Simulat
+00003290: 696f 6e49 6e70 7574 7320 6f62 6a65 6374  ionInputs object
+000032a0: 2066 726f 6d20 6120 6469 6374 696f 6e61   from a dictiona
+000032b0: 7279 2e0a 0a20 2020 2020 2020 2050 6172  ry...        Par
+000032c0: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
+000032d0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+000032e0: 2020 2064 6174 613a 2064 6963 740a 2020     data: dict.  
+000032f0: 2020 2020 2020 2020 2020 4469 6374 696f            Dictio
+00003300: 6e61 7279 2063 6f6e 7461 696e 696e 6720  nary containing 
+00003310: 696e 7075 7420 6669 6c65 2064 6174 612e  input file data.
+00003320: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
+00003330: 6573 0a20 2020 2020 2020 202d 2d2d 2d2d  es.        -----
+00003340: 2d2d 2d0a 2020 2020 2020 2020 3e3e 3e20  ---.        >>> 
+00003350: 6672 6f6d 2071 7569 6366 6972 655f 746f  from quicfire_to
+00003360: 6f6c 7320 696d 706f 7274 2053 696d 756c  ols import Simul
+00003370: 6174 696f 6e49 6e70 7574 730a 2020 2020  ationInputs.    
+00003380: 2020 2020 3e3e 3e20 6a73 6f6e 5f70 6174      >>> json_pat
+00003390: 6820 3d20 2270 6174 682f 746f 2f6a 736f  h = "path/to/jso
+000033a0: 6e2f 6f62 6a65 6374 220a 2020 2020 2020  n/object".      
+000033b0: 2020 3e3e 3e20 7369 6d5f 696e 7075 7473    >>> sim_inputs
+000033c0: 203d 2053 696d 756c 6174 696f 6e49 6e70   = SimulationInp
+000033d0: 7574 732e 6672 6f6d 5f6a 736f 6e28 6a73  uts.from_json(js
+000033e0: 6f6e 5f70 6174 6829 0a20 2020 2020 2020  on_path).       
+000033f0: 203e 3e3e 2073 696d 5f64 6963 7420 3d20   >>> sim_dict = 
+00003400: 7369 6d5f 696e 7075 7473 2e74 6f5f 6469  sim_inputs.to_di
+00003410: 6374 2829 0a20 2020 2020 2020 203e 3e3e  ct().        >>>
+00003420: 206e 6577 5f73 696d 5f69 6e70 7574 7320   new_sim_inputs 
+00003430: 3d20 5369 6d75 6c61 7469 6f6e 496e 7075  = SimulationInpu
+00003440: 7473 2e66 726f 6d5f 6469 6374 2873 696d  ts.from_dict(sim
+00003450: 5f64 6963 7429 0a20 2020 2020 2020 2022  _dict).        "
+00003460: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+00003470: 6e20 636c 7328 0a20 2020 2020 2020 2020  n cls(.         
+00003480: 2020 2072 6173 7465 726f 7269 6769 6e3d     rasterorigin=
+00003490: 5261 7374 6572 4f72 6967 696e 2e66 726f  RasterOrigin.fro
+000034a0: 6d5f 6469 6374 2864 6174 615b 2272 6173  m_dict(data["ras
+000034b0: 7465 726f 7269 6769 6e22 5d29 2c0a 2020  terorigin"]),.  
+000034c0: 2020 2020 2020 2020 2020 7175 5f62 7569            qu_bui
+000034d0: 6c64 696e 6773 3d51 555f 4275 696c 6469  ldings=QU_Buildi
+000034e0: 6e67 732e 6672 6f6d 5f64 6963 7428 6461  ngs.from_dict(da
+000034f0: 7461 5b22 7175 5f62 7569 6c64 696e 6773  ta["qu_buildings
+00003500: 225d 292c 0a20 2020 2020 2020 2020 2020  "]),.           
+00003510: 2071 755f 6669 6c65 6f70 7469 6f6e 733d   qu_fileoptions=
+00003520: 5155 5f46 696c 656f 7074 696f 6e73 2e66  QU_Fileoptions.f
+00003530: 726f 6d5f 6469 6374 2864 6174 615b 2271  rom_dict(data["q
+00003540: 755f 6669 6c65 6f70 7469 6f6e 7322 5d29  u_fileoptions"])
+00003550: 2c0a 2020 2020 2020 2020 2020 2020 7166  ,.            qf
+00003560: 6972 655f 6164 7661 6e63 6564 5f75 7365  ire_advanced_use
+00003570: 725f 696e 7075 7473 3d51 4669 7265 5f41  r_inputs=QFire_A
+00003580: 6476 616e 6365 645f 5573 6572 5f49 6e70  dvanced_User_Inp
+00003590: 7574 732e 6672 6f6d 5f64 6963 7428 0a20  uts.from_dict(. 
+000035a0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+000035b0: 6174 615b 2271 6669 7265 5f61 6476 616e  ata["qfire_advan
+000035c0: 6365 645f 7573 6572 5f69 6e70 7574 7322  ced_user_inputs"
+000035d0: 5d0a 2020 2020 2020 2020 2020 2020 292c  ].            ),
+000035e0: 0a20 2020 2020 2020 2020 2020 2071 6669  .            qfi
+000035f0: 7265 5f62 6c64 675f 6164 7661 6e63 6564  re_bldg_advanced
+00003600: 5f75 7365 725f 696e 7075 7473 3d51 4669  _user_inputs=QFi
+00003610: 7265 5f42 6c64 675f 4164 7661 6e63 6564  re_Bldg_Advanced
+00003620: 5f55 7365 725f 496e 7075 7473 2e66 726f  _User_Inputs.fro
+00003630: 6d5f 6469 6374 280a 2020 2020 2020 2020  m_dict(.        
+00003640: 2020 2020 2020 2020 6461 7461 5b22 7166          data["qf
+00003650: 6972 655f 626c 6467 5f61 6476 616e 6365  ire_bldg_advance
+00003660: 645f 7573 6572 5f69 6e70 7574 7322 5d0a  d_user_inputs"].
+00003670: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
+00003680: 2020 2020 2020 2020 2020 2071 6669 7265             qfire
+00003690: 5f70 6c75 6d65 5f61 6476 616e 6365 645f  _plume_advanced_
+000036a0: 7573 6572 5f69 6e70 7574 733d 5146 6972  user_inputs=QFir
+000036b0: 655f 506c 756d 655f 4164 7661 6e63 6564  e_Plume_Advanced
+000036c0: 5f55 7365 725f 496e 7075 7473 2e66 726f  _User_Inputs.fro
+000036d0: 6d5f 6469 6374 280a 2020 2020 2020 2020  m_dict(.        
+000036e0: 2020 2020 2020 2020 6461 7461 5b22 7166          data["qf
+000036f0: 6972 655f 706c 756d 655f 6164 7661 6e63  ire_plume_advanc
+00003700: 6564 5f75 7365 725f 696e 7075 7473 225d  ed_user_inputs"]
+00003710: 0a20 2020 2020 2020 2020 2020 2029 2c0a  .            ),.
+00003720: 2020 2020 2020 2020 2020 2020 7275 6e74              runt
+00003730: 696d 655f 6164 7661 6e63 6564 5f75 7365  ime_advanced_use
+00003740: 725f 696e 7075 7473 3d52 756e 7469 6d65  r_inputs=Runtime
+00003750: 4164 7661 6e63 6564 5573 6572 496e 7075  AdvancedUserInpu
+00003760: 7473 2e66 726f 6d5f 6469 6374 280a 2020  ts.from_dict(.  
+00003770: 2020 2020 2020 2020 2020 2020 2020 6461                da
+00003780: 7461 5b22 7275 6e74 696d 655f 6164 7661  ta["runtime_adva
+00003790: 6e63 6564 5f75 7365 725f 696e 7075 7473  nced_user_inputs
+000037a0: 225d 0a20 2020 2020 2020 2020 2020 2029  "].            )
+000037b0: 2c0a 2020 2020 2020 2020 2020 2020 7175  ,.            qu
+000037c0: 5f6d 6f76 696e 6763 6f6f 7264 733d 5155  _movingcoords=QU
+000037d0: 5f6d 6f76 696e 6763 6f6f 7264 732e 6672  _movingcoords.fr
+000037e0: 6f6d 5f64 6963 7428 6461 7461 5b22 7175  om_dict(data["qu
+000037f0: 5f6d 6f76 696e 6763 6f6f 7264 7322 5d29  _movingcoords"])
+00003800: 2c0a 2020 2020 2020 2020 2020 2020 7170  ,.            qp
+00003810: 5f62 7569 6c64 6f75 743d 5150 5f62 7569  _buildout=QP_bui
+00003820: 6c64 6f75 742e 6672 6f6d 5f64 6963 7428  ldout.from_dict(
+00003830: 6461 7461 5b22 7170 5f62 7569 6c64 6f75  data["qp_buildou
+00003840: 7422 5d29 2c0a 2020 2020 2020 2020 2020  t"]),.          
+00003850: 2020 7175 5f6d 6574 7061 7261 6d73 3d51    qu_metparams=Q
+00003860: 555f 6d65 7470 6172 616d 732e 6672 6f6d  U_metparams.from
+00003870: 5f64 6963 7428 6461 7461 5b22 7175 5f6d  _dict(data["qu_m
+00003880: 6574 7061 7261 6d73 225d 292c 0a20 2020  etparams"]),.   
+00003890: 2020 2020 2020 2020 2071 7569 635f 6669           quic_fi
+000038a0: 7265 3d51 5549 435f 6669 7265 2e66 726f  re=QUIC_fire.fro
+000038b0: 6d5f 6469 6374 2864 6174 615b 2271 7569  m_dict(data["qui
+000038c0: 635f 6669 7265 225d 292c 0a20 2020 2020  c_fire"]),.     
+000038d0: 2020 2020 2020 2067 7269 646c 6973 743d         gridlist=
+000038e0: 4772 6964 6c69 7374 2e66 726f 6d5f 6469  Gridlist.from_di
+000038f0: 6374 2864 6174 615b 2267 7269 646c 6973  ct(data["gridlis
+00003900: 7422 5d29 2c0a 2020 2020 2020 2020 2020  t"]),.          
+00003910: 2020 7769 6e64 7365 6e73 6f72 733d 5769    windsensors=Wi
+00003920: 6e64 5365 6e73 6f72 4172 7261 792e 6672  ndSensorArray.fr
+00003930: 6f6d 5f64 6963 7428 6461 7461 5b22 7769  om_dict(data["wi
+00003940: 6e64 7365 6e73 6f72 7322 5d29 2c0a 2020  ndsensors"]),.  
+00003950: 2020 2020 2020 2020 2020 7175 5f74 6f70            qu_top
+00003960: 6f69 6e70 7574 733d 5155 5f54 6f70 6f49  oinputs=QU_TopoI
+00003970: 6e70 7574 732e 6672 6f6d 5f64 6963 7428  nputs.from_dict(
+00003980: 6461 7461 5b22 7175 5f74 6f70 6f69 6e70  data["qu_topoinp
+00003990: 7574 7322 5d29 2c0a 2020 2020 2020 2020  uts"]),.        
+000039a0: 2020 2020 7175 5f73 696d 7061 7261 6d73      qu_simparams
+000039b0: 3d51 555f 5369 6d70 6172 616d 732e 6672  =QU_Simparams.fr
+000039c0: 6f6d 5f64 6963 7428 6461 7461 5b22 7175  om_dict(data["qu
+000039d0: 5f73 696d 7061 7261 6d73 225d 292c 0a20  _simparams"]),. 
+000039e0: 2020 2020 2020 2029 0a0a 2020 2020 4063         )..    @c
+000039f0: 6c61 7373 6d65 7468 6f64 0a20 2020 2064  lassmethod.    d
+00003a00: 6566 2066 726f 6d5f 6a73 6f6e 2863 6c73  ef from_json(cls
+00003a10: 2c20 7061 7468 3a20 7374 7220 7c20 5061  , path: str | Pa
+00003a20: 7468 2920 2d3e 2053 696d 756c 6174 696f  th) -> Simulatio
+00003a30: 6e49 6e70 7574 733a 0a20 2020 2020 2020  nInputs:.       
+00003a40: 2022 2222 0a20 2020 2020 2020 2049 6e69   """.        Ini
+00003a50: 7469 616c 697a 6573 2061 2053 696d 756c  tializes a Simul
+00003a60: 6174 696f 6e49 6e70 7574 7320 6f62 6a65  ationInputs obje
+00003a70: 6374 2066 726f 6d20 6120 4a53 4f4e 2066  ct from a JSON f
+00003a80: 696c 652e 0a0a 2020 2020 2020 2020 5061  ile...        Pa
+00003a90: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
+00003aa0: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+00003ab0: 2020 2020 7061 7468 3a20 7374 7220 7c20      path: str | 
+00003ac0: 5061 7468 0a20 2020 2020 2020 2020 2020  Path.           
+00003ad0: 2050 6174 6820 746f 2074 6865 204a 534f   Path to the JSO
+00003ae0: 4e20 6669 6c65 2e0a 0a20 2020 2020 2020  N file...       
+00003af0: 2045 7861 6d70 6c65 730a 2020 2020 2020   Examples.      
+00003b00: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
+00003b10: 2020 203e 3e3e 2066 726f 6d20 7175 6963     >>> from quic
+00003b20: 6669 7265 5f74 6f6f 6c73 2069 6d70 6f72  fire_tools impor
+00003b30: 7420 5369 6d75 6c61 7469 6f6e 496e 7075  t SimulationInpu
+00003b40: 7473 0a20 2020 2020 2020 203e 3e3e 206a  ts.        >>> j
+00003b50: 736f 6e5f 7061 7468 203d 2022 7061 7468  son_path = "path
+00003b60: 2f74 6f2f 6a73 6f6e 2f6f 626a 6563 7422  /to/json/object"
+00003b70: 0a20 2020 2020 2020 203e 3e3e 2073 696d  .        >>> sim
+00003b80: 5f69 6e70 7574 7320 3d20 5369 6d75 6c61  _inputs = Simula
+00003b90: 7469 6f6e 496e 7075 7473 2e66 726f 6d5f  tionInputs.from_
+00003ba0: 6a73 6f6e 286a 736f 6e5f 7061 7468 290a  json(json_path).
+00003bb0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00003bc0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00003bd0: 6528 7061 7468 2c20 7374 7229 3a0a 2020  e(path, str):.  
+00003be0: 2020 2020 2020 2020 2020 7061 7468 203d            path =
+00003bf0: 2050 6174 6828 7061 7468 290a 2020 2020   Path(path).    
+00003c00: 2020 2020 7769 7468 206f 7065 6e28 7061      with open(pa
+00003c10: 7468 2c20 2272 2229 2061 7320 663a 0a20  th, "r") as f:. 
+00003c20: 2020 2020 2020 2020 2020 2064 6174 6120             data 
+00003c30: 3d20 6a73 6f6e 2e6c 6f61 6428 6629 0a20  = json.load(f). 
+00003c40: 2020 2020 2020 2072 6574 7572 6e20 636c         return cl
+00003c50: 732e 6672 6f6d 5f64 6963 7428 6461 7461  s.from_dict(data
+00003c60: 290a 0a20 2020 2064 6566 2077 7269 7465  )..    def write
+00003c70: 5f69 6e70 7574 7328 7365 6c66 2c20 6469  _inputs(self, di
+00003c80: 7265 6374 6f72 793a 2073 7472 207c 2050  rectory: str | P
+00003c90: 6174 682c 2076 6572 7369 6f6e 3a20 7374  ath, version: st
+00003ca0: 7220 3d20 226c 6174 6573 7422 2920 2d3e  r = "latest") ->
+00003cb0: 204e 6f6e 653a 0a20 2020 2020 2020 2022   None:.        "
+00003cc0: 2222 0a20 2020 2020 2020 2057 7269 7465  "".        Write
+00003cd0: 2061 6c6c 2069 6e70 7574 2066 696c 6573   all input files
+00003ce0: 2069 6e20 7468 6520 5369 6d75 6c61 7469   in the Simulati
+00003cf0: 6f6e 496e 7075 7473 206f 626a 6563 7420  onInputs object 
+00003d00: 746f 2061 2073 7065 6369 6669 6564 0a20  to a specified. 
+00003d10: 2020 2020 2020 2064 6972 6563 746f 7279         directory
+00003d20: 2e0a 0a20 2020 2020 2020 2054 6869 7320  ...        This 
+00003d30: 6d65 7468 6f64 2069 7320 6120 636f 7265  method is a core
+00003d40: 206d 6574 686f 6420 6f66 2074 6865 2053   method of the S
+00003d50: 696d 756c 6174 696f 6e49 6e70 7574 7320  imulationInputs 
+00003d60: 636c 6173 732e 2049 740a 2020 2020 2020  class. It.      
+00003d70: 2020 6973 2074 6865 2070 7269 6e63 6970    is the princip
+00003d80: 6c65 2077 6179 2074 6f20 7472 616e 736c  le way to transl
+00003d90: 6174 6520 6120 5369 6d75 6c61 7469 6f6e  ate a Simulation
+00003da0: 496e 7075 7473 206f 626a 6563 7420 696e  Inputs object in
+00003db0: 746f 2061 0a20 2020 2020 2020 2051 5549  to a.        QUI
+00003dc0: 432d 4669 7265 2069 6e70 7574 2066 696c  C-Fire input fil
+00003dd0: 6520 6465 636b 2e0a 0a20 2020 2020 2020  e deck...       
+00003de0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+00003df0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+00003e00: 2020 2020 2020 2064 6972 6563 746f 7279         directory
+00003e10: 3a20 7374 7220 7c20 5061 7468 0a20 2020  : str | Path.   
+00003e20: 2020 2020 2020 2020 2044 6972 6563 746f           Directo
+00003e30: 7279 2074 6f20 7772 6974 6520 7468 6520  ry to write the 
+00003e40: 696e 7075 7420 6669 6c65 7320 746f 2e0a  input files to..
+00003e50: 2020 2020 2020 2020 7665 7273 696f 6e3a          version:
+00003e60: 2073 7472 0a20 2020 2020 2020 2020 2020   str.           
+00003e70: 2056 6572 7369 6f6e 206f 6620 7468 6520   Version of the 
+00003e80: 696e 7075 7420 6669 6c65 7320 746f 2077  input files to w
+00003e90: 7269 7465 2e20 4465 6661 756c 7420 6973  rite. Default is
+00003ea0: 2022 6c61 7465 7374 222e 0a0a 2020 2020   "latest"...    
+00003eb0: 2020 2020 4578 616d 706c 6573 0a20 2020      Examples.   
+00003ec0: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
+00003ed0: 2020 2020 2020 3e3e 3e20 6672 6f6d 2071        >>> from q
+00003ee0: 7569 6366 6972 655f 746f 6f6c 7320 696d  uicfire_tools im
+00003ef0: 706f 7274 2053 696d 756c 6174 696f 6e49  port SimulationI
+00003f00: 6e70 7574 730a 2020 2020 2020 2020 3e3e  nputs.        >>
+00003f10: 3e20 7369 6d5f 696e 7075 7473 203d 2053  > sim_inputs = S
+00003f20: 696d 756c 6174 696f 6e49 6e70 7574 732e  imulationInputs.
+00003f30: 6372 6561 7465 5f73 696d 756c 6174 696f  create_simulatio
+00003f40: 6e28 6e78 3d31 3030 2c20 6e79 3d31 3030  n(nx=100, ny=100
+00003f50: 2c20 6669 7265 5f6e 7a3d 3236 2c20 7769  , fire_nz=26, wi
+00003f60: 6e64 5f73 7065 6564 3d31 2e38 2c20 7769  nd_speed=1.8, wi
+00003f70: 6e64 5f64 6972 6563 7469 6f6e 3d39 302c  nd_direction=90,
+00003f80: 2073 696d 756c 6174 696f 6e5f 7469 6d65   simulation_time
+00003f90: 3d36 3030 290a 2020 2020 2020 2020 3e3e  =600).        >>
+00003fa0: 3e20 7369 6d5f 696e 7075 7473 2e77 7269  > sim_inputs.wri
+00003fb0: 7465 5f69 6e70 7574 7328 2270 6174 682f  te_inputs("path/
+00003fc0: 746f 2f73 696d 756c 6174 696f 6e2f 6469  to/simulation/di
+00003fd0: 7265 6374 6f72 7922 290a 2020 2020 2020  rectory").      
+00003fe0: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
+00003ff0: 2069 7369 6e73 7461 6e63 6528 6469 7265   isinstance(dire
+00004000: 6374 6f72 792c 2073 7472 293a 0a20 2020  ctory, str):.   
+00004010: 2020 2020 2020 2020 2064 6972 6563 746f           directo
+00004020: 7279 203d 2050 6174 6828 6469 7265 6374  ry = Path(direct
+00004030: 6f72 7929 0a0a 2020 2020 2020 2020 6966  ory)..        if
+00004040: 206e 6f74 2064 6972 6563 746f 7279 2e65   not directory.e
+00004050: 7869 7374 7328 293a 0a20 2020 2020 2020  xists():.       
+00004060: 2020 2020 2072 6169 7365 204e 6f74 4144       raise NotAD
+00004070: 6972 6563 746f 7279 4572 726f 7228 6622  irectoryError(f"
+00004080: 7b64 6972 6563 746f 7279 7d20 646f 6573  {directory} does
+00004090: 206e 6f74 2065 7869 7374 2229 0a0a 2020   not exist")..  
+000040a0: 2020 2020 2020 7665 7273 696f 6e20 3d20        version = 
+000040b0: 5f76 616c 6964 6174 655f 616e 645f 7265  _validate_and_re
+000040c0: 7475 726e 5f76 6572 7369 6f6e 2876 6572  turn_version(ver
+000040d0: 7369 6f6e 290a 0a20 2020 2020 2020 2073  sion)..        s
+000040e0: 656c 662e 5f75 7064 6174 655f 7368 6172  elf._update_shar
+000040f0: 6564 5f61 7474 7269 6275 7465 7328 290a  ed_attributes().
+00004100: 0a20 2020 2020 2020 2023 2053 6b69 7020  .        # Skip 
+00004110: 7772 6974 696e 6720 6772 6964 6c69 7374  writing gridlist
+00004120: 2061 6e64 2072 6173 7465 726f 7269 6769   and rasterorigi
+00004130: 6e20 6966 2066 7565 6c5f 666c 6167 203d  n if fuel_flag =
+00004140: 3d20 310a 2020 2020 2020 2020 736b 6970  = 1.        skip
+00004150: 5f69 6e70 7574 7320 3d20 5b5d 0a20 2020  _inputs = [].   
+00004160: 2020 2020 2069 6620 7365 6c66 2e71 7569       if self.qui
+00004170: 635f 6669 7265 2e66 7565 6c5f 6465 6e73  c_fire.fuel_dens
+00004180: 6974 795f 666c 6167 203d 3d20 333a 0a20  ity_flag == 3:. 
+00004190: 2020 2020 2020 2020 2020 2073 6b69 705f             skip_
+000041a0: 696e 7075 7473 2e65 7874 656e 6428 5b22  inputs.extend(["
+000041b0: 6772 6964 6c69 7374 222c 2022 7261 7374  gridlist", "rast
+000041c0: 6572 6f72 6967 696e 225d 290a 0a20 2020  erorigin"])..   
+000041d0: 2020 2020 2023 2057 7269 7465 2065 6163       # Write eac
+000041e0: 6820 696e 7075 7420 6669 6c65 2074 6f20  h input file to 
+000041f0: 7468 6520 6f75 7470 7574 2064 6972 6563  the output direc
+00004200: 746f 7279 0a20 2020 2020 2020 2066 6f72  tory.        for
+00004210: 2069 6e70 7574 5f66 696c 6520 696e 2073   input_file in s
+00004220: 656c 662e 5f69 6e70 7574 5f66 696c 6573  elf._input_files
+00004230: 5f64 6963 742e 7661 6c75 6573 2829 3a0a  _dict.values():.
+00004240: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00004250: 6e70 7574 5f66 696c 6520 213d 2073 656c  nput_file != sel
+00004260: 662e 5f69 6e70 7574 5f66 696c 6573 5f64  f._input_files_d
+00004270: 6963 745b 2277 696e 6473 656e 736f 7273  ict["windsensors
+00004280: 225d 3a0a 2020 2020 2020 2020 2020 2020  "]:.            
+00004290: 2020 2020 696e 7075 745f 6669 6c65 2e74      input_file.t
+000042a0: 6f5f 6669 6c65 2864 6972 6563 746f 7279  o_file(directory
+000042b0: 2c20 7665 7273 696f 6e3d 7665 7273 696f  , version=versio
+000042c0: 6e29 0a20 2020 2020 2020 2020 2020 2065  n).            e
+000042d0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+000042e0: 2020 2020 2069 6e70 7574 5f66 696c 652e       input_file.
+000042f0: 746f 5f66 696c 6528 7365 6c66 2e71 7569  to_file(self.qui
+00004300: 635f 6669 7265 2e74 696d 655f 6e6f 772c  c_fire.time_now,
+00004310: 2064 6972 6563 746f 7279 2c20 7665 7273   directory, vers
+00004320: 696f 6e3d 7665 7273 696f 6e29 0a0a 2020  ion=version)..  
+00004330: 2020 2020 2020 2320 436f 7079 2051 555f        # Copy QU_
+00004340: 6c61 6e64 7573 6520 6672 6f6d 2074 6865  landuse from the
+00004350: 2074 656d 706c 6174 6520 6469 7265 6374   template direct
+00004360: 6f72 7920 746f 2074 6865 206f 7574 7075  ory to the outpu
+00004370: 7420 6469 7265 6374 6f72 790a 2020 2020  t directory.    
+00004380: 2020 2020 7465 6d70 6c61 7465 5f66 696c      template_fil
+00004390: 655f 7061 7468 203d 2054 454d 504c 4154  e_path = TEMPLAT
+000043a0: 4553 5f50 4154 4820 2f20 7665 7273 696f  ES_PATH / versio
+000043b0: 6e20 2f20 2251 555f 6c61 6e64 7573 652e  n / "QU_landuse.
+000043c0: 696e 7022 0a20 2020 2020 2020 206f 7574  inp".        out
+000043d0: 7075 745f 6669 6c65 5f70 6174 6820 3d20  put_file_path = 
+000043e0: 6469 7265 6374 6f72 7920 2f20 2251 555f  directory / "QU_
+000043f0: 6c61 6e64 7573 652e 696e 7022 0a20 2020  landuse.inp".   
+00004400: 2020 2020 2077 6974 6820 6f70 656e 2874       with open(t
+00004410: 656d 706c 6174 655f 6669 6c65 5f70 6174  emplate_file_pat
+00004420: 682c 2022 7262 2229 2061 7320 6674 656d  h, "rb") as ftem
+00004430: 703a 0a20 2020 2020 2020 2020 2020 2077  p:.            w
+00004440: 6974 6820 6f70 656e 286f 7574 7075 745f  ith open(output_
+00004450: 6669 6c65 5f70 6174 682c 2022 7762 2229  file_path, "wb")
+00004460: 2061 7320 666f 7574 3a0a 2020 2020 2020   as fout:.      
+00004470: 2020 2020 2020 2020 2020 666f 7574 2e77            fout.w
+00004480: 7269 7465 2866 7465 6d70 2e72 6561 6428  rite(ftemp.read(
+00004490: 2929 0a0a 2020 2020 6465 6620 746f 5f64  ))..    def to_d
+000044a0: 6963 7428 7365 6c66 2920 2d3e 2064 6963  ict(self) -> dic
+000044b0: 743a 0a20 2020 2020 2020 2022 2222 0a20  t:.        """. 
+000044c0: 2020 2020 2020 2043 6f6e 7665 7274 2074         Convert t
+000044d0: 6865 2073 7461 7465 206f 6620 7468 6520  he state of the 
+000044e0: 5369 6d75 6c61 7469 6f6e 496e 7075 7473  SimulationInputs
+000044f0: 206f 626a 6563 7420 746f 2061 2064 6963   object to a dic
+00004500: 7469 6f6e 6172 792e 0a20 2020 2020 2020  tionary..       
+00004510: 2054 6865 206e 616d 6520 6f66 2065 6163   The name of eac
+00004520: 6820 696e 7075 7420 6669 6c65 2069 6e20  h input file in 
+00004530: 7468 6520 5369 6d75 6c61 7469 6f6e 496e  the SimulationIn
+00004540: 7075 7473 206f 626a 6563 7420 6973 2061  puts object is a
+00004550: 206b 6579 0a20 2020 2020 2020 2074 6f20   key.        to 
+00004560: 7468 6174 2069 6e70 7574 2066 696c 6527  that input file'
+00004570: 7320 6469 6374 696f 6e61 7279 2066 6f72  s dictionary for
+00004580: 6d2e 0a0a 2020 2020 2020 2020 5265 7475  m...        Retu
+00004590: 726e 730a 2020 2020 2020 2020 2d2d 2d2d  rns.        ----
+000045a0: 2d2d 2d0a 2020 2020 2020 2020 6469 6374  ---.        dict
+000045b0: 0a20 2020 2020 2020 2020 2020 2044 6963  .            Dic
+000045c0: 7469 6f6e 6172 7920 7265 7072 6573 656e  tionary represen
+000045d0: 7461 7469 6f6e 206f 6620 7468 6520 6f62  tation of the ob
+000045e0: 6a65 6374 2e0a 0a20 2020 2020 2020 2045  ject...        E
+000045f0: 7861 6d70 6c65 730a 2020 2020 2020 2020  xamples.        
+00004600: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00004610: 203e 3e3e 2066 726f 6d20 7175 6963 6669   >>> from quicfi
+00004620: 7265 5f74 6f6f 6c73 2069 6d70 6f72 7420  re_tools import 
+00004630: 5369 6d75 6c61 7469 6f6e 496e 7075 7473  SimulationInputs
+00004640: 0a20 2020 2020 2020 203e 3e3e 2073 696d  .        >>> sim
+00004650: 5f69 6e70 7574 7320 3d20 5369 6d75 6c61  _inputs = Simula
+00004660: 7469 6f6e 496e 7075 7473 2e63 7265 6174  tionInputs.creat
+00004670: 655f 7369 6d75 6c61 7469 6f6e 286e 783d  e_simulation(nx=
+00004680: 3130 302c 206e 793d 3130 302c 2066 6972  100, ny=100, fir
+00004690: 655f 6e7a 3d32 362c 2077 696e 645f 7370  e_nz=26, wind_sp
+000046a0: 6565 643d 312e 382c 2077 696e 645f 6469  eed=1.8, wind_di
+000046b0: 7265 6374 696f 6e3d 3930 2c20 7369 6d75  rection=90, simu
+000046c0: 6c61 7469 6f6e 5f74 696d 653d 3630 3029  lation_time=600)
+000046d0: 0a20 2020 2020 2020 203e 3e3e 2073 696d  .        >>> sim
+000046e0: 5f64 6963 7420 3d20 7369 6d5f 696e 7075  _dict = sim_inpu
+000046f0: 7473 2e74 6f5f 6469 6374 2829 0a20 2020  ts.to_dict().   
+00004700: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00004710: 2072 6574 7572 6e20 7b6b 6579 3a20 7661   return {key: va
+00004720: 6c75 652e 746f 5f64 6963 7428 2920 666f  lue.to_dict() fo
+00004730: 7220 6b65 792c 2076 616c 7565 2069 6e20  r key, value in 
+00004740: 7365 6c66 2e5f 696e 7075 745f 6669 6c65  self._input_file
+00004750: 735f 6469 6374 2e69 7465 6d73 2829 7d0a  s_dict.items()}.
+00004760: 0a20 2020 2064 6566 2074 6f5f 6a73 6f6e  .    def to_json
+00004770: 2873 656c 662c 2070 6174 683a 2073 7472  (self, path: str
+00004780: 207c 2050 6174 6829 202d 3e20 4e6f 6e65   | Path) -> None
+00004790: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+000047a0: 2020 2020 2020 5772 6974 6520 7468 6520        Write the 
+000047b0: 5369 6d75 6c61 7469 6f6e 496e 7075 7473  SimulationInputs
+000047c0: 206f 626a 6563 7420 746f 2061 204a 534f   object to a JSO
+000047d0: 4e20 6669 6c65 2e0a 0a20 2020 2020 2020  N file...       
+000047e0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+000047f0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+00004800: 2020 2020 2020 2070 6174 6820 3a20 7374         path : st
+00004810: 7220 7c20 5061 7468 0a20 2020 2020 2020  r | Path.       
+00004820: 2020 2020 2050 6174 6820 746f 2077 7269       Path to wri
+00004830: 7465 2074 6865 204a 534f 4e20 6669 6c65  te the JSON file
+00004840: 2074 6f2e 0a0a 2020 2020 2020 2020 4578   to...        Ex
+00004850: 616d 706c 6573 0a20 2020 2020 2020 202d  amples.        -
+00004860: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00004870: 3e3e 3e20 6672 6f6d 2071 7569 6366 6972  >>> from quicfir
+00004880: 655f 746f 6f6c 7320 696d 706f 7274 2053  e_tools import S
+00004890: 696d 756c 6174 696f 6e49 6e70 7574 730a  imulationInputs.
+000048a0: 2020 2020 2020 2020 3e3e 3e20 7369 6d5f          >>> sim_
+000048b0: 696e 7075 7473 203d 2053 696d 756c 6174  inputs = Simulat
+000048c0: 696f 6e49 6e70 7574 732e 6372 6561 7465  ionInputs.create
+000048d0: 5f73 696d 756c 6174 696f 6e28 6e78 3d31  _simulation(nx=1
+000048e0: 3030 2c20 6e79 3d31 3030 2c20 6669 7265  00, ny=100, fire
+000048f0: 5f6e 7a3d 3236 2c20 7769 6e64 5f73 7065  _nz=26, wind_spe
+00004900: 6564 3d31 2e38 2c20 7769 6e64 5f64 6972  ed=1.8, wind_dir
+00004910: 6563 7469 6f6e 3d39 302c 2073 696d 756c  ection=90, simul
+00004920: 6174 696f 6e5f 7469 6d65 3d36 3030 290a  ation_time=600).
+00004930: 2020 2020 2020 2020 3e3e 3e20 7369 6d5f          >>> sim_
+00004940: 696e 7075 7473 2e74 6f5f 6a73 6f6e 2822  inputs.to_json("
+00004950: 7061 7468 2f74 6f2f 6a73 6f6e 2f6f 626a  path/to/json/obj
+00004960: 6563 7422 290a 2020 2020 2020 2020 2222  ect").        ""
+00004970: 220a 2020 2020 2020 2020 6966 2069 7369  ".        if isi
+00004980: 6e73 7461 6e63 6528 7061 7468 2c20 7374  nstance(path, st
+00004990: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
+000049a0: 7061 7468 203d 2050 6174 6828 7061 7468  path = Path(path
+000049b0: 290a 2020 2020 2020 2020 7769 7468 206f  ).        with o
+000049c0: 7065 6e28 7061 7468 2c20 2277 2229 2061  pen(path, "w") a
+000049d0: 7320 663a 0a20 2020 2020 2020 2020 2020  s f:.           
+000049e0: 206a 736f 6e2e 6475 6d70 2873 656c 662e   json.dump(self.
+000049f0: 746f 5f64 6963 7428 292c 2066 2c20 696e  to_dict(), f, in
+00004a00: 6465 6e74 3d34 290a 0a20 2020 2064 6566  dent=4)..    def
+00004a10: 2073 6574 5f63 7573 746f 6d5f 7369 6d75   set_custom_simu
+00004a20: 6c61 7469 6f6e 280a 2020 2020 2020 2020  lation(.        
+00004a30: 7365 6c66 2c0a 2020 2020 2020 2020 6675  self,.        fu
+00004a40: 656c 5f64 656e 7369 7479 3a20 626f 6f6c  el_density: bool
+00004a50: 203d 2054 7275 652c 0a20 2020 2020 2020   = True,.       
+00004a60: 2066 7565 6c5f 6d6f 6973 7475 7265 3a20   fuel_moisture: 
+00004a70: 626f 6f6c 203d 2054 7275 652c 0a20 2020  bool = True,.   
+00004a80: 2020 2020 2066 7565 6c5f 6865 6967 6874       fuel_height
+00004a90: 3a20 626f 6f6c 203d 2054 7275 652c 0a20  : bool = True,. 
+00004aa0: 2020 2020 2020 2073 697a 655f 7363 616c         size_scal
+00004ab0: 653a 2062 6f6f 6c20 3d20 4661 6c73 652c  e: bool = False,
+00004ac0: 0a20 2020 2020 2020 2070 6174 6368 5f61  .        patch_a
+00004ad0: 6e64 5f67 6170 3a20 626f 6f6c 203d 2046  nd_gap: bool = F
+00004ae0: 616c 7365 2c0a 2020 2020 2020 2020 6967  alse,.        ig
+00004af0: 6e69 7469 6f6e 3a20 626f 6f6c 203d 2054  nition: bool = T
+00004b00: 7275 652c 0a20 2020 2020 2020 2074 6f70  rue,.        top
+00004b10: 6f3a 2062 6f6f 6c20 3d20 5472 7565 2c0a  o: bool = True,.
+00004b20: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
+00004b30: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00004b40: 2020 2053 6574 7320 7468 6520 7369 6d75     Sets the simu
+00004b50: 6c61 7469 6f6e 2074 6f20 7573 6520 6375  lation to use cu
+00004b60: 7374 6f6d 2066 7565 6c2c 2069 676e 6974  stom fuel, ignit
+00004b70: 696f 6e2c 2061 6e64 2074 6f70 6f67 7261  ion, and topogra
+00004b80: 7068 790a 2020 2020 2020 2020 7365 7474  phy.        sett
+00004b90: 696e 6773 2e0a 0a20 2020 2020 2020 2054  ings...        T
+00004ba0: 6869 7320 6675 6e63 7469 6f6e 2063 616e  his function can
+00004bb0: 2062 6520 7573 6566 756c 2066 6f72 2073   be useful for s
+00004bc0: 6574 7469 6e67 2075 7020 7369 6d75 6c61  etting up simula
+00004bd0: 7469 6f6e 7320 7468 6174 2075 7365 202e  tions that use .
+00004be0: 6461 740a 2020 2020 2020 2020 6669 6c65  dat.        file
+00004bf0: 7320 746f 2064 6566 696e 6520 6375 7374  s to define cust
+00004c00: 6f6d 2066 7565 6c2c 2074 6f70 6f67 7261  om fuel, topogra
+00004c10: 7068 792c 206f 7220 6967 6e69 7469 6f6e  phy, or ignition
+00004c20: 2069 6e70 7574 732e 0a0a 2020 2020 2020   inputs...      
+00004c30: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+00004c40: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
+00004c50: 2020 2020 2020 2020 6675 656c 5f64 656e          fuel_den
+00004c60: 7369 7479 3a20 626f 6f6c 2c20 6f70 7469  sity: bool, opti
+00004c70: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
+00004c80: 2049 6620 5472 7565 2c20 7365 7473 2074   If True, sets t
+00004c90: 6865 2073 696d 756c 6174 696f 6e20 746f  he simulation to
+00004ca0: 2075 7365 2066 7565 6c20 6465 6e73 6974   use fuel densit
+00004cb0: 7920 696e 666f 726d 6174 696f 6e20 6672  y information fr
+00004cc0: 6f6d 0a20 2020 2020 2020 2020 2020 2061  om.            a
+00004cd0: 2074 7265 6573 7268 6f66 2e64 6174 2066   treesrhof.dat f
+00004ce0: 696c 6520 2866 7565 6c20 6465 6e73 6974  ile (fuel densit
+00004cf0: 7920 666c 6167 2033 292e 2044 6566 6175  y flag 3). Defau
+00004d00: 6c74 2069 7320 5472 7565 2e0a 2020 2020  lt is True..    
+00004d10: 2020 2020 6675 656c 5f6d 6f69 7374 7572      fuel_moistur
+00004d20: 653a 2062 6f6f 6c2c 206f 7074 696f 6e61  e: bool, optiona
+00004d30: 6c0a 2020 2020 2020 2020 2020 2020 4966  l.            If
+00004d40: 2054 7275 652c 2073 6574 7320 7468 6520   True, sets the 
+00004d50: 7369 6d75 6c61 7469 6f6e 2074 6f20 7573  simulation to us
+00004d60: 6520 6675 656c 206d 6f69 7374 7572 6520  e fuel moisture 
+00004d70: 696e 666f 726d 6174 696f 6e20 6672 6f6d  information from
+00004d80: 0a20 2020 2020 2020 2020 2020 2061 2074  .            a t
+00004d90: 7265 6573 6d6f 6973 742e 6461 7420 6669  reesmoist.dat fi
+00004da0: 6c65 2028 6675 656c 206d 6f69 7374 7572  le (fuel moistur
+00004db0: 6520 666c 6167 2033 292e 2044 6566 6175  e flag 3). Defau
+00004dc0: 6c74 2069 7320 5472 7565 2e0a 2020 2020  lt is True..    
+00004dd0: 2020 2020 6675 656c 5f68 6569 6768 743a      fuel_height:
+00004de0: 2062 6f6f 6c2c 206f 7074 696f 6e61 6c0a   bool, optional.
+00004df0: 2020 2020 2020 2020 2020 2020 4966 2054              If T
+00004e00: 7275 652c 2073 6574 7320 7468 6520 7369  rue, sets the si
+00004e10: 6d75 6c61 7469 6f6e 2074 6f20 7573 6520  mulation to use 
+00004e20: 6675 656c 2068 6569 6768 7420 696e 666f  fuel height info
+00004e30: 726d 6174 696f 6e20 6672 6f6d 0a20 2020  rmation from.   
+00004e40: 2020 2020 2020 2020 2061 2074 7265 6573           a trees
+00004e50: 6465 7074 682e 6461 7420 6669 6c65 2028  depth.dat file (
+00004e60: 6675 656c 2068 6569 6768 7420 666c 6167  fuel height flag
+00004e70: 2033 292e 2044 6566 6175 6c74 2069 7320   3). Default is 
+00004e80: 5472 7565 2e0a 2020 2020 2020 2020 7369  True..        si
+00004e90: 7a65 5f73 6361 6c65 3a20 626f 6f6c 2c20  ze_scale: bool, 
+00004ea0: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+00004eb0: 2020 2020 2049 6620 5472 7565 2c20 7365       If True, se
+00004ec0: 7473 2074 6865 2073 696d 756c 6174 696f  ts the simulatio
+00004ed0: 6e20 746f 2075 7365 2073 697a 6520 7363  n to use size sc
+00004ee0: 616c 6520 696e 666f 726d 6174 696f 6e20  ale information 
+00004ef0: 6672 6f6d 0a20 2020 2020 2020 2020 2020  from.           
+00004f00: 2061 2074 7265 6573 7373 2e64 6174 2066   a treesss.dat f
+00004f10: 696c 6520 2873 697a 6520 7363 616c 6520  ile (size scale 
+00004f20: 666c 6167 2033 292e 2044 6566 6175 6c74  flag 3). Default
+00004f30: 7320 746f 2046 616c 7365 2061 7320 7468  s to False as th
+00004f40: 6973 0a20 2020 2020 2020 2020 2020 2069  is.            i
+00004f50: 7320 6120 6e65 7720 6665 6174 7572 652e  s a new feature.
+00004f60: 0a20 2020 2020 2020 2070 6174 6368 5f61  .        patch_a
+00004f70: 6e64 5f67 6170 3a20 626f 6f6c 2c20 6f70  nd_gap: bool, op
+00004f80: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
+00004f90: 2020 2049 6620 5472 7565 2c20 7365 7473     If True, sets
+00004fa0: 2074 6865 2073 696d 756c 6174 696f 6e20   the simulation 
+00004fb0: 746f 2075 7365 2070 6174 6368 2061 6e64  to use patch and
+00004fc0: 2067 6170 2069 6e66 6f72 6d61 7469 6f6e   gap information
+00004fd0: 2066 726f 6d0a 2020 2020 2020 2020 2020   from.          
+00004fe0: 2020 7061 7463 682e 6461 7420 616e 6420    patch.dat and 
+00004ff0: 6761 702e 6461 7420 6669 6c65 7320 2870  gap.dat files (p
+00005000: 6174 6368 2061 6e64 2067 6170 2066 6c61  atch and gap fla
+00005010: 6720 3229 2e20 4465 6661 756c 7473 2074  g 2). Defaults t
+00005020: 6f0a 2020 2020 2020 2020 2020 2020 4661  o.            Fa
+00005030: 6c73 6520 6173 2074 6869 7320 6973 2061  lse as this is a
+00005040: 206e 6577 2066 6561 7475 7265 2e0a 2020   new feature..  
+00005050: 2020 2020 2020 6967 6e69 7469 6f6e 203a        ignition :
+00005060: 2062 6f6f 6c2c 206f 7074 696f 6e61 6c0a   bool, optional.
+00005070: 2020 2020 2020 2020 2020 2020 4966 2054              If T
+00005080: 7275 652c 2073 6574 7320 7468 6520 7369  rue, sets the si
+00005090: 6d75 6c61 7469 6f6e 2074 6f20 7573 6520  mulation to use 
+000050a0: 6120 6375 7374 6f6d 2069 676e 6974 696f  a custom ignitio
+000050b0: 6e20 736f 7572 6365 0a20 2020 2020 2020  n source.       
+000050c0: 2020 2020 2028 6967 6e69 7469 6f6e 2066       (ignition f
+000050d0: 6c61 6720 3629 2e20 4465 6661 756c 7420  lag 6). Default 
+000050e0: 6973 2054 7275 652e 0a20 2020 2020 2020  is True..       
+000050f0: 2074 6f70 6f20 3a20 626f 6f6c 2c20 6f70   topo : bool, op
+00005100: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
+00005110: 2020 2049 6620 5472 7565 2c20 7365 7473     If True, sets
+00005120: 2074 6865 2073 696d 756c 6174 696f 6e20   the simulation 
+00005130: 746f 2075 7365 2063 7573 746f 6d20 746f  to use custom to
+00005140: 706f 6772 6170 6879 2073 6574 7469 6e67  pography setting
+00005150: 730a 2020 2020 2020 2020 2020 2020 2874  s.            (t
+00005160: 6f70 6f67 7261 7068 7920 666c 6167 2035  opography flag 5
+00005170: 292e 2044 6566 6175 6c74 2069 7320 5472  ). Default is Tr
+00005180: 7565 2e0a 0a20 2020 2020 2020 2045 7861  ue...        Exa
+00005190: 6d70 6c65 730a 2020 2020 2020 2020 2d2d  mples.        --
+000051a0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203e  ------.        >
+000051b0: 3e3e 2066 726f 6d20 7175 6963 6669 7265  >> from quicfire
+000051c0: 5f74 6f6f 6c73 2069 6d70 6f72 7420 5369  _tools import Si
+000051d0: 6d75 6c61 7469 6f6e 496e 7075 7473 0a20  mulationInputs. 
+000051e0: 2020 2020 2020 203e 3e3e 2073 696d 5f69         >>> sim_i
+000051f0: 6e70 7574 7320 3d20 5369 6d75 6c61 7469  nputs = Simulati
+00005200: 6f6e 496e 7075 7473 2e63 7265 6174 655f  onInputs.create_
+00005210: 7369 6d75 6c61 7469 6f6e 286e 783d 3130  simulation(nx=10
+00005220: 302c 206e 793d 3130 302c 2066 6972 655f  0, ny=100, fire_
+00005230: 6e7a 3d32 362c 2077 696e 645f 7370 6565  nz=26, wind_spee
+00005240: 643d 312e 382c 2077 696e 645f 6469 7265  d=1.8, wind_dire
+00005250: 6374 696f 6e3d 3930 2c20 7369 6d75 6c61  ction=90, simula
+00005260: 7469 6f6e 5f74 696d 653d 3630 3029 0a20  tion_time=600). 
+00005270: 2020 2020 2020 203e 3e3e 2073 696d 5f69         >>> sim_i
+00005280: 6e70 7574 732e 7365 745f 6375 7374 6f6d  nputs.set_custom
+00005290: 5f73 696d 756c 6174 696f 6e28 6675 656c  _simulation(fuel
+000052a0: 3d54 7275 652c 2069 676e 6974 696f 6e3d  =True, ignition=
+000052b0: 5472 7565 2c20 746f 706f 3d54 7275 6529  True, topo=True)
+000052c0: 0a20 2020 2020 2020 203e 3e3e 2073 696d  .        >>> sim
+000052d0: 5f69 6e70 7574 732e 7175 6963 5f66 6972  _inputs.quic_fir
+000052e0: 652e 6675 656c 5f66 6c61 670a 2020 2020  e.fuel_flag.    
+000052f0: 2020 2020 330a 2020 2020 2020 2020 2222      3.        ""
+00005300: 220a 2020 2020 2020 2020 6966 2066 7565  ".        if fue
+00005310: 6c5f 6465 6e73 6974 793a 0a20 2020 2020  l_density:.     
+00005320: 2020 2020 2020 2073 656c 662e 7175 6963         self.quic
+00005330: 5f66 6972 652e 6675 656c 5f64 656e 7369  _fire.fuel_densi
+00005340: 7479 5f66 6c61 6720 3d20 330a 2020 2020  ty_flag = 3.    
+00005350: 2020 2020 6966 2066 7565 6c5f 6d6f 6973      if fuel_mois
+00005360: 7475 7265 3a0a 2020 2020 2020 2020 2020  ture:.          
+00005370: 2020 7365 6c66 2e71 7569 635f 6669 7265    self.quic_fire
+00005380: 2e66 7565 6c5f 6d6f 6973 7475 7265 5f66  .fuel_moisture_f
+00005390: 6c61 6720 3d20 330a 2020 2020 2020 2020  lag = 3.        
+000053a0: 6966 2066 7565 6c5f 6865 6967 6874 3a0a  if fuel_height:.
+000053b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000053c0: 2e71 7569 635f 6669 7265 2e66 7565 6c5f  .quic_fire.fuel_
+000053d0: 6865 6967 6874 5f66 6c61 6720 3d20 330a  height_flag = 3.
+000053e0: 2020 2020 2020 2020 6966 2073 697a 655f          if size_
+000053f0: 7363 616c 653a 0a20 2020 2020 2020 2020  scale:.         
+00005400: 2020 2073 656c 662e 7175 6963 5f66 6972     self.quic_fir
+00005410: 652e 7369 7a65 5f73 6361 6c65 5f66 6c61  e.size_scale_fla
+00005420: 6720 3d20 330a 2020 2020 2020 2020 6966  g = 3.        if
+00005430: 2070 6174 6368 5f61 6e64 5f67 6170 3a0a   patch_and_gap:.
+00005440: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00005450: 2e71 7569 635f 6669 7265 2e70 6174 6368  .quic_fire.patch
+00005460: 5f61 6e64 5f67 6170 5f66 6c61 6720 3d20  _and_gap_flag = 
+00005470: 320a 2020 2020 2020 2020 6966 2069 676e  2.        if ign
+00005480: 6974 696f 6e3a 0a20 2020 2020 2020 2020  ition:.         
+00005490: 2020 2073 656c 662e 7175 6963 5f66 6972     self.quic_fir
+000054a0: 652e 6967 6e69 7469 6f6e 203d 2049 676e  e.ignition = Ign
+000054b0: 6974 696f 6e28 6967 6e69 7469 6f6e 5f66  ition(ignition_f
+000054c0: 6c61 673d 4967 6e69 7469 6f6e 466c 6167  lag=IgnitionFlag
+000054d0: 7328 3729 290a 2020 2020 2020 2020 6966  s(7)).        if
+000054e0: 2074 6f70 6f3a 0a20 2020 2020 2020 2020   topo:.         
+000054f0: 2020 2073 656c 662e 7175 5f74 6f70 6f69     self.qu_topoi
+00005500: 6e70 7574 732e 746f 706f 6772 6170 6879  nputs.topography
+00005510: 203d 2054 6f70 6f67 7261 7068 7928 746f   = Topography(to
+00005520: 706f 5f66 6c61 673d 546f 706f 466c 6167  po_flag=TopoFlag
+00005530: 7328 3529 290a 0a20 2020 2064 6566 2073  s(5))..    def s
+00005540: 6574 5f75 6e69 666f 726d 5f66 7565 6c73  et_uniform_fuels
+00005550: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+00005560: 2020 2020 2020 2020 6675 656c 5f64 656e          fuel_den
+00005570: 7369 7479 3a20 666c 6f61 742c 0a20 2020  sity: float,.   
+00005580: 2020 2020 2066 7565 6c5f 6d6f 6973 7475       fuel_moistu
+00005590: 7265 3a20 666c 6f61 742c 0a20 2020 2020  re: float,.     
+000055a0: 2020 2066 7565 6c5f 6865 6967 6874 3a20     fuel_height: 
+000055b0: 666c 6f61 742c 0a20 2020 2020 2020 2073  float,.        s
+000055c0: 697a 655f 7363 616c 653a 2066 6c6f 6174  ize_scale: float
+000055d0: 203d 2030 2e30 3030 352c 0a20 2020 2020   = 0.0005,.     
+000055e0: 2020 2070 6174 6368 5f73 697a 653a 2066     patch_size: f
+000055f0: 6c6f 6174 203d 2030 2e30 2c0a 2020 2020  loat = 0.0,.    
+00005600: 2020 2020 6761 705f 7369 7a65 3a20 666c      gap_size: fl
+00005610: 6f61 7420 3d20 302e 302c 0a20 2020 2029  oat = 0.0,.    )
+00005620: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+00005630: 2020 2222 220a 2020 2020 2020 2020 5365    """.        Se
+00005640: 7473 2074 6865 2073 696d 756c 6174 696f  ts the simulatio
+00005650: 6e20 746f 2075 7365 2075 6e69 666f 726d  n to use uniform
+00005660: 2066 7565 6c20 7365 7474 696e 6773 2e20   fuel settings. 
+00005670: 5468 6973 2066 756e 6374 696f 6e20 7570  This function up
+00005680: 6461 7465 730a 2020 2020 2020 2020 7468  dates.        th
+00005690: 6520 6675 656c 2066 6c61 6720 746f 2031  e fuel flag to 1
+000056a0: 2061 6e64 2073 6574 7320 7468 6520 6675   and sets the fu
+000056b0: 656c 2064 656e 7369 7479 2c20 6675 656c  el density, fuel
+000056c0: 206d 6f69 7374 7572 652c 2061 6e64 2066   moisture, and f
+000056d0: 7565 6c0a 2020 2020 2020 2020 6865 6967  uel.        heig
+000056e0: 6874 2074 6f20 7468 6520 7370 6563 6966  ht to the specif
+000056f0: 6965 6420 7661 6c75 6573 2e0a 0a20 2020  ied values...   
+00005700: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
+00005710: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00005720: 2d2d 0a20 2020 2020 2020 2066 7565 6c5f  --.        fuel_
+00005730: 6465 6e73 6974 793a 2066 6c6f 6174 0a20  density: float. 
+00005740: 2020 2020 2020 2020 2020 2046 7565 6c20             Fuel 
+00005750: 6275 6c6b 2064 656e 7369 7479 205b 6b67  bulk density [kg
+00005760: 2f6d 5e33 5d2e 204e 6f74 653a 2054 6869  /m^3]. Note: Thi
+00005770: 7320 6973 2074 6865 2066 7565 6c20 6275  s is the fuel bu
+00005780: 6c6b 2064 656e 7369 7479 2c20 736f 0a20  lk density, so. 
+00005790: 2020 2020 2020 2020 2020 2074 6865 2066             the f
+000057a0: 7565 6c20 6c6f 6164 2073 686f 756c 6420  uel load should 
+000057b0: 6265 206e 6f72 6d61 6c69 7a65 6420 6279  be normalized by
+000057c0: 2074 6865 2068 6569 6768 7420 6f66 2074   the height of t
+000057d0: 6865 2066 7565 6c20 6265 642e 0a20 2020  he fuel bed..   
+000057e0: 2020 2020 2066 7565 6c5f 6d6f 6973 7475       fuel_moistu
+000057f0: 7265 3a20 666c 6f61 740a 2020 2020 2020  re: float.      
+00005800: 2020 2020 2020 4675 656c 206d 6f69 7374        Fuel moist
+00005810: 7572 6520 636f 6e74 656e 7420 5b25 5d2e  ure content [%].
+00005820: 0a20 2020 2020 2020 2066 7565 6c5f 6865  .        fuel_he
+00005830: 6967 6874 3a20 666c 6f61 740a 2020 2020  ight: float.    
+00005840: 2020 2020 2020 2020 4675 656c 2062 6564          Fuel bed
+00005850: 2068 6569 6768 7420 5b6d 5d2e 0a20 2020   height [m]..   
+00005860: 2020 2020 2073 697a 655f 7363 616c 653a       size_scale:
+00005870: 2066 6c6f 6174 2c20 6f70 7469 6f6e 616c   float, optional
+00005880: 0a20 2020 2020 2020 2020 2020 2053 697a  .            Siz
+00005890: 6520 7363 616c 6520 5b6d 5d2e 2044 6566  e scale [m]. Def
+000058a0: 6175 6c74 2069 7320 302e 3030 3035 2e0a  ault is 0.0005..
+000058b0: 2020 2020 2020 2020 7061 7463 685f 7369          patch_si
+000058c0: 7a65 3a20 666c 6f61 742c 206f 7074 696f  ze: float, optio
+000058d0: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
+000058e0: 5061 7463 6820 7369 7a65 205b 6d5d 2e20  Patch size [m]. 
+000058f0: 4465 6661 756c 7420 6973 2030 2e30 2e0a  Default is 0.0..
+00005900: 2020 2020 2020 2020 6761 705f 7369 7a65          gap_size
+00005910: 3a20 666c 6f61 742c 206f 7074 696f 6e61  : float, optiona
+00005920: 6c0a 2020 2020 2020 2020 2020 2020 4761  l.            Ga
+00005930: 7020 7369 7a65 205b 6d5d 2e20 4465 6661  p size [m]. Defa
+00005940: 756c 7420 6973 2030 2e30 2e0a 0a20 2020  ult is 0.0...   
+00005950: 2020 2020 2045 7861 6d70 6c65 730a 2020       Examples.  
+00005960: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
+00005970: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
+00005980: 7175 6963 6669 7265 5f74 6f6f 6c73 2069  quicfire_tools i
+00005990: 6d70 6f72 7420 5369 6d75 6c61 7469 6f6e  mport Simulation
+000059a0: 496e 7075 7473 0a20 2020 2020 2020 203e  Inputs.        >
+000059b0: 3e3e 2073 696d 5f69 6e70 7574 7320 3d20  >> sim_inputs = 
+000059c0: 5369 6d75 6c61 7469 6f6e 496e 7075 7473  SimulationInputs
+000059d0: 2e63 7265 6174 655f 7369 6d75 6c61 7469  .create_simulati
+000059e0: 6f6e 286e 783d 3130 302c 206e 793d 3130  on(nx=100, ny=10
+000059f0: 302c 2066 6972 655f 6e7a 3d32 362c 2077  0, fire_nz=26, w
+00005a00: 696e 645f 7370 6565 643d 312e 382c 2077  ind_speed=1.8, w
+00005a10: 696e 645f 6469 7265 6374 696f 6e3d 3930  ind_direction=90
+00005a20: 2c20 7369 6d75 6c61 7469 6f6e 5f74 696d  , simulation_tim
+00005a30: 653d 3630 3029 0a20 2020 2020 2020 203e  e=600).        >
+00005a40: 3e3e 2073 696d 5f69 6e70 7574 732e 7365  >> sim_inputs.se
+00005a50: 745f 756e 6966 6f72 6d5f 6675 656c 7328  t_uniform_fuels(
+00005a60: 6675 656c 5f64 656e 7369 7479 3d30 2e35  fuel_density=0.5
+00005a70: 2c20 6675 656c 5f6d 6f69 7374 7572 653d  , fuel_moisture=
+00005a80: 3235 2c20 6675 656c 5f68 6569 6768 743d  25, fuel_height=
+00005a90: 3129 0a20 2020 2020 2020 203e 3e3e 2073  1).        >>> s
+00005aa0: 696d 5f69 6e70 7574 732e 7175 6963 5f66  im_inputs.quic_f
+00005ab0: 6972 652e 6675 656c 5f64 656e 7369 7479  ire.fuel_density
+00005ac0: 5f66 6c61 670a 2020 2020 2020 2020 310a  _flag.        1.
+00005ad0: 2020 2020 2020 2020 3e3e 3e20 7369 6d5f          >>> sim_
+00005ae0: 696e 7075 7473 2e71 7569 635f 6669 7265  inputs.quic_fire
+00005af0: 2e66 7565 6c5f 6465 6e73 6974 790a 2020  .fuel_density.  
+00005b00: 2020 2020 2020 302e 350a 2020 2020 2020        0.5.      
+00005b10: 2020 2222 220a 2020 2020 2020 2020 7365    """.        se
+00005b20: 6c66 2e71 7569 635f 6669 7265 2e66 7565  lf.quic_fire.fue
+00005b30: 6c5f 6465 6e73 6974 795f 666c 6167 203d  l_density_flag =
+00005b40: 2031 0a20 2020 2020 2020 2073 656c 662e   1.        self.
+00005b50: 7175 6963 5f66 6972 652e 6675 656c 5f64  quic_fire.fuel_d
+00005b60: 656e 7369 7479 203d 2066 7565 6c5f 6465  ensity = fuel_de
+00005b70: 6e73 6974 790a 2020 2020 2020 2020 7365  nsity.        se
+00005b80: 6c66 2e71 7569 635f 6669 7265 2e66 7565  lf.quic_fire.fue
+00005b90: 6c5f 6d6f 6973 7475 7265 5f66 6c61 6720  l_moisture_flag 
+00005ba0: 3d20 310a 2020 2020 2020 2020 7365 6c66  = 1.        self
+00005bb0: 2e71 7569 635f 6669 7265 2e66 7565 6c5f  .quic_fire.fuel_
+00005bc0: 6d6f 6973 7475 7265 203d 2066 7565 6c5f  moisture = fuel_
+00005bd0: 6d6f 6973 7475 7265 0a20 2020 2020 2020  moisture.       
+00005be0: 2073 656c 662e 7175 6963 5f66 6972 652e   self.quic_fire.
+00005bf0: 6675 656c 5f68 6569 6768 745f 666c 6167  fuel_height_flag
+00005c00: 203d 2031 0a20 2020 2020 2020 2073 656c   = 1.        sel
+00005c10: 662e 7175 6963 5f66 6972 652e 6675 656c  f.quic_fire.fuel
+00005c20: 5f68 6569 6768 7420 3d20 6675 656c 5f68  _height = fuel_h
+00005c30: 6569 6768 740a 2020 2020 2020 2020 6966  eight.        if
+00005c40: 2073 697a 655f 7363 616c 6520 213d 2030   size_scale != 0
+00005c50: 2e30 3030 353a 0a20 2020 2020 2020 2020  .0005:.         
+00005c60: 2020 2073 656c 662e 7175 6963 5f66 6972     self.quic_fir
+00005c70: 652e 7369 7a65 5f73 6361 6c65 5f66 6c61  e.size_scale_fla
+00005c80: 6720 3d20 310a 2020 2020 2020 2020 2020  g = 1.          
+00005c90: 2020 7365 6c66 2e71 7569 635f 6669 7265    self.quic_fire
+00005ca0: 2e73 697a 655f 7363 616c 6520 3d20 7369  .size_scale = si
+00005cb0: 7a65 5f73 6361 6c65 0a20 2020 2020 2020  ze_scale.       
+00005cc0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00005cd0: 2020 2073 656c 662e 7175 6963 5f66 6972     self.quic_fir
+00005ce0: 652e 7369 7a65 5f73 6361 6c65 5f66 6c61  e.size_scale_fla
+00005cf0: 6720 3d20 300a 2020 2020 2020 2020 6966  g = 0.        if
+00005d00: 2070 6174 6368 5f73 697a 6520 213d 2030   patch_size != 0
+00005d10: 2e30 206f 7220 6761 705f 7369 7a65 2021  .0 or gap_size !
+00005d20: 3d20 302e 303a 0a20 2020 2020 2020 2020  = 0.0:.         
+00005d30: 2020 2073 656c 662e 7175 6963 5f66 6972     self.quic_fir
+00005d40: 652e 7061 7463 685f 616e 645f 6761 705f  e.patch_and_gap_
+00005d50: 666c 6167 203d 2031 0a20 2020 2020 2020  flag = 1.       
+00005d60: 2020 2020 2073 656c 662e 7175 6963 5f66       self.quic_f
+00005d70: 6972 652e 7061 7463 685f 7369 7a65 203d  ire.patch_size =
+00005d80: 2070 6174 6368 5f73 697a 650a 2020 2020   patch_size.    
+00005d90: 2020 2020 2020 2020 7365 6c66 2e71 7569          self.qui
+00005da0: 635f 6669 7265 2e67 6170 5f73 697a 6520  c_fire.gap_size 
+00005db0: 3d20 6761 705f 7369 7a65 0a20 2020 2020  = gap_size.     
+00005dc0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00005dd0: 2020 2020 2073 656c 662e 7175 6963 5f66       self.quic_f
+00005de0: 6972 652e 7061 7463 685f 616e 645f 6761  ire.patch_and_ga
+00005df0: 705f 666c 6167 203d 2030 0a0a 2020 2020  p_flag = 0..    
+00005e00: 6465 6620 7365 745f 7265 6374 616e 676c  def set_rectangl
+00005e10: 655f 6967 6e69 7469 6f6e 280a 2020 2020  e_ignition(.    
+00005e20: 2020 2020 7365 6c66 2c20 785f 6d69 6e3a      self, x_min:
+00005e30: 2066 6c6f 6174 2c20 795f 6d69 6e3a 2066   float, y_min: f
+00005e40: 6c6f 6174 2c20 785f 6c65 6e67 7468 3a20  loat, x_length: 
+00005e50: 666c 6f61 742c 2079 5f6c 656e 6774 683a  float, y_length:
+00005e60: 2066 6c6f 6174 0a20 2020 2029 202d 3e20   float.    ) -> 
+00005e70: 4e6f 6e65 3a0a 2020 2020 2020 2020 2222  None:.        ""
+00005e80: 220a 2020 2020 2020 2020 5365 7473 2074  ".        Sets t
+00005e90: 6865 2073 696d 756c 6174 696f 6e20 746f  he simulation to
+00005ea0: 2075 7365 2061 2072 6563 7461 6e67 6c65   use a rectangle
+00005eb0: 2069 676e 6974 696f 6e20 736f 7572 6365   ignition source
+00005ec0: 2e20 5468 6973 2066 756e 6374 696f 6e0a  . This function.
+00005ed0: 2020 2020 2020 2020 7570 6461 7465 7320          updates 
+00005ee0: 7468 6520 6967 6e69 7469 6f6e 2066 6c61  the ignition fla
+00005ef0: 6720 746f 2031 2061 6e64 2073 6574 7320  g to 1 and sets 
+00005f00: 7468 6520 6967 6e69 7469 6f6e 2073 6f75  the ignition sou
+00005f10: 7263 6520 746f 2074 6865 0a20 2020 2020  rce to the.     
+00005f20: 2020 2073 7065 6369 6669 6564 2072 6563     specified rec
+00005f30: 7461 6e67 6c65 2e0a 0a20 2020 2020 2020  tangle...       
+00005f40: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+00005f50: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+00005f60: 2020 2020 2020 2078 5f6d 696e 3a20 666c         x_min: fl
+00005f70: 6f61 740a 2020 2020 2020 2020 2020 2020  oat.            
+00005f80: 536f 7574 682d 7765 7374 2063 6f72 6e65  South-west corne
+00005f90: 7220 696e 2074 6865 2078 2d64 6972 6563  r in the x-direc
+00005fa0: 7469 6f6e 205b 6d5d 0a20 2020 2020 2020  tion [m].       
+00005fb0: 2079 5f6d 696e 3a20 666c 6f61 740a 2020   y_min: float.  
+00005fc0: 2020 2020 2020 2020 2020 536f 7574 682d            South-
+00005fd0: 7765 7374 2063 6f72 6e65 7220 696e 2074  west corner in t
+00005fe0: 6865 2079 2d64 6972 6563 7469 6f6e 205b  he y-direction [
+00005ff0: 6d5d 0a20 2020 2020 2020 2078 5f6c 656e  m].        x_len
+00006000: 6774 683a 2066 6c6f 6174 0a20 2020 2020  gth: float.     
+00006010: 2020 2020 2020 204c 656e 6774 6820 696e         Length in
+00006020: 2074 6865 2078 2d64 6972 6563 7469 6f6e   the x-direction
+00006030: 205b 6d5d 0a20 2020 2020 2020 2079 5f6c   [m].        y_l
+00006040: 656e 6774 683a 2066 6c6f 6174 0a20 2020  ength: float.   
+00006050: 2020 2020 2020 2020 204c 656e 6774 6820           Length 
+00006060: 696e 2074 6865 2079 2d64 6972 6563 7469  in the y-directi
+00006070: 6f6e 205b 6d5d 0a0a 2020 2020 2020 2020  on [m]..        
+00006080: 4578 616d 706c 6573 0a20 2020 2020 2020  Examples.       
+00006090: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
+000060a0: 203e 3e3e 2066 726f 6d20 7175 6963 6669   >>> from quicfi
+000060b0: 7265 5f74 6f6f 6c73 2069 6d70 6f72 7420  re_tools import 
+000060c0: 5369 6d75 6c61 7469 6f6e 496e 7075 7473  SimulationInputs
+000060d0: 0a20 2020 2020 2020 203e 3e3e 2073 696d  .        >>> sim
+000060e0: 5f69 6e70 7574 7320 3d20 5369 6d75 6c61  _inputs = Simula
+000060f0: 7469 6f6e 496e 7075 7473 2e63 7265 6174  tionInputs.creat
+00006100: 655f 7369 6d75 6c61 7469 6f6e 286e 783d  e_simulation(nx=
+00006110: 3130 302c 206e 793d 3130 302c 2066 6972  100, ny=100, fir
+00006120: 655f 6e7a 3d32 362c 2077 696e 645f 7370  e_nz=26, wind_sp
+00006130: 6565 643d 312e 382c 2077 696e 645f 6469  eed=1.8, wind_di
+00006140: 7265 6374 696f 6e3d 3930 2c20 7369 6d75  rection=90, simu
+00006150: 6c61 7469 6f6e 5f74 696d 653d 3630 3029  lation_time=600)
+00006160: 0a20 2020 2020 2020 203e 3e3e 2073 696d  .        >>> sim
+00006170: 5f69 6e70 7574 732e 7365 745f 7265 6374  _inputs.set_rect
+00006180: 616e 676c 655f 6967 6e69 7469 6f6e 2878  angle_ignition(x
+00006190: 5f6d 696e 3d30 2c20 795f 6d69 6e3d 302c  _min=0, y_min=0,
+000061a0: 2078 5f6c 656e 6774 683d 3130 2c20 795f   x_length=10, y_
+000061b0: 6c65 6e67 7468 3d31 3029 0a20 2020 2020  length=10).     
+000061c0: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
+000061d0: 676e 6974 696f 6e20 3d20 5265 6374 616e  gnition = Rectan
+000061e0: 676c 6549 676e 6974 696f 6e28 0a20 2020  gleIgnition(.   
+000061f0: 2020 2020 2020 2020 2078 5f6d 696e 3d78           x_min=x
+00006200: 5f6d 696e 2c20 795f 6d69 6e3d 795f 6d69  _min, y_min=y_mi
+00006210: 6e2c 2078 5f6c 656e 6774 683d 785f 6c65  n, x_length=x_le
+00006220: 6e67 7468 2c20 795f 6c65 6e67 7468 3d79  ngth, y_length=y
+00006230: 5f6c 656e 6774 680a 2020 2020 2020 2020  _length.        
+00006240: 290a 2020 2020 2020 2020 7365 6c66 2e71  ).        self.q
+00006250: 7569 635f 6669 7265 2e69 676e 6974 696f  uic_fire.ignitio
+00006260: 6e20 3d20 6967 6e69 7469 6f6e 0a0a 2020  n = ignition..  
+00006270: 2020 6465 6620 7365 745f 6f75 7470 7574    def set_output
+00006280: 5f66 696c 6573 280a 2020 2020 2020 2020  _files(.        
+00006290: 7365 6c66 2c0a 2020 2020 2020 2020 656e  self,.        en
+000062a0: 675f 746f 5f61 746d 3a20 626f 6f6c 203d  g_to_atm: bool =
+000062b0: 2046 616c 7365 2c0a 2020 2020 2020 2020   False,.        
+000062c0: 7265 6163 745f 7261 7465 3a20 626f 6f6c  react_rate: bool
+000062d0: 203d 2046 616c 7365 2c0a 2020 2020 2020   = False,.      
+000062e0: 2020 6675 656c 5f64 656e 733a 2062 6f6f    fuel_dens: boo
+000062f0: 6c20 3d20 4661 6c73 652c 0a20 2020 2020  l = False,.     
+00006300: 2020 2071 665f 7769 6e64 3a20 626f 6f6c     qf_wind: bool
+00006310: 203d 2046 616c 7365 2c0a 2020 2020 2020   = False,.      
+00006320: 2020 7175 5f77 696e 645f 696e 7374 3a20    qu_wind_inst: 
+00006330: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
+00006340: 2020 2020 2020 7175 5f77 696e 645f 6176        qu_wind_av
+00006350: 673a 2062 6f6f 6c20 3d20 4661 6c73 652c  g: bool = False,
+00006360: 0a20 2020 2020 2020 2066 7565 6c5f 6d6f  .        fuel_mo
+00006370: 6973 743a 2062 6f6f 6c20 3d20 4661 6c73  ist: bool = Fals
+00006380: 652c 0a20 2020 2020 2020 206d 6173 735f  e,.        mass_
+00006390: 6275 726e 743a 2062 6f6f 6c20 3d20 4661  burnt: bool = Fa
+000063a0: 6c73 652c 0a20 2020 2020 2020 2065 6d69  lse,.        emi
+000063b0: 7373 696f 6e73 3a20 626f 6f6c 203d 2046  ssions: bool = F
+000063c0: 616c 7365 2c0a 2020 2020 2020 2020 7261  alse,.        ra
+000063d0: 6469 6174 696f 6e3a 2062 6f6f 6c20 3d20  diation: bool = 
+000063e0: 4661 6c73 652c 0a20 2020 2020 2020 2073  False,.        s
+000063f0: 7572 665f 656e 673a 2062 6f6f 6c20 3d20  urf_eng: bool = 
+00006400: 4661 6c73 652c 0a20 2020 2020 2020 2069  False,.        i
+00006410: 6e74 656e 7369 7479 3a20 626f 6f6c 203d  ntensity: bool =
+00006420: 2046 616c 7365 2c0a 2020 2020 2920 2d3e   False,.    ) ->
+00006430: 204e 6f6e 653a 0a20 2020 2020 2020 2022   None:.        "
+00006440: 2222 0a20 2020 2020 2020 2053 6574 7320  "".        Sets 
+00006450: 7468 6520 7369 6d75 6c61 7469 6f6e 2074  the simulation t
+00006460: 6f20 6f75 7470 7574 2074 6865 2073 7065  o output the spe
+00006470: 6369 6669 6564 2066 696c 6573 2e20 4669  cified files. Fi
+00006480: 6c65 7320 7365 7420 746f 2054 7275 650a  les set to True.
+00006490: 2020 2020 2020 2020 7769 6c6c 2062 6520          will be 
+000064a0: 6f75 7470 7574 2062 7920 7468 6520 7369  output by the si
+000064b0: 6d75 6c61 7469 6f6e 2c20 616e 6420 6669  mulation, and fi
+000064c0: 6c65 7320 7365 7420 746f 2046 616c 7365  les set to False
+000064d0: 2077 696c 6c20 6e6f 7420 6265 0a20 2020   will not be.   
+000064e0: 2020 2020 206f 7574 7075 742e 0a0a 2020       output...  
+000064f0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+00006500: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00006510: 2d2d 2d0a 2020 2020 2020 2020 656e 675f  ---.        eng_
+00006520: 746f 5f61 746d 3a20 626f 6f6c 2c20 6f70  to_atm: bool, op
+00006530: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
+00006540: 2020 2049 6620 5472 7565 2c20 6f75 7470     If True, outp
+00006550: 7574 2074 6865 2066 6972 652d 656e 6572  ut the fire-ener
+00006560: 6779 5f74 6f5f 6174 6d6f 732e 6269 6e20  gy_to_atmos.bin 
+00006570: 6669 6c65 2e20 4465 6661 756c 7420 6973  file. Default is
+00006580: 2046 616c 7365 2e0a 2020 2020 2020 2020   False..        
+00006590: 7265 6163 745f 7261 7465 3a20 626f 6f6c  react_rate: bool
+000065a0: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+000065b0: 2020 2020 2020 2049 6620 5472 7565 2c20         If True, 
+000065c0: 6f75 7470 7574 2074 6865 2066 6972 652d  output the fire-
+000065d0: 7265 6163 7469 6f6e 5f72 6174 652e 6269  reaction_rate.bi
+000065e0: 6e20 6669 6c65 2e20 4465 6661 756c 7420  n file. Default 
+000065f0: 6973 2046 616c 7365 2e0a 2020 2020 2020  is False..      
+00006600: 2020 6675 656c 5f64 656e 733a 2062 6f6f    fuel_dens: boo
+00006610: 6c2c 206f 7074 696f 6e61 6c0a 2020 2020  l, optional.    
+00006620: 2020 2020 2020 2020 4966 2054 7275 652c          If True,
+00006630: 206f 7574 7075 7420 7468 6520 6675 656c   output the fuel
+00006640: 732d 6465 6e73 2e62 696e 2066 696c 652e  s-dens.bin file.
+00006650: 2044 6566 6175 6c74 2069 7320 4661 6c73   Default is Fals
+00006660: 652e 0a20 2020 2020 2020 2071 665f 7769  e..        qf_wi
+00006670: 6e64 3a20 626f 6f6c 2c20 6f70 7469 6f6e  nd: bool, option
+00006680: 616c 0a20 2020 2020 2020 2020 2020 2049  al.            I
+00006690: 6620 5472 7565 2c20 6f75 7470 7574 2074  f True, output t
+000066a0: 6865 2077 696e 6475 2c20 7769 6e64 762c  he windu, windv,
+000066b0: 2061 6e64 2077 696e 6477 202e 6269 6e20   and windw .bin 
+000066c0: 6669 6c65 732e 0a20 2020 2020 2020 2020  files..         
+000066d0: 2020 2044 6566 6175 6c74 2069 7320 4661     Default is Fa
+000066e0: 6c73 652e 0a20 2020 2020 2020 2071 755f  lse..        qu_
+000066f0: 7769 6e64 5f69 6e73 743a 2062 6f6f 6c2c  wind_inst: bool,
+00006700: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+00006710: 2020 2020 2020 4966 2054 7275 652c 206f        If True, o
+00006720: 7574 7075 7420 7468 6520 7175 6963 5f77  utput the quic_w
+00006730: 696e 645f 696e 7374 2e62 696e 2066 696c  ind_inst.bin fil
+00006740: 652e 2044 6566 6175 6c74 2069 7320 4661  e. Default is Fa
+00006750: 6c73 652e 0a20 2020 2020 2020 2071 755f  lse..        qu_
+00006760: 7769 6e64 5f61 7667 3a20 626f 6f6c 2c20  wind_avg: bool, 
+00006770: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+00006780: 2020 2020 2049 6620 5472 7565 2c20 6f75       If True, ou
+00006790: 7470 7574 2074 6865 2071 7569 635f 7769  tput the quic_wi
+000067a0: 6e64 5f61 7667 2e62 696e 2066 696c 652e  nd_avg.bin file.
+000067b0: 2044 6566 6175 6c74 2069 7320 4661 6c73   Default is Fals
+000067c0: 652e 0a20 2020 2020 2020 2066 7565 6c5f  e..        fuel_
+000067d0: 6d6f 6973 743a 2062 6f6f 6c2c 206f 7074  moist: bool, opt
+000067e0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+000067f0: 2020 4966 2054 7275 652c 206f 7574 7075    If True, outpu
+00006800: 7420 7468 6520 6675 656c 732d 6d6f 6973  t the fuels-mois
+00006810: 742e 6269 6e20 6669 6c65 2e20 4465 6661  t.bin file. Defa
+00006820: 756c 7420 6973 2046 616c 7365 2e0a 2020  ult is False..  
+00006830: 2020 2020 2020 6d61 7373 5f62 7572 6e74        mass_burnt
+00006840: 3a20 626f 6f6c 2c20 6f70 7469 6f6e 616c  : bool, optional
+00006850: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+00006860: 5472 7565 2c20 6f75 7470 7574 2074 6865  True, output the
+00006870: 206d 6275 726e 745f 696e 7465 672e 6269   mburnt_integ.bi
+00006880: 6e20 6669 6c65 2e20 4465 6661 756c 7420  n file. Default 
+00006890: 6973 2046 616c 7365 2e0a 2020 2020 2020  is False..      
+000068a0: 2020 656d 6973 7369 6f6e 733a 2062 6f6f    emissions: boo
+000068b0: 6c2c 206f 7074 696f 6e61 6c0a 2020 2020  l, optional.    
+000068c0: 2020 2020 2020 2020 4966 2054 7275 652c          If True,
+000068d0: 206f 7574 7075 7420 7468 6520 636f 2d65   output the co-e
+000068e0: 6d69 7373 696f 6e73 2061 6e64 2070 6d2d  missions and pm-
+000068f0: 656d 6973 7369 6f6e 7320 2e62 696e 2066  emissions .bin f
+00006900: 696c 6573 2e0a 2020 2020 2020 2020 2020  iles..          
+00006910: 2020 4465 6661 756c 7420 6973 2046 616c    Default is Fal
+00006920: 7365 2e0a 2020 2020 2020 2020 7261 6469  se..        radi
+00006930: 6174 696f 6e3a 2062 6f6f 6c2c 206f 7074  ation: bool, opt
+00006940: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+00006950: 2020 4966 2054 7275 652c 206f 7574 7075    If True, outpu
+00006960: 7420 7468 6520 7468 6572 6d61 6c64 6f73  t the thermaldos
+00006970: 6520 616e 6420 7468 6572 6d61 6c72 6164  e and thermalrad
+00006980: 6961 7469 6f6e 202e 6269 6e20 6669 6c65  iation .bin file
+00006990: 732e 0a20 2020 2020 2020 2020 2020 2044  s..            D
+000069a0: 6566 6175 6c74 2069 7320 4661 6c73 652e  efault is False.
+000069b0: 0a20 2020 2020 2020 2069 6e74 656e 7369  .        intensi
+000069c0: 7479 3a20 626f 6f6c 2c20 6f70 7469 6f6e  ty: bool, option
+000069d0: 616c 0a20 2020 2020 2020 2020 2020 2049  al.            I
+000069e0: 6620 5472 7565 2c20 6f75 7470 7574 2074  f True, output t
+000069f0: 6865 2066 6972 652d 696e 7465 6e73 6974  he fire-intensit
+00006a00: 792e 6269 6e20 6669 6c65 2e20 4465 6661  y.bin file. Defa
+00006a10: 756c 7420 6973 2046 616c 7365 2e0a 0a20  ult is False... 
+00006a20: 2020 2020 2020 2045 7861 6d70 6c65 730a         Examples.
+00006a30: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00006a40: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
+00006a50: 6d20 7175 6963 6669 7265 5f74 6f6f 6c73  m quicfire_tools
+00006a60: 2069 6d70 6f72 7420 5369 6d75 6c61 7469   import Simulati
+00006a70: 6f6e 496e 7075 7473 0a20 2020 2020 2020  onInputs.       
+00006a80: 203e 3e3e 2073 696d 5f69 6e70 7574 7320   >>> sim_inputs 
+00006a90: 3d20 5369 6d75 6c61 7469 6f6e 496e 7075  = SimulationInpu
+00006aa0: 7473 2e63 7265 6174 655f 7369 6d75 6c61  ts.create_simula
+00006ab0: 7469 6f6e 286e 783d 3130 302c 206e 793d  tion(nx=100, ny=
+00006ac0: 3130 302c 2066 6972 655f 6e7a 3d32 362c  100, fire_nz=26,
+00006ad0: 2077 696e 645f 7370 6565 643d 312e 382c   wind_speed=1.8,
+00006ae0: 2077 696e 645f 6469 7265 6374 696f 6e3d   wind_direction=
+00006af0: 3930 2c20 7369 6d75 6c61 7469 6f6e 5f74  90, simulation_t
+00006b00: 696d 653d 3630 3029 0a20 2020 2020 2020  ime=600).       
+00006b10: 203e 3e3e 2073 696d 5f69 6e70 7574 732e   >>> sim_inputs.
+00006b20: 7365 745f 6f75 7470 7574 5f66 696c 6573  set_output_files
+00006b30: 2866 7565 6c5f 6465 6e73 3d54 7275 652c  (fuel_dens=True,
+00006b40: 206d 6173 735f 6275 726e 743d 5472 7565   mass_burnt=True
+00006b50: 290a 2020 2020 2020 2020 2222 220a 0a20  ).        """.. 
+00006b60: 2020 2020 2020 2073 656c 662e 7175 6963         self.quic
+00006b70: 5f66 6972 652e 656e 675f 746f 5f61 746d  _fire.eng_to_atm
+00006b80: 5f6f 7574 203d 2069 6e74 2865 6e67 5f74  _out = int(eng_t
+00006b90: 6f5f 6174 6d29 0a20 2020 2020 2020 2073  o_atm).        s
+00006ba0: 656c 662e 7175 6963 5f66 6972 652e 7265  elf.quic_fire.re
+00006bb0: 6163 745f 7261 7465 5f6f 7574 203d 2069  act_rate_out = i
+00006bc0: 6e74 2872 6561 6374 5f72 6174 6529 0a20  nt(react_rate). 
+00006bd0: 2020 2020 2020 2073 656c 662e 7175 6963         self.quic
+00006be0: 5f66 6972 652e 6675 656c 5f64 656e 735f  _fire.fuel_dens_
+00006bf0: 6f75 7420 3d20 696e 7428 6675 656c 5f64  out = int(fuel_d
+00006c00: 656e 7329 0a20 2020 2020 2020 2073 656c  ens).        sel
+00006c10: 662e 7175 6963 5f66 6972 652e 7166 5f77  f.quic_fire.qf_w
+00006c20: 696e 645f 6f75 7420 3d20 696e 7428 7166  ind_out = int(qf
+00006c30: 5f77 696e 6429 0a20 2020 2020 2020 2073  _wind).        s
+00006c40: 656c 662e 7175 6963 5f66 6972 652e 7175  elf.quic_fire.qu
+00006c50: 5f77 696e 645f 696e 7374 5f6f 7574 203d  _wind_inst_out =
+00006c60: 2069 6e74 2871 755f 7769 6e64 5f69 6e73   int(qu_wind_ins
+00006c70: 7429 0a20 2020 2020 2020 2073 656c 662e  t).        self.
+00006c80: 7175 6963 5f66 6972 652e 7175 5f77 696e  quic_fire.qu_win
+00006c90: 645f 6176 675f 6f75 7420 3d20 696e 7428  d_avg_out = int(
+00006ca0: 7175 5f77 696e 645f 6176 6729 0a20 2020  qu_wind_avg).   
+00006cb0: 2020 2020 2073 656c 662e 7175 6963 5f66       self.quic_f
+00006cc0: 6972 652e 6675 656c 5f6d 6f69 7374 5f6f  ire.fuel_moist_o
+00006cd0: 7574 203d 2069 6e74 2866 7565 6c5f 6d6f  ut = int(fuel_mo
+00006ce0: 6973 7429 0a20 2020 2020 2020 2073 656c  ist).        sel
+00006cf0: 662e 7175 6963 5f66 6972 652e 6d61 7373  f.quic_fire.mass
+00006d00: 5f62 7572 6e74 5f6f 7574 203d 2069 6e74  _burnt_out = int
+00006d10: 286d 6173 735f 6275 726e 7429 0a20 2020  (mass_burnt).   
+00006d20: 2020 2020 2073 656c 662e 7175 6963 5f66       self.quic_f
+00006d30: 6972 652e 7261 6469 6174 696f 6e5f 6f75  ire.radiation_ou
+00006d40: 7420 3d20 696e 7428 7261 6469 6174 696f  t = int(radiatio
+00006d50: 6e29 0a20 2020 2020 2020 2073 656c 662e  n).        self.
+00006d60: 7175 6963 5f66 6972 652e 7375 7266 5f65  quic_fire.surf_e
+00006d70: 6e67 5f6f 7574 203d 2069 6e74 2873 7572  ng_out = int(sur
+00006d80: 665f 656e 6729 0a20 2020 2020 2020 2073  f_eng).        s
+00006d90: 656c 662e 7175 6963 5f66 6972 652e 656d  elf.quic_fire.em
+00006da0: 6973 7369 6f6e 735f 6f75 7420 3d20 3220  issions_out = 2 
+00006db0: 6966 2065 6d69 7373 696f 6e73 2065 6c73  if emissions els
+00006dc0: 6520 300a 0a20 2020 2064 6566 2073 6574  e 0..    def set
+00006dd0: 5f6f 7574 7075 745f 696e 7465 7276 616c  _output_interval
+00006de0: 2873 656c 662c 2069 6e74 6572 7661 6c3a  (self, interval:
+00006df0: 2069 6e74 293a 0a20 2020 2020 2020 2022   int):.        "
+00006e00: 2222 0a20 2020 2020 2020 2053 6574 7320  "".        Sets 
+00006e10: 7468 6520 696e 7465 7276 616c 2c20 696e  the interval, in
+00006e20: 2073 6563 6f6e 6473 2c20 6174 2077 6869   seconds, at whi
+00006e30: 6368 2074 6865 2073 696d 756c 6174 696f  ch the simulatio
+00006e40: 6e20 7769 6c6c 2077 7269 7465 202e 6269  n will write .bi
+00006e50: 6e0a 2020 2020 2020 2020 6669 6c65 7320  n.        files 
+00006e60: 746f 2064 6973 6b2e 2054 6869 7320 6675  to disk. This fu
+00006e70: 6e63 7469 6f6e 2073 6574 7320 7468 6520  nction sets the 
+00006e80: 7361 6d65 2069 6e74 6572 7661 6c20 666f  same interval fo
+00006e90: 7220 616c 6c20 6f75 7470 7574 0a20 2020  r all output.   
+00006ea0: 2020 2020 2066 696c 6573 2e0a 0a20 2020       files...   
+00006eb0: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
+00006ec0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00006ed0: 2d2d 0a20 2020 2020 2020 2069 6e74 6572  --.        inter
+00006ee0: 7661 6c3a 2069 6e74 0a20 2020 2020 2020  val: int.       
+00006ef0: 2020 2020 2049 6e74 6572 7661 6c20 696e       Interval in
+00006f00: 2073 6563 6f6e 6473 2061 7420 7768 6963   seconds at whic
+00006f10: 6820 746f 2077 7269 7465 202e 6269 6e20  h to write .bin 
+00006f20: 6669 6c65 7320 746f 2064 6973 6b2e 0a0a  files to disk...
+00006f30: 2020 2020 2020 2020 4578 616d 706c 6573          Examples
+00006f40: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00006f50: 2d0a 2020 2020 2020 2020 3e3e 3e20 6672  -.        >>> fr
+00006f60: 6f6d 2071 7569 6366 6972 655f 746f 6f6c  om quicfire_tool
+00006f70: 7320 696d 706f 7274 2053 696d 756c 6174  s import Simulat
+00006f80: 696f 6e49 6e70 7574 730a 2020 2020 2020  ionInputs.      
+00006f90: 2020 3e3e 3e20 7369 6d5f 696e 7075 7473    >>> sim_inputs
+00006fa0: 203d 2053 696d 756c 6174 696f 6e49 6e70   = SimulationInp
+00006fb0: 7574 732e 6372 6561 7465 5f73 696d 756c  uts.create_simul
+00006fc0: 6174 696f 6e28 6e78 3d31 3030 2c20 6e79  ation(nx=100, ny
+00006fd0: 3d31 3030 2c20 6669 7265 5f6e 7a3d 3236  =100, fire_nz=26
+00006fe0: 2c20 7769 6e64 5f73 7065 6564 3d31 2e38  , wind_speed=1.8
+00006ff0: 2c20 7769 6e64 5f64 6972 6563 7469 6f6e  , wind_direction
+00007000: 3d39 302c 2073 696d 756c 6174 696f 6e5f  =90, simulation_
+00007010: 7469 6d65 3d36 3030 290a 2020 2020 2020  time=600).      
+00007020: 2020 3e3e 3e20 7369 6d5f 696e 7075 7473    >>> sim_inputs
+00007030: 2e73 6574 5f6f 7574 7075 745f 696e 7465  .set_output_inte
+00007040: 7276 616c 2836 3029 0a20 2020 2020 2020  rval(60).       
+00007050: 2022 2222 0a20 2020 2020 2020 2073 656c   """.        sel
+00007060: 662e 7175 6963 5f66 6972 652e 6f75 745f  f.quic_fire.out_
+00007070: 7469 6d65 5f66 6972 6520 3d20 696e 7465  time_fire = inte
+00007080: 7276 616c 0a20 2020 2020 2020 2073 656c  rval.        sel
+00007090: 662e 7175 6963 5f66 6972 652e 6f75 745f  f.quic_fire.out_
+000070a0: 7469 6d65 5f77 696e 6420 3d20 696e 7465  time_wind = inte
+000070b0: 7276 616c 0a20 2020 2020 2020 2073 656c  rval.        sel
+000070c0: 662e 7175 6963 5f66 6972 652e 6f75 745f  f.quic_fire.out_
+000070d0: 7469 6d65 5f77 696e 645f 6176 6720 3d20  time_wind_avg = 
+000070e0: 696e 7465 7276 616c 0a20 2020 2020 2020  interval.       
+000070f0: 2073 656c 662e 7175 6963 5f66 6972 652e   self.quic_fire.
+00007100: 6f75 745f 7469 6d65 5f65 6d69 735f 7261  out_time_emis_ra
+00007110: 6420 3d20 696e 7465 7276 616c 0a0a 2020  d = interval..  
+00007120: 2020 6465 6620 6e65 775f 7769 6e64 5f73    def new_wind_s
+00007130: 656e 736f 7228 0a20 2020 2020 2020 2073  ensor(.        s
+00007140: 656c 662c 0a20 2020 2020 2020 2075 7064  elf,.        upd
+00007150: 6174 653a 2073 7472 203d 204e 6f6e 652c  ate: str = None,
+00007160: 0a20 2020 2020 2020 2077 696e 645f 7370  .        wind_sp
+00007170: 6565 6473 3a20 666c 6f61 7420 7c20 6c69  eeds: float | li
+00007180: 7374 2866 6c6f 6174 2920 3d20 4e6f 6e65  st(float) = None
+00007190: 2c0a 2020 2020 2020 2020 7769 6e64 5f64  ,.        wind_d
+000071a0: 6972 6563 7469 6f6e 733a 2069 6e74 207c  irections: int |
+000071b0: 206c 6973 7428 696e 7429 203d 204e 6f6e   list(int) = Non
+000071c0: 652c 0a20 2020 2020 2020 2077 696e 645f  e,.        wind_
+000071d0: 7469 6d65 733a 2069 6e74 207c 206c 6973  times: int | lis
+000071e0: 7428 696e 7429 203d 204e 6f6e 652c 0a20  t(int) = None,. 
+000071f0: 2020 2020 2020 2073 656e 736f 725f 6865         sensor_he
+00007200: 6967 6874 3a20 666c 6f61 7420 3d20 4e6f  ight: float = No
+00007210: 6e65 2c0a 2020 2020 2020 2020 785f 6c6f  ne,.        x_lo
+00007220: 6361 7469 6f6e 3a20 696e 7420 3d20 4e6f  cation: int = No
+00007230: 6e65 2c0a 2020 2020 2020 2020 795f 6c6f  ne,.        y_lo
+00007240: 6361 7469 6f6e 3a20 696e 7420 3d20 4e6f  cation: int = No
+00007250: 6e65 2c0a 2020 2020 293a 0a20 2020 2020  ne,.    ):.     
+00007260: 2020 2022 2222 0a20 2020 2020 2020 2041     """.        A
+00007270: 6464 7320 6120 7769 6e64 2073 656e 736f  dds a wind senso
+00007280: 7220 6f72 2075 7064 6174 6573 2061 6e20  r or updates an 
+00007290: 6578 6973 7469 6e67 206f 6e65 2e0a 0a20  existing one... 
+000072a0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+000072b0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+000072c0: 2d2d 2d2d 0a20 2020 2020 2020 2075 7064  ----.        upd
+000072d0: 6174 653a 2073 7472 0a20 2020 2020 2020  ate: str.       
+000072e0: 2020 2020 204e 616d 6520 6f66 2074 6865       Name of the
+000072f0: 2077 696e 6420 7365 6e73 6f72 2c20 652e   wind sensor, e.
+00007300: 672e 2022 7365 6e73 6f72 3122 2e20 5365  g. "sensor1". Se
+00007310: 6e73 6f72 206d 7573 7420 616c 7265 6164  nsor must alread
+00007320: 7920 6578 6973 7420 696e 2077 696e 6473  y exist in winds
+00007330: 656e 736f 7273 2e0a 2020 2020 2020 2020  ensors..        
+00007340: 2020 2020 4f6d 6974 206f 7220 7573 6520      Omit or use 
+00007350: 7570 6461 7465 203d 204e 6f6e 6520 746f  update = None to
+00007360: 2061 6464 2061 206e 6577 2073 656e 736f   add a new senso
+00007370: 722e 0a20 2020 2020 2020 2077 696e 645f  r..        wind_
+00007380: 7370 6565 6473 203a 2050 6f73 6974 6976  speeds : Positiv
+00007390: 6546 6c6f 6174 207c 206c 6973 7428 506f  eFloat | list(Po
+000073a0: 7369 7469 7665 466c 6f61 7429 0a20 2020  sitiveFloat).   
+000073b0: 2020 2020 2020 2020 204f 7074 696f 6e61           Optiona
+000073c0: 6c2e 2055 7064 6174 6564 2077 696e 6420  l. Updated wind 
+000073d0: 7370 6565 6420 6f72 206c 6973 7420 6f66  speed or list of
+000073e0: 2077 696e 6420 7370 6565 6473 2069 6e20   wind speeds in 
+000073f0: 6d2f 730a 2020 2020 2020 2020 7769 6e64  m/s.        wind
+00007400: 5f64 6972 6563 7469 6f6e 733a 2050 6f73  _directions: Pos
+00007410: 6974 6976 6549 6e74 207c 206c 6973 7428  itiveInt | list(
+00007420: 506f 7369 7469 7665 496e 7429 0a20 2020  PositiveInt).   
+00007430: 2020 2020 2020 2020 204f 7074 696f 6e61           Optiona
+00007440: 6c2e 2055 7064 6174 6564 2077 696e 6420  l. Updated wind 
+00007450: 6469 7265 6374 696f 6e20 6f72 206c 6973  direction or lis
+00007460: 7420 6f66 2077 696e 6420 6469 7265 6374  t of wind direct
+00007470: 696f 6e73 2069 6e20 6465 6772 6565 732e  ions in degrees.
+00007480: 2055 7365 2030 2066 6f72 206e 6f72 7468   Use 0 for north
+00007490: 2e0a 2020 2020 2020 2020 7769 6e64 5f74  ..        wind_t
+000074a0: 696d 6573 203a 204e 6f6e 4e65 6761 7469  imes : NonNegati
+000074b0: 7665 496e 7420 7c20 6c69 7374 284e 6f6e  veInt | list(Non
+000074c0: 4e65 6761 7469 7665 496e 7429 0a20 2020  NegativeInt).   
+000074d0: 2020 2020 2020 2020 204f 7074 696f 6e61           Optiona
+000074e0: 6c2e 2055 7064 6174 6564 206c 6973 7420  l. Updated list 
+000074f0: 6f66 2074 696d 6573 2066 6f72 2065 6163  of times for eac
+00007500: 6820 7769 6e64 7368 6966 742e 2055 7365  h windshift. Use
+00007510: 2030 2066 6f72 2073 696e 676c 6520 7769   0 for single wi
+00007520: 6e64 7368 6966 742e 2046 6972 7374 2076  ndshift. First v
+00007530: 616c 7565 206d 7573 7420 6265 2030 2e0a  alue must be 0..
+00007540: 2020 2020 2020 2020 7365 6e73 6f72 5f68          sensor_h
+00007550: 6569 6768 7420 3a20 506f 7369 7469 7665  eight : Positive
+00007560: 466c 6f61 740a 2020 2020 2020 2020 2020  Float.          
+00007570: 2020 4f70 7469 6f6e 616c 2e20 5570 6461    Optional. Upda
+00007580: 7465 6420 6865 6967 6874 206f 6620 7468  ted height of th
+00007590: 6520 7769 6e64 2073 656e 736f 7220 696e  e wind sensor in
+000075a0: 206d 6574 6572 732e 0a20 2020 2020 2020   meters..       
+000075b0: 2078 5f6c 6f63 6174 696f 6e20 3a20 506f   x_location : Po
+000075c0: 7369 7469 7665 496e 740a 2020 2020 2020  sitiveInt.      
+000075d0: 2020 2020 2020 4f70 7469 6f6e 616c 2e20        Optional. 
+000075e0: 5570 6461 7465 6420 6c6f 6361 7469 6f6e  Updated location
+000075f0: 206f 6620 7468 6520 7769 6e64 2073 656e   of the wind sen
+00007600: 736f 7220 696e 2074 6865 2078 2d64 6972  sor in the x-dir
+00007610: 6563 7469 6f6e 2028 6d29 2e0a 2020 2020  ection (m)..    
+00007620: 2020 2020 795f 6c6f 6361 7469 6f6e 203a      y_location :
+00007630: 2050 6f73 6974 6976 6549 6e74 0a20 2020   PositiveInt.   
+00007640: 2020 2020 2020 2020 204f 7074 696f 6e61           Optiona
+00007650: 6c2e 2055 7064 6174 6564 206c 6f63 6174  l. Updated locat
+00007660: 696f 6e20 6f66 2074 6865 2077 696e 6420  ion of the wind 
+00007670: 7365 6e73 6f72 2069 6e20 7468 6520 792d  sensor in the y-
+00007680: 6469 7265 6374 696f 6e20 286d 292e 0a0a  direction (m)...
+00007690: 2020 2020 2020 2020 4578 616d 706c 6573          Examples
+000076a0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000076b0: 2d0a 2020 2020 2020 2020 3e3e 3e20 6672  -.        >>> fr
+000076c0: 6f6d 2071 7569 6366 6972 655f 746f 6f6c  om quicfire_tool
+000076d0: 7320 696d 706f 7274 2053 696d 756c 6174  s import Simulat
+000076e0: 696f 6e49 6e70 7574 730a 2020 2020 2020  ionInputs.      
+000076f0: 2020 3e3e 3e20 7369 6d5f 696e 7075 7473    >>> sim_inputs
+00007700: 203d 2053 696d 756c 6174 696f 6e49 6e70   = SimulationInp
+00007710: 7574 732e 6372 6561 7465 5f73 696d 756c  uts.create_simul
+00007720: 6174 696f 6e28 6e78 3d31 3030 2c20 6e79  ation(nx=100, ny
+00007730: 3d31 3030 2c20 6669 7265 5f6e 7a3d 3236  =100, fire_nz=26
+00007740: 2c20 7769 6e64 5f73 7065 6564 3d31 2e38  , wind_speed=1.8
+00007750: 2c20 7769 6e64 5f64 6972 6563 7469 6f6e  , wind_direction
+00007760: 3d39 302c 2073 696d 756c 6174 696f 6e5f  =90, simulation_
+00007770: 7469 6d65 3d36 3030 290a 2020 2020 2020  time=600).      
+00007780: 2020 3e3e 3e20 2320 4164 6420 6120 6e65    >>> # Add a ne
+00007790: 7720 7365 6e73 6f72 0a20 2020 2020 2020  w sensor.       
+000077a0: 203e 3e3e 2073 696d 5f69 6e70 7574 732e   >>> sim_inputs.
+000077b0: 6e65 775f 7769 6e64 5f73 656e 736f 7228  new_wind_sensor(
+000077c0: 7769 6e64 5f73 7065 6564 7320 3d20 342e  wind_speeds = 4.
+000077d0: 3437 2c20 7769 6e64 5f64 6972 6563 7469  47, wind_directi
+000077e0: 6f6e 7320 3d20 3237 302c 2077 696e 645f  ons = 270, wind_
+000077f0: 7469 6d65 7320 3d20 302c 2073 656e 736f  times = 0, senso
+00007800: 725f 6865 6967 6874 203d 2036 2e31 2c20  r_height = 6.1, 
+00007810: 785f 6c6f 6361 7469 6f6e 203d 2035 302c  x_location = 50,
+00007820: 2079 5f6c 6f63 6174 696f 6e20 3d20 3530   y_location = 50
+00007830: 290a 2020 2020 2020 2020 3e3e 3e20 2320  ).        >>> # 
+00007840: 5570 6461 7465 2061 6e20 6578 6973 7469  Update an existi
+00007850: 6e67 2077 696e 6420 7365 6e73 6f72 0a20  ng wind sensor. 
+00007860: 2020 2020 2020 203e 3e3e 2073 696d 5f69         >>> sim_i
+00007870: 6e70 7574 732e 6e65 775f 7769 6e64 5f73  nputs.new_wind_s
+00007880: 656e 736f 7228 7570 6461 7465 203d 2027  ensor(update = '
+00007890: 7365 6e73 6f72 3227 2c20 7769 6e64 5f73  sensor2', wind_s
+000078a0: 7065 6564 7320 3d20 5b34 2e34 372c 2036  peeds = [4.47, 6
+000078b0: 2e37 5d2c 2077 696e 645f 6469 7265 6374  .7], wind_direct
+000078c0: 696f 6e73 203d 205b 3237 302c 2032 3730  ions = [270, 270
+000078d0: 5d2c 2077 696e 645f 7469 6d65 7320 3d20  ], wind_times = 
+000078e0: 5b30 2c33 3030 5d29 0a20 2020 2020 2020  [0,300]).       
+000078f0: 2022 2222 0a20 2020 2020 2020 2069 6620   """.        if 
+00007900: 7570 6461 7465 2069 7320 4e6f 6e65 3a0a  update is None:.
+00007910: 2020 2020 2020 2020 2020 2020 6172 675f              arg_
+00007920: 6469 6374 203d 207b 0a20 2020 2020 2020  dict = {.       
+00007930: 2020 2020 2020 2020 2022 785f 6c6f 6361           "x_loca
+00007940: 7469 6f6e 223a 2078 5f6c 6f63 6174 696f  tion": x_locatio
+00007950: 6e2c 0a20 2020 2020 2020 2020 2020 2020  n,.             
+00007960: 2020 2022 795f 6c6f 6361 7469 6f6e 223a     "y_location":
+00007970: 2079 5f6c 6f63 6174 696f 6e2c 0a20 2020   y_location,.   
+00007980: 2020 2020 2020 2020 2020 2020 2022 7769               "wi
+00007990: 6e64 5f73 7065 6564 7322 3a20 7769 6e64  nd_speeds": wind
+000079a0: 5f73 7065 6564 732c 0a20 2020 2020 2020  _speeds,.       
+000079b0: 2020 2020 2020 2020 2022 7769 6e64 5f64           "wind_d
+000079c0: 6972 6563 7469 6f6e 7322 3a20 7769 6e64  irections": wind
+000079d0: 5f64 6972 6563 7469 6f6e 732c 0a20 2020  _directions,.   
+000079e0: 2020 2020 2020 2020 2020 2020 2022 7769               "wi
+000079f0: 6e64 5f74 696d 6573 223a 2077 696e 645f  nd_times": wind_
+00007a00: 7469 6d65 732c 0a20 2020 2020 2020 2020  times,.         
+00007a10: 2020 2020 2020 2022 7365 6e73 6f72 5f68         "sensor_h
+00007a20: 6569 6768 7422 3a20 7365 6e73 6f72 5f68  eight": sensor_h
+00007a30: 6569 6768 742c 0a20 2020 2020 2020 2020  eight,.         
+00007a40: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
+00007a50: 2065 7272 6f72 5f6c 6973 7420 3d20 5b5d   error_list = []
+00007a60: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+00007a70: 206b 2c20 7620 696e 2061 7267 5f64 6963   k, v in arg_dic
+00007a80: 742e 6974 656d 7328 293a 0a20 2020 2020  t.items():.     
+00007a90: 2020 2020 2020 2020 2020 2069 6620 7620             if v 
+00007aa0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+00007ab0: 2020 2020 2020 2020 2020 2020 2065 7272               err
+00007ac0: 6f72 5f6c 6973 742e 6170 7065 6e64 286b  or_list.append(k
+00007ad0: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+00007ae0: 206c 656e 2865 7272 6f72 5f6c 6973 7429   len(error_list)
+00007af0: 203e 2030 3a0a 2020 2020 2020 2020 2020   > 0:.          
+00007b00: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
+00007b10: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+00007b20: 2020 2020 2020 2020 2020 2066 2241 7267             f"Arg
+00007b30: 756d 656e 7473 207b 6572 726f 725f 6c69  uments {error_li
+00007b40: 7374 7d20 6d75 7374 2062 6520 7375 7070  st} must be supp
+00007b50: 6c69 6564 2077 6865 6e20 7570 6461 7465  lied when update
+00007b60: 203d 204e 6f6e 6522 0a20 2020 2020 2020   = None".       
+00007b70: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00007b80: 2020 2020 2020 2073 656c 662e 7769 6e64         self.wind
+00007b90: 7365 6e73 6f72 732e 6164 645f 7365 6e73  sensors.add_sens
+00007ba0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+00007bb0: 2020 2020 7769 6e64 5f74 696d 6573 3d77      wind_times=w
+00007bc0: 696e 645f 7469 6d65 732c 0a20 2020 2020  ind_times,.     
+00007bd0: 2020 2020 2020 2020 2020 2077 696e 645f             wind_
+00007be0: 7370 6565 6473 3d77 696e 645f 7370 6565  speeds=wind_spee
+00007bf0: 6473 2c0a 2020 2020 2020 2020 2020 2020  ds,.            
+00007c00: 2020 2020 7769 6e64 5f64 6972 6563 7469      wind_directi
+00007c10: 6f6e 733d 7769 6e64 5f64 6972 6563 7469  ons=wind_directi
+00007c20: 6f6e 732c 0a20 2020 2020 2020 2020 2020  ons,.           
+00007c30: 2020 2020 2073 656e 736f 725f 6865 6967       sensor_heig
+00007c40: 6874 3d73 656e 736f 725f 6865 6967 6874  ht=sensor_height
+00007c50: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00007c60: 2020 785f 6c6f 6361 7469 6f6e 3d78 5f6c    x_location=x_l
+00007c70: 6f63 6174 696f 6e2c 0a20 2020 2020 2020  ocation,.       
+00007c80: 2020 2020 2020 2020 2079 5f6c 6f63 6174           y_locat
+00007c90: 696f 6e3d 795f 6c6f 6361 7469 6f6e 2c0a  ion=y_location,.
+00007ca0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00007cb0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00007cc0: 2020 2020 2020 2020 7365 6c66 2e77 696e          self.win
+00007cd0: 6473 656e 736f 7273 2e75 7064 6174 655f  dsensors.update_
+00007ce0: 7365 6e73 6f72 280a 2020 2020 2020 2020  sensor(.        
+00007cf0: 2020 2020 2020 2020 7365 6e73 6f72 5f6e          sensor_n
+00007d00: 616d 653d 7570 6461 7465 2c0a 2020 2020  ame=update,.    
+00007d10: 2020 2020 2020 2020 2020 2020 7769 6e64              wind
+00007d20: 5f74 696d 6573 3d77 696e 645f 7469 6d65  _times=wind_time
+00007d30: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+00007d40: 2020 2077 696e 645f 7370 6565 6473 3d77     wind_speeds=w
+00007d50: 696e 645f 7370 6565 6473 2c0a 2020 2020  ind_speeds,.    
+00007d60: 2020 2020 2020 2020 2020 2020 7769 6e64              wind
+00007d70: 5f64 6972 6563 7469 6f6e 733d 7769 6e64  _directions=wind
+00007d80: 5f64 6972 6563 7469 6f6e 732c 0a20 2020  _directions,.   
+00007d90: 2020 2020 2020 2020 2020 2020 2073 656e               sen
+00007da0: 736f 725f 6865 6967 6874 3d73 656e 736f  sor_height=senso
+00007db0: 725f 6865 6967 6874 2c0a 2020 2020 2020  r_height,.      
+00007dc0: 2020 2020 2020 2020 2020 785f 6c6f 6361            x_loca
+00007dd0: 7469 6f6e 3d78 5f6c 6f63 6174 696f 6e2c  tion=x_location,
+00007de0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007df0: 2079 5f6c 6f63 6174 696f 6e3d 795f 6c6f   y_location=y_lo
+00007e00: 6361 7469 6f6e 2c0a 2020 2020 2020 2020  cation,.        
+00007e10: 2020 2020 290a 0a20 2020 2064 6566 206e      )..    def n
+00007e20: 6577 5f77 696e 645f 7365 6e73 6f72 5f66  ew_wind_sensor_f
+00007e30: 726f 6d5f 6373 7628 0a20 2020 2020 2020  rom_csv(.       
+00007e40: 2073 656c 662c 0a20 2020 2020 2020 2064   self,.        d
+00007e50: 6972 6563 746f 7279 3a20 7374 7220 7c20  irectory: str | 
+00007e60: 5061 7468 2c0a 2020 2020 2020 2020 6669  Path,.        fi
+00007e70: 6c65 6e61 6d65 3a20 7374 722c 0a20 2020  lename: str,.   
+00007e80: 2020 2020 2075 7064 6174 653a 2073 7472       update: str
+00007e90: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+00007ea0: 2073 656e 736f 725f 6865 6967 6874 3a20   sensor_height: 
+00007eb0: 666c 6f61 7420 3d20 4e6f 6e65 2c0a 2020  float = None,.  
+00007ec0: 2020 2020 2020 785f 6c6f 6361 7469 6f6e        x_location
+00007ed0: 3a20 696e 7420 3d20 4e6f 6e65 2c0a 2020  : int = None,.  
+00007ee0: 2020 2020 2020 795f 6c6f 6361 7469 6f6e        y_location
+00007ef0: 3a20 696e 7420 3d20 4e6f 6e65 2c0a 2020  : int = None,.  
+00007f00: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
+00007f10: 0a20 2020 2020 2020 2041 6464 7320 6120  .        Adds a 
+00007f20: 7769 6e64 2073 656e 736f 7220 6f72 2075  wind sensor or u
+00007f30: 7064 6174 6573 2061 6e20 6578 6973 7469  pdates an existi
+00007f40: 6e67 206f 6e65 2066 726f 6d20 6120 6373  ng one from a cs
+00007f50: 7620 6669 6c65 2e0a 0a20 2020 2020 2020  v file...       
+00007f60: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+00007f70: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+00007f80: 2020 2020 2020 2064 6972 6563 746f 7279         directory
+00007f90: 203a 2073 7472 207c 2050 6174 680a 2020   : str | Path.  
+00007fa0: 2020 2020 2020 2020 2020 4469 7265 6374            Direct
+00007fb0: 6f72 7920 636f 6e74 6169 6e69 6e67 2074  ory containing t
+00007fc0: 6865 2063 7376 2074 6f20 7265 6164 0a20  he csv to read. 
+00007fd0: 2020 2020 2020 2066 696c 656e 616d 6520         filename 
+00007fe0: 3a20 7374 720a 2020 2020 2020 2020 2020  : str.          
+00007ff0: 2020 4e61 6d65 206f 6620 7468 6520 6373    Name of the cs
+00008000: 7620 6669 6c65 0a20 2020 2020 2020 2075  v file.        u
+00008010: 7064 6174 653a 2073 7472 0a20 2020 2020  pdate: str.     
+00008020: 2020 2020 2020 204e 616d 6520 6f66 2074         Name of t
+00008030: 6865 2077 696e 6420 7365 6e73 6f72 2c20  he wind sensor, 
+00008040: 652e 672e 2022 7365 6e73 6f72 3122 2e20  e.g. "sensor1". 
+00008050: 5365 6e73 6f72 206d 7573 7420 616c 7265  Sensor must alre
+00008060: 6164 7920 6578 6973 7420 696e 2077 696e  ady exist in win
+00008070: 6473 656e 736f 7273 2e0a 2020 2020 2020  dsensors..      
+00008080: 2020 2020 2020 4f6d 6974 206f 7220 7573        Omit or us
+00008090: 6520 7570 6461 7465 203d 204e 6f6e 6520  e update = None 
+000080a0: 746f 2061 6464 2061 206e 6577 2073 656e  to add a new sen
+000080b0: 736f 722e 0a20 2020 2020 2020 2073 656e  sor..        sen
+000080c0: 736f 725f 6865 6967 6874 203a 2066 6c6f  sor_height : flo
+000080d0: 6174 203e 2030 0a20 2020 2020 2020 2020  at > 0.         
+000080e0: 2020 2048 6569 6768 7420 6f66 2077 696e     Height of win
+000080f0: 6420 7365 6e73 6f72 2e0a 2020 2020 2020  d sensor..      
+00008100: 2020 785f 6c6f 6361 7469 6f6e 203a 2069    x_location : i
+00008110: 6e74 203e 3d20 300a 2020 2020 2020 2020  nt >= 0.        
+00008120: 2020 2020 4c6f 6361 7469 6f6e 206f 6620      Location of 
+00008130: 7468 6520 7769 6e64 2073 656e 736f 7220  the wind sensor 
+00008140: 696e 2074 6865 2078 2d64 6972 6563 7469  in the x-directi
+00008150: 6f6e 2e0a 2020 2020 2020 2020 795f 6c6f  on..        y_lo
+00008160: 6361 7469 6f6e 203a 2069 6e74 203e 3d20  cation : int >= 
+00008170: 300a 2020 2020 2020 2020 2020 2020 4c6f  0.            Lo
+00008180: 6361 7469 6f6e 206f 6620 7468 6520 7769  cation of the wi
+00008190: 6e64 2073 656e 736f 7220 696e 2074 6865  nd sensor in the
+000081a0: 2079 2d64 6972 6563 7469 6f6e 2e0a 0a20   y-direction... 
+000081b0: 2020 2020 2020 2043 6f6c 756d 6e73 0a20         Columns. 
+000081c0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
+000081d0: 2020 2020 2020 2077 696e 645f 7469 6d65         wind_time
+000081e0: 7320 3a20 696e 7420 3e3d 2030 0a20 2020  s : int >= 0.   
+000081f0: 2020 2020 2020 2020 2054 696d 6520 696e           Time in
+00008200: 2073 6563 6f6e 6473 2074 6861 7420 6561   seconds that ea
+00008210: 6368 2077 696e 6473 6869 6674 206f 6363  ch windshift occ
+00008220: 7572 7320 6672 6f6d 2074 6865 2073 7461  urs from the sta
+00008230: 7274 206f 6620 7468 6520 7369 6d75 6c61  rt of the simula
+00008240: 7469 6f6e 2e0a 2020 2020 2020 2020 2020  tion..          
+00008250: 2020 4669 7273 7420 656e 7472 7920 6d75    First entry mu
+00008260: 7374 2062 6520 302e 0a20 2020 2020 2020  st be 0..       
+00008270: 2077 696e 645f 7370 6565 6473 203a 2066   wind_speeds : f
+00008280: 6c6f 6174 203e 2030 0a20 2020 2020 2020  loat > 0.       
+00008290: 2020 2020 2057 696e 6420 7370 6565 6420       Wind speed 
+000082a0: 6f66 2065 6163 6820 7769 6e64 7368 6966  of each windshif
+000082b0: 7420 696e 206d 2f73 2e0a 2020 2020 2020  t in m/s..      
+000082c0: 2020 7769 6e64 5f64 6972 6563 7469 6f6e    wind_direction
+000082d0: 7320 3a20 3020 3c3d 2069 6e74 203c 2033  s : 0 <= int < 3
+000082e0: 3630 0a20 2020 2020 2020 2020 2020 2057  60.            W
+000082f0: 696e 6420 6469 7265 6374 696f 6e20 6f66  ind direction of
+00008300: 2065 6163 6820 7769 6e64 7368 6966 7420   each windshift 
+00008310: 696e 2064 6567 7265 6573 2e0a 0a20 2020  in degrees...   
+00008320: 2020 2020 2045 7861 6d70 6c65 730a 2020       Examples.  
+00008330: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
+00008340: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
+00008350: 7175 6963 6669 7265 5f74 6f6f 6c73 2069  quicfire_tools i
+00008360: 6d70 6f72 7420 5369 6d75 6c61 7469 6f6e  mport Simulation
+00008370: 496e 7075 7473 0a20 2020 2020 2020 203e  Inputs.        >
+00008380: 3e3e 2073 696d 5f69 6e70 7574 7320 3d20  >> sim_inputs = 
+00008390: 5369 6d75 6c61 7469 6f6e 496e 7075 7473  SimulationInputs
+000083a0: 2e63 7265 6174 655f 7369 6d75 6c61 7469  .create_simulati
+000083b0: 6f6e 286e 783d 3130 302c 206e 793d 3130  on(nx=100, ny=10
+000083c0: 302c 2066 6972 655f 6e7a 3d32 362c 2077  0, fire_nz=26, w
+000083d0: 696e 645f 7370 6565 643d 312e 382c 2077  ind_speed=1.8, w
+000083e0: 696e 645f 6469 7265 6374 696f 6e3d 3930  ind_direction=90
+000083f0: 2c20 7369 6d75 6c61 7469 6f6e 5f74 696d  , simulation_tim
+00008400: 653d 3630 3029 0a20 2020 2020 2020 203e  e=600).        >
+00008410: 3e3e 2073 696d 5f69 6e70 7574 732e 6e65  >> sim_inputs.ne
+00008420: 775f 7769 6e64 5f73 656e 736f 725f 6672  w_wind_sensor_fr
+00008430: 6f6d 5f63 7376 2822 7061 7468 2f74 6f2f  om_csv("path/to/
+00008440: 6469 7265 6374 6f72 7922 2c22 6669 6c65  directory","file
+00008450: 6e61 6d65 222c 7570 6461 7465 3d27 7365  name",update='se
+00008460: 6e73 6f72 3127 290a 2020 2020 2020 2020  nsor1').        
+00008470: 2222 220a 2020 2020 2020 2020 6966 2069  """.        if i
+00008480: 7369 6e73 7461 6e63 6528 6469 7265 6374  sinstance(direct
+00008490: 6f72 792c 2073 7472 293a 0a20 2020 2020  ory, str):.     
+000084a0: 2020 2020 2020 2064 6972 6563 746f 7279         directory
+000084b0: 203d 2050 6174 6828 6469 7265 6374 6f72   = Path(director
+000084c0: 7929 0a20 2020 2020 2020 2066 696c 6570  y).        filep
+000084d0: 6174 6820 3d20 6469 7265 6374 6f72 7920  ath = directory 
+000084e0: 2f20 6669 6c65 6e61 6d65 0a20 2020 2020  / filename.     
+000084f0: 2020 2064 6620 3d20 7064 2e72 6561 645f     df = pd.read_
+00008500: 6373 7628 6669 6c65 7061 7468 290a 2020  csv(filepath).  
+00008510: 2020 2020 2020 7661 6c69 6461 7465 203d        validate =
+00008520: 2044 6174 6146 7261 6d65 5363 6865 6d61   DataFrameSchema
+00008530: 280a 2020 2020 2020 2020 2020 2020 7b0a  (.            {.
+00008540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008550: 2277 696e 645f 7469 6d65 7322 3a20 436f  "wind_times": Co
+00008560: 6c75 6d6e 2869 6e74 2c20 6368 6563 6b73  lumn(int, checks
+00008570: 3d43 6865 636b 2e67 6528 3029 292c 0a20  =Check.ge(0)),. 
+00008580: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00008590: 7769 6e64 5f73 7065 6564 7322 3a20 436f  wind_speeds": Co
+000085a0: 6c75 6d6e 2866 6c6f 6174 2c20 6368 6563  lumn(float, chec
+000085b0: 6b73 3d43 6865 636b 2e67 7428 3029 292c  ks=Check.gt(0)),
+000085c0: 2020 2320 6361 6e20 7769 6e64 7370 6565    # can windspee
+000085d0: 6420 6265 2030 3f0a 2020 2020 2020 2020  d be 0?.        
+000085e0: 2020 2020 2020 2020 2277 696e 645f 6469          "wind_di
+000085f0: 7265 6374 696f 6e73 223a 2043 6f6c 756d  rections": Colum
+00008600: 6e28 696e 742c 2063 6865 636b 733d 4368  n(int, checks=Ch
+00008610: 6563 6b2e 6c74 2833 3630 2929 2c0a 2020  eck.lt(360)),.  
+00008620: 2020 2020 2020 2020 2020 7d0a 2020 2020            }.    
+00008630: 2020 2020 290a 2020 2020 2020 2020 7661      ).        va
+00008640: 6c69 6461 7465 645f 6466 203d 2076 616c  lidated_df = val
+00008650: 6964 6174 6528 6466 290a 2020 2020 2020  idate(df).      
+00008660: 2020 6966 2075 7064 6174 6520 6973 204e    if update is N
+00008670: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00008680: 2073 656c 662e 7769 6e64 7365 6e73 6f72   self.windsensor
+00008690: 732e 6164 645f 7365 6e73 6f72 280a 2020  s.add_sensor(.  
+000086a0: 2020 2020 2020 2020 2020 2020 2020 7769                wi
+000086b0: 6e64 5f74 696d 6573 3d6c 6973 7428 7661  nd_times=list(va
+000086c0: 6c69 6461 7465 645f 6466 5b22 7769 6e64  lidated_df["wind
+000086d0: 5f74 696d 6573 225d 292c 0a20 2020 2020  _times"]),.     
+000086e0: 2020 2020 2020 2020 2020 2077 696e 645f             wind_
+000086f0: 7370 6565 6473 3d6c 6973 7428 7661 6c69  speeds=list(vali
+00008700: 6461 7465 645f 6466 5b22 7769 6e64 5f73  dated_df["wind_s
+00008710: 7065 6564 7322 5d29 2c0a 2020 2020 2020  peeds"]),.      
+00008720: 2020 2020 2020 2020 2020 7769 6e64 5f64            wind_d
+00008730: 6972 6563 7469 6f6e 733d 6c69 7374 2876  irections=list(v
+00008740: 616c 6964 6174 6564 5f64 665b 2277 696e  alidated_df["win
+00008750: 645f 6469 7265 6374 696f 6e73 225d 292c  d_directions"]),
+00008760: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00008770: 2073 656e 736f 725f 6865 6967 6874 3d73   sensor_height=s
+00008780: 656e 736f 725f 6865 6967 6874 2c0a 2020  ensor_height,.  
+00008790: 2020 2020 2020 2020 2020 2020 2020 785f                x_
+000087a0: 6c6f 6361 7469 6f6e 3d78 5f6c 6f63 6174  location=x_locat
+000087b0: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
+000087c0: 2020 2020 2079 5f6c 6f63 6174 696f 6e3d       y_location=
+000087d0: 795f 6c6f 6361 7469 6f6e 2c0a 2020 2020  y_location,.    
+000087e0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000087f0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00008800: 2020 2020 7365 6c66 2e77 696e 6473 656e      self.windsen
+00008810: 736f 7273 2e75 7064 6174 655f 7365 6e73  sors.update_sens
+00008820: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+00008830: 2020 2020 7365 6e73 6f72 5f6e 616d 653d      sensor_name=
+00008840: 7570 6461 7465 2c0a 2020 2020 2020 2020  update,.        
+00008850: 2020 2020 2020 2020 7769 6e64 5f74 696d          wind_tim
+00008860: 6573 3d6c 6973 7428 7661 6c69 6461 7465  es=list(validate
+00008870: 645f 6466 5b22 7769 6e64 5f74 696d 6573  d_df["wind_times
+00008880: 225d 292c 0a20 2020 2020 2020 2020 2020  "]),.           
+00008890: 2020 2020 2077 696e 645f 7370 6565 6473       wind_speeds
+000088a0: 3d6c 6973 7428 7661 6c69 6461 7465 645f  =list(validated_
+000088b0: 6466 5b22 7769 6e64 5f73 7065 6564 7322  df["wind_speeds"
+000088c0: 5d29 2c0a 2020 2020 2020 2020 2020 2020  ]),.            
+000088d0: 2020 2020 7769 6e64 5f64 6972 6563 7469      wind_directi
+000088e0: 6f6e 733d 6c69 7374 2876 616c 6964 6174  ons=list(validat
+000088f0: 6564 5f64 665b 2277 696e 645f 6469 7265  ed_df["wind_dire
+00008900: 6374 696f 6e73 225d 292c 0a20 2020 2020  ctions"]),.     
+00008910: 2020 2020 2020 2020 2020 2073 656e 736f             senso
+00008920: 725f 6865 6967 6874 3d73 656e 736f 725f  r_height=sensor_
+00008930: 6865 6967 6874 2c0a 2020 2020 2020 2020  height,.        
+00008940: 2020 2020 2020 2020 785f 6c6f 6361 7469          x_locati
+00008950: 6f6e 3d78 5f6c 6f63 6174 696f 6e2c 0a20  on=x_location,. 
+00008960: 2020 2020 2020 2020 2020 2020 2020 2079                 y
+00008970: 5f6c 6f63 6174 696f 6e3d 795f 6c6f 6361  _location=y_loca
+00008980: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
+00008990: 2020 290a 0a20 2020 2064 6566 205f 7570    )..    def _up
+000089a0: 6461 7465 5f73 6861 7265 645f 6174 7472  date_shared_attr
+000089b0: 6962 7574 6573 2873 656c 6629 3a0a 2020  ibutes(self):.  
+000089c0: 2020 2020 2020 7365 6c66 2e67 7269 646c        self.gridl
+000089d0: 6973 742e 6e20 3d20 7365 6c66 2e71 755f  ist.n = self.qu_
+000089e0: 7369 6d70 6172 616d 732e 6e78 0a20 2020  simparams.nx.   
+000089f0: 2020 2020 2073 656c 662e 6772 6964 6c69       self.gridli
+00008a00: 7374 2e6d 203d 2073 656c 662e 7175 5f73  st.m = self.qu_s
+00008a10: 696d 7061 7261 6d73 2e6e 790a 2020 2020  imparams.ny.    
+00008a20: 2020 2020 7365 6c66 2e67 7269 646c 6973      self.gridlis
+00008a30: 742e 6c20 3d20 7365 6c66 2e71 7569 635f  t.l = self.quic_
+00008a40: 6669 7265 2e6e 7a0a 2020 2020 2020 2020  fire.nz.        
+00008a50: 7365 6c66 2e67 7269 646c 6973 742e 6478  self.gridlist.dx
+00008a60: 203d 2073 656c 662e 7175 5f73 696d 7061   = self.qu_simpa
+00008a70: 7261 6d73 2e64 780a 2020 2020 2020 2020  rams.dx.        
+00008a80: 7365 6c66 2e67 7269 646c 6973 742e 6479  self.gridlist.dy
+00008a90: 203d 2073 656c 662e 7175 5f73 696d 7061   = self.qu_simpa
+00008aa0: 7261 6d73 2e64 790a 2020 2020 2020 2020  rams.dy.        
+00008ab0: 6966 206e 6f74 2073 656c 662e 7175 5f73  if not self.qu_s
+00008ac0: 696d 7061 7261 6d73 2e77 696e 645f 7469  imparams.wind_ti
+00008ad0: 6d65 735b 305d 203d 3d20 7365 6c66 2e71  mes[0] == self.q
+00008ae0: 7569 635f 6669 7265 2e74 696d 655f 6e6f  uic_fire.time_no
+00008af0: 773a 0a20 2020 2020 2020 2020 2020 2070  w:.            p
+00008b00: 7269 6e74 280a 2020 2020 2020 2020 2020  rint(.          
+00008b10: 2020 2020 2020 6622 5741 524e 494e 473a        f"WARNING:
+00008b20: 2066 6972 6520 7374 6172 7420 7469 6d65   fire start time
+00008b30: 206d 7573 7420 6265 2074 6865 2073 616d   must be the sam
+00008b40: 6520 666f 7220 616c 6c20 696e 7075 7420  e for all input 
+00008b50: 6669 6c65 732e 5c6e 220a 2020 2020 2020  files.\n".      
+00008b60: 2020 2020 2020 2020 2020 6622 5469 6d65            f"Time
+00008b70: 733a 205c 6e22 0a20 2020 2020 2020 2020  s: \n".         
+00008b80: 2020 2020 2020 2066 225c 7451 5549 435f         f"\tQUIC_
+00008b90: 6669 7265 2e69 6e70 3a20 7b73 656c 662e  fire.inp: {self.
+00008ba0: 7175 6963 5f66 6972 652e 7469 6d65 5f6e  quic_fire.time_n
+00008bb0: 6f77 7d5c 6e22 0a20 2020 2020 2020 2020  ow}\n".         
+00008bc0: 2020 2020 2020 2066 225c 7451 555f 7369         f"\tQU_si
+00008bd0: 6d70 6172 616d 732e 696e 703a 207b 7365  mparams.inp: {se
+00008be0: 6c66 2e71 755f 7369 6d70 6172 616d 732e  lf.qu_simparams.
+00008bf0: 7769 6e64 5f74 696d 6573 5b30 5d7d 5c6e  wind_times[0]}\n
+00008c00: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00008c10: 2020 6622 5365 7474 696e 6720 616c 6c20    f"Setting all 
+00008c20: 7661 6c75 6573 2074 6f20 7b73 656c 662e  values to {self.
+00008c30: 7175 6963 5f66 6972 652e 7469 6d65 5f6e  quic_fire.time_n
+00008c40: 6f77 7d22 0a20 2020 2020 2020 2020 2020  ow}".           
+00008c50: 2029 0a20 2020 2020 2020 2023 2054 4f44   ).        # TOD
+00008c60: 4f3a 2063 6865 636b 2071 755f 6d65 7470  O: check qu_metp
+00008c70: 6172 616d 7320 616e 6420 7175 5f73 696d  arams and qu_sim
+00008c80: 7061 7261 6d73 0a20 2020 2020 2020 2073  params.        s
+00008c90: 656c 662e 7175 5f73 696d 7061 7261 6d73  elf.qu_simparams
+00008ca0: 2e77 696e 645f 7469 6d65 7320 3d20 5b0a  .wind_times = [.
+00008cb0: 2020 2020 2020 2020 2020 2020 7320 2b20              s + 
+00008cc0: 7365 6c66 2e71 7569 635f 6669 7265 2e74  self.quic_fire.t
+00008cd0: 696d 655f 6e6f 7720 666f 7220 7320 696e  ime_now for s in
+00008ce0: 2073 656c 662e 7769 6e64 7365 6e73 6f72   self.windsensor
+00008cf0: 732e 7769 6e64 5f74 696d 6573 0a20 2020  s.wind_times.   
+00008d00: 2020 2020 205d 0a20 2020 2020 2020 2073       ].        s
+00008d10: 656c 662e 7175 5f6d 6574 7061 7261 6d73  elf.qu_metparams
+00008d20: 2e6e 756d 5f73 656e 736f 7273 203d 206c  .num_sensors = l
+00008d30: 656e 2873 656c 662e 7769 6e64 7365 6e73  en(self.windsens
+00008d40: 6f72 732e 7365 6e73 6f72 5f61 7272 6179  ors.sensor_array
+00008d50: 290a 0a0a 636c 6173 7320 496e 7075 7446  )...class InputF
+00008d60: 696c 6528 4261 7365 4d6f 6465 6c2c 2076  ile(BaseModel, v
+00008d70: 616c 6964 6174 655f 6173 7369 676e 6d65  alidate_assignme
+00008d80: 6e74 3d54 7275 6529 3a0a 2020 2020 2222  nt=True):.    ""
+00008d90: 220a 2020 2020 4261 7365 2063 6c61 7373  ".    Base class
+00008da0: 2072 6570 7265 7365 6e74 696e 6720 616e   representing an
+00008db0: 2069 6e70 7574 2066 696c 652e 0a0a 2020   input file...  
+00008dc0: 2020 5468 6973 2062 6173 6520 636c 6173    This base clas
+00008dd0: 7320 7072 6f76 6964 6573 2061 2063 6f6d  s provides a com
+00008de0: 6d6f 6e20 696e 7465 7266 6163 6520 666f  mon interface fo
+00008df0: 7220 616c 6c20 696e 7075 7420 6669 6c65  r all input file
+00008e00: 7320 696e 206f 7264 6572 2074 6f0a 2020  s in order to.  
+00008e10: 2020 6163 636f 6d70 6c69 7368 2074 776f    accomplish two
+00008e20: 206d 6169 6e20 676f 616c 733a 0a0a 2020   main goals:..  
+00008e30: 2020 3129 2052 6574 7572 6e20 646f 6375    1) Return docu
+00008e40: 6d65 6e74 6174 696f 6e20 666f 7220 6561  mentation for ea
+00008e50: 6368 2070 6172 616d 6574 6572 2069 6e20  ch parameter in 
+00008e60: 7468 6520 696e 7075 7420 6669 6c65 2e0a  the input file..
+00008e70: 0a20 2020 2032 2920 5072 6f76 6964 6520  .    2) Provide 
+00008e80: 6120 6d65 7468 6f64 2074 6f20 7772 6974  a method to writ
+00008e90: 6520 7468 6520 696e 7075 7420 6669 6c65  e the input file
+00008ea0: 2074 6f20 6120 6469 7265 6374 6f72 792e   to a directory.
+00008eb0: 0a20 2020 2022 2222 0a0a 2020 2020 6e61  .    """..    na
+00008ec0: 6d65 3a20 7374 720a 2020 2020 5f65 7874  me: str.    _ext
+00008ed0: 656e 7369 6f6e 3a20 7374 720a 0a20 2020  ension: str..   
+00008ee0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+00008ef0: 6566 205f 6669 6c65 6e61 6d65 2873 656c  ef _filename(sel
+00008f00: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
+00008f10: 726e 2066 227b 7365 6c66 2e6e 616d 657d  rn f"{self.name}
+00008f20: 7b73 656c 662e 5f65 7874 656e 7369 6f6e  {self._extension
+00008f30: 7d22 0a0a 2020 2020 4070 726f 7065 7274  }"..    @propert
+00008f40: 790a 2020 2020 6465 6620 646f 6375 6d65  y.    def docume
+00008f50: 6e74 6174 696f 6e5f 6469 6374 2873 656c  ntation_dict(sel
+00008f60: 6629 202d 3e20 6469 6374 3a0a 2020 2020  f) -> dict:.    
+00008f70: 2020 2020 2320 5265 7475 726e 2074 6865      # Return the
+00008f80: 2064 6f63 756d 656e 7461 7469 6f6e 2064   documentation d
+00008f90: 6963 7469 6f6e 6172 790a 2020 2020 2020  ictionary.      
+00008fa0: 2020 7769 7468 206f 7065 6e28 444f 4353    with open(DOCS
+00008fb0: 5f50 4154 4820 2f20 6622 7b73 656c 662e  _PATH / f"{self.
+00008fc0: 5f66 696c 656e 616d 657d 2e6a 736f 6e22  _filename}.json"
+00008fd0: 2c20 2272 2229 2061 7320 663a 0a20 2020  , "r") as f:.   
+00008fe0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00008ff0: 6a73 6f6e 2e6c 6f61 6428 6629 0a0a 2020  json.load(f)..  
+00009000: 2020 6465 6620 6c69 7374 5f70 6172 616d    def list_param
+00009010: 6574 6572 7328 7365 6c66 2920 2d3e 206c  eters(self) -> l
+00009020: 6973 745b 7374 725d 3a0a 2020 2020 2020  ist[str]:.      
+00009030: 2020 2222 220a 2020 2020 2020 2020 4765    """.        Ge
+00009040: 7420 6120 6c69 7374 206f 6620 7468 6520  t a list of the 
+00009050: 6e61 6d65 7320 6f66 2061 6c6c 2070 6172  names of all par
+00009060: 616d 6574 6572 7320 696e 2074 6865 2069  ameters in the i
+00009070: 6e70 7574 2066 696c 652e 0a20 2020 2020  nput file..     
+00009080: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
+00009090: 6574 7572 6e20 6c69 7374 2873 656c 662e  eturn list(self.
+000090a0: 646f 6375 6d65 6e74 6174 696f 6e5f 6469  documentation_di
+000090b0: 6374 2e6b 6579 7328 2929 0a0a 2020 2020  ct.keys())..    
+000090c0: 6465 6620 6765 745f 646f 6375 6d65 6e74  def get_document
+000090d0: 6174 696f 6e28 7365 6c66 2c20 7061 7261  ation(self, para
+000090e0: 6d65 7465 723a 2073 7472 203d 204e 6f6e  meter: str = Non
+000090f0: 6529 202d 3e20 6469 6374 3a0a 2020 2020  e) -> dict:.    
+00009100: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00009110: 5265 7472 6965 7665 2064 6f63 756d 656e  Retrieve documen
+00009120: 7461 7469 6f6e 2066 6f72 2061 2070 6172  tation for a par
+00009130: 616d 6574 6572 2e20 4966 206e 6f20 7061  ameter. If no pa
+00009140: 7261 6d65 7465 7220 6973 2073 7065 6369  rameter is speci
+00009150: 6669 6564 2c0a 2020 2020 2020 2020 7265  fied,.        re
+00009160: 7475 726e 2064 6f63 756d 656e 7461 7469  turn documentati
+00009170: 6f6e 2066 6f72 2061 6c6c 2070 6172 616d  on for all param
+00009180: 6574 6572 732e 0a20 2020 2020 2020 2022  eters..        "
+00009190: 2222 0a20 2020 2020 2020 2069 6620 7061  "".        if pa
+000091a0: 7261 6d65 7465 723a 0a20 2020 2020 2020  rameter:.       
+000091b0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+000091c0: 2e64 6f63 756d 656e 7461 7469 6f6e 5f64  .documentation_d
+000091d0: 6963 742e 6765 7428 7061 7261 6d65 7465  ict.get(paramete
+000091e0: 722c 207b 7d29 0a20 2020 2020 2020 2065  r, {}).        e
+000091f0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00009200: 2072 6574 7572 6e20 7365 6c66 2e64 6f63   return self.doc
+00009210: 756d 656e 7461 7469 6f6e 5f64 6963 740a  umentation_dict.
+00009220: 0a20 2020 2064 6566 2070 7269 6e74 5f64  .    def print_d
+00009230: 6f63 756d 656e 7461 7469 6f6e 5f74 6162  ocumentation_tab
+00009240: 6c65 2873 656c 662c 2070 6172 616d 6574  le(self, paramet
+00009250: 6572 3a20 7374 7220 3d20 4e6f 6e65 2920  er: str = None) 
+00009260: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+00009270: 2022 2222 0a20 2020 2020 2020 2050 7269   """.        Pri
+00009280: 6e74 2064 6f63 756d 656e 7461 7469 6f6e  nt documentation
+00009290: 2066 6f72 2061 2070 6172 616d 6574 6572   for a parameter
+000092a0: 2e20 4966 206e 6f20 7061 7261 6d65 7465  . If no paramete
+000092b0: 7220 6973 2073 7065 6369 6669 6564 2c0a  r is specified,.
+000092c0: 2020 2020 2020 2020 7072 696e 7420 646f          print do
+000092d0: 6375 6d65 6e74 6174 696f 6e20 666f 7220  cumentation for 
+000092e0: 616c 6c20 7061 7261 6d65 7465 7273 2e0a  all parameters..
+000092f0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00009300: 2020 2020 6966 2070 6172 616d 6574 6572      if parameter
+00009310: 3a0a 2020 2020 2020 2020 2020 2020 696e  :.            in
+00009320: 666f 203d 2073 656c 662e 6765 745f 646f  fo = self.get_do
+00009330: 6375 6d65 6e74 6174 696f 6e28 7061 7261  cumentation(para
+00009340: 6d65 7465 7229 0a20 2020 2020 2020 2065  meter).        e
+00009350: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00009360: 2069 6e66 6f20 3d20 7365 6c66 2e67 6574   info = self.get
+00009370: 5f64 6f63 756d 656e 7461 7469 6f6e 2829  _documentation()
+00009380: 0a20 2020 2020 2020 2066 6f72 206b 6579  .        for key
+00009390: 2c20 7661 6c75 6520 696e 2069 6e66 6f2e  , value in info.
+000093a0: 6974 656d 7328 293a 0a20 2020 2020 2020  items():.       
+000093b0: 2020 2020 206b 6579 203d 206b 6579 2e72       key = key.r
+000093c0: 6570 6c61 6365 2822 5f22 2c20 2220 2229  eplace("_", " ")
+000093d0: 2e63 6170 6974 616c 697a 6528 290a 2020  .capitalize().  
+000093e0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+000093f0: 6622 2d20 7b6b 6579 7d3a 207b 7661 6c75  f"- {key}: {valu
+00009400: 657d 2229 0a0a 2020 2020 6465 6620 746f  e}")..    def to
+00009410: 5f64 6963 7428 7365 6c66 2c20 696e 636c  _dict(self, incl
+00009420: 7564 655f 7072 6976 6174 653a 2062 6f6f  ude_private: boo
+00009430: 6c20 3d20 4661 6c73 6529 202d 3e20 6469  l = False) -> di
+00009440: 6374 3a0a 2020 2020 2020 2020 2222 220a  ct:.        """.
+00009450: 2020 2020 2020 2020 436f 6e76 6572 7420          Convert 
+00009460: 7468 6520 6f62 6a65 6374 2074 6f20 6120  the object to a 
+00009470: 6469 6374 696f 6e61 7279 2c20 6578 636c  dictionary, excl
+00009480: 7564 696e 6720 6174 7472 6962 7574 6573  uding attributes
+00009490: 2074 6861 7420 7374 6172 740a 2020 2020   that start.    
+000094a0: 2020 2020 7769 7468 2061 6e20 756e 6465      with an unde
+000094b0: 7273 636f 7265 2e0a 0a20 2020 2020 2020  rscore...       
+000094c0: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
+000094d0: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
+000094e0: 2064 6963 740a 2020 2020 2020 2020 2020   dict.          
+000094f0: 2020 4469 6374 696f 6e61 7279 2072 6570    Dictionary rep
+00009500: 7265 7365 6e74 6174 696f 6e20 6f66 2074  resentation of t
+00009510: 6865 206f 626a 6563 742e 0a20 2020 2020  he object..     
+00009520: 2020 2022 2222 0a20 2020 2020 2020 2061     """.        a
+00009530: 6c6c 5f66 6965 6c64 7320 3d20 7365 6c66  ll_fields = self
+00009540: 2e6d 6f64 656c 5f64 756d 7028 0a20 2020  .model_dump(.   
+00009550: 2020 2020 2020 2020 2065 7863 6c75 6465           exclude
+00009560: 3d7b 226e 616d 6522 2c20 225f 6578 7465  ={"name", "_exte
+00009570: 6e73 696f 6e22 2c20 225f 6669 6c65 6e61  nsion", "_filena
+00009580: 6d65 222c 2022 646f 6375 6d65 6e74 6174  me", "documentat
+00009590: 696f 6e5f 6469 6374 227d 0a20 2020 2020  ion_dict"}.     
+000095a0: 2020 2029 0a20 2020 2020 2020 2069 6620     ).        if 
+000095b0: 696e 636c 7564 655f 7072 6976 6174 653a  include_private:
+000095c0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+000095d0: 7572 6e20 616c 6c5f 6669 656c 6473 0a20  urn all_fields. 
+000095e0: 2020 2020 2020 2072 6574 7572 6e20 7b0a         return {.
+000095f0: 2020 2020 2020 2020 2020 2020 6b65 793a              key:
+00009600: 2076 616c 7565 2066 6f72 206b 6579 2c20   value for key, 
+00009610: 7661 6c75 6520 696e 2061 6c6c 5f66 6965  value in all_fie
+00009620: 6c64 732e 6974 656d 7328 2920 6966 206e  lds.items() if n
+00009630: 6f74 206b 6579 2e73 7461 7274 7377 6974  ot key.startswit
+00009640: 6828 225f 2229 0a20 2020 2020 2020 207d  h("_").        }
+00009650: 0a0a 2020 2020 6465 6620 746f 5f66 696c  ..    def to_fil
+00009660: 6528 7365 6c66 2c20 6469 7265 6374 6f72  e(self, director
+00009670: 793a 2050 6174 682c 2076 6572 7369 6f6e  y: Path, version
+00009680: 3a20 7374 7220 3d20 226c 6174 6573 7422  : str = "latest"
+00009690: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+000096a0: 2020 2020 2020 2057 7269 7465 2074 6865         Write the
+000096b0: 2069 6e70 7574 2066 696c 6520 746f 2061   input file to a
+000096c0: 2073 7065 6369 6669 6564 2064 6972 6563   specified direc
+000096d0: 746f 7279 2e0a 0a20 2020 2020 2020 2041  tory...        A
+000096e0: 7474 7269 6275 7465 730a 2020 2020 2020  ttributes.      
+000096f0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+00009700: 2020 2020 2064 6972 6563 746f 7279 203a       directory :
+00009710: 2050 6174 680a 2020 2020 2020 2020 2020   Path.          
+00009720: 2020 4469 7265 6374 6f72 7920 746f 2077    Directory to w
+00009730: 7269 7465 2074 6865 2069 6e70 7574 2066  rite the input f
+00009740: 696c 6520 746f 2e0a 2020 2020 2020 2020  ile to..        
+00009750: 7665 7273 696f 6e20 3a20 7374 720a 2020  version : str.  
+00009760: 2020 2020 2020 2020 2020 5665 7273 696f            Versio
+00009770: 6e20 6f66 2074 6865 2069 6e70 7574 2066  n of the input f
+00009780: 696c 6520 746f 2077 7269 7465 2e20 4465  ile to write. De
+00009790: 6661 756c 7420 6973 2022 6c61 7465 7374  fault is "latest
+000097a0: 222e 0a20 2020 2020 2020 2022 2222 0a20  "..        """. 
+000097b0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+000097c0: 616e 6365 2864 6972 6563 746f 7279 2c20  ance(directory, 
+000097d0: 7374 7229 3a0a 2020 2020 2020 2020 2020  str):.          
+000097e0: 2020 6469 7265 6374 6f72 7920 3d20 5061    directory = Pa
+000097f0: 7468 2864 6972 6563 746f 7279 290a 0a20  th(directory).. 
+00009800: 2020 2020 2020 2076 6572 7369 6f6e 203d         version =
+00009810: 205f 7661 6c69 6461 7465 5f61 6e64 5f72   _validate_and_r
+00009820: 6574 7572 6e5f 7665 7273 696f 6e28 7665  eturn_version(ve
+00009830: 7273 696f 6e29 0a0a 2020 2020 2020 2020  rsion)..        
+00009840: 7465 6d70 6c61 7465 5f66 696c 655f 7061  template_file_pa
+00009850: 7468 203d 2054 454d 504c 4154 4553 5f50  th = TEMPLATES_P
+00009860: 4154 4820 2f20 7665 7273 696f 6e20 2f20  ATH / version / 
+00009870: 6622 7b73 656c 662e 5f66 696c 656e 616d  f"{self._filenam
+00009880: 657d 220a 2020 2020 2020 2020 7769 7468  e}".        with
+00009890: 206f 7065 6e28 7465 6d70 6c61 7465 5f66   open(template_f
+000098a0: 696c 655f 7061 7468 2c20 2272 2229 2061  ile_path, "r") a
+000098b0: 7320 6674 656d 703a 0a20 2020 2020 2020  s ftemp:.       
+000098c0: 2020 2020 2073 7263 203d 2054 656d 706c       src = Templ
+000098d0: 6174 6528 6674 656d 702e 7265 6164 2829  ate(ftemp.read()
+000098e0: 290a 0a20 2020 2020 2020 2072 6573 756c  )..        resul
+000098f0: 7420 3d20 7372 632e 7375 6273 7469 7475  t = src.substitu
+00009900: 7465 2873 656c 662e 746f 5f64 6963 7428  te(self.to_dict(
+00009910: 696e 636c 7564 655f 7072 6976 6174 653d  include_private=
+00009920: 5472 7565 2929 0a0a 2020 2020 2020 2020  True))..        
+00009930: 6f75 7470 7574 5f66 696c 655f 7061 7468  output_file_path
+00009940: 203d 2064 6972 6563 746f 7279 202f 2073   = directory / s
+00009950: 656c 662e 5f66 696c 656e 616d 650a 2020  elf._filename.  
+00009960: 2020 2020 2020 7769 7468 206f 7065 6e28        with open(
+00009970: 6f75 7470 7574 5f66 696c 655f 7061 7468  output_file_path
+00009980: 2c20 2277 2229 2061 7320 666f 7574 3a0a  , "w") as fout:.
+00009990: 2020 2020 2020 2020 2020 2020 666f 7574              fout
+000099a0: 2e77 7269 7465 2872 6573 756c 7429 0a0a  .write(result)..
+000099b0: 2020 2020 4063 6c61 7373 6d65 7468 6f64      @classmethod
+000099c0: 0a20 2020 2064 6566 2066 726f 6d5f 6469  .    def from_di
+000099d0: 6374 2863 6c73 2c20 6461 7461 3a20 6469  ct(cls, data: di
+000099e0: 6374 293a 0a20 2020 2020 2020 2072 6574  ct):.        ret
+000099f0: 7572 6e20 636c 7328 2a2a 6461 7461 290a  urn cls(**data).
+00009a00: 0a0a 2320 544f 444f 3a20 556e 6966 7920  ..# TODO: Unify 
+00009a10: 636c 6173 7320 6e61 6d69 6e67 0a0a 0a63  class naming...c
+00009a20: 6c61 7373 2047 7269 646c 6973 7428 496e  lass Gridlist(In
+00009a30: 7075 7446 696c 6529 3a0a 2020 2020 2222  putFile):.    ""
+00009a40: 220a 2020 2020 436c 6173 7320 7265 7072  ".    Class repr
+00009a50: 6573 656e 7469 6e67 2074 6865 2067 7269  esenting the gri
+00009a60: 646c 6973 742e 7478 7420 6669 6c65 2e20  dlist.txt file. 
+00009a70: 5468 6973 2066 696c 6520 636f 6e74 6169  This file contai
+00009a80: 6e73 2074 6865 2067 7269 640a 2020 2020  ns the grid.    
+00009a90: 696e 666f 726d 6174 696f 6e20 666f 7220  information for 
+00009aa0: 7468 6520 5155 4943 2d46 6972 6520 7369  the QUIC-Fire si
+00009ab0: 6d75 6c61 7469 6f6e 2077 6865 6e20 6361  mulation when ca
+00009ac0: 6e6f 7069 6573 2061 7265 2070 7265 7365  nopies are prese
+00009ad0: 6e74 2e0a 0a20 2020 2041 7474 7269 6275  nt...    Attribu
+00009ae0: 7465 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  tes.    --------
+00009af0: 2d2d 0a20 2020 206e 203a 2069 6e74 0a20  --.    n : int. 
+00009b00: 2020 2020 2020 204e 756d 6265 7220 6f66         Number of
+00009b10: 2063 656c 6c73 2069 6e20 7468 6520 782d   cells in the x-
+00009b20: 6469 7265 6374 696f 6e20 5b2d 5d0a 2020  direction [-].  
+00009b30: 2020 6d20 3a20 696e 740a 2020 2020 2020    m : int.      
+00009b40: 2020 4e75 6d62 6572 206f 6620 6365 6c6c    Number of cell
+00009b50: 7320 696e 2074 6865 2079 2d64 6972 6563  s in the y-direc
+00009b60: 7469 6f6e 205b 2d5d 0a20 2020 206c 203a  tion [-].    l :
+00009b70: 2069 6e74 0a20 2020 2020 2020 204e 756d   int.        Num
+00009b80: 6265 7220 6f66 2063 656c 6c73 2069 6e20  ber of cells in 
+00009b90: 7468 6520 7a2d 6469 7265 6374 696f 6e20  the z-direction 
+00009ba0: 5b2d 5d0a 2020 2020 6478 203a 2066 6c6f  [-].    dx : flo
+00009bb0: 6174 0a20 2020 2020 2020 2043 656c 6c20  at.        Cell 
+00009bc0: 7369 7a65 2069 6e20 7468 6520 782d 6469  size in the x-di
+00009bd0: 7265 6374 696f 6e20 5b6d 5d0a 2020 2020  rection [m].    
+00009be0: 6479 203a 2066 6c6f 6174 0a20 2020 2020  dy : float.     
+00009bf0: 2020 2043 656c 6c20 7369 7a65 2069 6e20     Cell size in 
+00009c00: 7468 6520 792d 6469 7265 6374 696f 6e20  the y-direction 
+00009c10: 5b6d 5d0a 2020 2020 647a 203a 2066 6c6f  [m].    dz : flo
+00009c20: 6174 0a20 2020 2020 2020 2043 656c 6c20  at.        Cell 
+00009c30: 7369 7a65 2069 6e20 7468 6520 7a2d 6469  size in the z-di
+00009c40: 7265 6374 696f 6e20 5b6d 5d0a 2020 2020  rection [m].    
+00009c50: 6161 3120 3a20 666c 6f61 740a 2020 2020  aa1 : float.    
+00009c60: 2020 2020 5374 7265 7463 6869 6e67 2066      Stretching f
+00009c70: 6163 746f 7220 666f 7220 7468 6520 7665  actor for the ve
+00009c80: 7274 6963 616c 2067 7269 6420 7370 6163  rtical grid spac
+00009c90: 696e 6720 5b2d 5d0a 2020 2020 2222 220a  ing [-].    """.
+00009ca0: 0a20 2020 206e 616d 653a 2073 7472 203d  .    name: str =
+00009cb0: 2046 6965 6c64 2822 6772 6964 6c69 7374   Field("gridlist
+00009cc0: 222c 2066 726f 7a65 6e3d 5472 7565 290a  ", frozen=True).
+00009cd0: 2020 2020 5f65 7874 656e 7369 6f6e 3a20      _extension: 
+00009ce0: 7374 7220 3d20 2222 0a20 2020 206e 3a20  str = "".    n: 
+00009cf0: 506f 7369 7469 7665 496e 740a 2020 2020  PositiveInt.    
+00009d00: 6d3a 2050 6f73 6974 6976 6549 6e74 0a20  m: PositiveInt. 
+00009d10: 2020 206c 3a20 506f 7369 7469 7665 496e     l: PositiveIn
+00009d20: 740a 2020 2020 6478 3a20 506f 7369 7469  t.    dx: Positi
+00009d30: 7665 466c 6f61 7420 3d20 320a 2020 2020  veFloat = 2.    
+00009d40: 6479 3a20 506f 7369 7469 7665 466c 6f61  dy: PositiveFloa
+00009d50: 7420 3d20 320a 2020 2020 647a 3a20 506f  t = 2.    dz: Po
+00009d60: 7369 7469 7665 466c 6f61 7420 3d20 310a  sitiveFloat = 1.
+00009d70: 2020 2020 6161 313a 2050 6f73 6974 6976      aa1: Positiv
+00009d80: 6546 6c6f 6174 203d 2031 2e30 0a0a 2020  eFloat = 1.0..  
+00009d90: 2020 4063 6c61 7373 6d65 7468 6f64 0a20    @classmethod. 
+00009da0: 2020 2064 6566 2066 726f 6d5f 6669 6c65     def from_file
+00009db0: 2863 6c73 2c20 6469 7265 6374 6f72 793a  (cls, directory:
+00009dc0: 2073 7472 207c 2050 6174 682c 202a 2a6b   str | Path, **k
+00009dd0: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
+00009de0: 2222 220a 2020 2020 2020 2020 496e 6974  """.        Init
+00009df0: 6961 6c69 7a65 7320 6120 4772 6964 6c69  ializes a Gridli
+00009e00: 7374 206f 626a 6563 7420 6672 6f6d 2061  st object from a
+00009e10: 2064 6972 6563 746f 7279 2063 6f6e 7461   directory conta
+00009e20: 696e 696e 6720 610a 2020 2020 2020 2020  ining a.        
+00009e30: 6772 6964 6c69 7374 2e74 7874 2066 696c  gridlist.txt fil
+00009e40: 652e 0a20 2020 2020 2020 2022 2222 0a20  e..        """. 
+00009e50: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+00009e60: 616e 6365 2864 6972 6563 746f 7279 2c20  ance(directory, 
+00009e70: 7374 7229 3a0a 2020 2020 2020 2020 2020  str):.          
+00009e80: 2020 6469 7265 6374 6f72 7920 3d20 5061    directory = Pa
+00009e90: 7468 2864 6972 6563 746f 7279 290a 2020  th(directory).  
+00009ea0: 2020 2020 2020 7769 7468 206f 7065 6e28        with open(
+00009eb0: 6469 7265 6374 6f72 7920 2f20 2267 7269  directory / "gri
+00009ec0: 646c 6973 7422 2c20 2272 2229 2061 7320  dlist", "r") as 
+00009ed0: 663a 0a20 2020 2020 2020 2020 2020 206c  f:.            l
+00009ee0: 696e 6573 203d 2066 2e72 6561 6428 290a  ines = f.read().
+00009ef0: 0a20 2020 2020 2020 2074 7279 3a0a 2020  .        try:.  
+00009f00: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00009f10: 2063 6c73 280a 2020 2020 2020 2020 2020   cls(.          
+00009f20: 2020 2020 2020 6e3d 696e 7428 6c69 6e65        n=int(line
+00009f30: 732e 7370 6c69 7428 226e 3d22 295b 315d  s.split("n=")[1]
+00009f40: 2e73 706c 6974 2829 5b30 5d29 2c0a 2020  .split()[0]),.  
+00009f50: 2020 2020 2020 2020 2020 2020 2020 6d3d                m=
+00009f60: 696e 7428 6c69 6e65 732e 7370 6c69 7428  int(lines.split(
+00009f70: 226d 3d22 295b 315d 2e73 706c 6974 2829  "m=")[1].split()
+00009f80: 5b30 5d29 2c0a 2020 2020 2020 2020 2020  [0]),.          
+00009f90: 2020 2020 2020 6c3d 696e 7428 6c69 6e65        l=int(line
+00009fa0: 732e 7370 6c69 7428 226c 3d22 295b 315d  s.split("l=")[1]
+00009fb0: 2e73 706c 6974 2829 5b30 5d29 2c0a 2020  .split()[0]),.  
+00009fc0: 2020 2020 2020 2020 2020 2020 2020 6478                dx
+00009fd0: 3d66 6c6f 6174 286c 696e 6573 2e73 706c  =float(lines.spl
+00009fe0: 6974 2822 6478 3d22 295b 315d 2e73 706c  it("dx=")[1].spl
+00009ff0: 6974 2829 5b30 5d29 2c0a 2020 2020 2020  it()[0]),.      
+0000a000: 2020 2020 2020 2020 2020 6479 3d66 6c6f            dy=flo
+0000a010: 6174 286c 696e 6573 2e73 706c 6974 2822  at(lines.split("
+0000a020: 6479 3d22 295b 315d 2e73 706c 6974 2829  dy=")[1].split()
+0000a030: 5b30 5d29 2c0a 2020 2020 2020 2020 2020  [0]),.          
+0000a040: 2020 2020 2020 647a 3d66 6c6f 6174 286c        dz=float(l
+0000a050: 696e 6573 2e73 706c 6974 2822 647a 3d22  ines.split("dz="
+0000a060: 295b 315d 2e73 706c 6974 2829 5b30 5d29  )[1].split()[0])
+0000a070: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000a080: 2020 6161 313d 666c 6f61 7428 6c69 6e65    aa1=float(line
+0000a090: 732e 7370 6c69 7428 2261 6131 3d22 295b  s.split("aa1=")[
+0000a0a0: 315d 2e73 706c 6974 2829 5b30 5d29 2c0a  1].split()[0]),.
+0000a0b0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0000a0c0: 2020 2020 2020 6578 6365 7074 2049 6e64        except Ind
+0000a0d0: 6578 4572 726f 723a 0a20 2020 2020 2020  exError:.       
+0000a0e0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+0000a0f0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+0000a100: 2020 2020 2020 2066 2245 7272 6f72 2070         f"Error p
+0000a110: 6172 7369 6e67 207b 636c 732e 5f5f 6e61  arsing {cls.__na
+0000a120: 6d65 5f5f 7d20 6672 6f6d 2066 696c 653a  me__} from file:
+0000a130: 2067 7269 646c 6973 7422 0a20 2020 2020   gridlist".     
+0000a140: 2020 2020 2020 2020 2020 2066 225c 6e50             f"\nP
+0000a150: 6c65 6173 6520 6368 6563 6b20 7468 6520  lease check the 
+0000a160: 6669 6c65 2066 6f72 2063 6f72 7265 6374  file for correct
+0000a170: 6e65 7373 2e22 0a20 2020 2020 2020 2020  ness.".         
+0000a180: 2020 2029 0a0a 0a63 6c61 7373 2052 6173     )...class Ras
+0000a190: 7465 724f 7269 6769 6e28 496e 7075 7446  terOrigin(InputF
+0000a1a0: 696c 6529 3a0a 2020 2020 2222 220a 2020  ile):.    """.  
+0000a1b0: 2020 436c 6173 7320 7265 7072 6573 656e    Class represen
+0000a1c0: 7469 6e67 2074 6865 2072 6173 7465 726f  ting the rastero
+0000a1d0: 7269 6769 6e2e 7478 7420 6669 6c65 2e20  rigin.txt file. 
+0000a1e0: 5468 6973 2066 696c 6520 636f 6e74 6169  This file contai
+0000a1f0: 6e73 2074 6865 0a20 2020 2063 6f6f 7264  ns the.    coord
+0000a200: 696e 6174 6573 206f 6620 7468 6520 736f  inates of the so
+0000a210: 7574 682d 7765 7374 2063 6f72 6e65 7220  uth-west corner 
+0000a220: 6f66 2074 6865 2064 6f6d 6169 6e20 696e  of the domain in
+0000a230: 2055 544d 2063 6f6f 7264 696e 6174 6573   UTM coordinates
+0000a240: 2e0a 0a20 2020 2041 7474 7269 6275 7465  ...    Attribute
+0000a250: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
+0000a260: 0a20 2020 2075 746d 5f78 203a 2066 6c6f  .    utm_x : flo
+0000a270: 6174 0a20 2020 2020 2020 2055 544d 2d78  at.        UTM-x
+0000a280: 2063 6f6f 7264 696e 6174 6573 206f 6620   coordinates of 
+0000a290: 7468 6520 736f 7574 682d 7765 7374 2063  the south-west c
+0000a2a0: 6f72 6e65 7220 6f66 2064 6f6d 6169 6e20  orner of domain 
+0000a2b0: 5b6d 5d0a 2020 2020 7574 6d5f 7920 3a20  [m].    utm_y : 
+0000a2c0: 666c 6f61 740a 2020 2020 2020 2020 5554  float.        UT
+0000a2d0: 4d2d 7920 636f 6f72 6469 6e61 7465 7320  M-y coordinates 
+0000a2e0: 6f66 2074 6865 2073 6f75 7468 2d77 6573  of the south-wes
+0000a2f0: 7420 636f 726e 6572 206f 6620 646f 6d61  t corner of doma
+0000a300: 696e 205b 6d5d 0a20 2020 2022 2222 0a0a  in [m].    """..
+0000a310: 2020 2020 6e61 6d65 3a20 7374 7220 3d20      name: str = 
+0000a320: 4669 656c 6428 2272 6173 7465 726f 7269  Field("rasterori
+0000a330: 6769 6e22 2c20 6672 6f7a 656e 3d54 7275  gin", frozen=Tru
+0000a340: 6529 0a20 2020 205f 6578 7465 6e73 696f  e).    _extensio
+0000a350: 6e3a 2073 7472 203d 2022 2e74 7874 220a  n: str = ".txt".
+0000a360: 2020 2020 7574 6d5f 783a 204e 6f6e 4e65      utm_x: NonNe
+0000a370: 6761 7469 7665 466c 6f61 7420 3d20 302e  gativeFloat = 0.
+0000a380: 300a 2020 2020 7574 6d5f 793a 204e 6f6e  0.    utm_y: Non
+0000a390: 4e65 6761 7469 7665 466c 6f61 7420 3d20  NegativeFloat = 
+0000a3a0: 302e 300a 0a20 2020 2040 636c 6173 736d  0.0..    @classm
+0000a3b0: 6574 686f 640a 2020 2020 6465 6620 6672  ethod.    def fr
+0000a3c0: 6f6d 5f66 696c 6528 636c 732c 2064 6972  om_file(cls, dir
+0000a3d0: 6563 746f 7279 3a20 7374 7220 7c20 5061  ectory: str | Pa
+0000a3e0: 7468 2c20 2a2a 6b77 6172 6773 293a 0a20  th, **kwargs):. 
+0000a3f0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0000a400: 2020 2049 6e69 7469 616c 697a 6573 2061     Initializes a
+0000a410: 2052 6173 7465 724f 7269 6769 6e20 6f62   RasterOrigin ob
+0000a420: 6a65 6374 2066 726f 6d20 6120 6469 7265  ject from a dire
+0000a430: 6374 6f72 7920 636f 6e74 6169 6e69 6e67  ctory containing
+0000a440: 2061 0a20 2020 2020 2020 2072 6173 7465   a.        raste
+0000a450: 726f 7269 6769 6e2e 7478 7420 6669 6c65  rorigin.txt file
+0000a460: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+0000a470: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+0000a480: 6e63 6528 6469 7265 6374 6f72 792c 2073  nce(directory, s
+0000a490: 7472 293a 0a20 2020 2020 2020 2020 2020  tr):.           
+0000a4a0: 2064 6972 6563 746f 7279 203d 2050 6174   directory = Pat
+0000a4b0: 6828 6469 7265 6374 6f72 7929 0a20 2020  h(directory).   
+0000a4c0: 2020 2020 2077 6974 6820 6f70 656e 2864       with open(d
+0000a4d0: 6972 6563 746f 7279 202f 2022 7261 7374  irectory / "rast
+0000a4e0: 6572 6f72 6967 696e 2e74 7874 222c 2022  erorigin.txt", "
+0000a4f0: 7222 2920 6173 2066 3a0a 2020 2020 2020  r") as f:.      
+0000a500: 2020 2020 2020 6c69 6e65 7320 3d20 662e        lines = f.
+0000a510: 7265 6164 6c69 6e65 7328 290a 2020 2020  readlines().    
+0000a520: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+0000a530: 2020 2020 2072 6574 7572 6e20 636c 7328       return cls(
+0000a540: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a550: 2075 746d 5f78 3d66 6c6f 6174 286c 696e   utm_x=float(lin
+0000a560: 6573 5b30 5d2e 7370 6c69 7428 295b 305d  es[0].split()[0]
+0000a570: 292c 2075 746d 5f79 3d66 6c6f 6174 286c  ), utm_y=float(l
+0000a580: 696e 6573 5b31 5d2e 7370 6c69 7428 295b  ines[1].split()[
+0000a590: 305d 290a 2020 2020 2020 2020 2020 2020  0]).            
+0000a5a0: 290a 2020 2020 2020 2020 6578 6365 7074  ).        except
+0000a5b0: 2049 6e64 6578 4572 726f 723a 0a20 2020   IndexError:.   
+0000a5c0: 2020 2020 2020 2020 2023 204f 7074 696f           # Optio
+0000a5d0: 6e61 6c20 6669 6c65 2c20 7265 7475 726e  nal file, return
+0000a5e0: 2064 6566 6175 6c74 2076 616c 7565 7320   default values 
+0000a5f0: 6966 2070 6172 7369 6e67 2066 6169 6c73  if parsing fails
+0000a600: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0000a610: 7572 6e20 636c 7328 290a 0a0a 636c 6173  urn cls()...clas
+0000a620: 7320 5155 5f42 7569 6c64 696e 6773 2849  s QU_Buildings(I
+0000a630: 6e70 7574 4669 6c65 293a 0a20 2020 2022  nputFile):.    "
+0000a640: 2222 0a20 2020 2043 6c61 7373 2072 6570  "".    Class rep
+0000a650: 7265 7365 6e74 696e 6720 7468 6520 5155  resenting the QU
+0000a660: 5f62 7569 6c64 696e 6773 2e69 6e70 2066  _buildings.inp f
+0000a670: 696c 652e 2054 6869 7320 6669 6c65 2063  ile. This file c
+0000a680: 6f6e 7461 696e 7320 7468 650a 2020 2020  ontains the.    
+0000a690: 6275 696c 6469 6e67 2d72 656c 6174 6564  building-related
+0000a6a0: 2064 6174 6120 666f 7220 7468 6520 5155   data for the QU
+0000a6b0: 4943 2d46 6972 6520 7369 6d75 6c61 7469  IC-Fire simulati
+0000a6c0: 6f6e 2e20 5468 6973 2063 6c61 7373 2069  on. This class i
+0000a6d0: 7320 6e6f 740a 2020 2020 6375 7272 656e  s not.    curren
+0000a6e0: 746c 7920 7573 6564 2069 6e20 5155 4943  tly used in QUIC
+0000a6f0: 2d46 6972 652e 0a0a 2020 2020 4174 7472  -Fire...    Attr
+0000a700: 6962 7574 6573 0a20 2020 202d 2d2d 2d2d  ibutes.    -----
+0000a710: 2d2d 2d2d 2d0a 2020 2020 7761 6c6c 5f72  -----.    wall_r
+0000a720: 6f75 6768 6e65 7373 5f6c 656e 6774 6820  oughness_length 
+0000a730: 3a20 666c 6f61 740a 2020 2020 2020 2020  : float.        
+0000a740: 5761 6c6c 2072 6f75 6768 6e65 7373 206c  Wall roughness l
+0000a750: 656e 6774 6820 5b6d 5d2e 204d 7573 7420  ength [m]. Must 
+0000a760: 6265 2067 7265 6174 6572 2074 6861 6e20  be greater than 
+0000a770: 302e 2044 6566 6175 6c74 2069 7320 302e  0. Default is 0.
+0000a780: 312e 0a20 2020 206e 756d 6265 725f 6f66  1..    number_of
+0000a790: 5f62 7569 6c64 696e 6773 203a 2069 6e74  _buildings : int
+0000a7a0: 0a20 2020 2020 2020 204e 756d 6265 7220  .        Number 
+0000a7b0: 6f66 2062 7569 6c64 696e 6773 205b 2d5d  of buildings [-]
+0000a7c0: 2e20 4465 6661 756c 7420 6973 2030 2e20  . Default is 0. 
+0000a7d0: 4e6f 7420 6375 7272 656e 746c 7920 7573  Not currently us
+0000a7e0: 6564 2069 6e20 5155 4943 2d46 6972 652e  ed in QUIC-Fire.
+0000a7f0: 0a20 2020 206e 756d 6265 725f 6f66 5f70  .    number_of_p
+0000a800: 6f6c 7967 6f6e 5f6e 6f64 6573 203a 2069  olygon_nodes : i
+0000a810: 6e74 0a20 2020 2020 2020 204e 756d 6265  nt.        Numbe
+0000a820: 7220 6f66 2070 6f6c 7967 6f6e 2062 7569  r of polygon bui
+0000a830: 6c64 696e 6720 6e6f 6465 7320 5b2d 5d2e  lding nodes [-].
+0000a840: 2044 6566 6175 6c74 2069 7320 302e 204e   Default is 0. N
+0000a850: 6f74 2063 7572 7265 6e74 6c79 2075 7365  ot currently use
+0000a860: 640a 2020 2020 2020 2020 696e 2051 5549  d.        in QUI
+0000a870: 432d 4669 7265 2e0a 2020 2020 2222 220a  C-Fire..    """.
+0000a880: 0a20 2020 206e 616d 653a 2073 7472 203d  .    name: str =
+0000a890: 2046 6965 6c64 2822 5155 5f62 7569 6c64   Field("QU_build
+0000a8a0: 696e 6773 222c 2066 726f 7a65 6e3d 5472  ings", frozen=Tr
+0000a8b0: 7565 290a 2020 2020 5f65 7874 656e 7369  ue).    _extensi
+0000a8c0: 6f6e 3a20 7374 7220 3d20 222e 696e 7022  on: str = ".inp"
+0000a8d0: 0a20 2020 2077 616c 6c5f 726f 7567 686e  .    wall_roughn
+0000a8e0: 6573 735f 6c65 6e67 7468 3a20 506f 7369  ess_length: Posi
+0000a8f0: 7469 7665 466c 6f61 7420 3d20 302e 310a  tiveFloat = 0.1.
+0000a900: 2020 2020 6e75 6d62 6572 5f6f 665f 6275      number_of_bu
+0000a910: 696c 6469 6e67 733a 204e 6f6e 4e65 6761  ildings: NonNega
+0000a920: 7469 7665 496e 7420 3d20 300a 2020 2020  tiveInt = 0.    
+0000a930: 6e75 6d62 6572 5f6f 665f 706f 6c79 676f  number_of_polygo
+0000a940: 6e5f 6e6f 6465 733a 204e 6f6e 4e65 6761  n_nodes: NonNega
+0000a950: 7469 7665 496e 7420 3d20 300a 0a20 2020  tiveInt = 0..   
+0000a960: 2040 636c 6173 736d 6574 686f 640a 2020   @classmethod.  
+0000a970: 2020 6465 6620 6672 6f6d 5f66 696c 6528    def from_file(
+0000a980: 636c 732c 2064 6972 6563 746f 7279 3a20  cls, directory: 
+0000a990: 7374 7220 7c20 5061 7468 2c20 2a2a 6b77  str | Path, **kw
+0000a9a0: 6172 6773 293a 0a20 2020 2020 2020 2022  args):.        "
+0000a9b0: 2222 0a20 2020 2020 2020 2049 6e69 7469  "".        Initi
+0000a9c0: 616c 697a 6573 2061 2051 555f 4275 696c  alizes a QU_Buil
+0000a9d0: 6469 6e67 7320 6f62 6a65 6374 2066 726f  dings object fro
+0000a9e0: 6d20 6120 6469 7265 6374 6f72 7920 636f  m a directory co
+0000a9f0: 6e74 6169 6e69 6e67 2061 0a20 2020 2020  ntaining a.     
+0000aa00: 2020 2051 555f 6275 696c 6469 6e67 732e     QU_buildings.
+0000aa10: 696e 7020 6669 6c65 2e0a 2020 2020 2020  inp file..      
+0000aa20: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
+0000aa30: 2069 7369 6e73 7461 6e63 6528 6469 7265   isinstance(dire
+0000aa40: 6374 6f72 792c 2073 7472 293a 0a20 2020  ctory, str):.   
+0000aa50: 2020 2020 2020 2020 2064 6972 6563 746f           directo
+0000aa60: 7279 203d 2050 6174 6828 6469 7265 6374  ry = Path(direct
+0000aa70: 6f72 7929 0a20 2020 2020 2020 2077 6974  ory).        wit
+0000aa80: 6820 6f70 656e 2864 6972 6563 746f 7279  h open(directory
+0000aa90: 202f 2022 5155 5f62 7569 6c64 696e 6773   / "QU_buildings
+0000aaa0: 2e69 6e70 222c 2022 7222 2920 6173 2066  .inp", "r") as f
+0000aab0: 3a0a 2020 2020 2020 2020 2020 2020 6c69  :.            li
+0000aac0: 6e65 7320 3d20 662e 7265 6164 6c69 6e65  nes = f.readline
+0000aad0: 7328 290a 2020 2020 2020 2020 7472 793a  s().        try:
+0000aae0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0000aaf0: 7572 6e20 636c 7328 0a20 2020 2020 2020  urn cls(.       
+0000ab00: 2020 2020 2020 2020 2077 616c 6c5f 726f           wall_ro
+0000ab10: 7567 686e 6573 735f 6c65 6e67 7468 3d66  ughness_length=f
+0000ab20: 6c6f 6174 286c 696e 6573 5b31 5d2e 7370  loat(lines[1].sp
+0000ab30: 6c69 7428 295b 305d 292c 0a20 2020 2020  lit()[0]),.     
+0000ab40: 2020 2020 2020 2020 2020 206e 756d 6265             numbe
+0000ab50: 725f 6f66 5f62 7569 6c64 696e 6773 3d69  r_of_buildings=i
+0000ab60: 6e74 286c 696e 6573 5b32 5d2e 7370 6c69  nt(lines[2].spli
+0000ab70: 7428 295b 305d 292c 0a20 2020 2020 2020  t()[0]),.       
+0000ab80: 2020 2020 2020 2020 206e 756d 6265 725f           number_
+0000ab90: 6f66 5f70 6f6c 7967 6f6e 5f6e 6f64 6573  of_polygon_nodes
+0000aba0: 3d69 6e74 286c 696e 6573 5b33 5d2e 7370  =int(lines[3].sp
+0000abb0: 6c69 7428 295b 305d 292c 0a20 2020 2020  lit()[0]),.     
+0000abc0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0000abd0: 2065 7863 6570 7420 496e 6465 7845 7272   except IndexErr
+0000abe0: 6f72 3a0a 2020 2020 2020 2020 2020 2020  or:.            
+0000abf0: 2320 4f70 7469 6f6e 616c 2066 696c 652c  # Optional file,
+0000ac00: 2072 6574 7572 6e20 6465 6661 756c 7420   return default 
+0000ac10: 7661 6c75 6573 2069 6620 7061 7273 696e  values if parsin
+0000ac20: 6720 6661 696c 730a 2020 2020 2020 2020  g fails.        
+0000ac30: 2020 2020 7265 7475 726e 2063 6c73 2829      return cls()
+0000ac40: 0a0a 0a63 6c61 7373 2051 555f 4669 6c65  ...class QU_File
+0000ac50: 6f70 7469 6f6e 7328 496e 7075 7446 696c  options(InputFil
+0000ac60: 6529 3a0a 2020 2020 2222 220a 2020 2020  e):.    """.    
+0000ac70: 436c 6173 7320 7265 7072 6573 656e 7469  Class representi
+0000ac80: 6e67 2074 6865 2051 555f 6669 6c65 6f70  ng the QU_fileop
+0000ac90: 7469 6f6e 732e 696e 7020 6669 6c65 2e20  tions.inp file. 
+0000aca0: 5468 6973 2066 696c 6520 636f 6e74 6169  This file contai
+0000acb0: 6e73 0a20 2020 2066 696c 6520 6f75 7470  ns.    file outp
+0000acc0: 7574 2d72 656c 6174 6564 206f 7074 696f  ut-related optio
+0000acd0: 6e73 2066 6f72 2074 6865 2051 5549 432d  ns for the QUIC-
+0000ace0: 4669 7265 2073 696d 756c 6174 696f 6e2e  Fire simulation.
+0000acf0: 0a0a 2020 2020 4174 7472 6962 7574 6573  ..    Attributes
+0000ad00: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
+0000ad10: 2020 2020 6f75 7470 7574 5f64 6174 615f      output_data_
+0000ad20: 6669 6c65 5f66 6f72 6d61 745f 666c 6167  file_format_flag
+0000ad30: 203a 2069 6e74 0a20 2020 2020 2020 204f   : int.        O
+0000ad40: 7574 7075 7420 6461 7461 2066 696c 6520  utput data file 
+0000ad50: 666f 726d 6174 2066 6c61 672e 2056 616c  format flag. Val
+0000ad60: 7565 7320 6163 6365 7074 6564 2061 7265  ues accepted are
+0000ad70: 205b 312c 2032 2c20 335d 2e0a 2020 2020   [1, 2, 3]..    
+0000ad80: 2020 2020 5265 636f 6d6d 656e 6465 6420      Recommended 
+0000ad90: 7661 6c75 6520 322e 2031 202d 2062 696e  value 2. 1 - bin
+0000ada0: 6172 792c 2032 202d 2041 5343 4949 2c20  ary, 2 - ASCII, 
+0000adb0: 3320 2d20 626f 7468 2e0a 2020 2020 6e6f  3 - both..    no
+0000adc0: 6e5f 6d61 7373 5f63 6f6e 7365 7276 6564  n_mass_conserved
+0000add0: 5f69 6e69 7469 616c 5f66 6965 6c64 5f66  _initial_field_f
+0000ade0: 6c61 6720 3a20 696e 740a 2020 2020 2020  lag : int.      
+0000adf0: 2020 466c 6167 2074 6f20 7772 6974 6520    Flag to write 
+0000ae00: 6f75 7420 6e6f 6e2d 6d61 7373 2063 6f6e  out non-mass con
+0000ae10: 7365 7276 6564 2069 6e69 7469 616c 2066  served initial f
+0000ae20: 6965 6c64 2066 696c 6520 756f 6669 656c  ield file uofiel
+0000ae30: 642e 6461 742e 0a20 2020 2020 2020 2056  d.dat..        V
+0000ae40: 616c 7565 7320 6163 6365 7074 6564 2061  alues accepted a
+0000ae50: 7265 205b 302c 2031 5d2e 2052 6563 6f6d  re [0, 1]. Recom
+0000ae60: 6d65 6e64 6564 2076 616c 7565 2030 2e20  mended value 0. 
+0000ae70: 3020 2d20 6f66 662c 2031 202d 206f 6e2e  0 - off, 1 - on.
+0000ae80: 0a20 2020 2069 6e69 7469 616c 5f73 656e  .    initial_sen
+0000ae90: 736f 725f 7665 6c6f 6369 7479 5f66 6965  sor_velocity_fie
+0000aea0: 6c64 5f66 6c61 6720 3a20 696e 740a 2020  ld_flag : int.  
+0000aeb0: 2020 2020 2020 466c 6167 2074 6f20 7772        Flag to wr
+0000aec0: 6974 6520 6f75 7420 7468 6520 6669 6c65  ite out the file
+0000aed0: 2075 6f73 656e 736f 7266 6965 6c64 2e64   uosensorfield.d
+0000aee0: 6174 2e20 5661 6c75 6573 2061 6363 6570  at. Values accep
+0000aef0: 7465 6420 6172 650a 2020 2020 2020 2020  ted are.        
+0000af00: 5b30 2c20 315d 2e20 5265 636f 6d6d 656e  [0, 1]. Recommen
+0000af10: 6465 6420 7661 6c75 6520 302e 2030 202d  ded value 0. 0 -
+0000af20: 206f 6666 2c20 3120 2d20 6f6e 2e0a 2020   off, 1 - on..  
+0000af30: 2020 7175 5f73 7461 6767 6572 6564 5f76    qu_staggered_v
+0000af40: 656c 6f63 6974 795f 6669 6c65 5f66 6c61  elocity_file_fla
+0000af50: 6720 3a20 696e 740a 2020 2020 2020 2020  g : int.        
+0000af60: 466c 6167 2074 6f20 7772 6974 6520 6f75  Flag to write ou
+0000af70: 7420 7468 6520 6669 6c65 2051 555f 7374  t the file QU_st
+0000af80: 6167 6765 7265 645f 7665 6c6f 6369 7479  aggered_velocity
+0000af90: 2e62 696e 2e20 5661 6c75 6573 2061 6363  .bin. Values acc
+0000afa0: 6570 7465 640a 2020 2020 2020 2020 6172  epted.        ar
+0000afb0: 6520 5b30 2c20 315d 2e20 5265 636f 6d6d  e [0, 1]. Recomm
+0000afc0: 656e 6465 6420 7661 6c75 6520 302e 2030  ended value 0. 0
+0000afd0: 202d 206f 6666 2c20 3120 2d20 6f6e 2e0a   - off, 1 - on..
+0000afe0: 2020 2020 6765 6e65 7261 7465 5f77 696e      generate_win
+0000aff0: 645f 7374 6172 7475 705f 6669 6c65 735f  d_startup_files_
+0000b000: 666c 6167 203a 2069 6e74 0a20 2020 2020  flag : int.     
+0000b010: 2020 2047 656e 6572 6174 6520 7769 6e64     Generate wind
+0000b020: 2073 7461 7274 7570 2066 696c 6573 2066   startup files f
+0000b030: 6f72 2065 6e73 656d 626c 6520 7369 6d75  or ensemble simu
+0000b040: 6c61 7469 6f6e 732e 2056 616c 7565 7320  lations. Values 
+0000b050: 6163 6365 7074 6564 0a20 2020 2020 2020  accepted.       
+0000b060: 2061 7265 205b 302c 2031 5d2e 2052 6563   are [0, 1]. Rec
+0000b070: 6f6d 6d65 6e64 6564 2076 616c 7565 2030  ommended value 0
+0000b080: 2e20 3020 2d20 6f66 662c 2031 202d 206f  . 0 - off, 1 - o
+0000b090: 6e2e 0a20 2020 2022 2222 0a0a 2020 2020  n..    """..    
+0000b0a0: 6e61 6d65 3a20 7374 7220 3d20 4669 656c  name: str = Fiel
+0000b0b0: 6428 2251 555f 6669 6c65 6f70 7469 6f6e  d("QU_fileoption
+0000b0c0: 7322 2c20 6672 6f7a 656e 3d54 7275 6529  s", frozen=True)
+0000b0d0: 0a20 2020 205f 6578 7465 6e73 696f 6e3a  .    _extension:
+0000b0e0: 2073 7472 203d 2022 2e69 6e70 220a 2020   str = ".inp".  
+0000b0f0: 2020 6f75 7470 7574 5f64 6174 615f 6669    output_data_fi
+0000b100: 6c65 5f66 6f72 6d61 745f 666c 6167 3a20  le_format_flag: 
+0000b110: 4c69 7465 7261 6c5b 312c 2032 2c20 335d  Literal[1, 2, 3]
+0000b120: 203d 2032 0a20 2020 206e 6f6e 5f6d 6173   = 2.    non_mas
+0000b130: 735f 636f 6e73 6572 7665 645f 696e 6974  s_conserved_init
+0000b140: 6961 6c5f 6669 656c 645f 666c 6167 3a20  ial_field_flag: 
+0000b150: 4c69 7465 7261 6c5b 302c 2031 5d20 3d20  Literal[0, 1] = 
+0000b160: 300a 2020 2020 696e 6974 6961 6c5f 7365  0.    initial_se
+0000b170: 6e73 6f72 5f76 656c 6f63 6974 795f 6669  nsor_velocity_fi
+0000b180: 656c 645f 666c 6167 3a20 4c69 7465 7261  eld_flag: Litera
+0000b190: 6c5b 302c 2031 5d20 3d20 300a 2020 2020  l[0, 1] = 0.    
+0000b1a0: 7175 5f73 7461 6767 6572 6564 5f76 656c  qu_staggered_vel
+0000b1b0: 6f63 6974 795f 6669 6c65 5f66 6c61 673a  ocity_file_flag:
+0000b1c0: 204c 6974 6572 616c 5b30 2c20 315d 203d   Literal[0, 1] =
+0000b1d0: 2030 0a20 2020 2067 656e 6572 6174 655f   0.    generate_
+0000b1e0: 7769 6e64 5f73 7461 7274 7570 5f66 696c  wind_startup_fil
+0000b1f0: 6573 5f66 6c61 673a 204c 6974 6572 616c  es_flag: Literal
+0000b200: 5b30 2c20 315d 203d 2030 0a0a 2020 2020  [0, 1] = 0..    
+0000b210: 4063 6c61 7373 6d65 7468 6f64 0a20 2020  @classmethod.   
+0000b220: 2064 6566 2066 726f 6d5f 6669 6c65 2863   def from_file(c
+0000b230: 6c73 2c20 6469 7265 6374 6f72 793a 2073  ls, directory: s
+0000b240: 7472 207c 2050 6174 682c 202a 2a6b 7761  tr | Path, **kwa
+0000b250: 7267 7329 3a0a 2020 2020 2020 2020 2222  rgs):.        ""
+0000b260: 220a 2020 2020 2020 2020 496e 6974 6961  ".        Initia
+0000b270: 6c69 7a65 7320 6120 5155 5f46 696c 656f  lizes a QU_Fileo
+0000b280: 7074 696f 6e73 206f 626a 6563 7420 6672  ptions object fr
+0000b290: 6f6d 2061 2064 6972 6563 746f 7279 2063  om a directory c
+0000b2a0: 6f6e 7461 696e 696e 6720 610a 2020 2020  ontaining a.    
+0000b2b0: 2020 2020 5155 5f66 696c 656f 7074 696f      QU_fileoptio
+0000b2c0: 6e73 2e69 6e70 2066 696c 652e 0a20 2020  ns.inp file..   
+0000b2d0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0000b2e0: 2069 6620 6973 696e 7374 616e 6365 2864   if isinstance(d
+0000b2f0: 6972 6563 746f 7279 2c20 7374 7229 3a0a  irectory, str):.
+0000b300: 2020 2020 2020 2020 2020 2020 6469 7265              dire
+0000b310: 6374 6f72 7920 3d20 5061 7468 2864 6972  ctory = Path(dir
+0000b320: 6563 746f 7279 290a 2020 2020 2020 2020  ectory).        
+0000b330: 7769 7468 206f 7065 6e28 6469 7265 6374  with open(direct
+0000b340: 6f72 7920 2f20 2251 555f 6669 6c65 6f70  ory / "QU_fileop
+0000b350: 7469 6f6e 732e 696e 7022 2c20 2272 2229  tions.inp", "r")
+0000b360: 2061 7320 663a 0a20 2020 2020 2020 2020   as f:.         
+0000b370: 2020 206c 696e 6573 203d 2066 2e72 6561     lines = f.rea
+0000b380: 646c 696e 6573 2829 0a20 2020 2020 2020  dlines().       
+0000b390: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
+0000b3a0: 2020 7265 7475 726e 2063 6c73 280a 2020    return cls(.  
+0000b3b0: 2020 2020 2020 2020 2020 2020 2020 6f75                ou
+0000b3c0: 7470 7574 5f64 6174 615f 6669 6c65 5f66  tput_data_file_f
+0000b3d0: 6f72 6d61 745f 666c 6167 3d69 6e74 286c  ormat_flag=int(l
+0000b3e0: 696e 6573 5b31 5d2e 7370 6c69 7428 295b  ines[1].split()[
+0000b3f0: 305d 292c 0a20 2020 2020 2020 2020 2020  0]),.           
+0000b400: 2020 2020 206e 6f6e 5f6d 6173 735f 636f       non_mass_co
+0000b410: 6e73 6572 7665 645f 696e 6974 6961 6c5f  nserved_initial_
+0000b420: 6669 656c 645f 666c 6167 3d69 6e74 286c  field_flag=int(l
+0000b430: 696e 6573 5b32 5d2e 7370 6c69 7428 295b  ines[2].split()[
+0000b440: 305d 292c 0a20 2020 2020 2020 2020 2020  0]),.           
+0000b450: 2020 2020 2069 6e69 7469 616c 5f73 656e       initial_sen
+0000b460: 736f 725f 7665 6c6f 6369 7479 5f66 6965  sor_velocity_fie
+0000b470: 6c64 5f66 6c61 673d 696e 7428 6c69 6e65  ld_flag=int(line
+0000b480: 735b 335d 2e73 706c 6974 2829 5b30 5d29  s[3].split()[0])
+0000b490: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000b4a0: 2020 7175 5f73 7461 6767 6572 6564 5f76    qu_staggered_v
+0000b4b0: 656c 6f63 6974 795f 6669 6c65 5f66 6c61  elocity_file_fla
+0000b4c0: 673d 696e 7428 6c69 6e65 735b 345d 2e73  g=int(lines[4].s
+0000b4d0: 706c 6974 2829 5b30 5d29 2c0a 2020 2020  plit()[0]),.    
+0000b4e0: 2020 2020 2020 2020 2020 2020 6765 6e65              gene
+0000b4f0: 7261 7465 5f77 696e 645f 7374 6172 7475  rate_wind_startu
+0000b500: 705f 6669 6c65 735f 666c 6167 3d69 6e74  p_files_flag=int
+0000b510: 286c 696e 6573 5b35 5d2e 7370 6c69 7428  (lines[5].split(
+0000b520: 295b 305d 292c 0a20 2020 2020 2020 2020  )[0]),.         
+0000b530: 2020 2029 0a20 2020 2020 2020 2065 7863     ).        exc
+0000b540: 6570 7420 496e 6465 7845 7272 6f72 3a0a  ept IndexError:.
+0000b550: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0000b560: 6520 5661 6c75 6545 7272 6f72 280a 2020  e ValueError(.  
+0000b570: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+0000b580: 4572 726f 7220 7061 7273 696e 6720 7b63  Error parsing {c
+0000b590: 6c73 2e5f 5f6e 616d 655f 5f7d 2066 726f  ls.__name__} fro
+0000b5a0: 6d20 6669 6c65 3a20 5155 5f66 696c 656f  m file: QU_fileo
+0000b5b0: 7074 696f 6e73 2e69 6e70 220a 2020 2020  ptions.inp".    
+0000b5c0: 2020 2020 2020 2020 2020 2020 6622 5c6e              f"\n
+0000b5d0: 506c 6561 7365 2063 6865 636b 2074 6865  Please check the
+0000b5e0: 2066 696c 6520 666f 7220 636f 7272 6563   file for correc
+0000b5f0: 746e 6573 732e 220a 2020 2020 2020 2020  tness.".        
+0000b600: 2020 2020 290a 0a0a 636c 6173 7320 5155      )...class QU
+0000b610: 5f53 696d 7061 7261 6d73 2849 6e70 7574  _Simparams(Input
+0000b620: 4669 6c65 293a 0a20 2020 2022 2222 0a20  File):.    """. 
+0000b630: 2020 2043 6c61 7373 2072 6570 7265 7365     Class represe
+0000b640: 6e74 696e 6720 7468 6520 5155 5f73 696d  nting the QU_sim
+0000b650: 7061 7261 6d73 2e69 6e70 2066 696c 652e  params.inp file.
+0000b660: 2054 6869 7320 6669 6c65 2063 6f6e 7461   This file conta
+0000b670: 696e 7320 7468 650a 2020 2020 7369 6d75  ins the.    simu
+0000b680: 6c61 7469 6f6e 2070 6172 616d 6574 6572  lation parameter
+0000b690: 7320 666f 7220 7468 6520 5155 4943 2d46  s for the QUIC-F
+0000b6a0: 6972 6520 7369 6d75 6c61 7469 6f6e 2e0a  ire simulation..
+0000b6b0: 0a20 2020 2041 7474 7269 6275 7465 730a  .    Attributes.
+0000b6c0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+0000b6d0: 2020 206e 7820 3a20 696e 740a 2020 2020     nx : int.    
+0000b6e0: 2020 2020 4e75 6d62 6572 206f 6620 6365      Number of ce
+0000b6f0: 6c6c 7320 696e 2074 6865 2078 2d64 6972  lls in the x-dir
+0000b700: 6563 7469 6f6e 205b 2d5d 2e20 5265 636f  ection [-]. Reco
+0000b710: 6d6d 656e 6465 6420 7661 6c75 653a 203e  mmended value: >
+0000b720: 2031 3030 0a20 2020 206e 7920 3a20 696e   100.    ny : in
+0000b730: 740a 2020 2020 2020 2020 4e75 6d62 6572  t.        Number
+0000b740: 206f 6620 6365 6c6c 7320 696e 2074 6865   of cells in the
+0000b750: 2079 2d64 6972 6563 7469 6f6e 205b 2d5d   y-direction [-]
+0000b760: 2e20 5265 636f 6d6d 656e 6465 6420 7661  . Recommended va
+0000b770: 6c75 653a 203e 2031 3030 0a20 2020 206e  lue: > 100.    n
+0000b780: 7a20 3a20 696e 740a 2020 2020 2020 2020  z : int.        
+0000b790: 4e75 6d62 6572 206f 6620 6365 6c6c 7320  Number of cells 
+0000b7a0: 696e 2074 6865 207a 2d64 6972 6563 7469  in the z-directi
+0000b7b0: 6f6e 205b 2d5d 2e0a 2020 2020 6478 203a  on [-]..    dx :
+0000b7c0: 2066 6c6f 6174 0a20 2020 2020 2020 2043   float.        C
+0000b7d0: 656c 6c20 7369 7a65 2069 6e20 7468 6520  ell size in the 
+0000b7e0: 782d 6469 7265 6374 696f 6e20 5b6d 5d2e  x-direction [m].
+0000b7f0: 2052 6563 6f6d 6d65 6e64 6564 2076 616c   Recommended val
+0000b800: 7565 3a20 3220 6d0a 2020 2020 6479 203a  ue: 2 m.    dy :
+0000b810: 2066 6c6f 6174 0a20 2020 2020 2020 2043   float.        C
+0000b820: 656c 6c20 7369 7a65 2069 6e20 7468 6520  ell size in the 
+0000b830: 792d 6469 7265 6374 696f 6e20 5b6d 5d2e  y-direction [m].
+0000b840: 2052 6563 6f6d 6d65 6e64 6564 2076 616c   Recommended val
+0000b850: 7565 3a20 3220 6d0a 2020 2020 7175 6963  ue: 2 m.    quic
+0000b860: 5f64 6f6d 6169 6e5f 6865 6967 6874 203a  _domain_height :
+0000b870: 2066 6c6f 6174 0a20 2020 2020 2020 2051   float.        Q
+0000b880: 5549 4320 646f 6d61 696e 2068 6569 6768  UIC domain heigh
+0000b890: 7420 5b6d 5d2e 2052 6563 6f6d 6d65 6e64  t [m]. Recommend
+0000b8a0: 6564 2076 616c 7565 3a20 3330 3020 6d0a  ed value: 300 m.
+0000b8b0: 2020 2020 7375 7266 6163 655f 7665 7274      surface_vert
+0000b8c0: 6963 616c 5f63 656c 6c5f 7369 7a65 203a  ical_cell_size :
+0000b8d0: 2066 6c6f 6174 0a20 2020 2020 2020 2053   float.        S
+0000b8e0: 7572 6661 6365 2076 6572 7469 6361 6c20  urface vertical 
+0000b8f0: 6365 6c6c 2073 697a 6520 5b6d 5d2e 0a20  cell size [m].. 
+0000b900: 2020 206e 756d 6265 725f 7375 7266 6163     number_surfac
+0000b910: 655f 6365 6c6c 7320 3a20 696e 740a 2020  e_cells : int.  
+0000b920: 2020 2020 2020 4e75 6d62 6572 206f 6620        Number of 
+0000b930: 756e 6966 6f72 6d20 7375 7266 6163 6520  uniform surface 
+0000b940: 6365 6c6c 7320 5b2d 5d2e 0a20 2020 2073  cells [-]..    s
+0000b950: 7472 6574 6368 5f67 7269 645f 666c 6167  tretch_grid_flag
+0000b960: 203a 2069 6e74 0a20 2020 2020 2020 2056   : int.        V
+0000b970: 6572 7469 6361 6c20 6772 6964 2073 7472  ertical grid str
+0000b980: 6574 6368 696e 6720 666c 6167 2c20 7661  etching flag, va
+0000b990: 6c75 6573 2061 6363 6570 7465 6420 5b30  lues accepted [0
+0000b9a0: 2c20 312c 2033 5d2e 2044 6566 6175 6c74  , 1, 3]. Default
+0000b9b0: 2069 7320 332e 0a20 2020 2020 2020 2030   is 3..        0
+0000b9c0: 202d 2075 6e69 666f 726d 2c20 3120 2d20   - uniform, 1 - 
+0000b9d0: 6375 7374 6f6d 2c20 3320 2d20 7061 7261  custom, 3 - para
+0000b9e0: 626f 6c69 632e 2049 6620 7374 7265 7463  bolic. If stretc
+0000b9f0: 685f 6772 6964 5f66 6c61 6720 6973 2030  h_grid_flag is 0
+0000ba00: 206f 7220 330a 2020 2020 2020 2020 647a   or 3.        dz
+0000ba10: 5f61 7272 6179 2069 7320 636f 6d70 7574  _array is comput
+0000ba20: 6564 2066 726f 6d20 6e7a 2c20 7375 7266  ed from nz, surf
+0000ba30: 6163 655f 7665 7274 6963 616c 5f63 656c  ace_vertical_cel
+0000ba40: 6c5f 7369 7a65 2c20 616e 640a 2020 2020  l_size, and.    
+0000ba50: 2020 2020 6e75 6d62 6572 5f73 7572 6661      number_surfa
+0000ba60: 6365 5f63 656c 6c73 2e20 4966 2073 7472  ce_cells. If str
+0000ba70: 6574 6368 5f67 7269 645f 666c 6167 2069  etch_grid_flag i
+0000ba80: 7320 312c 2063 7573 746f 6d5f 647a 5f61  s 1, custom_dz_a
+0000ba90: 7272 6179 206d 7573 740a 2020 2020 2020  rray must.      
+0000baa0: 2020 6265 2070 726f 7669 6465 642e 0a20    be provided.. 
+0000bab0: 2020 2063 7573 746f 6d5f 647a 5f61 7272     custom_dz_arr
+0000bac0: 6179 203a 206c 6973 745b 666c 6f61 745d  ay : list[float]
+0000bad0: 0a20 2020 2020 2020 2056 6572 7469 6361  .        Vertica
+0000bae0: 6c20 6772 6964 2073 7061 6369 6e67 2061  l grid spacing a
+0000baf0: 7272 6179 205b 6d5d 2e20 4d75 7374 2062  rray [m]. Must b
+0000bb00: 6520 7072 6f76 6964 6564 2069 6620 7374  e provided if st
+0000bb10: 7265 7463 685f 6772 6964 5f66 6c61 670a  retch_grid_flag.
+0000bb20: 2020 2020 2020 2020 6973 2031 2e20 4966          is 1. If
+0000bb30: 2073 7472 6574 6368 5f67 7269 645f 666c   stretch_grid_fl
+0000bb40: 6167 2069 7320 3020 6f72 2033 2c20 647a  ag is 0 or 3, dz
+0000bb50: 5f61 7272 6179 2069 7320 636f 6d70 7574  _array is comput
+0000bb60: 6564 2066 726f 6d20 6e7a 2c0a 2020 2020  ed from nz,.    
+0000bb70: 2020 2020 7375 7266 6163 655f 7665 7274      surface_vert
+0000bb80: 6963 616c 5f63 656c 6c5f 7369 7a65 2c20  ical_cell_size, 
+0000bb90: 616e 6420 6e75 6d62 6572 5f73 7572 6661  and number_surfa
+0000bba0: 6365 5f63 656c 6c73 2e0a 2020 2020 7574  ce_cells..    ut
+0000bbb0: 635f 6f66 6673 6574 203a 2069 6e74 0a20  c_offset : int. 
+0000bbc0: 2020 2020 2020 2048 6f75 7273 2064 6966         Hours dif
+0000bbd0: 6665 7265 6e63 6520 6672 6f6d 2055 5443  ference from UTC
+0000bbe0: 2028 616b 6120 5554 4d29 205b 685d 0a20   (aka UTM) [h]. 
+0000bbf0: 2020 2077 696e 645f 7469 6d65 7320 3a20     wind_times : 
+0000bc00: 6c69 7374 5b69 6e74 5d0a 2020 2020 2020  list[int].      
+0000bc10: 2020 4c69 7374 206f 6620 7469 6d65 7320    List of times 
+0000bc20: 6174 2077 6869 6368 2074 6865 2077 696e  at which the win
+0000bc30: 6473 2061 7265 2061 7661 696c 6162 6c65  ds are available
+0000bc40: 2069 6e20 556e 6978 2045 706f 6368 2074   in Unix Epoch t
+0000bc50: 696d 650a 2020 2020 2020 2020 2869 6e74  ime.        (int
+0000bc60: 6567 6572 2073 6563 6f6e 6473 2073 696e  eger seconds sin
+0000bc70: 6365 2031 3937 302f 312f 3120 3030 3a30  ce 1970/1/1 00:0
+0000bc80: 303a 3030 292e 2054 6865 7365 2061 7265  0:00). These are
+0000bc90: 2055 5443 2074 696d 6573 2e0a 2020 2020   UTC times..    
+0000bca0: 2020 2020 4465 6661 756c 7473 2074 6f20      Defaults to 
+0000bcb0: 5b69 6e74 2874 696d 652e 7469 6d65 2829  [int(time.time()
+0000bcc0: 295d 2069 6620 6e6f 7420 7072 6f76 6964  )] if not provid
+0000bcd0: 6564 2e0a 2020 2020 736f 725f 6974 6572  ed..    sor_iter
+0000bce0: 5f6d 6178 203a 2069 6e74 0a20 2020 2020  _max : int.     
+0000bcf0: 2020 204d 6178 696d 756d 206e 756d 6265     Maximum numbe
+0000bd00: 7220 6f66 2069 7465 7261 7469 6f6e 7320  r of iterations 
+0000bd10: 6f66 2074 6865 2053 4f52 2077 696e 6420  of the SOR wind 
+0000bd20: 736f 6c76 6572 2e20 5265 636f 6d6d 656e  solver. Recommen
+0000bd30: 6465 6420 7661 6c75 653a 0a20 2020 2020  ded value:.     
+0000bd40: 2020 2031 302e 2044 6566 6175 6c74 2069     10. Default i
+0000bd50: 7320 3130 2e0a 2020 2020 736f 725f 7265  s 10..    sor_re
+0000bd60: 7369 6475 616c 5f72 6564 7563 7469 6f6e  sidual_reduction
+0000bd70: 203a 2069 6e74 0a20 2020 2020 2020 2052   : int.        R
+0000bd80: 6573 6964 7561 6c20 7265 6475 6374 696f  esidual reductio
+0000bd90: 6e20 746f 2061 7373 6573 7320 636f 6e76  n to assess conv
+0000bda0: 6572 6765 6e63 6520 6f66 2074 6865 2053  ergence of the S
+0000bdb0: 4f52 2073 6f6c 7665 7220 286f 7264 6572  OR solver (order
+0000bdc0: 7320 6f66 0a20 2020 2020 2020 206d 6167  s of.        mag
+0000bdd0: 6e69 7475 6465 292e 2052 6563 6f6d 6d65  nitude). Recomme
+0000bde0: 6e64 6564 2076 616c 7565 3a20 332e 2044  nded value: 3. D
+0000bdf0: 6566 6175 6c74 2069 7320 332e 0a20 2020  efault is 3..   
+0000be00: 2075 7365 5f64 6966 6675 7369 6f6e 5f66   use_diffusion_f
+0000be10: 6c61 6720 3a20 696e 740a 2020 2020 2020  lag : int.      
+0000be20: 2020 5573 6520 6469 6666 7573 696f 6e20    Use diffusion 
+0000be30: 616c 676f 7269 7468 6d3a 2030 203d 206f  algorithm: 0 = o
+0000be40: 6666 2c20 3120 3d20 6f6e 2e20 5265 636f  ff, 1 = on. Reco
+0000be50: 6d6d 656e 6465 6420 7661 6c75 653a 2030  mmended value: 0
+0000be60: 2e0a 2020 2020 2020 2020 4465 6661 756c  ..        Defaul
+0000be70: 7420 6973 2030 2e0a 2020 2020 6e75 6d62  t is 0..    numb
+0000be80: 6572 5f64 6966 6675 7369 6f6e 5f69 7465  er_diffusion_ite
+0000be90: 7261 7469 6f6e 7320 3a20 696e 740a 2020  rations : int.  
+0000bea0: 2020 2020 2020 4e75 6d62 6572 206f 6620        Number of 
+0000beb0: 6469 6666 7573 696f 6e20 6974 6572 6174  diffusion iterat
+0000bec0: 696f 6e73 2e20 5265 636f 6d6d 656e 6465  ions. Recommende
+0000bed0: 6420 7661 6c75 653a 2031 302e 2044 6566  d value: 10. Def
+0000bee0: 6175 6c74 2069 7320 3130 2e0a 2020 2020  ault is 10..    
+0000bef0: 646f 6d61 696e 5f72 6f74 6174 696f 6e20  domain_rotation 
+0000bf00: 3a20 666c 6f61 740a 2020 2020 2020 2020  : float.        
+0000bf10: 446f 6d61 696e 2072 6f74 6174 696f 6e20  Domain rotation 
+0000bf20: 7265 6c61 7469 7665 2074 6f20 7472 7565  relative to true
+0000bf30: 206e 6f72 7468 2028 636c 6f63 6b77 6973   north (clockwis
+0000bf40: 6520 6973 2070 6f73 6974 6976 6529 0a20  e is positive). 
+0000bf50: 2020 2020 2020 205b 6465 6772 6565 735d         [degrees]
+0000bf60: 2e20 5265 636f 6d6d 656e 6465 6420 7661  . Recommended va
+0000bf70: 6c75 653a 2030 2064 6567 2e20 4465 6661  lue: 0 deg. Defa
+0000bf80: 756c 7420 6973 2030 2e0a 2020 2020 7574  ult is 0..    ut
+0000bf90: 6d5f 7820 3a20 666c 6f61 740a 2020 2020  m_x : float.    
+0000bfa0: 2020 2020 5554 4d2d 7820 636f 6f72 6469      UTM-x coordi
+0000bfb0: 6e61 7465 7320 6f66 2074 6865 2073 6f75  nates of the sou
+0000bfc0: 7468 2d77 6573 7420 636f 726e 6572 206f  th-west corner o
+0000bfd0: 6620 646f 6d61 696e 205b 6d5d 2e20 4465  f domain [m]. De
+0000bfe0: 6661 756c 7420 6973 2030 2e0a 2020 2020  fault is 0..    
+0000bff0: 7574 6d5f 7920 3a20 666c 6f61 740a 2020  utm_y : float.  
+0000c000: 2020 2020 2020 5554 4d2d 7920 636f 6f72        UTM-y coor
+0000c010: 6469 6e61 7465 7320 6f66 2074 6865 2073  dinates of the s
+0000c020: 6f75 7468 2d77 6573 7420 636f 726e 6572  outh-west corner
+0000c030: 206f 6620 646f 6d61 696e 205b 6d5d 2e20   of domain [m]. 
+0000c040: 4465 6661 756c 7420 6973 2030 2e0a 2020  Default is 0..  
+0000c050: 2020 7574 6d5f 7a6f 6e65 5f6e 756d 6265    utm_zone_numbe
+0000c060: 7220 3a20 696e 740a 2020 2020 2020 2020  r : int.        
+0000c070: 5554 4d20 7a6f 6e65 206e 756d 6265 7220  UTM zone number 
+0000c080: 5b2d 5d2e 2044 6566 6175 6c74 2069 7320  [-]. Default is 
+0000c090: 312e 0a20 2020 2075 746d 5f7a 6f6e 655f  1..    utm_zone_
+0000c0a0: 6c65 7474 6572 203a 2069 6e74 0a20 2020  letter : int.   
+0000c0b0: 2020 2020 2055 544d 207a 6f6e 6520 6c65       UTM zone le
+0000c0c0: 7474 6572 2028 413d 312c 2042 3d32 2c20  tter (A=1, B=2, 
+0000c0d0: 2e2e 2e29 205b 2d5d 2e20 4465 6661 756c  ...) [-]. Defaul
+0000c0e0: 7420 6973 2031 2e0a 2020 2020 7175 6963  t is 1..    quic
+0000c0f0: 5f63 6664 5f66 6c61 6720 3a20 696e 740a  _cfd_flag : int.
+0000c100: 2020 2020 2020 2020 5155 4943 2d43 4644          QUIC-CFD
+0000c110: 2066 6c61 673a 2030 203d 206f 6666 2c20   flag: 0 = off, 
+0000c120: 3120 3d20 6f6e 2e20 5265 636f 6d6d 656e  1 = on. Recommen
+0000c130: 6465 6420 7661 6c75 653a 2030 2e20 4465  ded value: 0. De
+0000c140: 6661 756c 7420 6973 2030 2e0a 2020 2020  fault is 0..    
+0000c150: 6578 706c 6f73 6976 655f 626c 6467 5f66  explosive_bldg_f
+0000c160: 6c61 6720 3a20 696e 740a 2020 2020 2020  lag : int.      
+0000c170: 2020 4578 706c 6f73 6976 6520 6275 696c    Explosive buil
+0000c180: 6469 6e67 2064 616d 6167 6520 666c 6167  ding damage flag
+0000c190: 3a20 3020 3d20 6f66 662c 2031 203d 206f  : 0 = off, 1 = o
+0000c1a0: 6e2e 2052 6563 6f6d 6d65 6e64 6564 2076  n. Recommended v
+0000c1b0: 616c 7565 3a20 302e 0a20 2020 2020 2020  alue: 0..       
+0000c1c0: 2044 6566 6175 6c74 2069 7320 302e 0a20   Default is 0.. 
+0000c1d0: 2020 2062 6c64 675f 6172 7261 795f 666c     bldg_array_fl
+0000c1e0: 6167 203a 2069 6e74 0a20 2020 2020 2020  ag : int.       
+0000c1f0: 2042 7569 6c64 696e 6720 6172 7261 7920   Building array 
+0000c200: 666c 6167 2e20 3020 3d20 6f66 662c 2031  flag. 0 = off, 1
+0000c210: 203d 206f 6e2e 2052 6563 6f6d 6d65 6e64   = on. Recommend
+0000c220: 6564 2076 616c 7565 3a20 302e 2044 6566  ed value: 0. Def
+0000c230: 6175 6c74 2069 730a 2020 2020 2020 2020  ault is.        
+0000c240: 302e 0a20 2020 2022 2222 0a0a 2020 2020  0..    """..    
+0000c250: 6e61 6d65 3a20 7374 7220 3d20 4669 656c  name: str = Fiel
+0000c260: 6428 2251 555f 7369 6d70 6172 616d 7322  d("QU_simparams"
+0000c270: 2c20 6672 6f7a 656e 3d54 7275 6529 0a20  , frozen=True). 
+0000c280: 2020 205f 6578 7465 6e73 696f 6e3a 2073     _extension: s
+0000c290: 7472 203d 2022 2e69 6e70 220a 2020 2020  tr = ".inp".    
+0000c2a0: 6e78 3a20 506f 7369 7469 7665 496e 740a  nx: PositiveInt.
+0000c2b0: 2020 2020 6e79 3a20 506f 7369 7469 7665      ny: Positive
+0000c2c0: 496e 740a 2020 2020 6e7a 3a20 506f 7369  Int.    nz: Posi
+0000c2d0: 7469 7665 496e 7420 3d20 3232 0a20 2020  tiveInt = 22.   
+0000c2e0: 2064 783a 2050 6f73 6974 6976 6546 6c6f   dx: PositiveFlo
+0000c2f0: 6174 203d 2032 0a20 2020 2064 793a 2050  at = 2.    dy: P
+0000c300: 6f73 6974 6976 6546 6c6f 6174 203d 2032  ositiveFloat = 2
+0000c310: 0a20 2020 2071 7569 635f 646f 6d61 696e  .    quic_domain
+0000c320: 5f68 6569 6768 743a 2050 6f73 6974 6976  _height: Positiv
+0000c330: 6546 6c6f 6174 203d 2033 3030 0a20 2020  eFloat = 300.   
+0000c340: 2077 696e 645f 7469 6d65 733a 206c 6973   wind_times: lis
+0000c350: 745b 696e 745d 0a20 2020 2073 7572 6661  t[int].    surfa
+0000c360: 6365 5f76 6572 7469 6361 6c5f 6365 6c6c  ce_vertical_cell
+0000c370: 5f73 697a 653a 2050 6f73 6974 6976 6546  _size: PositiveF
+0000c380: 6c6f 6174 203d 2031 2e30 0a20 2020 206e  loat = 1.0.    n
+0000c390: 756d 6265 725f 7375 7266 6163 655f 6365  umber_surface_ce
+0000c3a0: 6c6c 733a 2050 6f73 6974 6976 6549 6e74  lls: PositiveInt
+0000c3b0: 203d 2035 0a20 2020 2073 7472 6574 6368   = 5.    stretch
+0000c3c0: 5f67 7269 645f 666c 6167 3a20 4c69 7465  _grid_flag: Lite
+0000c3d0: 7261 6c5b 302c 2031 2c20 335d 203d 2033  ral[0, 1, 3] = 3
+0000c3e0: 0a20 2020 2063 7573 746f 6d5f 647a 5f61  .    custom_dz_a
+0000c3f0: 7272 6179 3a20 6c69 7374 5b50 6f73 6974  rray: list[Posit
+0000c400: 6976 6546 6c6f 6174 5d20 3d20 5b5d 0a20  iveFloat] = []. 
+0000c410: 2020 2075 7463 5f6f 6666 7365 743a 2069     utc_offset: i
+0000c420: 6e74 203d 2030 0a20 2020 2073 6f72 5f69  nt = 0.    sor_i
+0000c430: 7465 725f 6d61 783a 2050 6f73 6974 6976  ter_max: Positiv
+0000c440: 6549 6e74 203d 2031 300a 2020 2020 736f  eInt = 10.    so
+0000c450: 725f 7265 7369 6475 616c 5f72 6564 7563  r_residual_reduc
+0000c460: 7469 6f6e 3a20 506f 7369 7469 7665 496e  tion: PositiveIn
+0000c470: 7420 3d20 330a 2020 2020 7573 655f 6469  t = 3.    use_di
+0000c480: 6666 7573 696f 6e5f 666c 6167 3a20 4c69  ffusion_flag: Li
+0000c490: 7465 7261 6c5b 302c 2031 5d20 3d20 300a  teral[0, 1] = 0.
+0000c4a0: 2020 2020 6e75 6d62 6572 5f64 6966 6675      number_diffu
+0000c4b0: 7369 6f6e 5f69 7465 7261 7469 6f6e 733a  sion_iterations:
+0000c4c0: 2050 6f73 6974 6976 6549 6e74 203d 2031   PositiveInt = 1
+0000c4d0: 300a 2020 2020 646f 6d61 696e 5f72 6f74  0.    domain_rot
+0000c4e0: 6174 696f 6e3a 2066 6c6f 6174 203d 2030  ation: float = 0
+0000c4f0: 2e30 0a20 2020 2075 746d 5f78 3a20 666c  .0.    utm_x: fl
+0000c500: 6f61 7420 3d20 302e 300a 2020 2020 7574  oat = 0.0.    ut
+0000c510: 6d5f 793a 2066 6c6f 6174 203d 2030 2e30  m_y: float = 0.0
+0000c520: 0a20 2020 2075 746d 5f7a 6f6e 655f 6e75  .    utm_zone_nu
+0000c530: 6d62 6572 3a20 506f 7369 7469 7665 496e  mber: PositiveIn
+0000c540: 7420 3d20 310a 2020 2020 7574 6d5f 7a6f  t = 1.    utm_zo
+0000c550: 6e65 5f6c 6574 7465 723a 2050 6f73 6974  ne_letter: Posit
+0000c560: 6976 6549 6e74 203d 2031 0a20 2020 2071  iveInt = 1.    q
+0000c570: 7569 635f 6366 645f 666c 6167 3a20 4c69  uic_cfd_flag: Li
+0000c580: 7465 7261 6c5b 302c 2031 5d20 3d20 300a  teral[0, 1] = 0.
+0000c590: 2020 2020 6578 706c 6f73 6976 655f 626c      explosive_bl
+0000c5a0: 6467 5f66 6c61 673a 204c 6974 6572 616c  dg_flag: Literal
+0000c5b0: 5b30 2c20 315d 203d 2030 0a20 2020 2062  [0, 1] = 0.    b
+0000c5c0: 6c64 675f 6172 7261 795f 666c 6167 3a20  ldg_array_flag: 
+0000c5d0: 4c69 7465 7261 6c5b 302c 2031 5d20 3d20  Literal[0, 1] = 
+0000c5e0: 300a 2020 2020 5f66 726f 6d5f 6669 6c65  0.    _from_file
+0000c5f0: 5f64 7a5f 6172 7261 793a 204f 7074 696f  _dz_array: Optio
+0000c600: 6e61 6c5b 6c69 7374 5b50 6f73 6974 6976  nal[list[Positiv
+0000c610: 6546 6c6f 6174 5d5d 203d 204e 6f6e 650a  eFloat]] = None.
+0000c620: 0a20 2020 2040 636f 6d70 7574 6564 5f66  .    @computed_f
+0000c630: 6965 6c64 0a20 2020 2040 7072 6f70 6572  ield.    @proper
+0000c640: 7479 0a20 2020 2064 6566 205f 647a 5f61  ty.    def _dz_a
+0000c650: 7272 6179 2873 656c 6629 202d 3e20 6c69  rray(self) -> li
+0000c660: 7374 5b66 6c6f 6174 5d3a 0a20 2020 2020  st[float]:.     
+0000c670: 2020 2069 6620 7365 6c66 2e5f 6672 6f6d     if self._from
+0000c680: 5f66 696c 655f 647a 5f61 7272 6179 3a0a  _file_dz_array:.
+0000c690: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0000c6a0: 726e 2073 656c 662e 5f66 726f 6d5f 6669  rn self._from_fi
+0000c6b0: 6c65 5f64 7a5f 6172 7261 790a 2020 2020  le_dz_array.    
+0000c6c0: 2020 2020 656c 6966 2073 656c 662e 7374      elif self.st
+0000c6d0: 7265 7463 685f 6772 6964 5f66 6c61 6720  retch_grid_flag 
+0000c6e0: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
+0000c6f0: 2020 7265 7475 726e 205b 7365 6c66 2e73    return [self.s
+0000c700: 7572 6661 6365 5f76 6572 7469 6361 6c5f  urface_vertical_
+0000c710: 6365 6c6c 5f73 697a 655d 202a 2073 656c  cell_size] * sel
+0000c720: 662e 6e7a 0a20 2020 2020 2020 2065 6c69  f.nz.        eli
+0000c730: 6620 7365 6c66 2e73 7472 6574 6368 5f67  f self.stretch_g
+0000c740: 7269 645f 666c 6167 203d 3d20 313a 0a20  rid_flag == 1:. 
+0000c750: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0000c760: 6e20 7365 6c66 2e63 7573 746f 6d5f 647a  n self.custom_dz
+0000c770: 5f61 7272 6179 0a20 2020 2020 2020 2065  _array.        e
+0000c780: 6c69 6620 7365 6c66 2e73 7472 6574 6368  lif self.stretch
+0000c790: 5f67 7269 645f 666c 6167 203d 3d20 333a  _grid_flag == 3:
+0000c7a0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0000c7b0: 7572 6e20 636f 6d70 7574 655f 7061 7261  urn compute_para
+0000c7c0: 626f 6c69 635f 7374 7265 7463 6865 645f  bolic_stretched_
+0000c7d0: 6772 6964 280a 2020 2020 2020 2020 2020  grid(.          
+0000c7e0: 2020 2020 2020 7365 6c66 2e73 7572 6661        self.surfa
+0000c7f0: 6365 5f76 6572 7469 6361 6c5f 6365 6c6c  ce_vertical_cell
+0000c800: 5f73 697a 652c 0a20 2020 2020 2020 2020  _size,.         
+0000c810: 2020 2020 2020 2073 656c 662e 6e75 6d62         self.numb
+0000c820: 6572 5f73 7572 6661 6365 5f63 656c 6c73  er_surface_cells
+0000c830: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000c840: 2020 7365 6c66 2e6e 7a2c 0a20 2020 2020    self.nz,.     
+0000c850: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000c860: 7175 6963 5f64 6f6d 6169 6e5f 6865 6967  quic_domain_heig
+0000c870: 6874 2c0a 2020 2020 2020 2020 2020 2020  ht,.            
+0000c880: 292e 746f 6c69 7374 2829 0a0a 2020 2020  ).tolist()..    
+0000c890: 4063 6f6d 7075 7465 645f 6669 656c 640a  @computed_field.
+0000c8a0: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+0000c8b0: 2020 6465 6620 5f76 6572 7469 6361 6c5f    def _vertical_
+0000c8c0: 6772 6964 5f6c 696e 6573 2873 656c 6629  grid_lines(self)
+0000c8d0: 202d 3e20 7374 723a 0a20 2020 2020 2020   -> str:.       
+0000c8e0: 2022 2222 0a20 2020 2020 2020 2050 6172   """.        Par
+0000c8f0: 7365 7320 7468 6520 7665 7274 6963 616c  ses the vertical
+0000c900: 2067 7269 6420 7374 7265 7463 6869 6e67   grid stretching
+0000c910: 2066 6c61 6720 616e 6420 647a 5f61 7272   flag and dz_arr
+0000c920: 6179 2074 6f20 6765 6e65 7261 7465 2074  ay to generate t
+0000c930: 6865 0a20 2020 2020 2020 2076 6572 7469  he.        verti
+0000c940: 6361 6c20 6772 6964 2061 7320 6120 7374  cal grid as a st
+0000c950: 7269 6e67 2066 6f72 2074 6865 2051 555f  ring for the QU_
+0000c960: 7369 6d70 6172 616d 732e 696e 7020 6669  simparams.inp fi
+0000c970: 6c65 2e0a 0a20 2020 2020 2020 2041 6c73  le...        Als
+0000c980: 6f20 6d6f 6469 6669 6573 2064 7a5f 6172  o modifies dz_ar
+0000c990: 7261 7920 6966 2073 7472 6574 6368 5f67  ray if stretch_g
+0000c9a0: 7269 645f 666c 6167 2069 7320 6e6f 7420  rid_flag is not 
+0000c9b0: 312e 0a20 2020 2020 2020 2022 2222 0a20  1..        """. 
+0000c9c0: 2020 2020 2020 2073 7472 6574 6368 5f67         stretch_g
+0000c9d0: 7269 645f 6675 6e63 5f6d 6170 203d 207b  rid_func_map = {
+0000c9e0: 0a20 2020 2020 2020 2020 2020 2030 3a20  .            0: 
+0000c9f0: 7365 6c66 2e5f 7374 7265 7463 685f 6772  self._stretch_gr
+0000ca00: 6964 5f66 6c61 675f 302c 0a20 2020 2020  id_flag_0,.     
+0000ca10: 2020 2020 2020 2031 3a20 7365 6c66 2e5f         1: self._
+0000ca20: 7374 7265 7463 685f 6772 6964 5f66 6c61  stretch_grid_fla
+0000ca30: 675f 312c 0a20 2020 2020 2020 2020 2020  g_1,.           
+0000ca40: 2033 3a20 7365 6c66 2e5f 7374 7265 7463   3: self._stretc
+0000ca50: 685f 6772 6964 5f66 6c61 675f 332c 0a20  h_grid_flag_3,. 
+0000ca60: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+0000ca70: 2072 6574 7572 6e20 7374 7265 7463 685f   return stretch_
+0000ca80: 6772 6964 5f66 756e 635f 6d61 705b 7365  grid_func_map[se
+0000ca90: 6c66 2e73 7472 6574 6368 5f67 7269 645f  lf.stretch_grid_
+0000caa0: 666c 6167 5d28 290a 0a20 2020 2040 636f  flag]()..    @co
+0000cab0: 6d70 7574 6564 5f66 6965 6c64 0a20 2020  mputed_field.   
+0000cac0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+0000cad0: 6566 205f 7769 6e64 5f74 696d 655f 6c69  ef _wind_time_li
+0000cae0: 6e65 7328 7365 6c66 2920 2d3e 2073 7472  nes(self) -> str
+0000caf0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+0000cb00: 2073 656c 662e 5f67 656e 6572 6174 655f   self._generate_
+0000cb10: 7769 6e64 5f74 696d 655f 6c69 6e65 7328  wind_time_lines(
+0000cb20: 290a 0a20 2020 2064 6566 205f 7374 7265  )..    def _stre
+0000cb30: 7463 685f 6772 6964 5f66 6c61 675f 3028  tch_grid_flag_0(
+0000cb40: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+0000cb50: 2222 0a20 2020 2020 2020 2047 656e 6572  "".        Gener
+0000cb60: 6174 6573 2061 2075 6e69 666f 726d 2076  ates a uniform v
+0000cb70: 6572 7469 6361 6c20 6772 6964 2061 7320  ertical grid as 
+0000cb80: 6120 7374 7269 6e67 2066 6f72 2074 6865  a string for the
+0000cb90: 2051 555f 7369 6d70 6172 616d 732e 696e   QU_simparams.in
+0000cba0: 700a 2020 2020 2020 2020 6669 6c65 2e20  p.        file. 
+0000cbb0: 4164 6473 2074 6865 2075 6e69 666f 726d  Adds the uniform
+0000cbc0: 2067 7269 6420 746f 2064 7a5f 6172 7261   grid to dz_arra
+0000cbd0: 792e 0a20 2020 2020 2020 2022 2222 0a20  y..        """. 
+0000cbe0: 2020 2020 2020 2023 2043 7265 6174 6520         # Create 
+0000cbf0: 7468 6520 6c69 6e65 7320 666f 7220 7468  the lines for th
+0000cc00: 6520 756e 6966 6f72 6d20 6772 6964 0a20  e uniform grid. 
+0000cc10: 2020 2020 2020 2073 7572 6661 6365 5f64         surface_d
+0000cc20: 7a5f 6c69 6e65 203d 2028 0a20 2020 2020  z_line = (.     
+0000cc30: 2020 2020 2020 2066 227b 666c 6f61 7428         f"{float(
+0000cc40: 7365 6c66 2e73 7572 6661 6365 5f76 6572  self.surface_ver
+0000cc50: 7469 6361 6c5f 6365 6c6c 5f73 697a 6529  tical_cell_size)
+0000cc60: 7d5c 7422 2066 2221 2053 7572 6661 6365  }\t" f"! Surface
+0000cc70: 2044 5a20 5b6d 5d22 0a20 2020 2020 2020   DZ [m]".       
+0000cc80: 2029 0a20 2020 2020 2020 206e 756d 6265   ).        numbe
+0000cc90: 725f 7375 7266 6163 655f 6365 6c6c 735f  r_surface_cells_
+0000cca0: 6c69 6e65 203d 2028 0a20 2020 2020 2020  line = (.       
+0000ccb0: 2020 2020 2066 227b 7365 6c66 2e6e 756d       f"{self.num
+0000ccc0: 6265 725f 7375 7266 6163 655f 6365 6c6c  ber_surface_cell
+0000ccd0: 737d 5c74 2220 6622 2120 4e75 6d62 6572  s}\t" f"! Number
+0000cce0: 206f 6620 756e 6966 6f72 6d20 7375 7266   of uniform surf
+0000ccf0: 6163 6520 6365 6c6c 7322 0a20 2020 2020  ace cells".     
+0000cd00: 2020 2029 0a0a 2020 2020 2020 2020 7265     )..        re
+0000cd10: 7475 726e 2066 227b 7375 7266 6163 655f  turn f"{surface_
+0000cd20: 647a 5f6c 696e 657d 5c6e 7b6e 756d 6265  dz_line}\n{numbe
+0000cd30: 725f 7375 7266 6163 655f 6365 6c6c 735f  r_surface_cells_
+0000cd40: 6c69 6e65 7d22 0a0a 2020 2020 6465 6620  line}"..    def 
+0000cd50: 5f73 7472 6574 6368 5f67 7269 645f 666c  _stretch_grid_fl
+0000cd60: 6167 5f31 2873 656c 6629 3a0a 2020 2020  ag_1(self):.    
+0000cd70: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0000cd80: 4765 6e65 7261 7465 7320 6120 6375 7374  Generates a cust
+0000cd90: 6f6d 2076 6572 7469 6361 6c20 6772 6964  om vertical grid
+0000cda0: 2061 7320 6120 7374 7269 6e67 2066 6f72   as a string for
+0000cdb0: 2074 6865 2051 555f 7369 6d70 6172 616d   the QU_simparam
+0000cdc0: 732e 696e 700a 2020 2020 2020 2020 6669  s.inp.        fi
+0000cdd0: 6c65 2e0a 2020 2020 2020 2020 2222 220a  le..        """.
+0000cde0: 2020 2020 2020 2020 2320 5665 7269 6679          # Verify
+0000cdf0: 2074 6861 7420 647a 5f61 7272 6179 2069   that dz_array i
+0000ce00: 7320 6e6f 7420 656d 7074 790a 2020 2020  s not empty.    
+0000ce10: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
+0000ce20: 5f64 7a5f 6172 7261 793a 0a20 2020 2020  _dz_array:.     
+0000ce30: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+0000ce40: 7565 4572 726f 7228 0a20 2020 2020 2020  ueError(.       
+0000ce50: 2020 2020 2020 2020 2022 647a 5f61 7272           "dz_arr
+0000ce60: 6179 206d 7573 7420 6e6f 7420 6265 2065  ay must not be e
+0000ce70: 6d70 7479 2069 6620 7374 7265 7463 685f  mpty if stretch_
+0000ce80: 6772 6964 5f66 6c61 6720 220a 2020 2020  grid_flag ".    
+0000ce90: 2020 2020 2020 2020 2020 2020 2269 7320              "is 
+0000cea0: 312e 2050 6c65 6173 6520 7072 6f76 6964  1. Please provid
+0000ceb0: 6520 6120 6375 7374 6f6d 5f64 7a5f 6172  e a custom_dz_ar
+0000cec0: 7261 7920 7769 7468 206e 7a20 220a 2020  ray with nz ".  
+0000ced0: 2020 2020 2020 2020 2020 2020 2020 2265                "e
+0000cee0: 6c65 6d65 6e74 7320 6f72 2075 7365 2061  lements or use a
+0000cef0: 2064 6966 6665 7265 6e74 2073 7472 6574   different stret
+0000cf00: 6368 5f67 7269 645f 666c 6167 2e22 0a20  ch_grid_flag.". 
+0000cf10: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+0000cf20: 2020 2020 2020 2320 5665 7269 6679 2074        # Verify t
+0000cf30: 6861 7420 6e7a 2069 7320 6571 7561 6c20  hat nz is equal 
+0000cf40: 746f 2074 6865 206c 656e 6774 6820 6f66  to the length of
+0000cf50: 2064 7a5f 6172 7261 790a 2020 2020 2020   dz_array.      
+0000cf60: 2020 6966 2073 656c 662e 6e7a 2021 3d20    if self.nz != 
+0000cf70: 6c65 6e28 7365 6c66 2e5f 647a 5f61 7272  len(self._dz_arr
+0000cf80: 6179 293a 0a20 2020 2020 2020 2020 2020  ay):.           
+0000cf90: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+0000cfa0: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+0000cfb0: 2020 2066 226e 7a20 6d75 7374 2062 6520     f"nz must be 
+0000cfc0: 6571 7561 6c20 746f 2074 6865 206c 656e  equal to the len
+0000cfd0: 6774 6820 6f66 2064 7a5f 6172 7261 792e  gth of dz_array.
+0000cfe0: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
+0000cff0: 2020 2066 227b 7365 6c66 2e6e 7a7d 2021     f"{self.nz} !
+0000d000: 3d20 7b6c 656e 2873 656c 662e 5f64 7a5f  = {len(self._dz_
+0000d010: 6172 7261 7929 7d22 0a20 2020 2020 2020  array)}".       
+0000d020: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0000d030: 2320 5665 7269 6679 2074 6861 7420 7468  # Verify that th
+0000d040: 6520 6669 7273 7420 6e75 6d62 6572 5f73  e first number_s
+0000d050: 7572 6661 6365 5f63 656c 6c73 5f6c 696e  urface_cells_lin
+0000d060: 6520 656c 656d 656e 7473 206f 6620 647a  e elements of dz
+0000d070: 5f61 7272 6179 0a20 2020 2020 2020 2023  _array.        #
+0000d080: 2061 7265 2065 7175 616c 2074 6f20 7468   are equal to th
+0000d090: 6520 7375 7266 6163 655f 7665 7274 6963  e surface_vertic
+0000d0a0: 616c 5f63 656c 6c5f 7369 7a65 0a20 2020  al_cell_size.   
+0000d0b0: 2020 2020 2066 6f72 2064 7a20 696e 2073       for dz in s
+0000d0c0: 656c 662e 5f64 7a5f 6172 7261 795b 3a20  elf._dz_array[: 
+0000d0d0: 7365 6c66 2e6e 756d 6265 725f 7375 7266  self.number_surf
+0000d0e0: 6163 655f 6365 6c6c 735d 3a0a 2020 2020  ace_cells]:.    
+0000d0f0: 2020 2020 2020 2020 6966 2064 7a20 213d          if dz !=
+0000d100: 2073 656c 662e 7375 7266 6163 655f 7665   self.surface_ve
+0000d110: 7274 6963 616c 5f63 656c 6c5f 7369 7a65  rtical_cell_size
+0000d120: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000d130: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+0000d140: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+0000d150: 2020 2020 2020 2020 2254 6865 2066 6972          "The fir
+0000d160: 7374 206e 756d 6265 725f 7375 7266 6163  st number_surfac
+0000d170: 655f 6365 6c6c 735f 6c69 6e65 2022 0a20  e_cells_line ". 
+0000d180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d190: 2020 2022 656c 656d 656e 7473 206f 6620     "elements of 
+0000d1a0: 647a 5f61 7272 6179 206d 7573 7420 6265  dz_array must be
+0000d1b0: 2065 7175 616c 2074 6f20 220a 2020 2020   equal to ".    
+0000d1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d1d0: 2273 7572 6661 6365 5f76 6572 7469 6361  "surface_vertica
+0000d1e0: 6c5f 6365 6c6c 5f73 697a 6522 0a20 2020  l_cell_size".   
+0000d1f0: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
+0000d200: 2020 2020 2020 2020 2320 5772 6974 6520          # Write 
+0000d210: 7375 7266 6163 6520 7665 7274 6963 616c  surface vertical
+0000d220: 2063 656c 6c20 7369 7a65 206c 696e 650a   cell size line.
+0000d230: 2020 2020 2020 2020 7375 7266 6163 655f          surface_
+0000d240: 647a 5f6c 696e 6520 3d20 280a 2020 2020  dz_line = (.    
+0000d250: 2020 2020 2020 2020 6622 7b66 6c6f 6174          f"{float
+0000d260: 2873 656c 662e 7375 7266 6163 655f 7665  (self.surface_ve
+0000d270: 7274 6963 616c 5f63 656c 6c5f 7369 7a65  rtical_cell_size
+0000d280: 297d 5c74 2120 2220 6622 5375 7266 6163  )}\t! " f"Surfac
+0000d290: 6520 445a 205b 6d5d 220a 2020 2020 2020  e DZ [m]".      
+0000d2a0: 2020 290a 0a20 2020 2020 2020 2023 2057    )..        # W
+0000d2b0: 7269 7465 2068 6561 6465 7220 6c69 6e65  rite header line
+0000d2c0: 0a20 2020 2020 2020 2068 6561 6465 725f  .        header_
+0000d2d0: 6c69 6e65 203d 2022 2120 445a 2061 7272  line = "! DZ arr
+0000d2e0: 6179 205b 6d5d 220a 0a20 2020 2020 2020  ay [m]"..       
+0000d2f0: 2023 2057 7269 7465 2064 7a5f 6172 7261   # Write dz_arra
+0000d300: 7920 6c69 6e65 730a 2020 2020 2020 2020  y lines.        
+0000d310: 647a 5f61 7272 6179 5f6c 696e 6573 5f6c  dz_array_lines_l
+0000d320: 6973 7420 3d20 5b5d 0a20 2020 2020 2020  ist = [].       
+0000d330: 2066 6f72 2064 7a20 696e 2073 656c 662e   for dz in self.
+0000d340: 5f64 7a5f 6172 7261 793a 0a20 2020 2020  _dz_array:.     
+0000d350: 2020 2020 2020 2064 7a5f 6172 7261 795f         dz_array_
+0000d360: 6c69 6e65 735f 6c69 7374 2e61 7070 656e  lines_list.appen
+0000d370: 6428 6622 7b66 6c6f 6174 2864 7a29 7d22  d(f"{float(dz)}"
+0000d380: 290a 2020 2020 2020 2020 647a 5f61 7272  ).        dz_arr
+0000d390: 6179 5f6c 696e 6573 203d 2022 5c6e 222e  ay_lines = "\n".
+0000d3a0: 6a6f 696e 2864 7a5f 6172 7261 795f 6c69  join(dz_array_li
+0000d3b0: 6e65 735f 6c69 7374 290a 0a20 2020 2020  nes_list)..     
+0000d3c0: 2020 2072 6574 7572 6e20 6622 7b73 7572     return f"{sur
+0000d3d0: 6661 6365 5f64 7a5f 6c69 6e65 7d5c 6e7b  face_dz_line}\n{
+0000d3e0: 6865 6164 6572 5f6c 696e 657d 5c6e 7b64  header_line}\n{d
+0000d3f0: 7a5f 6172 7261 795f 6c69 6e65 737d 220a  z_array_lines}".
+0000d400: 0a20 2020 2064 6566 205f 7374 7265 7463  .    def _stretc
+0000d410: 685f 6772 6964 5f66 6c61 675f 3328 7365  h_grid_flag_3(se
+0000d420: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+0000d430: 0a20 2020 2020 2020 2047 656e 6572 6174  .        Generat
+0000d440: 6573 2061 2076 6572 7469 6361 6c20 6772  es a vertical gr
+0000d450: 6964 2066 6f72 2073 7472 6574 6368 5f67  id for stretch_g
+0000d460: 7269 645f 666c 6167 2033 2061 7320 6120  rid_flag 3 as a 
+0000d470: 7374 7269 6e67 2066 6f72 2074 6865 0a20  string for the. 
+0000d480: 2020 2020 2020 2051 555f 7369 6d70 6172         QU_simpar
+0000d490: 616d 732e 696e 7020 6669 6c65 2e20 5374  ams.inp file. St
+0000d4a0: 7265 7463 6820 6772 6964 2066 6c61 6720  retch grid flag 
+0000d4b0: 3320 6973 2061 2073 7472 6574 6368 696e  3 is a stretchin
+0000d4c0: 6720 7769 7468 0a20 2020 2020 2020 2070  g with.        p
+0000d4d0: 6172 6162 6f6c 6963 2076 6572 7469 6361  arabolic vertica
+0000d4e0: 6c20 6365 6c6c 2073 697a 652e 2041 6464  l cell size. Add
+0000d4f0: 7320 7468 6520 7061 7261 626f 6c69 6320  s the parabolic 
+0000d500: 6772 6964 2074 6f20 647a 5f61 7272 6179  grid to dz_array
+0000d510: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+0000d520: 2020 2020 2020 2320 5772 6974 6520 7375        # Write su
+0000d530: 7266 6163 6520 7665 7274 6963 616c 2063  rface vertical c
+0000d540: 656c 6c20 7369 7a65 206c 696e 650a 2020  ell size line.  
+0000d550: 2020 2020 2020 7375 7266 6163 655f 647a        surface_dz
+0000d560: 5f6c 696e 6520 3d20 280a 2020 2020 2020  _line = (.      
+0000d570: 2020 2020 2020 6622 7b66 6c6f 6174 2873        f"{float(s
+0000d580: 656c 662e 7375 7266 6163 655f 7665 7274  elf.surface_vert
+0000d590: 6963 616c 5f63 656c 6c5f 7369 7a65 297d  ical_cell_size)}
+0000d5a0: 5c74 2120 2220 6622 5375 7266 6163 6520  \t! " f"Surface 
+0000d5b0: 445a 205b 6d5d 220a 2020 2020 2020 2020  DZ [m]".        
+0000d5c0: 290a 0a20 2020 2020 2020 2023 2057 7269  )..        # Wri
+0000d5d0: 7465 206e 756d 6265 7220 6f66 2073 7572  te number of sur
+0000d5e0: 6661 6365 2063 656c 6c73 206c 696e 650a  face cells line.
+0000d5f0: 2020 2020 2020 2020 6e75 6d62 6572 5f73          number_s
+0000d600: 7572 6661 6365 5f63 656c 6c73 5f6c 696e  urface_cells_lin
+0000d610: 6520 3d20 280a 2020 2020 2020 2020 2020  e = (.          
+0000d620: 2020 6622 7b73 656c 662e 6e75 6d62 6572    f"{self.number
+0000d630: 5f73 7572 6661 6365 5f63 656c 6c73 7d5c  _surface_cells}\
+0000d640: 7421 2022 2066 224e 756d 6265 7220 6f66  t! " f"Number of
+0000d650: 2075 6e69 666f 726d 2073 7572 6661 6365   uniform surface
+0000d660: 2063 656c 6c73 220a 2020 2020 2020 2020   cells".        
+0000d670: 290a 0a20 2020 2020 2020 2023 2057 7269  )..        # Wri
+0000d680: 7465 2068 6561 6465 7220 6c69 6e65 0a20  te header line. 
+0000d690: 2020 2020 2020 2068 6561 6465 725f 6c69         header_li
+0000d6a0: 6e65 203d 2022 2120 445a 2061 7272 6179  ne = "! DZ array
+0000d6b0: 205b 6d5d 220a 0a20 2020 2020 2020 2023   [m]"..        #
+0000d6c0: 2057 7269 7465 2064 7a5f 6172 7261 7920   Write dz_array 
+0000d6d0: 6c69 6e65 730a 2020 2020 2020 2020 647a  lines.        dz
+0000d6e0: 5f6c 696e 6573 203d 2022 5c6e 222e 6a6f  _lines = "\n".jo
+0000d6f0: 696e 285b 6622 7b66 6c6f 6174 2864 7a29  in([f"{float(dz)
+0000d700: 7d22 2066 6f72 2064 7a20 696e 2073 656c  }" for dz in sel
+0000d710: 662e 5f64 7a5f 6172 7261 795d 290a 0a20  f._dz_array]).. 
+0000d720: 2020 2020 2020 2072 6574 7572 6e20 280a         return (.
+0000d730: 2020 2020 2020 2020 2020 2020 6622 7b73              f"{s
+0000d740: 7572 6661 6365 5f64 7a5f 6c69 6e65 7d5c  urface_dz_line}\
+0000d750: 6e7b 6e75 6d62 6572 5f73 7572 6661 6365  n{number_surface
+0000d760: 5f63 656c 6c73 5f6c 696e 657d 5c6e 7b68  _cells_line}\n{h
+0000d770: 6561 6465 725f 6c69 6e65 7d22 0a20 2020  eader_line}".   
+0000d780: 2020 2020 2020 2020 2066 225c 6e7b 647a           f"\n{dz
+0000d790: 5f6c 696e 6573 7d22 0a20 2020 2020 2020  _lines}".       
+0000d7a0: 2029 0a0a 2020 2020 6465 6620 5f67 656e   )..    def _gen
+0000d7b0: 6572 6174 655f 7769 6e64 5f74 696d 655f  erate_wind_time_
+0000d7c0: 6c69 6e65 7328 7365 6c66 293a 0a20 2020  lines(self):.   
+0000d7d0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0000d7e0: 2050 6172 7365 7320 7468 6520 7574 635f   Parses the utc_
+0000d7f0: 6f66 6673 6574 2061 6e64 2077 696e 645f  offset and wind_
+0000d800: 7469 6d65 7320 746f 2067 656e 6572 6174  times to generat
+0000d810: 6520 7468 6520 7769 6e64 2074 696d 6573  e the wind times
+0000d820: 0a20 2020 2020 2020 2061 7320 6120 7374  .        as a st
+0000d830: 7269 6e67 2066 6f72 2074 6865 2051 555f  ring for the QU_
+0000d840: 7369 6d70 6172 616d 732e 696e 7020 6669  simparams.inp fi
+0000d850: 6c65 2e0a 2020 2020 2020 2020 2222 220a  le..        """.
+0000d860: 2020 2020 2020 2020 2320 5665 7269 6679          # Verify
+0000d870: 2074 6861 7420 7769 6e64 5f73 7465 705f   that wind_step_
+0000d880: 7469 6d65 7320 6973 206e 6f74 2065 6d70  times is not emp
+0000d890: 7479 0a20 2020 2020 2020 2069 6620 6e6f  ty.        if no
+0000d8a0: 7420 7365 6c66 2e77 696e 645f 7469 6d65  t self.wind_time
+0000d8b0: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
+0000d8c0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+0000d8d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d8e0: 2022 7769 6e64 5f74 696d 6573 206d 7573   "wind_times mus
+0000d8f0: 7420 6e6f 7420 6265 2065 6d70 7479 2e20  t not be empty. 
+0000d900: 506c 6561 7365 2022 0a20 2020 2020 2020  Please ".       
+0000d910: 2020 2020 2020 2020 2022 7072 6f76 6964           "provid
+0000d920: 6520 6120 7769 6e64 5f74 696d 6573 2077  e a wind_times w
+0000d930: 6974 6820 6e75 6d5f 7769 6e64 5f73 7465  ith num_wind_ste
+0000d940: 7073 2022 0a20 2020 2020 2020 2020 2020  ps ".           
+0000d950: 2020 2020 2022 656c 656d 656e 7473 206f       "elements o
+0000d960: 7220 7573 6520 6120 6469 6666 6572 656e  r use a differen
+0000d970: 7420 6e75 6d5f 7769 6e64 5f73 7465 7073  t num_wind_steps
+0000d980: 2e22 0a20 2020 2020 2020 2020 2020 2029  .".            )
+0000d990: 0a0a 2020 2020 2020 2020 2320 5772 6974  ..        # Writ
+0000d9a0: 6520 6e75 6d62 6572 206f 6620 7469 6d65  e number of time
+0000d9b0: 2069 6e63 7265 6d65 6e74 7320 6c69 6e65   increments line
+0000d9c0: 0a20 2020 2020 2020 206e 756d 6265 725f  .        number_
+0000d9d0: 7469 6d65 5f69 6e63 7265 6d65 6e74 735f  time_increments_
+0000d9e0: 6c69 6e65 203d 2028 0a20 2020 2020 2020  line = (.       
+0000d9f0: 2020 2020 2066 227b 6c65 6e28 7365 6c66       f"{len(self
+0000da00: 2e77 696e 645f 7469 6d65 7329 7d5c 7422  .wind_times)}\t"
+0000da10: 2066 2221 204e 756d 6265 7220 6f66 2074   f"! Number of t
+0000da20: 696d 6520 696e 6372 656d 656e 7473 220a  ime increments".
+0000da30: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+0000da40: 2020 2023 2057 7269 7465 2075 7463 5f6f     # Write utc_o
+0000da50: 6666 7365 7420 6c69 6e65 0a20 2020 2020  ffset line.     
+0000da60: 2020 2075 7463 5f6f 6666 7365 745f 6c69     utc_offset_li
+0000da70: 6e65 203d 2066 227b 7365 6c66 2e75 7463  ne = f"{self.utc
+0000da80: 5f6f 6666 7365 747d 5c74 2120 5554 4320  _offset}\t! UTC 
+0000da90: 6f66 6673 6574 205b 686f 7572 735d 220a  offset [hours]".
+0000daa0: 0a20 2020 2020 2020 2023 2057 7269 7465  .        # Write
+0000dab0: 2068 6561 6465 7220 6c69 6e65 0a20 2020   header line.   
+0000dac0: 2020 2020 2068 6561 6465 725f 6c69 6e65       header_line
+0000dad0: 203d 2022 2120 5769 6e64 2073 7465 7020   = "! Wind step 
+0000dae0: 7469 6d65 7320 5b73 5d22 0a0a 2020 2020  times [s]"..    
+0000daf0: 2020 2020 2320 5772 6974 6520 7769 6e64      # Write wind
+0000db00: 5f73 7465 705f 7469 6d65 7320 6c69 6e65  _step_times line
+0000db10: 730a 2020 2020 2020 2020 7769 6e64 5f73  s.        wind_s
+0000db20: 7465 705f 7469 6d65 735f 6c69 6e65 735f  tep_times_lines_
+0000db30: 6c69 7374 203d 205b 5d0a 2020 2020 2020  list = [].      
+0000db40: 2020 666f 7220 7769 6e64 5f74 696d 6520    for wind_time 
+0000db50: 696e 2073 656c 662e 7769 6e64 5f74 696d  in self.wind_tim
+0000db60: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
+0000db70: 7769 6e64 5f73 7465 705f 7469 6d65 735f  wind_step_times_
+0000db80: 6c69 6e65 735f 6c69 7374 2e61 7070 656e  lines_list.appen
+0000db90: 6428 6622 7b77 696e 645f 7469 6d65 7d22  d(f"{wind_time}"
+0000dba0: 290a 2020 2020 2020 2020 7769 6e64 5f73  ).        wind_s
+0000dbb0: 7465 705f 7469 6d65 735f 6c69 6e65 7320  tep_times_lines 
+0000dbc0: 3d20 225c 6e22 2e6a 6f69 6e28 7769 6e64  = "\n".join(wind
+0000dbd0: 5f73 7465 705f 7469 6d65 735f 6c69 6e65  _step_times_line
+0000dbe0: 735f 6c69 7374 290a 0a20 2020 2020 2020  s_list)..       
+0000dbf0: 2072 6574 7572 6e20 225c 6e22 2e6a 6f69   return "\n".joi
+0000dc00: 6e28 0a20 2020 2020 2020 2020 2020 205b  n(.            [
+0000dc10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000dc20: 206e 756d 6265 725f 7469 6d65 5f69 6e63   number_time_inc
+0000dc30: 7265 6d65 6e74 735f 6c69 6e65 2c0a 2020  rements_line,.  
+0000dc40: 2020 2020 2020 2020 2020 2020 2020 7574                ut
+0000dc50: 635f 6f66 6673 6574 5f6c 696e 652c 0a20  c_offset_line,. 
+0000dc60: 2020 2020 2020 2020 2020 2020 2020 2068                 h
+0000dc70: 6561 6465 725f 6c69 6e65 2c0a 2020 2020  eader_line,.    
+0000dc80: 2020 2020 2020 2020 2020 2020 7769 6e64              wind
+0000dc90: 5f73 7465 705f 7469 6d65 735f 6c69 6e65  _step_times_line
+0000dca0: 732c 0a20 2020 2020 2020 2020 2020 205d  s,.            ]
+0000dcb0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+0000dcc0: 4063 6c61 7373 6d65 7468 6f64 0a20 2020  @classmethod.   
+0000dcd0: 2064 6566 2066 726f 6d5f 6669 6c65 2863   def from_file(c
+0000dce0: 6c73 2c20 6469 7265 6374 6f72 793a 2073  ls, directory: s
+0000dcf0: 7472 207c 2050 6174 682c 202a 2a6b 7761  tr | Path, **kwa
+0000dd00: 7267 7329 3a0a 2020 2020 2020 2020 2222  rgs):.        ""
+0000dd10: 220a 2020 2020 2020 2020 496e 6974 6961  ".        Initia
+0000dd20: 6c69 7a65 7320 6120 5155 5f53 696d 7061  lizes a QU_Simpa
+0000dd30: 7261 6d73 206f 626a 6563 7420 6672 6f6d  rams object from
+0000dd40: 2061 2064 6972 6563 746f 7279 2063 6f6e   a directory con
+0000dd50: 7461 696e 696e 6720 610a 2020 2020 2020  taining a.      
+0000dd60: 2020 5155 5f73 696d 7061 7261 6d73 2e69    QU_simparams.i
+0000dd70: 6e70 2066 696c 652e 0a20 2020 2020 2020  np file..       
+0000dd80: 2022 2222 0a20 2020 2020 2020 2069 6620   """.        if 
+0000dd90: 6973 696e 7374 616e 6365 2864 6972 6563  isinstance(direc
+0000dda0: 746f 7279 2c20 7374 7229 3a0a 2020 2020  tory, str):.    
+0000ddb0: 2020 2020 2020 2020 6469 7265 6374 6f72          director
+0000ddc0: 7920 3d20 5061 7468 2864 6972 6563 746f  y = Path(directo
+0000ddd0: 7279 290a 0a20 2020 2020 2020 2077 6974  ry)..        wit
+0000dde0: 6820 6f70 656e 2864 6972 6563 746f 7279  h open(directory
+0000ddf0: 202f 2022 5155 5f73 696d 7061 7261 6d73   / "QU_simparams
+0000de00: 2e69 6e70 222c 2022 7222 2920 6173 2066  .inp", "r") as f
+0000de10: 3a0a 2020 2020 2020 2020 2020 2020 6c69  :.            li
+0000de20: 6e65 7320 3d20 662e 7265 6164 6c69 6e65  nes = f.readline
+0000de30: 7328 290a 0a20 2020 2020 2020 2074 7279  s()..        try
+0000de40: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+0000de50: 5265 6164 2051 5520 6772 6964 2070 6172  Read QU grid par
+0000de60: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
+0000de70: 2020 2020 6e78 203d 2069 6e74 286c 696e      nx = int(lin
+0000de80: 6573 5b31 5d2e 7374 7269 7028 292e 7370  es[1].strip().sp
+0000de90: 6c69 7428 295b 305d 290a 2020 2020 2020  lit()[0]).      
+0000dea0: 2020 2020 2020 6e79 203d 2069 6e74 286c        ny = int(l
+0000deb0: 696e 6573 5b32 5d2e 7374 7269 7028 292e  ines[2].strip().
+0000dec0: 7370 6c69 7428 295b 305d 290a 2020 2020  split()[0]).    
+0000ded0: 2020 2020 2020 2020 6e7a 203d 2069 6e74          nz = int
+0000dee0: 286c 696e 6573 5b33 5d2e 7374 7269 7028  (lines[3].strip(
+0000def0: 292e 7370 6c69 7428 295b 305d 290a 2020  ).split()[0]).  
+0000df00: 2020 2020 2020 2020 2020 6478 203d 2066            dx = f
+0000df10: 6c6f 6174 286c 696e 6573 5b34 5d2e 7374  loat(lines[4].st
+0000df20: 7269 7028 292e 7370 6c69 7428 295b 305d  rip().split()[0]
+0000df30: 290a 2020 2020 2020 2020 2020 2020 6479  ).            dy
+0000df40: 203d 2066 6c6f 6174 286c 696e 6573 5b35   = float(lines[5
+0000df50: 5d2e 7374 7269 7028 292e 7370 6c69 7428  ].strip().split(
+0000df60: 295b 305d 290a 0a20 2020 2020 2020 2020  )[0])..         
+0000df70: 2020 2023 2052 6561 6420 7374 7265 7463     # Read stretc
+0000df80: 6820 6772 6964 2066 6c61 670a 2020 2020  h grid flag.    
+0000df90: 2020 2020 2020 2020 7374 7265 7463 685f          stretch_
+0000dfa0: 6772 6964 5f66 6c61 6720 3d20 696e 7428  grid_flag = int(
+0000dfb0: 6c69 6e65 735b 365d 2e73 7472 6970 2829  lines[6].strip()
+0000dfc0: 2e73 706c 6974 2829 5b30 5d29 0a0a 2020  .split()[0])..  
+0000dfd0: 2020 2020 2020 2020 2020 2320 5265 6164            # Read
+0000dfe0: 2076 6572 7469 6361 6c20 6772 6964 206c   vertical grid l
+0000dff0: 696e 6573 2061 7320 6675 6e63 7469 6f6e  ines as function
+0000e000: 206f 6620 7374 7265 7463 6820 6772 6964   of stretch grid
+0000e010: 2066 6c61 670a 2020 2020 2020 2020 2020   flag.          
+0000e020: 2020 6672 6f6d 5f66 696c 655f 647a 5f61    from_file_dz_a
+0000e030: 7272 6179 203d 205b 5d0a 2020 2020 2020  rray = [].      
+0000e040: 2020 2020 2020 6375 7374 6f6d 5f64 7a5f        custom_dz_
+0000e050: 6172 7261 7920 3d20 5b5d 0a20 2020 2020  array = [].     
+0000e060: 2020 2020 2020 2069 6620 7374 7265 7463         if stretc
+0000e070: 685f 6772 6964 5f66 6c61 6720 3d3d 2030  h_grid_flag == 0
+0000e080: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000e090: 2020 7375 7266 6163 655f 7665 7274 6963    surface_vertic
+0000e0a0: 616c 5f63 656c 6c5f 7369 7a65 203d 2066  al_cell_size = f
+0000e0b0: 6c6f 6174 286c 696e 6573 5b37 5d2e 7374  loat(lines[7].st
+0000e0c0: 7269 7028 292e 7370 6c69 7428 295b 305d  rip().split()[0]
+0000e0d0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0000e0e0: 2020 6e75 6d62 6572 5f73 7572 6661 6365    number_surface
+0000e0f0: 5f63 656c 6c73 203d 2069 6e74 286c 696e  _cells = int(lin
+0000e100: 6573 5b38 5d2e 7374 7269 7028 292e 7370  es[8].strip().sp
+0000e110: 6c69 7428 295b 305d 290a 2020 2020 2020  lit()[0]).      
+0000e120: 2020 2020 2020 2020 2020 7175 6963 5f64            quic_d
+0000e130: 6f6d 6169 6e5f 6865 6967 6874 203d 2073  omain_height = s
+0000e140: 7572 6661 6365 5f76 6572 7469 6361 6c5f  urface_vertical_
+0000e150: 6365 6c6c 5f73 697a 6520 2a20 6e75 6d62  cell_size * numb
+0000e160: 6572 5f73 7572 6661 6365 5f63 656c 6c73  er_surface_cells
+0000e170: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000e180: 2063 7572 7265 6e74 5f6c 696e 6520 3d20   current_line = 
+0000e190: 390a 2020 2020 2020 2020 2020 2020 656c  9.            el
+0000e1a0: 6966 2073 7472 6574 6368 5f67 7269 645f  if stretch_grid_
+0000e1b0: 666c 6167 203d 3d20 313a 0a20 2020 2020  flag == 1:.     
+0000e1c0: 2020 2020 2020 2020 2020 2073 7572 6661             surfa
+0000e1d0: 6365 5f76 6572 7469 6361 6c5f 6365 6c6c  ce_vertical_cell
+0000e1e0: 5f73 697a 6520 3d20 666c 6f61 7428 6c69  _size = float(li
+0000e1f0: 6e65 735b 375d 2e73 7472 6970 2829 2e73  nes[7].strip().s
+0000e200: 706c 6974 2829 5b30 5d29 0a20 2020 2020  plit()[0]).     
+0000e210: 2020 2020 2020 2020 2020 206e 756d 6265             numbe
+0000e220: 725f 7375 7266 6163 655f 6365 6c6c 7320  r_surface_cells 
+0000e230: 3d20 350a 2020 2020 2020 2020 2020 2020  = 5.            
+0000e240: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
+0000e250: 6765 2839 2c20 3920 2b20 6e7a 293a 0a20  ge(9, 9 + nz):. 
+0000e260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e270: 2020 2063 7573 746f 6d5f 647a 5f61 7272     custom_dz_arr
+0000e280: 6179 2e61 7070 656e 6428 666c 6f61 7428  ay.append(float(
+0000e290: 6c69 6e65 735b 695d 2e73 7472 6970 2829  lines[i].strip()
+0000e2a0: 2e73 706c 6974 2829 5b30 5d29 290a 2020  .split()[0])).  
+0000e2b0: 2020 2020 2020 2020 2020 2020 2020 7175                qu
+0000e2c0: 6963 5f64 6f6d 6169 6e5f 6865 6967 6874  ic_domain_height
+0000e2d0: 203d 2072 6f75 6e64 2873 756d 2863 7573   = round(sum(cus
+0000e2e0: 746f 6d5f 647a 5f61 7272 6179 292c 2032  tom_dz_array), 2
+0000e2f0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0000e300: 2020 6375 7272 656e 745f 6c69 6e65 203d    current_line =
+0000e310: 2039 202b 206e 7a0a 2020 2020 2020 2020   9 + nz.        
+0000e320: 2020 2020 656c 6966 2073 7472 6574 6368      elif stretch
+0000e330: 5f67 7269 645f 666c 6167 203d 3d20 333a  _grid_flag == 3:
+0000e340: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000e350: 2073 7572 6661 6365 5f76 6572 7469 6361   surface_vertica
+0000e360: 6c5f 6365 6c6c 5f73 697a 6520 3d20 666c  l_cell_size = fl
+0000e370: 6f61 7428 6c69 6e65 735b 375d 2e73 7472  oat(lines[7].str
+0000e380: 6970 2829 2e73 706c 6974 2829 5b30 5d29  ip().split()[0])
+0000e390: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000e3a0: 206e 756d 6265 725f 7375 7266 6163 655f   number_surface_
+0000e3b0: 6365 6c6c 7320 3d20 696e 7428 6c69 6e65  cells = int(line
+0000e3c0: 735b 385d 2e73 7472 6970 2829 2e73 706c  s[8].strip().spl
+0000e3d0: 6974 2829 5b30 5d29 0a20 2020 2020 2020  it()[0]).       
+0000e3e0: 2020 2020 2020 2020 2066 6f72 2069 2069           for i i
+0000e3f0: 6e20 7261 6e67 6528 3130 2c20 3130 202b  n range(10, 10 +
+0000e400: 206e 7a29 3a0a 2020 2020 2020 2020 2020   nz):.          
+0000e410: 2020 2020 2020 2020 2020 6672 6f6d 5f66            from_f
+0000e420: 696c 655f 647a 5f61 7272 6179 2e61 7070  ile_dz_array.app
+0000e430: 656e 6428 666c 6f61 7428 6c69 6e65 735b  end(float(lines[
+0000e440: 695d 2e73 7472 6970 2829 2e73 706c 6974  i].strip().split
+0000e450: 2829 5b30 5d29 290a 2020 2020 2020 2020  ()[0])).        
+0000e460: 2020 2020 2020 2020 7175 6963 5f64 6f6d          quic_dom
+0000e470: 6169 6e5f 6865 6967 6874 203d 2072 6f75  ain_height = rou
+0000e480: 6e64 2873 756d 2866 726f 6d5f 6669 6c65  nd(sum(from_file
+0000e490: 5f64 7a5f 6172 7261 7929 2c20 3229 0a20  _dz_array), 2). 
+0000e4a0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0000e4b0: 7572 7265 6e74 5f6c 696e 6520 3d20 3130  urrent_line = 10
+0000e4c0: 202b 206e 7a0a 2020 2020 2020 2020 2020   + nz.          
+0000e4d0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0000e4e0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+0000e4f0: 6c75 6545 7272 6f72 2822 7374 7265 7463  lueError("stretc
+0000e500: 685f 6772 6964 5f66 6c61 6720 6d75 7374  h_grid_flag must
+0000e510: 2062 6520 302c 2031 2c20 6f72 2033 2e22   be 0, 1, or 3."
+0000e520: 290a 0a20 2020 2020 2020 2020 2020 2023  )..            #
+0000e530: 2052 6561 6420 5155 2077 696e 6420 7061   Read QU wind pa
+0000e540: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
+0000e550: 2020 2020 206e 756d 6265 725f 7769 6e64       number_wind
+0000e560: 5f73 7465 7073 203d 2069 6e74 286c 696e  _steps = int(lin
+0000e570: 6573 5b63 7572 7265 6e74 5f6c 696e 655d  es[current_line]
+0000e580: 2e73 7472 6970 2829 2e73 706c 6974 2829  .strip().split()
+0000e590: 5b30 5d29 0a20 2020 2020 2020 2020 2020  [0]).           
+0000e5a0: 2075 7463 5f6f 6666 7365 7420 3d20 696e   utc_offset = in
+0000e5b0: 7428 6c69 6e65 735b 6375 7272 656e 745f  t(lines[current_
+0000e5c0: 6c69 6e65 202b 2031 5d2e 7374 7269 7028  line + 1].strip(
+0000e5d0: 292e 7370 6c69 7428 295b 305d 290a 2020  ).split()[0]).  
+0000e5e0: 2020 2020 2020 2020 2020 5f20 3d20 6c69            _ = li
+0000e5f0: 6e65 735b 6375 7272 656e 745f 6c69 6e65  nes[current_line
+0000e600: 202b 2032 5d2e 7374 7269 7028 292e 7370   + 2].strip().sp
+0000e610: 6c69 7428 295b 305d 0a20 2020 2020 2020  lit()[0].       
+0000e620: 2020 2020 2077 696e 645f 7469 6d65 7320       wind_times 
+0000e630: 3d20 5b5d 0a20 2020 2020 2020 2020 2020  = [].           
+0000e640: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
+0000e650: 6375 7272 656e 745f 6c69 6e65 202b 2033  current_line + 3
+0000e660: 2c20 6375 7272 656e 745f 6c69 6e65 202b  , current_line +
+0000e670: 2033 202b 206e 756d 6265 725f 7769 6e64   3 + number_wind
+0000e680: 5f73 7465 7073 293a 0a20 2020 2020 2020  _steps):.       
+0000e690: 2020 2020 2020 2020 2077 696e 645f 7469           wind_ti
+0000e6a0: 6d65 732e 6170 7065 6e64 2869 6e74 286c  mes.append(int(l
+0000e6b0: 696e 6573 5b69 5d2e 7374 7269 7028 2929  ines[i].strip())
+0000e6c0: 290a 2020 2020 2020 2020 2020 2020 6375  ).            cu
+0000e6d0: 7272 656e 745f 6c69 6e65 203d 2063 7572  rrent_line = cur
+0000e6e0: 7265 6e74 5f6c 696e 6520 2b20 3320 2b20  rent_line + 3 + 
+0000e6f0: 6e75 6d62 6572 5f77 696e 645f 7374 6570  number_wind_step
+0000e700: 730a 0a20 2020 2020 2020 2020 2020 2023  s..            #
+0000e710: 2053 6b69 7020 6e6f 7420 7573 6564 2070   Skip not used p
+0000e720: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
+0000e730: 2020 2020 2020 6375 7272 656e 745f 6c69        current_li
+0000e740: 6e65 202b 3d20 390a 0a20 2020 2020 2020  ne += 9..       
+0000e750: 2020 2020 2023 2052 6561 6420 7265 6d61       # Read rema
+0000e760: 696e 696e 6720 5155 2070 6172 616d 6574  ining QU paramet
+0000e770: 6572 730a 2020 2020 2020 2020 2020 2020  ers.            
+0000e780: 736f 725f 6974 6572 5f6d 6178 203d 2069  sor_iter_max = i
+0000e790: 6e74 286c 696e 6573 5b63 7572 7265 6e74  nt(lines[current
+0000e7a0: 5f6c 696e 655d 2e73 7472 6970 2829 2e73  _line].strip().s
+0000e7b0: 706c 6974 2829 5b30 5d29 0a20 2020 2020  plit()[0]).     
+0000e7c0: 2020 2020 2020 2073 6f72 5f72 6573 6964         sor_resid
+0000e7d0: 7561 6c5f 7265 6475 6374 696f 6e20 3d20  ual_reduction = 
+0000e7e0: 696e 7428 6c69 6e65 735b 6375 7272 656e  int(lines[curren
+0000e7f0: 745f 6c69 6e65 202b 2031 5d2e 7374 7269  t_line + 1].stri
+0000e800: 7028 292e 7370 6c69 7428 295b 305d 290a  p().split()[0]).
+0000e810: 2020 2020 2020 2020 2020 2020 7573 655f              use_
+0000e820: 6469 6666 7573 696f 6e5f 666c 6167 203d  diffusion_flag =
+0000e830: 2069 6e74 286c 696e 6573 5b63 7572 7265   int(lines[curre
+0000e840: 6e74 5f6c 696e 6520 2b20 325d 2e73 7472  nt_line + 2].str
+0000e850: 6970 2829 2e73 706c 6974 2829 5b30 5d29  ip().split()[0])
+0000e860: 0a20 2020 2020 2020 2020 2020 206e 756d  .            num
+0000e870: 6265 725f 6469 6666 7573 696f 6e5f 6974  ber_diffusion_it
+0000e880: 6572 6174 696f 6e73 203d 2069 6e74 280a  erations = int(.
+0000e890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e8a0: 6c69 6e65 735b 6375 7272 656e 745f 6c69  lines[current_li
+0000e8b0: 6e65 202b 2033 5d2e 7374 7269 7028 292e  ne + 3].strip().
+0000e8c0: 7370 6c69 7428 295b 305d 0a20 2020 2020  split()[0].     
+0000e8d0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0000e8e0: 2020 2020 2064 6f6d 6169 6e5f 726f 7461       domain_rota
+0000e8f0: 7469 6f6e 203d 2066 6c6f 6174 286c 696e  tion = float(lin
+0000e900: 6573 5b63 7572 7265 6e74 5f6c 696e 6520  es[current_line 
+0000e910: 2b20 345d 2e73 7472 6970 2829 2e73 706c  + 4].strip().spl
+0000e920: 6974 2829 5b30 5d29 0a20 2020 2020 2020  it()[0]).       
+0000e930: 2020 2020 2075 746d 5f78 203d 2066 6c6f       utm_x = flo
+0000e940: 6174 286c 696e 6573 5b63 7572 7265 6e74  at(lines[current
+0000e950: 5f6c 696e 6520 2b20 355d 2e73 7472 6970  _line + 5].strip
+0000e960: 2829 2e73 706c 6974 2829 5b30 5d29 0a20  ().split()[0]). 
+0000e970: 2020 2020 2020 2020 2020 2075 746d 5f79             utm_y
+0000e980: 203d 2066 6c6f 6174 286c 696e 6573 5b63   = float(lines[c
+0000e990: 7572 7265 6e74 5f6c 696e 6520 2b20 365d  urrent_line + 6]
+0000e9a0: 2e73 7472 6970 2829 2e73 706c 6974 2829  .strip().split()
+0000e9b0: 5b30 5d29 0a20 2020 2020 2020 2020 2020  [0]).           
+0000e9c0: 2075 746d 5f7a 6f6e 655f 6e75 6d62 6572   utm_zone_number
+0000e9d0: 203d 2069 6e74 286c 696e 6573 5b63 7572   = int(lines[cur
+0000e9e0: 7265 6e74 5f6c 696e 6520 2b20 375d 2e73  rent_line + 7].s
+0000e9f0: 7472 6970 2829 2e73 706c 6974 2829 5b30  trip().split()[0
+0000ea00: 5d29 0a20 2020 2020 2020 2020 2020 2075  ]).            u
+0000ea10: 746d 5f7a 6f6e 655f 6c65 7474 6572 203d  tm_zone_letter =
+0000ea20: 2069 6e74 286c 696e 6573 5b63 7572 7265   int(lines[curre
+0000ea30: 6e74 5f6c 696e 6520 2b20 385d 2e73 7472  nt_line + 8].str
+0000ea40: 6970 2829 2e73 706c 6974 2829 5b30 5d29  ip().split()[0])
+0000ea50: 0a20 2020 2020 2020 2020 2020 2071 7569  .            qui
+0000ea60: 635f 6366 645f 666c 6167 203d 2069 6e74  c_cfd_flag = int
+0000ea70: 286c 696e 6573 5b63 7572 7265 6e74 5f6c  (lines[current_l
+0000ea80: 696e 6520 2b20 395d 2e73 7472 6970 2829  ine + 9].strip()
+0000ea90: 2e73 706c 6974 2829 5b30 5d29 0a20 2020  .split()[0]).   
+0000eaa0: 2020 2020 2020 2020 2065 7870 6c6f 7369           explosi
+0000eab0: 7665 5f62 6c64 675f 666c 6167 203d 2069  ve_bldg_flag = i
+0000eac0: 6e74 286c 696e 6573 5b63 7572 7265 6e74  nt(lines[current
+0000ead0: 5f6c 696e 6520 2b20 3130 5d2e 7374 7269  _line + 10].stri
+0000eae0: 7028 292e 7370 6c69 7428 295b 305d 290a  p().split()[0]).
+0000eaf0: 2020 2020 2020 2020 2020 2020 626c 6467              bldg
+0000eb00: 5f61 7272 6179 5f66 6c61 6720 3d20 696e  _array_flag = in
+0000eb10: 7428 6c69 6e65 735b 6375 7272 656e 745f  t(lines[current_
+0000eb20: 6c69 6e65 202b 2031 315d 2e73 7472 6970  line + 11].strip
+0000eb30: 2829 2e73 706c 6974 2829 5b30 5d29 0a0a  ().split()[0])..
+0000eb40: 2020 2020 2020 2020 6578 6365 7074 2049          except I
+0000eb50: 6e64 6578 4572 726f 723a 0a20 2020 2020  ndexError:.     
+0000eb60: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+0000eb70: 7565 4572 726f 7228 0a20 2020 2020 2020  ueError(.       
+0000eb80: 2020 2020 2020 2020 2066 2245 7272 6f72           f"Error
+0000eb90: 2070 6172 7369 6e67 207b 636c 732e 5f5f   parsing {cls.__
+0000eba0: 6e61 6d65 5f5f 7d20 6672 6f6d 2066 696c  name__} from fil
+0000ebb0: 653a 2051 555f 7369 6d70 6172 616d 732e  e: QU_simparams.
+0000ebc0: 696e 7022 0a20 2020 2020 2020 2020 2020  inp".           
+0000ebd0: 2020 2020 2066 225c 6e50 6c65 6173 6520       f"\nPlease 
+0000ebe0: 6368 6563 6b20 7468 6520 6669 6c65 2066  check the file f
+0000ebf0: 6f72 2063 6f72 7265 6374 6e65 7373 2e22  or correctness."
+0000ec00: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+0000ec10: 2020 2020 2020 2020 7175 5f73 696d 7061          qu_simpa
+0000ec20: 7261 6d73 203d 2063 6c73 280a 2020 2020  rams = cls(.    
+0000ec30: 2020 2020 2020 2020 6e78 3d6e 782c 0a20          nx=nx,. 
+0000ec40: 2020 2020 2020 2020 2020 206e 793d 6e79             ny=ny
+0000ec50: 2c0a 2020 2020 2020 2020 2020 2020 6e7a  ,.            nz
+0000ec60: 3d6e 7a2c 0a20 2020 2020 2020 2020 2020  =nz,.           
+0000ec70: 2064 783d 6478 2c0a 2020 2020 2020 2020   dx=dx,.        
+0000ec80: 2020 2020 6479 3d64 792c 0a20 2020 2020      dy=dy,.     
+0000ec90: 2020 2020 2020 2071 7569 635f 646f 6d61         quic_doma
+0000eca0: 696e 5f68 6569 6768 743d 7175 6963 5f64  in_height=quic_d
+0000ecb0: 6f6d 6169 6e5f 6865 6967 6874 2c0a 2020  omain_height,.  
+0000ecc0: 2020 2020 2020 2020 2020 7375 7266 6163            surfac
+0000ecd0: 655f 7665 7274 6963 616c 5f63 656c 6c5f  e_vertical_cell_
+0000ece0: 7369 7a65 3d73 7572 6661 6365 5f76 6572  size=surface_ver
+0000ecf0: 7469 6361 6c5f 6365 6c6c 5f73 697a 652c  tical_cell_size,
+0000ed00: 0a20 2020 2020 2020 2020 2020 206e 756d  .            num
+0000ed10: 6265 725f 7375 7266 6163 655f 6365 6c6c  ber_surface_cell
+0000ed20: 733d 6e75 6d62 6572 5f73 7572 6661 6365  s=number_surface
+0000ed30: 5f63 656c 6c73 2c0a 2020 2020 2020 2020  _cells,.        
+0000ed40: 2020 2020 7374 7265 7463 685f 6772 6964      stretch_grid
+0000ed50: 5f66 6c61 673d 7374 7265 7463 685f 6772  _flag=stretch_gr
+0000ed60: 6964 5f66 6c61 672c 0a20 2020 2020 2020  id_flag,.       
+0000ed70: 2020 2020 2063 7573 746f 6d5f 647a 5f61       custom_dz_a
+0000ed80: 7272 6179 3d63 7573 746f 6d5f 647a 5f61  rray=custom_dz_a
+0000ed90: 7272 6179 2c0a 2020 2020 2020 2020 2020  rray,.          
+0000eda0: 2020 7574 635f 6f66 6673 6574 3d75 7463    utc_offset=utc
+0000edb0: 5f6f 6666 7365 742c 0a20 2020 2020 2020  _offset,.       
+0000edc0: 2020 2020 2077 696e 645f 7469 6d65 733d       wind_times=
+0000edd0: 7769 6e64 5f74 696d 6573 2c0a 2020 2020  wind_times,.    
+0000ede0: 2020 2020 2020 2020 736f 725f 6974 6572          sor_iter
+0000edf0: 5f6d 6178 3d73 6f72 5f69 7465 725f 6d61  _max=sor_iter_ma
+0000ee00: 782c 0a20 2020 2020 2020 2020 2020 2073  x,.            s
+0000ee10: 6f72 5f72 6573 6964 7561 6c5f 7265 6475  or_residual_redu
+0000ee20: 6374 696f 6e3d 736f 725f 7265 7369 6475  ction=sor_residu
+0000ee30: 616c 5f72 6564 7563 7469 6f6e 2c0a 2020  al_reduction,.  
+0000ee40: 2020 2020 2020 2020 2020 7573 655f 6469            use_di
+0000ee50: 6666 7573 696f 6e5f 666c 6167 3d75 7365  ffusion_flag=use
+0000ee60: 5f64 6966 6675 7369 6f6e 5f66 6c61 672c  _diffusion_flag,
+0000ee70: 0a20 2020 2020 2020 2020 2020 206e 756d  .            num
+0000ee80: 6265 725f 6469 6666 7573 696f 6e5f 6974  ber_diffusion_it
+0000ee90: 6572 6174 696f 6e73 3d6e 756d 6265 725f  erations=number_
+0000eea0: 6469 6666 7573 696f 6e5f 6974 6572 6174  diffusion_iterat
+0000eeb0: 696f 6e73 2c0a 2020 2020 2020 2020 2020  ions,.          
+0000eec0: 2020 646f 6d61 696e 5f72 6f74 6174 696f    domain_rotatio
+0000eed0: 6e3d 646f 6d61 696e 5f72 6f74 6174 696f  n=domain_rotatio
+0000eee0: 6e2c 0a20 2020 2020 2020 2020 2020 2075  n,.            u
+0000eef0: 746d 5f78 3d75 746d 5f78 2c0a 2020 2020  tm_x=utm_x,.    
+0000ef00: 2020 2020 2020 2020 7574 6d5f 793d 7574          utm_y=ut
+0000ef10: 6d5f 792c 0a20 2020 2020 2020 2020 2020  m_y,.           
+0000ef20: 2075 746d 5f7a 6f6e 655f 6e75 6d62 6572   utm_zone_number
+0000ef30: 3d75 746d 5f7a 6f6e 655f 6e75 6d62 6572  =utm_zone_number
+0000ef40: 2c0a 2020 2020 2020 2020 2020 2020 7574  ,.            ut
+0000ef50: 6d5f 7a6f 6e65 5f6c 6574 7465 723d 7574  m_zone_letter=ut
+0000ef60: 6d5f 7a6f 6e65 5f6c 6574 7465 722c 0a20  m_zone_letter,. 
+0000ef70: 2020 2020 2020 2020 2020 2071 7569 635f             quic_
+0000ef80: 6366 645f 666c 6167 3d71 7569 635f 6366  cfd_flag=quic_cf
+0000ef90: 645f 666c 6167 2c0a 2020 2020 2020 2020  d_flag,.        
+0000efa0: 2020 2020 6578 706c 6f73 6976 655f 626c      explosive_bl
+0000efb0: 6467 5f66 6c61 673d 6578 706c 6f73 6976  dg_flag=explosiv
+0000efc0: 655f 626c 6467 5f66 6c61 672c 0a20 2020  e_bldg_flag,.   
+0000efd0: 2020 2020 2020 2020 2062 6c64 675f 6172           bldg_ar
+0000efe0: 7261 795f 666c 6167 3d62 6c64 675f 6172  ray_flag=bldg_ar
+0000eff0: 7261 795f 666c 6167 2c0a 2020 2020 2020  ray_flag,.      
+0000f000: 2020 290a 2020 2020 2020 2020 7175 5f73    ).        qu_s
+0000f010: 696d 7061 7261 6d73 2e5f 6672 6f6d 5f66  imparams._from_f
+0000f020: 696c 655f 647a 5f61 7272 6179 203d 2066  ile_dz_array = f
+0000f030: 726f 6d5f 6669 6c65 5f64 7a5f 6172 7261  rom_file_dz_arra
+0000f040: 790a 2020 2020 2020 2020 7265 7475 726e  y.        return
+0000f050: 2071 755f 7369 6d70 6172 616d 730a 0a0a   qu_simparams...
+0000f060: 636c 6173 7320 5146 6972 655f 4164 7661  class QFire_Adva
+0000f070: 6e63 6564 5f55 7365 725f 496e 7075 7473  nced_User_Inputs
+0000f080: 2849 6e70 7574 4669 6c65 293a 0a20 2020  (InputFile):.   
+0000f090: 2022 2222 0a20 2020 2043 6c61 7373 2072   """.    Class r
+0000f0a0: 6570 7265 7365 6e74 696e 6720 7468 6520  epresenting the 
+0000f0b0: 5146 6972 655f 4164 7661 6e63 6564 5f55  QFire_Advanced_U
+0000f0c0: 7365 725f 496e 7075 7473 2e69 6e70 2069  ser_Inputs.inp i
+0000f0d0: 6e70 7574 2066 696c 652e 2054 6869 7320  nput file. This 
+0000f0e0: 6669 6c65 0a20 2020 2063 6f6e 7461 696e  file.    contain
+0000f0f0: 7320 6164 7661 6e63 6564 2070 6172 616d  s advanced param
+0000f100: 6574 6572 7320 7265 6c61 7465 6420 746f  eters related to
+0000f110: 2066 6972 6562 7261 6e64 732e 0a0a 2020   firebrands...  
+0000f120: 2020 4174 7472 6962 7574 6573 0a20 2020    Attributes.   
+0000f130: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+0000f140: 6672 6163 7469 6f6e 5f63 656c 6c73 5f6c  fraction_cells_l
+0000f150: 6175 6e63 685f 6669 7265 6272 616e 6473  aunch_firebrands
+0000f160: 203a 2050 6f73 6974 6976 6546 6c6f 6174   : PositiveFloat
+0000f170: 0a20 2020 2020 2020 2046 7261 6374 696f  .        Fractio
+0000f180: 6e20 6f66 2063 656c 6c73 2074 6861 7420  n of cells that 
+0000f190: 636f 756c 6420 6c61 756e 6368 2066 6972  could launch fir
+0000f1a0: 6562 7261 6e64 2074 7261 6365 7273 2066  ebrand tracers f
+0000f1b0: 726f 6d20 7768 6963 680a 2020 2020 2020  rom which.      
+0000f1c0: 2020 6669 7265 6272 616e 6420 7472 6163    firebrand trac
+0000f1d0: 6572 7320 7769 6c6c 2061 6374 7561 6c6c  ers will actuall
+0000f1e0: 7920 6265 206c 6175 6e63 6865 6420 5b2d  y be launched [-
+0000f1f0: 5d2e 2048 6967 6865 7220 7661 6c75 6520  ]. Higher value 
+0000f200: 3d20 6d6f 7265 0a20 2020 2020 2020 2066  = more.        f
+0000f210: 6972 6562 7261 6e64 2074 7261 6365 7273  irebrand tracers
+0000f220: 2e20 5265 636f 6d6d 656e 6465 6420 7661  . Recommended va
+0000f230: 6c75 653a 2030 2e30 350a 2020 2020 6669  lue: 0.05.    fi
+0000f240: 7265 6272 616e 645f 7261 6469 7573 5f73  rebrand_radius_s
+0000f250: 6361 6c65 5f66 6163 746f 7220 3a20 506f  cale_factor : Po
+0000f260: 7369 7469 7665 466c 6f61 740a 2020 2020  sitiveFloat.    
+0000f270: 2020 2020 4d75 6c74 6970 6c69 6361 7469      Multiplicati
+0000f280: 7665 2066 6163 746f 7220 7573 6564 2074  ve factor used t
+0000f290: 6f20 7265 6c61 7465 2074 6865 206c 656e  o relate the len
+0000f2a0: 6774 6820 7363 616c 6520 6f66 2074 6865  gth scale of the
+0000f2b0: 206d 6978 696e 670a 2020 2020 2020 2020   mixing.        
+0000f2c0: 2866 6972 6562 7261 6e64 2064 6973 7472  (firebrand distr
+0000f2d0: 6962 7574 696f 6e20 656e 7472 6169 6e6d  ibution entrainm
+0000f2e0: 656e 7420 6c65 6e67 7468 2073 6361 6c65  ent length scale
+0000f2f0: 2920 746f 2074 6865 2069 6e69 7469 616c  ) to the initial
+0000f300: 2073 697a 650a 2020 2020 2020 2020 6f66   size.        of
+0000f310: 2074 6865 2064 6973 7472 6962 7574 696f   the distributio
+0000f320: 6e20 5b2d 5d2e 2048 6967 6865 7220 7661  n [-]. Higher va
+0000f330: 6c75 6520 3d20 6869 6768 6572 2067 726f  lue = higher gro
+0000f340: 7774 6820 7261 7465 206f 7220 5254 0a20  wth rate or RT. 
+0000f350: 2020 2020 2020 2028 6669 7265 6272 616e         (firebran
+0000f360: 6420 6469 7374 7269 6275 7469 6f6e 2920  d distribution) 
+0000f370: 7769 7468 2066 6c69 6768 7420 7469 6d65  with flight time
+0000f380: 2e20 5265 636f 6d6d 656e 6465 6420 7661  . Recommended va
+0000f390: 6c75 653a 2034 300a 2020 2020 6669 7265  lue: 40.    fire
+0000f3a0: 6272 616e 645f 7472 616a 6563 746f 7279  brand_trajectory
+0000f3b0: 5f74 696d 655f 7374 6570 203a 2050 6f73  _time_step : Pos
+0000f3c0: 6974 6976 6549 6e74 0a20 2020 2020 2020  itiveInt.       
+0000f3d0: 2054 696d 6520 7374 6570 2075 7365 6420   Time step used 
+0000f3e0: 746f 2064 6574 6572 6d69 6e65 2074 6865  to determine the
+0000f3f0: 2066 6972 6562 7261 6e64 2074 7261 6365   firebrand trace
+0000f400: 7220 7472 616a 6563 746f 7279 205b 735d  r trajectory [s]
+0000f410: 2e0a 2020 2020 2020 2020 4869 6768 6572  ..        Higher
+0000f420: 2076 616c 7565 203d 206c 6573 7320 6163   value = less ac
+0000f430: 6375 7261 7465 2074 7261 6a65 6374 6f72  curate trajector
+0000f440: 792e 2052 6563 6f6d 6d65 6e64 6564 2076  y. Recommended v
+0000f450: 616c 7565 3a20 3120 730a 2020 2020 6669  alue: 1 s.    fi
+0000f460: 7265 6272 616e 645f 6c61 756e 6368 5f69  rebrand_launch_i
+0000f470: 6e74 6572 7661 6c20 3a20 506f 7369 7469  nterval : Positi
+0000f480: 7665 496e 740a 2020 2020 2020 2020 5469  veInt.        Ti
+0000f490: 6d65 2069 6e74 6572 7661 6c20 6265 7477  me interval betw
+0000f4a0: 6565 6e20 6c61 756e 6368 696e 6720 6f66  een launching of
+0000f4b0: 2066 6972 6562 7261 6e64 2074 7261 6365   firebrand trace
+0000f4c0: 7273 205b 735d 2e20 4869 6768 6572 2076  rs [s]. Higher v
+0000f4d0: 616c 7565 203d 0a20 2020 2020 2020 206c  alue =.        l
+0000f4e0: 6573 7320 6669 7265 6272 616e 6420 7472  ess firebrand tr
+0000f4f0: 6163 6572 7320 6c61 756e 6368 6564 2e20  acers launched. 
+0000f500: 5265 636f 6d6d 656e 6465 6420 7661 6c75  Recommended valu
+0000f510: 653a 2031 3020 730a 2020 2020 6669 7265  e: 10 s.    fire
+0000f520: 6272 616e 6473 5f70 6572 5f64 6570 6f73  brands_per_depos
+0000f530: 6974 696f 6e20 3a20 506f 7369 7469 7665  ition : Positive
+0000f540: 496e 740a 2020 2020 2020 2020 4e75 6d62  Int.        Numb
+0000f550: 6572 206f 6620 6669 7265 6272 616e 6420  er of firebrand 
+0000f560: 7472 6163 6572 7320 7468 6174 206f 6e65  tracers that one
+0000f570: 2066 6972 6562 7261 6e64 2074 7261 6365   firebrand trace
+0000f580: 7220 6c61 756e 6368 6564 0a20 2020 2020  r launched.     
+0000f590: 2020 2072 6570 7265 7365 6e74 7320 5b2d     represents [-
+0000f5a0: 5d2e 2052 6563 6f6d 6d65 6e64 6564 2076  ]. Recommended v
+0000f5b0: 616c 7565 3a20 3530 300a 2020 2020 6669  alue: 500.    fi
+0000f5c0: 7265 6272 616e 645f 6172 6561 5f72 6174  rebrand_area_rat
+0000f5d0: 696f 203a 2050 6f73 6974 6976 6546 6c6f  io : PositiveFlo
+0000f5e0: 6174 0a20 2020 2020 2020 204d 756c 7469  at.        Multi
+0000f5f0: 706c 6963 6174 6976 6520 6661 6374 6f72  plicative factor
+0000f600: 2075 7365 6420 746f 2072 656c 6174 6520   used to relate 
+0000f610: 7468 6520 6365 6c6c 2061 7265 6120 616e  the cell area an
+0000f620: 6420 6672 6163 7469 6f6e 206f 6620 6365  d fraction of ce
+0000f630: 6c6c 730a 2020 2020 2020 2020 6672 6f6d  lls.        from
+0000f640: 2077 6869 6368 2074 7261 6365 7273 2061   which tracers a
+0000f650: 7265 206c 6175 6e63 6865 6420 746f 2069  re launched to i
+0000f660: 6e69 7469 616c 2061 7265 6120 7265 7072  nitial area repr
+0000f670: 6573 656e 7465 6420 6279 206f 6e65 0a20  esented by one. 
+0000f680: 2020 2020 2020 2066 6972 6562 7261 6e64         firebrand
+0000f690: 205b 2d5d 2e0a 2020 2020 6d69 6e69 6d75   [-]..    minimu
+0000f6a0: 6d5f 6275 726e 5f72 6174 655f 636f 6566  m_burn_rate_coef
+0000f6b0: 6669 6369 656e 7420 3a20 506f 7369 7469  ficient : Positi
+0000f6c0: 7665 466c 6f61 740a 2020 2020 2020 2020  veFloat.        
+0000f6d0: 4d75 6c74 6970 6c69 6361 7469 7665 2066  Multiplicative f
+0000f6e0: 6163 746f 7220 7265 6c61 7469 6e67 2074  actor relating t
+0000f6f0: 6865 206d 696e 696d 756d 206d 6173 732d  he minimum mass-
+0000f700: 6c6f 7373 2072 6174 6520 7468 6174 2061  loss rate that a
+0000f710: 0a20 2020 2020 2020 2066 6972 6562 7261  .        firebra
+0000f720: 6e64 2074 7261 6365 7220 6e65 6564 7320  nd tracer needs 
+0000f730: 746f 2068 6176 6520 746f 206a 7573 7469  to have to justi
+0000f740: 6679 2063 6f6e 7469 6e75 696e 6720 746f  fy continuing to
+0000f750: 2074 7261 636b 2069 7473 0a20 2020 2020   track its.     
+0000f760: 2020 2074 7261 6a65 6374 6f72 7920 746f     trajectory to
+0000f770: 2074 6865 2065 6e65 7267 7920 6173 736f   the energy asso
+0000f780: 6369 6174 6564 2077 6974 6820 6120 6e65  ciated with a ne
+0000f790: 7720 6967 6e69 7469 6f6e 205b 2d5d 2e0a  w ignition [-]..
+0000f7a0: 2020 2020 6d61 785f 6669 7265 6272 616e      max_firebran
+0000f7b0: 645f 7468 6963 6b6e 6573 735f 6672 6163  d_thickness_frac
+0000f7c0: 7469 6f6e 203a 2050 6f73 6974 6976 6546  tion : PositiveF
+0000f7d0: 6c6f 6174 0a20 2020 2020 2020 204d 756c  loat.        Mul
+0000f7e0: 7469 706c 6963 6174 6976 6520 6661 6374  tiplicative fact
+0000f7f0: 6f72 2072 656c 6174 696e 6720 7468 6520  or relating the 
+0000f800: 7468 6963 6b6e 6573 7320 6f66 206c 6175  thickness of lau
+0000f810: 6e63 6865 6420 6669 7265 6272 616e 640a  nched firebrand.
+0000f820: 2020 2020 2020 2020 7472 6163 6572 2074          tracer t
+0000f830: 6f20 6d61 7869 6d75 6d20 6c6f 6674 6162  o maximum loftab
+0000f840: 6c65 2066 6972 6562 7261 6e64 2074 6869  le firebrand thi
+0000f850: 636b 6e65 7373 205b 2d5d 2e0a 2020 2020  ckness [-]..    
+0000f860: 6669 7265 6272 616e 645f 6765 726d 696e  firebrand_germin
+0000f870: 6174 696f 6e5f 6465 6c61 7920 3a20 506f  ation_delay : Po
+0000f880: 7369 7469 7665 496e 740a 2020 2020 2020  sitiveInt.      
+0000f890: 2020 5469 6d65 2061 6674 6572 2061 2066    Time after a f
+0000f8a0: 6972 6562 7261 6e64 2068 6173 206c 616e  irebrand has lan
+0000f8b0: 6465 6420 6174 2077 6869 6368 2061 2066  ded at which a f
+0000f8c0: 6972 6520 6973 2073 7461 7274 6564 205b  ire is started [
+0000f8d0: 735d 0a20 2020 2076 6572 7469 6361 6c5f  s].    vertical_
+0000f8e0: 7665 6c6f 6369 7479 5f73 6361 6c65 5f66  velocity_scale_f
+0000f8f0: 6163 746f 7220 3a20 506f 7369 7469 7665  actor : Positive
+0000f900: 466c 6f61 740a 2020 2020 2020 2020 4d61  Float.        Ma
+0000f910: 7869 6d75 6d20 7661 6c75 6520 6f66 2074  ximum value of t
+0000f920: 6865 206d 756c 7469 706c 6963 6174 6976  he multiplicativ
+0000f930: 6520 6661 6374 6f72 206f 6620 7468 6520  e factor of the 
+0000f940: 7665 7274 6963 616c 2076 656c 6f63 6974  vertical velocit
+0000f950: 790a 2020 2020 2020 2020 6578 7065 7269  y.        experi
+0000f960: 656e 6365 6420 6279 2061 2066 6972 6562  enced by a fireb
+0000f970: 7261 6e64 203d 2031 2f28 6672 6163 7469  rand = 1/(fracti
+0000f980: 6f6e 206f 6620 7468 6520 5155 4943 2d55  on of the QUIC-U
+0000f990: 5242 206f 6e20 6669 7265 2920 5b2d 5d0a  RB on fire) [-].
+0000f9a0: 2020 2020 6d69 6e69 6d75 6d5f 6669 7265      minimum_fire
+0000f9b0: 6272 616e 645f 6967 6e69 7469 6f6e 7320  brand_ignitions 
+0000f9c0: 3a20 506f 7369 7469 7665 496e 740a 2020  : PositiveInt.  
+0000f9d0: 2020 2020 2020 4d69 6e69 6d75 6d20 6e75        Minimum nu
+0000f9e0: 6d62 6572 206f 6620 6967 6e69 7469 6f6e  mber of ignition
+0000f9f0: 7320 746f 2062 6520 7361 6d70 6c65 6420  s to be sampled 
+0000fa00: 696e 2061 2070 6f73 6974 696f 6e20 7768  in a position wh
+0000fa10: 6572 6520 610a 2020 2020 2020 2020 6669  ere a.        fi
+0000fa20: 7265 6272 616e 6420 6c61 6e64 7320 5b2d  rebrand lands [-
+0000fa30: 5d0a 2020 2020 6d61 7869 6d75 6d5f 6669  ].    maximum_fi
+0000fa40: 7265 6272 616e 645f 6967 6e69 7469 6f6e  rebrand_ignition
+0000fa50: 7320 3a20 506f 7369 7469 7665 496e 740a  s : PositiveInt.
+0000fa60: 2020 2020 2020 2020 4d61 7869 6d75 6d20          Maximum 
+0000fa70: 6e75 6d62 6572 206f 6620 6967 6e69 7469  number of igniti
+0000fa80: 6f6e 7320 7361 6d70 6c65 6420 6174 2070  ons sampled at p
+0000fa90: 6f73 6974 696f 6e73 2064 6973 7472 6962  ositions distrib
+0000faa0: 7574 6564 2077 6974 6869 6e20 5254 0a20  uted within RT. 
+0000fab0: 2020 2020 2020 2061 726f 756e 6420 7768         around wh
+0000fac0: 6572 6520 6120 6669 7265 6272 616e 6420  ere a firebrand 
+0000fad0: 7472 6163 6572 206c 616e 6473 205b 2d5d  tracer lands [-]
+0000fae0: 0a20 2020 206d 696e 696d 756d 5f6c 616e  .    minimum_lan
+0000faf0: 6469 6e67 5f61 6e67 6c65 203a 2050 6f73  ding_angle : Pos
+0000fb00: 6974 6976 6546 6c6f 6174 0a20 2020 2020  itiveFloat.     
+0000fb10: 2020 204d 696e 696d 756d 2076 616c 7565     Minimum value
+0000fb20: 2063 6f6e 7369 6465 7265 6420 666f 7220   considered for 
+0000fb30: 7468 6520 616e 676c 6520 6265 7477 6565  the angle betwee
+0000fb40: 6e20 7468 6520 7472 616a 6563 746f 7279  n the trajectory
+0000fb50: 206f 6620 7468 650a 2020 2020 2020 2020   of the.        
+0000fb60: 6669 7265 6272 616e 6420 7768 656e 2069  firebrand when i
+0000fb70: 7420 6869 7473 2074 6865 2067 726f 756e  t hits the groun
+0000fb80: 6420 616e 6420 686f 7269 7a6f 6e74 616c  d and horizontal
+0000fb90: 205b 7261 645d 0a20 2020 206d 6178 696d   [rad].    maxim
+0000fba0: 756d 5f66 6972 6562 7261 6e64 5f74 6869  um_firebrand_thi
+0000fbb0: 636b 6e65 7373 203a 2050 6f73 6974 6976  ckness : Positiv
+0000fbc0: 6546 6c6f 6174 0a20 2020 2020 2020 204d  eFloat.        M
+0000fbd0: 6178 696d 756d 2066 6972 6562 7261 6e64  aximum firebrand
+0000fbe0: 2773 2074 6869 636b 6e65 7373 205b 6d5d  's thickness [m]
+0000fbf0: 0a20 2020 2022 2222 0a0a 2020 2020 6e61  .    """..    na
+0000fc00: 6d65 3a20 7374 7220 3d20 4669 656c 6428  me: str = Field(
+0000fc10: 2251 4669 7265 5f41 6476 616e 6365 645f  "QFire_Advanced_
+0000fc20: 5573 6572 5f49 6e70 7574 7322 2c20 6672  User_Inputs", fr
+0000fc30: 6f7a 656e 3d54 7275 6529 0a20 2020 205f  ozen=True).    _
+0000fc40: 6578 7465 6e73 696f 6e3a 2073 7472 203d  extension: str =
+0000fc50: 2022 2e69 6e70 220a 2020 2020 6672 6163   ".inp".    frac
+0000fc60: 7469 6f6e 5f63 656c 6c73 5f6c 6175 6e63  tion_cells_launc
+0000fc70: 685f 6669 7265 6272 616e 6473 3a20 506f  h_firebrands: Po
+0000fc80: 7369 7469 7665 466c 6f61 7420 3d20 4669  sitiveFloat = Fi
+0000fc90: 656c 6428 302e 3035 2c20 6765 3d30 2c20  eld(0.05, ge=0, 
+0000fca0: 6c74 3d31 290a 2020 2020 6669 7265 6272  lt=1).    firebr
+0000fcb0: 616e 645f 7261 6469 7573 5f73 6361 6c65  and_radius_scale
+0000fcc0: 5f66 6163 746f 723a 2050 6f73 6974 6976  _factor: Positiv
+0000fcd0: 6546 6c6f 6174 203d 2046 6965 6c64 2834  eFloat = Field(4
+0000fce0: 302e 302c 2067 653d 3129 0a20 2020 2066  0.0, ge=1).    f
+0000fcf0: 6972 6562 7261 6e64 5f74 7261 6a65 6374  irebrand_traject
+0000fd00: 6f72 795f 7469 6d65 5f73 7465 703a 2050  ory_time_step: P
+0000fd10: 6f73 6974 6976 6549 6e74 203d 2031 0a20  ositiveInt = 1. 
+0000fd20: 2020 2066 6972 6562 7261 6e64 5f6c 6175     firebrand_lau
+0000fd30: 6e63 685f 696e 7465 7276 616c 3a20 506f  nch_interval: Po
+0000fd40: 7369 7469 7665 496e 7420 3d20 3130 0a20  sitiveInt = 10. 
+0000fd50: 2020 2066 6972 6562 7261 6e64 735f 7065     firebrands_pe
+0000fd60: 725f 6465 706f 7369 7469 6f6e 3a20 506f  r_deposition: Po
+0000fd70: 7369 7469 7665 496e 7420 3d20 3530 300a  sitiveInt = 500.
+0000fd80: 2020 2020 6669 7265 6272 616e 645f 6172      firebrand_ar
+0000fd90: 6561 5f72 6174 696f 3a20 506f 7369 7469  ea_ratio: Positi
+0000fda0: 7665 466c 6f61 7420 3d20 3230 2e30 0a20  veFloat = 20.0. 
+0000fdb0: 2020 206d 696e 696d 756d 5f62 7572 6e5f     minimum_burn_
+0000fdc0: 7261 7465 5f63 6f65 6666 6963 6965 6e74  rate_coefficient
+0000fdd0: 3a20 506f 7369 7469 7665 466c 6f61 7420  : PositiveFloat 
+0000fde0: 3d20 3530 2e30 0a20 2020 206d 6178 5f66  = 50.0.    max_f
+0000fdf0: 6972 6562 7261 6e64 5f74 6869 636b 6e65  irebrand_thickne
+0000fe00: 7373 5f66 7261 6374 696f 6e3a 2050 6f73  ss_fraction: Pos
+0000fe10: 6974 6976 6546 6c6f 6174 203d 2030 2e37  itiveFloat = 0.7
+0000fe20: 350a 2020 2020 6669 7265 6272 616e 645f  5.    firebrand_
+0000fe30: 6765 726d 696e 6174 696f 6e5f 6465 6c61  germination_dela
+0000fe40: 793a 2050 6f73 6974 6976 6549 6e74 203d  y: PositiveInt =
+0000fe50: 2031 3830 0a20 2020 2076 6572 7469 6361   180.    vertica
+0000fe60: 6c5f 7665 6c6f 6369 7479 5f73 6361 6c65  l_velocity_scale
+0000fe70: 5f66 6163 746f 723a 2050 6f73 6974 6976  _factor: Positiv
+0000fe80: 6546 6c6f 6174 203d 2035 2e30 0a20 2020  eFloat = 5.0.   
+0000fe90: 206d 696e 696d 756d 5f66 6972 6562 7261   minimum_firebra
+0000fea0: 6e64 5f69 676e 6974 696f 6e73 3a20 506f  nd_ignitions: Po
+0000feb0: 7369 7469 7665 496e 7420 3d20 3530 0a20  sitiveInt = 50. 
+0000fec0: 2020 206d 6178 696d 756d 5f66 6972 6562     maximum_fireb
+0000fed0: 7261 6e64 5f69 676e 6974 696f 6e73 3a20  rand_ignitions: 
+0000fee0: 506f 7369 7469 7665 496e 7420 3d20 3130  PositiveInt = 10
+0000fef0: 300a 2020 2020 6d69 6e69 6d75 6d5f 6c61  0.    minimum_la
+0000ff00: 6e64 696e 675f 616e 676c 653a 2050 6f73  nding_angle: Pos
+0000ff10: 6974 6976 6546 6c6f 6174 203d 2046 6965  itiveFloat = Fie
+0000ff20: 6c64 2830 2e35 3233 3539 382c 2067 653d  ld(0.523598, ge=
+0000ff30: 302c 206c 653d 6e70 2e70 6920 2f20 3229  0, le=np.pi / 2)
+0000ff40: 0a20 2020 206d 6178 696d 756d 5f66 6972  .    maximum_fir
+0000ff50: 6562 7261 6e64 5f74 6869 636b 6e65 7373  ebrand_thickness
+0000ff60: 3a20 506f 7369 7469 7665 466c 6f61 7420  : PositiveFloat 
+0000ff70: 3d20 302e 3033 0a0a 2020 2020 4063 6c61  = 0.03..    @cla
+0000ff80: 7373 6d65 7468 6f64 0a20 2020 2064 6566  ssmethod.    def
+0000ff90: 2066 726f 6d5f 6669 6c65 2863 6c73 2c20   from_file(cls, 
+0000ffa0: 6469 7265 6374 6f72 793a 2073 7472 207c  directory: str |
+0000ffb0: 2050 6174 682c 202a 2a6b 7761 7267 7329   Path, **kwargs)
+0000ffc0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+0000ffd0: 2020 2020 2020 496e 6974 6961 6c69 7a65        Initialize
+0000ffe0: 7320 6120 5146 6972 655f 4164 7661 6e63  s a QFire_Advanc
+0000fff0: 6564 5f55 7365 725f 496e 7075 7473 206f  ed_User_Inputs o
+00010000: 626a 6563 7420 6672 6f6d 2061 2064 6972  bject from a dir
+00010010: 6563 746f 7279 0a20 2020 2020 2020 2063  ectory.        c
+00010020: 6f6e 7461 696e 696e 6720 6120 5146 6972  ontaining a QFir
+00010030: 655f 4164 7661 6e63 6564 5f55 7365 725f  e_Advanced_User_
+00010040: 496e 7075 7473 2e69 6e70 2066 696c 652e  Inputs.inp file.
+00010050: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00010060: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+00010070: 6365 2864 6972 6563 746f 7279 2c20 7374  ce(directory, st
+00010080: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
+00010090: 6469 7265 6374 6f72 7920 3d20 5061 7468  directory = Path
+000100a0: 2864 6972 6563 746f 7279 290a 2020 2020  (directory).    
+000100b0: 2020 2020 7769 7468 206f 7065 6e28 6469      with open(di
+000100c0: 7265 6374 6f72 7920 2f20 2251 4669 7265  rectory / "QFire
+000100d0: 5f41 6476 616e 6365 645f 5573 6572 5f49  _Advanced_User_I
+000100e0: 6e70 7574 732e 696e 7022 2c20 2272 2229  nputs.inp", "r")
+000100f0: 2061 7320 663a 0a20 2020 2020 2020 2020   as f:.         
+00010100: 2020 206c 696e 6573 203d 2066 2e72 6561     lines = f.rea
+00010110: 646c 696e 6573 2829 0a0a 2020 2020 2020  dlines()..      
+00010120: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
+00010130: 2020 2072 6574 7572 6e20 636c 7328 0a20     return cls(. 
+00010140: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00010150: 7261 6374 696f 6e5f 6365 6c6c 735f 6c61  raction_cells_la
+00010160: 756e 6368 5f66 6972 6562 7261 6e64 733d  unch_firebrands=
+00010170: 666c 6f61 7428 6c69 6e65 735b 305d 2e73  float(lines[0].s
+00010180: 706c 6974 2829 5b30 5d29 2c0a 2020 2020  plit()[0]),.    
+00010190: 2020 2020 2020 2020 2020 2020 6669 7265              fire
+000101a0: 6272 616e 645f 7261 6469 7573 5f73 6361  brand_radius_sca
+000101b0: 6c65 5f66 6163 746f 723d 666c 6f61 7428  le_factor=float(
+000101c0: 6c69 6e65 735b 315d 2e73 706c 6974 2829  lines[1].split()
+000101d0: 5b30 5d29 2c0a 2020 2020 2020 2020 2020  [0]),.          
+000101e0: 2020 2020 2020 6669 7265 6272 616e 645f        firebrand_
+000101f0: 7472 616a 6563 746f 7279 5f74 696d 655f  trajectory_time_
+00010200: 7374 6570 3d69 6e74 286c 696e 6573 5b32  step=int(lines[2
+00010210: 5d2e 7370 6c69 7428 295b 305d 292c 0a20  ].split()[0]),. 
+00010220: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00010230: 6972 6562 7261 6e64 5f6c 6175 6e63 685f  irebrand_launch_
+00010240: 696e 7465 7276 616c 3d69 6e74 286c 696e  interval=int(lin
+00010250: 6573 5b33 5d2e 7370 6c69 7428 295b 305d  es[3].split()[0]
+00010260: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+00010270: 2020 2066 6972 6562 7261 6e64 735f 7065     firebrands_pe
+00010280: 725f 6465 706f 7369 7469 6f6e 3d69 6e74  r_deposition=int
+00010290: 286c 696e 6573 5b34 5d2e 7370 6c69 7428  (lines[4].split(
+000102a0: 295b 305d 292c 0a20 2020 2020 2020 2020  )[0]),.         
+000102b0: 2020 2020 2020 2066 6972 6562 7261 6e64         firebrand
+000102c0: 5f61 7265 615f 7261 7469 6f3d 666c 6f61  _area_ratio=floa
+000102d0: 7428 6c69 6e65 735b 355d 2e73 706c 6974  t(lines[5].split
+000102e0: 2829 5b30 5d29 2c0a 2020 2020 2020 2020  ()[0]),.        
+000102f0: 2020 2020 2020 2020 6d69 6e69 6d75 6d5f          minimum_
+00010300: 6275 726e 5f72 6174 655f 636f 6566 6669  burn_rate_coeffi
+00010310: 6369 656e 743d 666c 6f61 7428 6c69 6e65  cient=float(line
+00010320: 735b 365d 2e73 706c 6974 2829 5b30 5d29  s[6].split()[0])
+00010330: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00010340: 2020 6d61 785f 6669 7265 6272 616e 645f    max_firebrand_
+00010350: 7468 6963 6b6e 6573 735f 6672 6163 7469  thickness_fracti
+00010360: 6f6e 3d66 6c6f 6174 286c 696e 6573 5b37  on=float(lines[7
+00010370: 5d2e 7370 6c69 7428 295b 305d 292c 0a20  ].split()[0]),. 
+00010380: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00010390: 6972 6562 7261 6e64 5f67 6572 6d69 6e61  irebrand_germina
+000103a0: 7469 6f6e 5f64 656c 6179 3d69 6e74 286c  tion_delay=int(l
+000103b0: 696e 6573 5b38 5d2e 7370 6c69 7428 295b  ines[8].split()[
+000103c0: 305d 292c 0a20 2020 2020 2020 2020 2020  0]),.           
+000103d0: 2020 2020 2076 6572 7469 6361 6c5f 7665       vertical_ve
+000103e0: 6c6f 6369 7479 5f73 6361 6c65 5f66 6163  locity_scale_fac
+000103f0: 746f 723d 666c 6f61 7428 6c69 6e65 735b  tor=float(lines[
+00010400: 395d 2e73 706c 6974 2829 5b30 5d29 2c0a  9].split()[0]),.
+00010410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010420: 6d69 6e69 6d75 6d5f 6669 7265 6272 616e  minimum_firebran
+00010430: 645f 6967 6e69 7469 6f6e 733d 696e 7428  d_ignitions=int(
+00010440: 6c69 6e65 735b 3130 5d2e 7370 6c69 7428  lines[10].split(
+00010450: 295b 305d 292c 0a20 2020 2020 2020 2020  )[0]),.         
+00010460: 2020 2020 2020 206d 6178 696d 756d 5f66         maximum_f
+00010470: 6972 6562 7261 6e64 5f69 676e 6974 696f  irebrand_ignitio
+00010480: 6e73 3d69 6e74 286c 696e 6573 5b31 315d  ns=int(lines[11]
+00010490: 2e73 706c 6974 2829 5b30 5d29 2c0a 2020  .split()[0]),.  
+000104a0: 2020 2020 2020 2020 2020 2020 2020 6d69                mi
+000104b0: 6e69 6d75 6d5f 6c61 6e64 696e 675f 616e  nimum_landing_an
+000104c0: 676c 653d 666c 6f61 7428 6c69 6e65 735b  gle=float(lines[
+000104d0: 3132 5d2e 7370 6c69 7428 295b 305d 292c  12].split()[0]),
+000104e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000104f0: 206d 6178 696d 756d 5f66 6972 6562 7261   maximum_firebra
+00010500: 6e64 5f74 6869 636b 6e65 7373 3d66 6c6f  nd_thickness=flo
+00010510: 6174 286c 696e 6573 5b31 335d 2e73 706c  at(lines[13].spl
+00010520: 6974 2829 5b30 5d29 2c0a 2020 2020 2020  it()[0]),.      
+00010530: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00010540: 6578 6365 7074 2049 6e64 6578 4572 726f  except IndexErro
+00010550: 723a 0a20 2020 2020 2020 2020 2020 2072  r:.            r
+00010560: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00010570: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010580: 2066 2245 7272 6f72 2070 6172 7369 6e67   f"Error parsing
+00010590: 207b 636c 732e 5f5f 6e61 6d65 5f5f 7d20   {cls.__name__} 
+000105a0: 6672 6f6d 2066 696c 653a 2051 4669 7265  from file: QFire
+000105b0: 5f41 6476 616e 6365 645f 5573 6572 5f49  _Advanced_User_I
+000105c0: 6e70 7574 732e 696e 7022 0a20 2020 2020  nputs.inp".     
+000105d0: 2020 2020 2020 2020 2020 2066 225c 6e50             f"\nP
+000105e0: 6c65 6173 6520 6368 6563 6b20 7468 6520  lease check the 
+000105f0: 6669 6c65 2066 6f72 2063 6f72 7265 6374  file for correct
+00010600: 6e65 7373 2e22 0a20 2020 2020 2020 2020  ness.".         
+00010610: 2020 2029 0a0a 0a63 6c61 7373 2051 5549     )...class QUI
+00010620: 435f 6669 7265 2849 6e70 7574 4669 6c65  C_fire(InputFile
+00010630: 293a 0a20 2020 2022 2222 0a20 2020 2043  ):.    """.    C
+00010640: 6c61 7373 2072 6570 7265 7365 6e74 696e  lass representin
+00010650: 6720 7468 6520 5155 4943 5f66 6972 652e  g the QUIC_fire.
+00010660: 696e 7020 696e 7075 7420 6669 6c65 2e20  inp input file. 
+00010670: 5468 6973 2066 696c 650a 2020 2020 636f  This file.    co
+00010680: 6e74 6169 6e73 2074 6865 2070 6172 616d  ntains the param
+00010690: 6574 6572 7320 7265 6c61 7469 6e67 2074  eters relating t
+000106a0: 6f20 7468 6520 6669 7265 2073 696d 756c  o the fire simul
+000106b0: 6174 696f 6e20 616e 640a 2020 2020 6f75  ation and.    ou
+000106c0: 7470 7574 732e 0a0a 2020 2020 4174 7472  tputs...    Attr
+000106d0: 6962 7574 6573 0a20 2020 202d 2d2d 2d2d  ibutes.    -----
+000106e0: 2d2d 2d2d 2d0a 2020 2020 6669 7265 5f66  -----.    fire_f
+000106f0: 6c61 6720 3a20 4c69 7465 7261 6c5b 302c  lag : Literal[0,
+00010700: 2031 5d0a 2020 2020 2020 2020 4669 7265   1].        Fire
+00010710: 2066 6c61 672c 2031 203d 2072 756e 2066   flag, 1 = run f
+00010720: 6972 653b 2030 203d 206e 6f20 6669 7265  ire; 0 = no fire
+00010730: 0a20 2020 2072 616e 646f 6d5f 7365 6564  .    random_seed
+00010740: 203a 2069 6e74 0a20 2020 2020 2020 2052   : int.        R
+00010750: 616e 646f 6d20 6e75 6d62 6572 2067 656e  andom number gen
+00010760: 6572 6174 6f72 2c20 2d31 3a20 7573 6520  erator, -1: use 
+00010770: 7469 6d65 2061 6e64 2064 6174 652c 2061  time and date, a
+00010780: 6e79 206f 7468 6572 2069 6e74 6567 6572  ny other integer
+00010790: 203e 2030 0a20 2020 2074 696d 655f 6e6f   > 0.    time_no
+000107a0: 7720 3a20 506f 7369 7469 7665 496e 740a  w : PositiveInt.
+000107b0: 2020 2020 2020 2020 5768 656e 2074 6865          When the
+000107c0: 2066 6972 6520 6973 2069 676e 6974 6564   fire is ignited
+000107d0: 2069 6e20 556e 6978 2045 706f 6368 2074   in Unix Epoch t
+000107e0: 696d 6520 2869 6e74 6567 6572 2073 6563  ime (integer sec
+000107f0: 6f6e 6473 2073 696e 6365 0a20 2020 2020  onds since.     
+00010800: 2020 2031 3937 302f 312f 3120 3030 3a30     1970/1/1 00:0
+00010810: 303a 3030 292e 204d 7573 7420 6265 2067  0:00). Must be g
+00010820: 7265 6174 6572 206f 7220 6571 7561 6c20  reater or equal 
+00010830: 746f 2074 6865 2074 696d 6520 6f66 2074  to the time of t
+00010840: 6865 2066 6972 7374 0a20 2020 2020 2020  he first.       
+00010850: 2077 696e 640a 2020 2020 7369 6d5f 7469   wind.    sim_ti
+00010860: 6d65 203a 2050 6f73 6974 6976 6549 6e74  me : PositiveInt
+00010870: 0a20 2020 2020 2020 2054 6f74 616c 2073  .        Total s
+00010880: 696d 756c 6174 696f 6e20 7469 6d65 2066  imulation time f
+00010890: 6f72 2074 6865 2066 6972 6520 5b73 5d0a  or the fire [s].
+000108a0: 2020 2020 6669 7265 5f74 696d 655f 7374      fire_time_st
+000108b0: 6570 203a 2050 6f73 6974 6976 6549 6e74  ep : PositiveInt
+000108c0: 0a20 2020 2020 2020 2054 696d 6520 7374  .        Time st
+000108d0: 6570 2066 6f72 2074 6865 2066 6972 6520  ep for the fire 
+000108e0: 7369 6d75 6c61 7469 6f6e 205b 735d 0a20  simulation [s]. 
+000108f0: 2020 2071 7569 635f 7469 6d65 5f73 7465     quic_time_ste
+00010900: 7020 3a20 506f 7369 7469 7665 496e 740a  p : PositiveInt.
+00010910: 2020 2020 2020 2020 4e75 6d62 6572 206f          Number o
+00010920: 6620 6669 7265 2074 696d 6520 7374 6570  f fire time step
+00010930: 7320 646f 6e65 2062 6566 6f72 6520 7570  s done before up
+00010940: 6461 7469 6e67 2074 6865 2071 7569 6320  dating the quic 
+00010950: 7769 6e64 2066 6965 6c64 0a20 2020 2020  wind field.     
+00010960: 2020 2028 696e 7465 6765 722c 203e 3d20     (integer, >= 
+00010970: 3129 0a20 2020 206f 7574 5f74 696d 655f  1).    out_time_
+00010980: 6669 7265 203a 2050 6f73 6974 6976 6549  fire : PositiveI
+00010990: 6e74 0a20 2020 2020 2020 2041 6674 6572  nt.        After
+000109a0: 2068 6f77 206d 616e 7920 6669 7265 2074   how many fire t
+000109b0: 696d 6520 7374 6570 7320 746f 2070 7269  ime steps to pri
+000109c0: 6e74 206f 7574 2066 6972 652d 7265 6c61  nt out fire-rela
+000109d0: 7465 6420 6669 6c65 7320 2865 7863 6c75  ted files (exclu
+000109e0: 6469 6e67 2065 6d69 7373 696f 6e73 2061  ding emissions a
+000109f0: 6e64 2072 6164 6961 7469 6f6e 290a 2020  nd radiation).  
+00010a00: 2020 6f75 745f 7469 6d65 5f77 696e 6420    out_time_wind 
+00010a10: 3a20 506f 7369 7469 7665 496e 740a 2020  : PositiveInt.  
+00010a20: 2020 2020 2020 4166 7465 7220 686f 7720        After how 
+00010a30: 6d61 6e79 2071 7569 6320 7570 6461 7465  many quic update
+00010a40: 7320 746f 2070 7269 6e74 206f 7574 2077  s to print out w
+00010a50: 696e 642d 7265 6c61 7465 6420 6669 6c65  ind-related file
+00010a60: 730a 2020 2020 6f75 745f 7469 6d65 5f65  s.    out_time_e
+00010a70: 6d69 735f 7261 6420 3a20 506f 7369 7469  mis_rad : Positi
+00010a80: 7665 496e 740a 2020 2020 2020 2020 4166  veInt.        Af
+00010a90: 7465 7220 686f 7720 6d61 6e79 2066 6972  ter how many fir
+00010aa0: 6520 7469 6d65 2073 7465 7073 2074 6f20  e time steps to 
+00010ab0: 6176 6572 6167 6520 656d 6973 7369 6f6e  average emission
+00010ac0: 7320 616e 6420 7261 6469 6174 696f 6e0a  s and radiation.
+00010ad0: 2020 2020 6f75 745f 7469 6d65 5f77 696e      out_time_win
+00010ae0: 645f 6176 6720 3a20 506f 7369 7469 7665  d_avg : Positive
+00010af0: 496e 740a 2020 2020 2020 2020 4166 7465  Int.        Afte
+00010b00: 7220 686f 7720 6d61 6e79 2071 7569 6320  r how many quic 
+00010b10: 7570 6461 7465 7320 746f 2070 7269 6e74  updates to print
+00010b20: 206f 7574 2061 7665 7261 6765 6420 7769   out averaged wi
+00010b30: 6e64 2d72 656c 6174 6564 2066 696c 6573  nd-related files
+00010b40: 0a20 2020 206e 7a20 3a20 506f 7369 7469  .    nz : Positi
+00010b50: 7665 496e 740a 2020 2020 2020 2020 4e75  veInt.        Nu
+00010b60: 6d62 6572 206f 6620 6669 7265 2067 7269  mber of fire gri
+00010b70: 6420 6365 6c6c 7320 696e 2074 6865 207a  d cells in the z
+00010b80: 2d64 6972 6563 7469 6f6e 2e0a 2020 2020  -direction..    
+00010b90: 7374 7265 7463 685f 6772 6964 5f66 6c61  stretch_grid_fla
+00010ba0: 6720 3a20 4c69 7465 7261 6c5b 302c 2031  g : Literal[0, 1
+00010bb0: 5d0a 2020 2020 2020 2020 5665 7274 6963  ].        Vertic
+00010bc0: 616c 2073 7472 6574 6368 696e 6720 666c  al stretching fl
+00010bd0: 6167 3a20 3020 3d20 756e 6966 6f72 6d20  ag: 0 = uniform 
+00010be0: 647a 2c20 3120 3d20 6375 7374 6f6d 0a20  dz, 1 = custom. 
+00010bf0: 2020 2064 7a20 3a20 506f 7369 7469 7665     dz : Positive
+00010c00: 466c 6f61 740a 2020 2020 2020 2020 4365  Float.        Ce
+00010c10: 6c6c 2073 697a 6520 696e 2074 6865 207a  ll size in the z
+00010c20: 2d64 6972 6563 7469 6f6e 205b 6d5d 206f  -direction [m] o
+00010c30: 6620 7468 6520 6669 7265 2067 7269 642e  f the fire grid.
+00010c40: 2052 6563 6f6d 6d65 6e64 6564 2076 616c   Recommended val
+00010c50: 7565 3a20 316d 0a20 2020 2064 7a5f 6172  ue: 1m.    dz_ar
+00010c60: 7261 7920 3a20 4c69 7374 5b50 6f73 6974  ray : List[Posit
+00010c70: 6976 6546 6c6f 6174 5d0a 2020 2020 2020  iveFloat].      
+00010c80: 2020 4375 7374 6f6d 2064 7a2c 206f 6e65    Custom dz, one
+00010c90: 2064 7a20 7065 7220 6c69 6e65 206d 7573   dz per line mus
+00010ca0: 7420 6265 2073 7065 6369 6669 6564 2c20  t be specified, 
+00010cb0: 6672 6f6d 2074 6865 2067 726f 756e 6420  from the ground 
+00010cc0: 746f 2074 6865 0a20 2020 2020 2020 2074  to the.        t
+00010cd0: 6f70 206f 6620 7468 6520 646f 6d61 696e  op of the domain
+00010ce0: 0a20 2020 2066 7565 6c5f 6465 6e73 6974  .    fuel_densit
+00010cf0: 795f 666c 6167 3a20 4c69 7465 7261 6c5b  y_flag: Literal[
+00010d00: 312c 2032 2c20 332c 2034 2c20 355d 0a20  1, 2, 3, 4, 5]. 
+00010d10: 2020 2020 2020 2046 7565 6c20 6465 6e73         Fuel dens
+00010d20: 6974 7920 666c 6167 2028 6465 6661 756c  ity flag (defaul
+00010d30: 7473 2074 6f20 3129 3a0a 2020 2020 2020  ts to 1):.      
+00010d40: 2020 3120 3d20 6465 6e73 6974 7920 6973    1 = density is
+00010d50: 2075 6e69 666f 726d 206f 7665 7220 7468   uniform over th
+00010d60: 6520 646f 6d61 696e 2c0a 2020 2020 2020  e domain,.      
+00010d70: 2020 3220 3d20 6465 6e73 6974 7920 6973    2 = density is
+00010d80: 2070 726f 7669 6465 6420 7468 726f 7567   provided throug
+00010d90: 6820 5146 5f46 7565 6c44 656e 7369 7479  h QF_FuelDensity
+00010da0: 2e69 6e70 2c0a 2020 2020 2020 2020 3320  .inp,.        3 
+00010db0: 3d20 6465 6e73 6974 7920 6973 2070 726f  = density is pro
+00010dc0: 7669 6465 6420 7468 726f 7567 6820 4669  vided through Fi
+00010dd0: 7265 7465 6320 6669 6c65 2028 7472 6565  retec file (tree
+00010de0: 7372 686f 662e 6461 7429 206d 6174 6368  srhof.dat) match
+00010df0: 696e 6720 5155 4943 2d46 6972 6520 6772  ing QUIC-Fire gr
+00010e00: 6964 2c0a 2020 2020 2020 2020 3420 3d20  id,.        4 = 
+00010e10: 6465 6e73 6974 7920 6973 2070 726f 7669  density is provi
+00010e20: 6465 6420 7468 726f 7567 6820 4669 7265  ded through Fire
+00010e30: 7465 6320 6669 6c65 7320 666f 7220 616e  tec files for an
+00010e40: 2061 7262 6974 7261 7279 2067 7269 642c   arbitrary grid,
+00010e50: 0a20 2020 2020 2020 2035 203d 2046 6173  .        5 = Fas
+00010e60: 7446 7565 6c73 2069 6e70 7574 2028 6173  tFuels input (as
+00010e70: 7375 6d69 6e67 2075 6e69 666f 726d 2064  suming uniform d
+00010e80: 7a20 6f66 2031 6d29 0a20 2020 2066 7565  z of 1m).    fue
+00010e90: 6c5f 6465 6e73 6974 7920 3a20 506f 7369  l_density : Posi
+00010ea0: 7469 7665 466c 6f61 740a 2020 2020 2020  tiveFloat.      
+00010eb0: 2020 4675 656c 2064 656e 7369 7479 2028    Fuel density (
+00010ec0: 6b67 2f6d 3329 0a20 2020 2066 7565 6c5f  kg/m3).    fuel_
+00010ed0: 6d6f 6973 7475 7265 5f66 6c61 6720 3a20  moisture_flag : 
+00010ee0: 4c69 7465 7261 6c5b 312c 2032 2c20 332c  Literal[1, 2, 3,
+00010ef0: 2034 2c20 355d 0a20 2020 2020 2020 2046   4, 5].        F
+00010f00: 7565 6c20 6d6f 6973 7475 7265 2066 6c61  uel moisture fla
+00010f10: 6720 2864 6566 6175 6c74 7320 746f 2031  g (defaults to 1
+00010f20: 293a 0a20 2020 2020 2020 2031 203d 206d  ):.        1 = m
+00010f30: 6f69 7374 7572 6520 6973 2075 6e69 666f  oisture is unifo
+00010f40: 726d 206f 7665 7220 7468 6520 646f 6d61  rm over the doma
+00010f50: 696e 2c0a 2020 2020 2020 2020 3220 3d20  in,.        2 = 
+00010f60: 6d6f 6973 7475 7265 2069 7320 7072 6f76  moisture is prov
+00010f70: 6964 6564 2074 6872 6f75 6768 2051 465f  ided through QF_
+00010f80: 4675 656c 4d6f 6973 7475 7265 2e69 6e70  FuelMoisture.inp
+00010f90: 2c0a 2020 2020 2020 2020 3320 3d20 6d6f  ,.        3 = mo
+00010fa0: 6973 7475 7265 2069 7320 7072 6f76 6964  isture is provid
+00010fb0: 6564 2074 6872 6f75 6768 2046 6972 6574  ed through Firet
+00010fc0: 6563 2066 696c 6520 2874 7265 6573 6d6f  ec file (treesmo
+00010fd0: 6973 742e 6461 7429 206d 6174 6368 696e  ist.dat) matchin
+00010fe0: 6720 5155 4943 2d46 6972 6520 6772 6964  g QUIC-Fire grid
+00010ff0: 2c0a 2020 2020 2020 2020 3420 3d20 6d6f  ,.        4 = mo
+00011000: 6973 7475 7265 2069 7320 7072 6f76 6964  isture is provid
+00011010: 6564 2074 6872 6f75 6768 2046 6972 6574  ed through Firet
+00011020: 6563 2066 696c 6573 2066 6f72 2061 6e20  ec files for an 
+00011030: 6172 6269 7472 6172 7920 6772 6964 2c0a  arbitrary grid,.
+00011040: 2020 2020 2020 2020 3520 3d20 4661 7374          5 = Fast
+00011050: 4675 656c 7320 696e 7075 7420 2861 7373  Fuels input (ass
+00011060: 756d 696e 6720 756e 6966 6f72 6d20 647a  uming uniform dz
+00011070: 206f 6620 316d 290a 2020 2020 6675 656c   of 1m).    fuel
+00011080: 5f6d 6f69 7374 7572 6520 3a20 506f 7369  _moisture : Posi
+00011090: 7469 7665 466c 6f61 740a 2020 2020 2020  tiveFloat.      
+000110a0: 2020 4675 656c 206d 6f69 7374 7572 6520    Fuel moisture 
+000110b0: 3d20 6d61 7373 206f 6620 7761 7465 722f  = mass of water/
+000110c0: 6d61 7373 206f 6620 6472 7920 6675 656c  mass of dry fuel
+000110d0: 2028 6b67 2f6b 6729 2e20 4d75 7374 2062   (kg/kg). Must b
+000110e0: 6520 6265 7477 6565 6e0a 2020 2020 2020  e between.      
+000110f0: 2020 3020 616e 6420 312e 0a20 2020 2066    0 and 1..    f
+00011100: 7565 6c5f 6865 6967 6874 5f66 6c61 6720  uel_height_flag 
+00011110: 3a20 4c69 7465 7261 6c5b 312c 2032 2c20  : Literal[1, 2, 
+00011120: 332c 2034 5d0a 2020 2020 2020 2020 4675  3, 4].        Fu
+00011130: 656c 2068 6569 6768 7420 666c 6167 2028  el height flag (
+00011140: 6465 6661 756c 7473 2074 6f20 3129 3a0a  defaults to 1):.
+00011150: 2020 2020 2020 2020 3120 3d20 6865 6967          1 = heig
+00011160: 6874 2069 7320 756e 6966 6f72 6d20 6f76  ht is uniform ov
+00011170: 6572 2074 6865 2064 6f6d 6169 6e2c 0a20  er the domain,. 
+00011180: 2020 2020 2020 2032 203d 2068 6569 6768         2 = heigh
+00011190: 7420 6973 2070 726f 7669 6465 6420 7468  t is provided th
+000111a0: 726f 7567 6820 5146 5f46 7565 6c48 6569  rough QF_FuelHei
+000111b0: 6768 742e 696e 702c 0a20 2020 2020 2020  ght.inp,.       
+000111c0: 2033 203d 2068 6569 6768 7420 6973 2070   3 = height is p
+000111d0: 726f 7669 6465 6420 7468 726f 7567 6820  rovided through 
+000111e0: 4669 7265 7465 6320 6669 6c65 2028 7472  Firetec file (tr
+000111f0: 6565 7368 6569 6768 742e 6461 7429 206d  eesheight.dat) m
+00011200: 6174 6368 696e 6720 5155 4943 2d46 6972  atching QUIC-Fir
+00011210: 6520 6772 6964 2c0a 2020 2020 2020 2020  e grid,.        
+00011220: 3420 3d20 6865 6967 6874 2069 7320 7072  4 = height is pr
+00011230: 6f76 6964 6564 2074 6872 6f75 6768 2046  ovided through F
+00011240: 6972 6574 6563 2066 696c 6573 2066 6f72  iretec files for
+00011250: 2061 6e20 6172 6269 7472 6172 7920 6772   an arbitrary gr
+00011260: 6964 2c0a 2020 2020 2020 2020 3520 3d20  id,.        5 = 
+00011270: 4661 7374 4675 656c 7320 696e 7075 7420  FastFuels input 
+00011280: 2861 7373 756d 696e 6720 756e 6966 6f72  (assuming unifor
+00011290: 6d20 647a 206f 6620 316d 290a 2020 2020  m dz of 1m).    
+000112a0: 6675 656c 5f68 6569 6768 7420 3a20 506f  fuel_height : Po
+000112b0: 7369 7469 7665 466c 6f61 740a 2020 2020  sitiveFloat.    
+000112c0: 2020 2020 4675 656c 2068 6569 6768 7420      Fuel height 
+000112d0: 6f66 2073 7572 6661 6365 206c 6179 6572  of surface layer
+000112e0: 2028 6d29 0a20 2020 2073 697a 655f 7363   (m).    size_sc
+000112f0: 616c 655f 666c 6167 203a 204c 6974 6572  ale_flag : Liter
+00011300: 616c 5b30 2c20 312c 2032 2c20 332c 2034  al[0, 1, 2, 3, 4
+00011310: 2c20 355d 0a20 2020 2020 2020 2053 697a  , 5].        Siz
+00011320: 6520 7363 616c 6520 666c 6167 2028 6465  e scale flag (de
+00011330: 6661 756c 7473 2074 6f20 3029 3a0a 2020  faults to 0):.  
+00011340: 2020 2020 2020 3020 3d20 4465 6661 756c        0 = Defaul
+00011350: 7420 7661 6c75 6520 2830 2e30 3030 3529  t value (0.0005)
+00011360: 206f 7665 7220 656e 7469 7265 2064 6f6d   over entire dom
+00011370: 6169 6e2c 0a20 2020 2020 2020 2031 203d  ain,.        1 =
+00011380: 2063 7573 746f 6d20 756e 6966 6f72 6d20   custom uniform 
+00011390: 7661 6c75 6520 6f76 6572 2074 6865 2064  value over the d
+000113a0: 6f6d 6169 6e2c 0a20 2020 2020 2020 2032  omain,.        2
+000113b0: 203d 2063 7573 746f 6d20 7661 6c75 6520   = custom value 
+000113c0: 7072 6f76 6964 6564 2074 6872 6f75 6768  provided through
+000113d0: 2051 465f 5369 7a65 5363 616c 652e 696e   QF_SizeScale.in
+000113e0: 702c 0a20 2020 2020 2020 2033 203d 2063  p,.        3 = c
+000113f0: 7573 746f 6d20 7661 6c75 6520 7072 6f76  ustom value prov
+00011400: 6964 6564 2074 6872 6f75 6768 2046 6972  ided through Fir
+00011410: 6574 6563 2066 696c 6520 2874 7265 6573  etec file (trees
+00011420: 7373 2e64 6174 2920 6d61 7463 6869 6e67  ss.dat) matching
+00011430: 2051 5549 432d 4669 7265 2067 7269 642c   QUIC-Fire grid,
+00011440: 0a20 2020 2020 2020 2034 203d 2063 7573  .        4 = cus
+00011450: 746f 6d20 7661 6c75 6520 7072 6f76 6964  tom value provid
+00011460: 6564 2074 6872 6f75 6768 2046 6972 6574  ed through Firet
+00011470: 6563 2066 696c 6573 2066 6f72 2061 6e20  ec files for an 
+00011480: 6172 6269 7472 6172 7920 6772 6964 2c0a  arbitrary grid,.
+00011490: 2020 2020 2020 2020 3520 3d20 4661 7374          5 = Fast
+000114a0: 4675 656c 7320 696e 7075 7420 2861 7373  Fuels input (ass
+000114b0: 756d 696e 6720 756e 6966 6f72 6d20 647a  uming uniform dz
+000114c0: 206f 6620 316d 290a 2020 2020 7369 7a65   of 1m).    size
+000114d0: 5f73 6361 6c65 203a 2050 6f73 6974 6976  _scale : Positiv
+000114e0: 6546 6c6f 6174 0a20 2020 2020 2020 2053  eFloat.        S
+000114f0: 697a 6520 7363 616c 6520 286d 292e 2044  ize scale (m). D
+00011500: 6566 6175 6c74 7320 746f 2030 2e30 3030  efaults to 0.000
+00011510: 352e 0a20 2020 2070 6174 6368 5f61 6e64  5..    patch_and
+00011520: 5f67 6170 5f66 6c61 6720 3a20 4c69 7465  _gap_flag : Lite
+00011530: 7261 6c5b 302c 2031 2c20 325d 0a20 2020  ral[0, 1, 2].   
+00011540: 2020 2020 2050 6174 6368 2061 6e64 2067       Patch and g
+00011550: 6170 2066 6c61 6720 2864 6566 6175 6c74  ap flag (default
+00011560: 7320 746f 2030 293a 0a20 2020 2020 2020  s to 0):.       
+00011570: 2030 203d 2044 6566 6175 6c74 2076 616c   0 = Default val
+00011580: 7565 7320 2830 2c20 3029 206f 7665 7220  ues (0, 0) over 
+00011590: 656e 7469 7265 2064 6f6d 6169 6e2c 0a20  entire domain,. 
+000115a0: 2020 2020 2020 2031 203d 2063 7573 746f         1 = custo
+000115b0: 6d20 756e 6966 6f72 6d20 7661 6c75 6573  m uniform values
+000115c0: 206f 7665 7220 7468 6520 646f 6d61 696e   over the domain
+000115d0: 2c0a 2020 2020 2020 2020 3220 3d20 6375  ,.        2 = cu
+000115e0: 7374 6f6d 2076 616c 7565 7320 7072 6f76  stom values prov
+000115f0: 6964 6564 2062 7920 7061 7463 682e 6461  ided by patch.da
+00011600: 7420 616e 6420 6761 702e 6461 740a 2020  t and gap.dat.  
+00011610: 2020 6967 6e69 7469 6f6e 3a20 4967 6e69    ignition: Igni
+00011620: 7469 6f6e 0a20 2020 2020 2020 2049 676e  tion.        Ign
+00011630: 6974 696f 6e20 7479 7065 2073 7065 6369  ition type speci
+00011640: 6669 6564 2061 7320 616e 2049 676e 6974  fied as an Ignit
+00011650: 696f 6e73 5479 7065 2063 6c61 7373 2066  ionsType class f
+00011660: 726f 6d20 6967 6e69 7469 6f6e 732e 7079  rom ignitions.py
+00011670: 0a20 2020 2020 2020 2031 203d 2072 6563  .        1 = rec
+00011680: 7461 6e67 6c65 0a20 2020 2020 2020 2032  tangle.        2
+00011690: 203d 2073 7175 6172 6520 7269 6e67 0a20   = square ring. 
+000116a0: 2020 2020 2020 2033 203d 2063 6972 6375         3 = circu
+000116b0: 6c61 7220 7269 6e67 0a20 2020 2020 2020  lar ring.       
+000116c0: 2036 203d 2069 676e 6974 652e 6461 7420   6 = ignite.dat 
+000116d0: 2846 6972 6574 6563 2066 696c 6529 0a20  (Firetec file). 
+000116e0: 2020 2069 676e 6974 696f 6e73 5f70 6572     ignitions_per
+000116f0: 5f63 656c 6c20 3a20 506f 7369 7469 7665  _cell : Positive
+00011700: 496e 740a 2020 2020 2020 2020 4e75 6d62  Int.        Numb
+00011710: 6572 206f 6620 6967 6e69 7469 6f6e 2070  er of ignition p
+00011720: 6572 2063 656c 6c20 6f66 2074 6865 2066  er cell of the f
+00011730: 6972 6520 6d6f 6465 6c2e 2052 6563 6f6d  ire model. Recom
+00011740: 6d65 6e64 6564 206d 6178 2076 616c 7565  mended max value
+00011750: 0a20 2020 2020 2020 206f 6620 3130 300a  .        of 100.
+00011760: 2020 2020 6669 7265 6272 616e 645f 666c      firebrand_fl
+00011770: 6167 203a 204c 6974 6572 616c 5b30 2c20  ag : Literal[0, 
+00011780: 315d 0a20 2020 2020 2020 2046 6972 6562  1].        Fireb
+00011790: 7261 6e64 2066 6c61 672c 2030 203d 206f  rand flag, 0 = o
+000117a0: 6666 3b20 3120 3d20 6f6e 2e20 5265 636f  ff; 1 = on. Reco
+000117b0: 6d6d 656e 6465 6420 7661 6c75 6520 3d20  mmended value = 
+000117c0: 303b 2066 6972 6562 7261 6e64 730a 2020  0; firebrands.  
+000117d0: 2020 2020 2020 6172 6520 756e 7465 7374        are untest
+000117e0: 6564 2066 6f72 2073 6d61 6c6c 2073 6361  ed for small sca
+000117f0: 6c65 2070 726f 626c 656d 730a 2020 2020  le problems.    
+00011800: 6175 746f 5f6b 696c 6c20 3a20 4c69 7465  auto_kill : Lite
+00011810: 7261 6c5b 302c 2031 5d0a 2020 2020 2020  ral[0, 1].      
+00011820: 2020 4b69 6c6c 2069 6620 7468 6520 6669    Kill if the fi
+00011830: 7265 2069 7320 6f75 7420 616e 6420 7468  re is out and th
+00011840: 6572 6520 6172 6520 6e6f 206d 6f72 6520  ere are no more 
+00011850: 6967 6e69 7469 6f6e 7320 6f72 2066 6972  ignitions or fir
+00011860: 6562 7261 6e64 730a 2020 2020 2020 2020  ebrands.        
+00011870: 2830 203d 206e 6f2c 2031 203d 2079 6573  (0 = no, 1 = yes
+00011880: 290a 2020 2020 656e 675f 746f 5f61 746d  ).    eng_to_atm
+00011890: 5f6f 7574 203a 204c 6974 6572 616c 5b30  _out : Literal[0
+000118a0: 2c20 315d 0a20 2020 2020 2020 204f 7574  , 1].        Out
+000118b0: 7075 7420 666c 6167 205b 302c 2031 5d3a  put flag [0, 1]:
+000118c0: 2067 7269 6464 6564 2065 6e65 7267 792d   gridded energy-
+000118d0: 746f 2d61 746d 6f73 7068 6572 650a 2020  to-atmosphere.  
+000118e0: 2020 2020 2020 2833 4420 6669 7265 2067        (3D fire g
+000118f0: 7269 6420 2b20 6578 7472 6120 6c61 7965  rid + extra laye
+00011900: 7273 290a 2020 2020 7265 6163 745f 7261  rs).    react_ra
+00011910: 7465 5f6f 7574 203a 204c 6974 6572 616c  te_out : Literal
+00011920: 5b30 2c20 315d 0a20 2020 2020 2020 204f  [0, 1].        O
+00011930: 7574 7075 7420 666c 6167 205b 302c 2031  utput flag [0, 1
+00011940: 5d3a 2063 6f6d 7072 6573 7365 6420 6172  ]: compressed ar
+00011950: 7261 7920 7265 6163 7469 6f6e 2072 6174  ray reaction rat
+00011960: 6520 2866 6972 6520 6772 6964 290a 2020  e (fire grid).  
+00011970: 2020 6675 656c 5f64 656e 735f 6f75 7420    fuel_dens_out 
+00011980: 3a20 4c69 7465 7261 6c5b 302c 2031 5d0a  : Literal[0, 1].
+00011990: 2020 2020 2020 2020 4f75 7470 7574 2066          Output f
+000119a0: 6c61 6720 5b30 2c20 315d 3a20 636f 6d70  lag [0, 1]: comp
+000119b0: 7265 7373 6564 2061 7272 6179 2066 7565  ressed array fue
+000119c0: 6c20 6465 6e73 6974 7920 2866 6972 6520  l density (fire 
+000119d0: 6772 6964 290a 2020 2020 7166 5f77 696e  grid).    qf_win
+000119e0: 645f 6f75 7420 3a20 4c69 7465 7261 6c5b  d_out : Literal[
+000119f0: 302c 2031 5d0a 2020 2020 2020 2020 4f75  0, 1].        Ou
+00011a00: 7470 7574 2066 6c61 6720 5b30 2c20 315d  tput flag [0, 1]
+00011a10: 3a20 6772 6964 6465 6420 7769 6e64 2028  : gridded wind (
+00011a20: 752c 762c 772c 7369 676d 6129 2028 3344  u,v,w,sigma) (3D
+00011a30: 2066 6972 6520 6772 6964 290a 2020 2020   fire grid).    
+00011a40: 7175 5f77 696e 645f 696e 7374 5f6f 7574  qu_wind_inst_out
+00011a50: 203a 204c 6974 6572 616c 5b30 2c20 315d   : Literal[0, 1]
+00011a60: 0a20 2020 2020 2020 204f 7574 7075 7420  .        Output 
+00011a70: 666c 6167 205b 302c 2031 5d3a 2067 7269  flag [0, 1]: gri
+00011a80: 6464 6564 2051 5520 7769 6e64 7320 7769  dded QU winds wi
+00011a90: 7468 2066 6972 6520 6566 6665 6374 732c  th fire effects,
+00011aa0: 2069 6e73 7461 6e74 616e 656f 7573 0a20   instantaneous. 
+00011ab0: 2020 2020 2020 2028 5155 4943 2d55 5242         (QUIC-URB
+00011ac0: 2067 7269 6429 0a20 2020 2071 755f 7769   grid).    qu_wi
+00011ad0: 6e64 5f61 7667 5f6f 7574 203a 204c 6974  nd_avg_out : Lit
+00011ae0: 6572 616c 5b30 2c20 315d 0a20 2020 2020  eral[0, 1].     
+00011af0: 2020 204f 7574 7075 7420 666c 6167 205b     Output flag [
+00011b00: 302c 2031 5d3a 2067 7269 6464 6564 2051  0, 1]: gridded Q
+00011b10: 5520 7769 6e64 7320 7769 7468 2066 6972  U winds with fir
+00011b20: 6520 6566 6665 6374 732c 2061 7665 7261  e effects, avera
+00011b30: 6765 640a 2020 2020 2020 2020 2851 5549  ged.        (QUI
+00011b40: 432d 5552 4220 6772 6964 290a 2020 2020  C-URB grid).    
+00011b50: 6675 656c 5f6d 6f69 7374 5f6f 7574 203a  fuel_moist_out :
+00011b60: 204c 6974 6572 616c 5b30 2c20 315d 0a20   Literal[0, 1]. 
+00011b70: 2020 2020 2020 204f 7574 7075 7420 666c         Output fl
+00011b80: 6167 205b 302c 2031 5d3a 2063 6f6d 7072  ag [0, 1]: compr
+00011b90: 6573 7365 6420 6172 7261 7920 6675 656c  essed array fuel
+00011ba0: 206d 6f69 7374 7572 6520 2866 6972 6520   moisture (fire 
+00011bb0: 6772 6964 290a 2020 2020 6d61 7373 5f62  grid).    mass_b
+00011bc0: 7572 6e74 5f6f 7574 203a 204c 6974 6572  urnt_out : Liter
+00011bd0: 616c 5b30 2c20 315d 0a20 2020 2020 2020  al[0, 1].       
+00011be0: 204f 7574 7075 7420 666c 6167 205b 302c   Output flag [0,
+00011bf0: 2031 5d3a 2076 6572 7469 6361 6c6c 792d   1]: vertically-
+00011c00: 696e 7465 6772 6174 6564 2025 206d 6173  integrated % mas
+00011c10: 7320 6275 726e 7420 2866 6972 6520 6772  s burnt (fire gr
+00011c20: 6964 290a 2020 2020 6669 7265 6272 616e  id).    firebran
+00011c30: 645f 6f75 7420 3a20 4c69 7465 7261 6c5b  d_out : Literal[
+00011c40: 302c 2031 5d0a 2020 2020 2020 2020 4f75  0, 1].        Ou
+00011c50: 7470 7574 2066 6c61 6720 5b30 2c20 315d  tput flag [0, 1]
+00011c60: 3a20 6669 7265 6272 616e 6420 7472 616a  : firebrand traj
+00011c70: 6563 746f 7269 6573 2e20 4d75 7374 2062  ectories. Must b
+00011c80: 6520 3020 7768 656e 2066 6972 6562 7261  e 0 when firebra
+00011c90: 6e64 0a20 2020 2020 2020 2066 6c61 6720  nd.        flag 
+00011ca0: 6973 2030 0a20 2020 2065 6d69 7373 696f  is 0.    emissio
+00011cb0: 6e73 5f6f 7574 203a 204c 6974 6572 616c  ns_out : Literal
+00011cc0: 5b30 2c20 312c 2032 2c20 332c 2034 2c20  [0, 1, 2, 3, 4, 
+00011cd0: 355d 0a20 2020 2020 2020 204f 7574 7075  5].        Outpu
+00011ce0: 7420 666c 6167 205b 302c 2035 5d3a 2063  t flag [0, 5]: c
+00011cf0: 6f6d 7072 6573 7365 6420 6172 7261 7920  ompressed array 
+00011d00: 656d 6973 7369 6f6e 7320 2866 6972 6520  emissions (fire 
+00011d10: 6772 6964 293a 0a20 2020 2020 2020 2020  grid):.         
+00011d20: 2020 2030 203d 2064 6f20 6e6f 7420 6f75     0 = do not ou
+00011d30: 7470 7574 2061 6e79 2065 6d69 7373 696f  tput any emissio
+00011d40: 6e20 7265 6c61 7465 6420 7661 7269 6162  n related variab
+00011d50: 6c65 730a 2020 2020 2020 2020 2020 2020  les.            
+00011d60: 3120 3d20 6f75 7470 7574 2065 6d69 7373  1 = output emiss
+00011d70: 696f 6e73 2066 696c 6573 2061 6e64 2073  ions files and s
+00011d80: 696d 756c 6174 6520 434f 2069 6e20 5155  imulate CO in QU
+00011d90: 4943 2d53 4d4f 4b45 0a20 2020 2020 2020  IC-SMOKE.       
+00011da0: 2020 2020 2032 203d 206f 7574 7075 7420       2 = output 
+00011db0: 656d 6973 7369 6f6e 7320 6669 6c65 7320  emissions files 
+00011dc0: 616e 6420 7369 6d75 6c61 7465 2050 4d32  and simulate PM2
+00011dd0: 2e35 2069 6e20 5155 4943 2d20 534d 4f4b  .5 in QUIC- SMOK
+00011de0: 450a 2020 2020 2020 2020 2020 2020 3320  E.            3 
+00011df0: 3d20 6f75 7470 7574 2065 6d69 7373 696f  = output emissio
+00011e00: 6e73 2066 696c 6573 2061 6e64 2073 696d  ns files and sim
+00011e10: 756c 6174 6520 626f 7468 2043 4f20 616e  ulate both CO an
+00011e20: 6420 504d 322e 3520 696e 0a20 2020 2020  d PM2.5 in.     
+00011e30: 2020 2020 2020 2020 2020 2051 5549 432d             QUIC-
+00011e40: 534d 4f4b 450a 2020 2020 2020 2020 2020  SMOKE.          
+00011e50: 2020 3420 3d20 6f75 7470 7574 2065 6d69    4 = output emi
+00011e60: 7373 696f 6e73 2066 696c 6573 2062 7574  ssions files but
+00011e70: 2075 7365 206c 6962 7261 7279 2061 7070   use library app
+00011e80: 726f 6163 6820 696e 2051 5549 432d 534d  roach in QUIC-SM
+00011e90: 4f4b 450a 2020 2020 2020 2020 2020 2020  OKE.            
+00011ea0: 3520 3d20 6f75 7470 7574 2065 6d69 7373  5 = output emiss
+00011eb0: 696f 6e73 2066 696c 6573 2061 6e64 2073  ions files and s
+00011ec0: 696d 756c 6174 6520 626f 7468 2077 6174  imulate both wat
+00011ed0: 6572 2069 6e20 5155 4943 2d53 4d4f 4b45  er in QUIC-SMOKE
+00011ee0: 0a20 2020 2072 6164 6961 7469 6f6e 5f6f  .    radiation_o
+00011ef0: 7574 203a 204c 6974 6572 616c 5b30 2c20  ut : Literal[0, 
+00011f00: 315d 0a20 2020 2020 2020 204f 7574 7075  1].        Outpu
+00011f10: 7420 666c 6167 205b 302c 2031 5d3a 2067  t flag [0, 1]: g
+00011f20: 7269 6464 6564 2074 6865 726d 616c 2072  ridded thermal r
+00011f30: 6164 6961 7469 6f6e 2028 6669 7265 2067  adiation (fire g
+00011f40: 7269 6429 0a20 2020 2069 6e74 656e 7369  rid).    intensi
+00011f50: 7479 5f6f 7574 203a 204c 6974 6572 616c  ty_out : Literal
+00011f60: 5b30 2c20 315d 0a20 2020 2020 2020 204f  [0, 1].        O
+00011f70: 7574 7075 7420 666c 6167 205b 302c 2031  utput flag [0, 1
+00011f80: 5d3a 2073 7572 6661 6365 2066 6972 6520  ]: surface fire 
+00011f90: 696e 7465 6e73 6974 7920 6174 2065 7665  intensity at eve
+00011fa0: 7279 2066 6972 6520 7469 6d65 2073 7465  ry fire time ste
+00011fb0: 700a 2020 2020 2222 220a 0a20 2020 206e  p.    """..    n
+00011fc0: 616d 653a 2073 7472 203d 2022 5155 4943  ame: str = "QUIC
+00011fd0: 5f66 6972 6522 0a20 2020 205f 6578 7465  _fire".    _exte
+00011fe0: 6e73 696f 6e3a 2073 7472 203d 2022 2e69  nsion: str = ".i
+00011ff0: 6e70 220a 2020 2020 6669 7265 5f66 6c61  np".    fire_fla
+00012000: 673a 204c 6974 6572 616c 5b30 2c20 315d  g: Literal[0, 1]
+00012010: 203d 2031 0a20 2020 2072 616e 646f 6d5f   = 1.    random_
+00012020: 7365 6564 3a20 696e 7420 3d20 4669 656c  seed: int = Fiel
+00012030: 6428 6765 3d2d 312c 2064 6566 6175 6c74  d(ge=-1, default
+00012040: 3d2d 3129 0a20 2020 2074 696d 655f 6e6f  =-1).    time_no
+00012050: 773a 2050 6f73 6974 6976 6549 6e74 0a20  w: PositiveInt. 
+00012060: 2020 2073 696d 5f74 696d 653a 2050 6f73     sim_time: Pos
+00012070: 6974 6976 6549 6e74 0a20 2020 2066 6972  itiveInt.    fir
+00012080: 655f 7469 6d65 5f73 7465 703a 2050 6f73  e_time_step: Pos
+00012090: 6974 6976 6549 6e74 203d 2031 0a20 2020  itiveInt = 1.   
+000120a0: 2071 7569 635f 7469 6d65 5f73 7465 703a   quic_time_step:
+000120b0: 2050 6f73 6974 6976 6549 6e74 203d 2031   PositiveInt = 1
+000120c0: 0a20 2020 206f 7574 5f74 696d 655f 6669  .    out_time_fi
+000120d0: 7265 3a20 506f 7369 7469 7665 496e 7420  re: PositiveInt 
+000120e0: 3d20 3330 0a20 2020 206f 7574 5f74 696d  = 30.    out_tim
+000120f0: 655f 7769 6e64 3a20 506f 7369 7469 7665  e_wind: Positive
+00012100: 496e 7420 3d20 3330 0a20 2020 206f 7574  Int = 30.    out
+00012110: 5f74 696d 655f 656d 6973 5f72 6164 3a20  _time_emis_rad: 
+00012120: 506f 7369 7469 7665 496e 7420 3d20 3330  PositiveInt = 30
+00012130: 0a20 2020 206f 7574 5f74 696d 655f 7769  .    out_time_wi
+00012140: 6e64 5f61 7667 3a20 506f 7369 7469 7665  nd_avg: Positive
+00012150: 496e 7420 3d20 3330 0a20 2020 206e 7a3a  Int = 30.    nz:
+00012160: 2050 6f73 6974 6976 6549 6e74 0a20 2020   PositiveInt.   
+00012170: 2073 7472 6574 6368 5f67 7269 645f 666c   stretch_grid_fl
+00012180: 6167 3a20 4c69 7465 7261 6c5b 302c 2031  ag: Literal[0, 1
+00012190: 5d20 3d20 300a 2020 2020 647a 3a20 506f  ] = 0.    dz: Po
+000121a0: 7369 7469 7665 466c 6f61 7420 3d20 310a  sitiveFloat = 1.
+000121b0: 2020 2020 647a 5f61 7272 6179 3a20 6c69      dz_array: li
+000121c0: 7374 5b50 6f73 6974 6976 6546 6c6f 6174  st[PositiveFloat
+000121d0: 5d20 3d20 5b5d 0a20 2020 2066 7565 6c5f  ] = [].    fuel_
+000121e0: 6465 6e73 6974 795f 666c 6167 3a20 4c69  density_flag: Li
+000121f0: 7465 7261 6c5b 312c 2032 2c20 332c 2034  teral[1, 2, 3, 4
+00012200: 2c20 355d 203d 2031 0a20 2020 2066 7565  , 5] = 1.    fue
+00012210: 6c5f 6465 6e73 6974 793a 2055 6e69 6f6e  l_density: Union
+00012220: 5b50 6f73 6974 6976 6546 6c6f 6174 2c20  [PositiveFloat, 
+00012230: 4e6f 6e65 5d20 3d20 302e 350a 2020 2020  None] = 0.5.    
+00012240: 6675 656c 5f6d 6f69 7374 7572 655f 666c  fuel_moisture_fl
+00012250: 6167 3a20 4c69 7465 7261 6c5b 312c 2032  ag: Literal[1, 2
+00012260: 2c20 332c 2034 2c20 355d 203d 2031 0a20  , 3, 4, 5] = 1. 
+00012270: 2020 2066 7565 6c5f 6d6f 6973 7475 7265     fuel_moisture
+00012280: 3a20 556e 696f 6e5b 506f 7369 7469 7665  : Union[Positive
+00012290: 466c 6f61 742c 204e 6f6e 655d 203d 2030  Float, None] = 0
+000122a0: 2e31 0a20 2020 2066 7565 6c5f 6865 6967  .1.    fuel_heig
+000122b0: 6874 5f66 6c61 673a 204c 6974 6572 616c  ht_flag: Literal
+000122c0: 5b31 2c20 322c 2033 2c20 345d 203d 2031  [1, 2, 3, 4] = 1
+000122d0: 0a20 2020 2066 7565 6c5f 6865 6967 6874  .    fuel_height
+000122e0: 3a20 556e 696f 6e5b 506f 7369 7469 7665  : Union[Positive
+000122f0: 466c 6f61 742c 204e 6f6e 655d 203d 2031  Float, None] = 1
+00012300: 2e30 0a20 2020 2073 697a 655f 7363 616c  .0.    size_scal
+00012310: 655f 666c 6167 3a20 4c69 7465 7261 6c5b  e_flag: Literal[
+00012320: 302c 2031 2c20 322c 2033 2c20 342c 2035  0, 1, 2, 3, 4, 5
+00012330: 5d20 3d20 300a 2020 2020 7369 7a65 5f73  ] = 0.    size_s
+00012340: 6361 6c65 3a20 506f 7369 7469 7665 466c  cale: PositiveFl
+00012350: 6f61 7420 3d20 302e 3030 3035 0a20 2020  oat = 0.0005.   
+00012360: 2070 6174 6368 5f61 6e64 5f67 6170 5f66   patch_and_gap_f
+00012370: 6c61 673a 204c 6974 6572 616c 5b30 2c20  lag: Literal[0, 
+00012380: 312c 2032 5d20 3d20 300a 2020 2020 7061  1, 2] = 0.    pa
+00012390: 7463 685f 7369 7a65 3a20 4e6f 6e4e 6567  tch_size: NonNeg
+000123a0: 6174 6976 6546 6c6f 6174 203d 2030 0a20  ativeFloat = 0. 
+000123b0: 2020 2067 6170 5f73 697a 653a 204e 6f6e     gap_size: Non
+000123c0: 4e65 6761 7469 7665 466c 6f61 7420 3d20  NegativeFloat = 
+000123d0: 300a 2020 2020 6967 6e69 7469 6f6e 3a20  0.    ignition: 
+000123e0: 556e 696f 6e5b 0a20 2020 2020 2020 2052  Union[.        R
+000123f0: 6563 7461 6e67 6c65 4967 6e69 7469 6f6e  ectangleIgnition
+00012400: 2c20 5371 7561 7265 5269 6e67 4967 6e69  , SquareRingIgni
+00012410: 7469 6f6e 2c20 4369 7263 756c 6172 5269  tion, CircularRi
+00012420: 6e67 4967 6e69 7469 6f6e 2c20 4967 6e69  ngIgnition, Igni
+00012430: 7469 6f6e 0a20 2020 205d 0a20 2020 2069  tion.    ].    i
+00012440: 676e 6974 696f 6e73 5f70 6572 5f63 656c  gnitions_per_cel
+00012450: 6c3a 2050 6f73 6974 6976 6549 6e74 203d  l: PositiveInt =
+00012460: 2032 0a20 2020 2066 6972 6562 7261 6e64   2.    firebrand
+00012470: 5f66 6c61 673a 204c 6974 6572 616c 5b30  _flag: Literal[0
+00012480: 2c20 315d 203d 2030 0a20 2020 2061 7574  , 1] = 0.    aut
+00012490: 6f5f 6b69 6c6c 3a20 4c69 7465 7261 6c5b  o_kill: Literal[
+000124a0: 302c 2031 5d20 3d20 310a 2020 2020 656e  0, 1] = 1.    en
+000124b0: 675f 746f 5f61 746d 5f6f 7574 3a20 4c69  g_to_atm_out: Li
+000124c0: 7465 7261 6c5b 302c 2031 5d20 3d20 300a  teral[0, 1] = 0.
+000124d0: 2020 2020 7265 6163 745f 7261 7465 5f6f      react_rate_o
+000124e0: 7574 3a20 4c69 7465 7261 6c5b 302c 2031  ut: Literal[0, 1
+000124f0: 5d20 3d20 300a 2020 2020 6675 656c 5f64  ] = 0.    fuel_d
+00012500: 656e 735f 6f75 743a 204c 6974 6572 616c  ens_out: Literal
+00012510: 5b30 2c20 315d 203d 2031 0a20 2020 2071  [0, 1] = 1.    q
+00012520: 665f 7769 6e64 5f6f 7574 3a20 4c69 7465  f_wind_out: Lite
+00012530: 7261 6c5b 302c 2031 5d20 3d20 300a 2020  ral[0, 1] = 0.  
+00012540: 2020 7175 5f77 696e 645f 696e 7374 5f6f    qu_wind_inst_o
+00012550: 7574 3a20 4c69 7465 7261 6c5b 302c 2031  ut: Literal[0, 1
+00012560: 5d20 3d20 310a 2020 2020 7175 5f77 696e  ] = 1.    qu_win
+00012570: 645f 6176 675f 6f75 743a 204c 6974 6572  d_avg_out: Liter
+00012580: 616c 5b30 2c20 315d 203d 2030 0a20 2020  al[0, 1] = 0.   
+00012590: 2066 7565 6c5f 6d6f 6973 745f 6f75 743a   fuel_moist_out:
+000125a0: 204c 6974 6572 616c 5b30 2c20 315d 203d   Literal[0, 1] =
+000125b0: 2030 0a20 2020 206d 6173 735f 6275 726e   0.    mass_burn
+000125c0: 745f 6f75 743a 204c 6974 6572 616c 5b30  t_out: Literal[0
+000125d0: 2c20 315d 203d 2030 0a20 2020 2066 6972  , 1] = 0.    fir
+000125e0: 6562 7261 6e64 5f6f 7574 3a20 4c69 7465  ebrand_out: Lite
+000125f0: 7261 6c5b 302c 2031 5d20 3d20 300a 2020  ral[0, 1] = 0.  
+00012600: 2020 656d 6973 7369 6f6e 735f 6f75 743a    emissions_out:
+00012610: 204c 6974 6572 616c 5b30 2c20 312c 2032   Literal[0, 1, 2
+00012620: 2c20 332c 2034 2c20 355d 203d 2030 0a20  , 3, 4, 5] = 0. 
+00012630: 2020 2072 6164 6961 7469 6f6e 5f6f 7574     radiation_out
+00012640: 3a20 4c69 7465 7261 6c5b 302c 2031 5d20  : Literal[0, 1] 
+00012650: 3d20 300a 2020 2020 7375 7266 5f65 6e67  = 0.    surf_eng
+00012660: 5f6f 7574 3a20 4c69 7465 7261 6c5b 302c  _out: Literal[0,
+00012670: 2031 5d20 3d20 300a 0a20 2020 2040 6669   1] = 0..    @fi
+00012680: 656c 645f 7661 6c69 6461 746f 7228 2272  eld_validator("r
+00012690: 616e 646f 6d5f 7365 6564 2229 0a20 2020  andom_seed").   
+000126a0: 2040 636c 6173 736d 6574 686f 640a 2020   @classmethod.  
+000126b0: 2020 6465 6620 7661 6c69 6461 7465 5f72    def validate_r
+000126c0: 616e 646f 6d5f 7365 6564 2863 6c73 2c20  andom_seed(cls, 
+000126d0: 763a 2069 6e74 2920 2d3e 2069 6e74 3a0a  v: int) -> int:.
+000126e0: 2020 2020 2020 2020 6966 2076 203d 3d20          if v == 
+000126f0: 303a 0a20 2020 2020 2020 2020 2020 2072  0:.            r
+00012700: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00012710: 2251 5549 435f 6669 7265 2e69 6e70 3a20  "QUIC_fire.inp: 
+00012720: 7261 6e64 6f6d 5f73 6565 6420 6d75 7374  random_seed must
+00012730: 2062 6520 6e6f 7420 6265 2030 2229 0a20   be not be 0"). 
+00012740: 2020 2020 2020 2072 6574 7572 6e20 760a         return v.
+00012750: 0a20 2020 2040 636f 6d70 7574 6564 5f66  .    @computed_f
+00012760: 6965 6c64 0a20 2020 2040 7072 6f70 6572  ield.    @proper
+00012770: 7479 0a20 2020 2064 6566 205f 7374 7265  ty.    def _stre
+00012780: 7463 685f 6772 6964 5f69 6e70 7574 2873  tch_grid_input(s
+00012790: 656c 6629 202d 3e20 7374 723a 0a20 2020  elf) -> str:.   
+000127a0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+000127b0: 2057 7269 7465 7320 6120 6375 7374 6f6d   Writes a custom
+000127c0: 2073 7472 6574 6368 2067 7269 6420 746f   stretch grid to
+000127d0: 2051 5549 435f 6669 7265 2e69 6e70 2c20   QUIC_fire.inp, 
+000127e0: 6966 2070 726f 7669 6465 642e 0a20 2020  if provided..   
+000127f0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00012800: 2069 6620 7365 6c66 2e73 7472 6574 6368   if self.stretch
+00012810: 5f67 7269 645f 666c 6167 203d 3d20 313a  _grid_flag == 1:
+00012820: 0a20 2020 2020 2020 2020 2020 2023 2056  .            # V
+00012830: 6572 6966 7920 7468 6174 2064 7a5f 6172  erify that dz_ar
+00012840: 7261 7920 6973 206e 6f74 2065 6d70 7479  ray is not empty
+00012850: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00012860: 6e6f 7420 7365 6c66 2e64 7a5f 6172 7261  not self.dz_arra
+00012870: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
+00012880: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+00012890: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
+000128a0: 2020 2020 2020 2020 2022 647a 5f61 7272           "dz_arr
+000128b0: 6179 206d 7573 7420 6e6f 7420 6265 2065  ay must not be e
+000128c0: 6d70 7479 2069 6620 7374 7265 7463 685f  mpty if stretch_
+000128d0: 6772 6964 5f66 6c61 6720 220a 2020 2020  grid_flag ".    
+000128e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000128f0: 2269 7320 312e 2050 6c65 6173 6520 7072  "is 1. Please pr
+00012900: 6f76 6964 6520 6120 647a 5f61 7272 6179  ovide a dz_array
+00012910: 2077 6974 6820 6e7a 2065 6c65 6d65 6e74   with nz element
+00012920: 7322 0a20 2020 2020 2020 2020 2020 2020  s".             
+00012930: 2020 2020 2020 2022 206f 7220 7573 6520         " or use 
+00012940: 6120 6469 6666 6572 656e 7420 7374 7265  a different stre
+00012950: 7463 685f 6772 6964 5f66 6c61 672e 220a  tch_grid_flag.".
+00012960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012970: 290a 0a20 2020 2020 2020 2020 2020 2023  )..            #
+00012980: 2056 6572 6966 7920 7468 6174 206e 7a20   Verify that nz 
+00012990: 6973 2065 7175 616c 2074 6f20 7468 6520  is equal to the 
+000129a0: 6c65 6e67 7468 206f 6620 647a 5f61 7272  length of dz_arr
+000129b0: 6179 0a20 2020 2020 2020 2020 2020 2069  ay.            i
+000129c0: 6620 7365 6c66 2e6e 7a20 213d 206c 656e  f self.nz != len
+000129d0: 2873 656c 662e 647a 5f61 7272 6179 293a  (self.dz_array):
+000129e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000129f0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00012a00: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+00012a10: 2020 2020 2020 2066 226e 7a20 6d75 7374         f"nz must
+00012a20: 2062 6520 6571 7561 6c20 746f 2074 6865   be equal to the
+00012a30: 206c 656e 6774 6820 6f66 2064 7a5f 6172   length of dz_ar
+00012a40: 7261 792e 2022 0a20 2020 2020 2020 2020  ray. ".         
+00012a50: 2020 2020 2020 2020 2020 2066 227b 7365             f"{se
+00012a60: 6c66 2e6e 7a7d 2021 3d20 7b6c 656e 2873  lf.nz} != {len(s
+00012a70: 656c 662e 647a 5f61 7272 6179 297d 220a  elf.dz_array)}".
+00012a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012a90: 290a 0a20 2020 2020 2020 2020 2020 2023  )..            #
+00012aa0: 2057 7269 7465 2064 7a5f 6172 7261 7920   Write dz_array 
+00012ab0: 6c69 6e65 730a 2020 2020 2020 2020 2020  lines.          
+00012ac0: 2020 647a 5f61 7272 6179 5f6c 696e 6573    dz_array_lines
+00012ad0: 5f6c 6973 7420 3d20 5b5d 0a20 2020 2020  _list = [].     
+00012ae0: 2020 2020 2020 2066 6f72 2064 7a20 696e         for dz in
+00012af0: 2073 656c 662e 647a 5f61 7272 6179 3a0a   self.dz_array:.
+00012b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012b10: 647a 5f61 7272 6179 5f6c 696e 6573 5f6c  dz_array_lines_l
+00012b20: 6973 742e 6170 7065 6e64 2866 227b 666c  ist.append(f"{fl
+00012b30: 6f61 7428 647a 297d 2229 0a20 2020 2020  oat(dz)}").     
+00012b40: 2020 2020 2020 2064 7a5f 6172 7261 795f         dz_array_
+00012b50: 6c69 6e65 7320 3d20 225c 6e22 2e6a 6f69  lines = "\n".joi
+00012b60: 6e28 647a 5f61 7272 6179 5f6c 696e 6573  n(dz_array_lines
+00012b70: 5f6c 6973 7429 0a0a 2020 2020 2020 2020  _list)..        
+00012b80: 2020 2020 7265 7475 726e 2066 227b 647a      return f"{dz
+00012b90: 5f61 7272 6179 5f6c 696e 6573 7d5c 6e22  _array_lines}\n"
+00012ba0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00012bb0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00012bc0: 6e20 7374 7228 7365 6c66 2e64 7a29 0a0a  n str(self.dz)..
+00012bd0: 2020 2020 4063 6f6d 7075 7465 645f 6669      @computed_fi
+00012be0: 656c 640a 2020 2020 4070 726f 7065 7274  eld.    @propert
+00012bf0: 790a 2020 2020 6465 6620 5f69 676e 6974  y.    def _ignit
+00012c00: 696f 6e5f 6c69 6e65 7328 7365 6c66 2920  ion_lines(self) 
+00012c10: 2d3e 2073 7472 3a0a 2020 2020 2020 2020  -> str:.        
+00012c20: 7265 7475 726e 2073 7472 2873 656c 662e  return str(self.
+00012c30: 6967 6e69 7469 6f6e 290a 0a20 2020 2040  ignition)..    @
+00012c40: 636f 6d70 7574 6564 5f66 6965 6c64 0a20  computed_field. 
+00012c50: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00012c60: 2064 6566 205f 6675 656c 5f64 656e 7369   def _fuel_densi
+00012c70: 7479 5f6c 696e 6573 2873 656c 6629 202d  ty_lines(self) -
+00012c80: 3e20 7374 723a 0a20 2020 2020 2020 2066  > str:.        f
+00012c90: 7565 6c5f 6465 6e73 6974 795f 666c 6167  uel_density_flag
+00012ca0: 5f6c 696e 6520 3d20 6622 7b73 656c 662e  _line = f"{self.
+00012cb0: 6675 656c 5f64 656e 7369 7479 5f66 6c61  fuel_density_fla
+00012cc0: 677d 5c74 2120 6675 656c 2064 656e 7369  g}\t! fuel densi
+00012cd0: 7479 2066 6c61 6722 0a20 2020 2020 2020  ty flag".       
+00012ce0: 2069 6620 7365 6c66 2e66 7565 6c5f 6465   if self.fuel_de
+00012cf0: 6e73 6974 795f 666c 6167 203d 3d20 313a  nsity_flag == 1:
+00012d00: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00012d10: 7572 6e20 6675 656c 5f64 656e 7369 7479  urn fuel_density
+00012d20: 5f66 6c61 675f 6c69 6e65 202b 2066 225c  _flag_line + f"\
+00012d30: 6e7b 7365 6c66 2e66 7565 6c5f 6465 6e73  n{self.fuel_dens
+00012d40: 6974 797d 220a 2020 2020 2020 2020 7265  ity}".        re
+00012d50: 7475 726e 2066 7565 6c5f 6465 6e73 6974  turn fuel_densit
+00012d60: 795f 666c 6167 5f6c 696e 650a 0a20 2020  y_flag_line..   
+00012d70: 2040 636f 6d70 7574 6564 5f66 6965 6c64   @computed_field
+00012d80: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+00012d90: 2020 2064 6566 205f 6675 656c 5f6d 6f69     def _fuel_moi
+00012da0: 7374 7572 655f 6c69 6e65 7328 7365 6c66  sture_lines(self
+00012db0: 2920 2d3e 2073 7472 3a0a 2020 2020 2020  ) -> str:.      
+00012dc0: 2020 6675 656c 5f6d 6f69 7374 5f66 6c61    fuel_moist_fla
+00012dd0: 675f 6c69 6e65 203d 2066 225c 6e7b 7365  g_line = f"\n{se
+00012de0: 6c66 2e66 7565 6c5f 6d6f 6973 7475 7265  lf.fuel_moisture
+00012df0: 5f66 6c61 677d 5c74 2120 6675 656c 206d  _flag}\t! fuel m
+00012e00: 6f69 7374 7572 6520 666c 6167 220a 2020  oisture flag".  
+00012e10: 2020 2020 2020 6966 2073 656c 662e 6675        if self.fu
+00012e20: 656c 5f6d 6f69 7374 7572 655f 666c 6167  el_moisture_flag
+00012e30: 203d 3d20 313a 0a20 2020 2020 2020 2020   == 1:.         
+00012e40: 2020 2072 6574 7572 6e20 6675 656c 5f6d     return fuel_m
+00012e50: 6f69 7374 5f66 6c61 675f 6c69 6e65 202b  oist_flag_line +
+00012e60: 2066 225c 6e7b 7365 6c66 2e66 7565 6c5f   f"\n{self.fuel_
+00012e70: 6d6f 6973 7475 7265 7d22 0a20 2020 2020  moisture}".     
+00012e80: 2020 2072 6574 7572 6e20 6675 656c 5f6d     return fuel_m
+00012e90: 6f69 7374 5f66 6c61 675f 6c69 6e65 0a0a  oist_flag_line..
+00012ea0: 2020 2020 4063 6f6d 7075 7465 645f 6669      @computed_fi
+00012eb0: 656c 640a 2020 2020 4070 726f 7065 7274  eld.    @propert
+00012ec0: 790a 2020 2020 6465 6620 5f66 7565 6c5f  y.    def _fuel_
+00012ed0: 6865 6967 6874 5f6c 696e 6573 2873 656c  height_lines(sel
+00012ee0: 6629 202d 3e20 7374 723a 0a20 2020 2020  f) -> str:.     
+00012ef0: 2020 2069 6620 7365 6c66 2e66 7565 6c5f     if self.fuel_
+00012f00: 6465 6e73 6974 795f 666c 6167 203d 3d20  density_flag == 
+00012f10: 313a 0a20 2020 2020 2020 2020 2020 2066  1:.            f
+00012f20: 7565 6c5f 6865 6967 6874 5f66 6c61 675f  uel_height_flag_
+00012f30: 6c69 6e65 203d 2066 225c 6e7b 7365 6c66  line = f"\n{self
+00012f40: 2e66 7565 6c5f 6865 6967 6874 5f66 6c61  .fuel_height_fla
+00012f50: 677d 5c74 2120 6675 656c 2068 6569 6768  g}\t! fuel heigh
+00012f60: 7420 666c 6167 220a 2020 2020 2020 2020  t flag".        
+00012f70: 2020 2020 6966 2073 656c 662e 6675 656c      if self.fuel
+00012f80: 5f68 6569 6768 745f 666c 6167 203d 3d20  _height_flag == 
+00012f90: 313a 0a20 2020 2020 2020 2020 2020 2020  1:.             
+00012fa0: 2020 2072 6574 7572 6e20 6675 656c 5f68     return fuel_h
+00012fb0: 6569 6768 745f 666c 6167 5f6c 696e 6520  eight_flag_line 
+00012fc0: 2b20 6622 5c6e 7b73 656c 662e 6675 656c  + f"\n{self.fuel
+00012fd0: 5f68 6569 6768 747d 220a 2020 2020 2020  _height}".      
+00012fe0: 2020 2020 2020 7265 7475 726e 2066 7565        return fue
+00012ff0: 6c5f 6865 6967 6874 5f66 6c61 675f 6c69  l_height_flag_li
+00013000: 6e65 0a20 2020 2020 2020 2072 6574 7572  ne.        retur
+00013010: 6e20 2222 0a0a 2020 2020 4063 6f6d 7075  n ""..    @compu
+00013020: 7465 645f 6669 656c 640a 2020 2020 4070  ted_field.    @p
+00013030: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+00013040: 5f73 697a 655f 7363 616c 655f 6c69 6e65  _size_scale_line
+00013050: 7328 7365 6c66 2920 2d3e 2073 7472 3a0a  s(self) -> str:.
+00013060: 2020 2020 2020 2020 7369 7a65 5f73 6361          size_sca
+00013070: 6c65 5f66 6c61 675f 6c69 6e65 203d 2066  le_flag_line = f
+00013080: 225c 6e7b 7365 6c66 2e73 697a 655f 7363  "\n{self.size_sc
+00013090: 616c 655f 666c 6167 7d5c 7421 2073 697a  ale_flag}\t! siz
+000130a0: 6520 7363 616c 6520 666c 6167 220a 2020  e scale flag".  
+000130b0: 2020 2020 2020 6966 2073 656c 662e 7369        if self.si
+000130c0: 7a65 5f73 6361 6c65 5f66 6c61 6720 3d3d  ze_scale_flag ==
+000130d0: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
+000130e0: 7265 7475 726e 2073 697a 655f 7363 616c  return size_scal
+000130f0: 655f 666c 6167 5f6c 696e 6520 2b20 6622  e_flag_line + f"
+00013100: 5c6e 7b73 656c 662e 7369 7a65 5f73 6361  \n{self.size_sca
+00013110: 6c65 7d22 0a20 2020 2020 2020 2072 6574  le}".        ret
+00013120: 7572 6e20 7369 7a65 5f73 6361 6c65 5f66  urn size_scale_f
+00013130: 6c61 675f 6c69 6e65 0a0a 2020 2020 4063  lag_line..    @c
+00013140: 6f6d 7075 7465 645f 6669 656c 640a 2020  omputed_field.  
+00013150: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+00013160: 6465 6620 5f70 6174 6368 5f61 6e64 5f67  def _patch_and_g
+00013170: 6170 5f6c 696e 6573 2873 656c 6629 202d  ap_lines(self) -
+00013180: 3e20 7374 723a 0a20 2020 2020 2020 2070  > str:.        p
+00013190: 6174 6368 5f61 6e64 5f67 6170 5f66 6c61  atch_and_gap_fla
+000131a0: 675f 6c69 6e65 203d 2066 225c 6e7b 7365  g_line = f"\n{se
+000131b0: 6c66 2e70 6174 6368 5f61 6e64 5f67 6170  lf.patch_and_gap
+000131c0: 5f66 6c61 677d 5c74 2120 7061 7463 6820  _flag}\t! patch 
+000131d0: 616e 6420 6761 7020 666c 6167 220a 2020  and gap flag".  
+000131e0: 2020 2020 2020 6966 2073 656c 662e 7061        if self.pa
+000131f0: 7463 685f 616e 645f 6761 705f 666c 6167  tch_and_gap_flag
+00013200: 203d 3d20 313a 0a20 2020 2020 2020 2020   == 1:.         
+00013210: 2020 2072 6574 7572 6e20 7061 7463 685f     return patch_
+00013220: 616e 645f 6761 705f 666c 6167 5f6c 696e  and_gap_flag_lin
+00013230: 6520 2b20 6622 5c6e 7b73 656c 662e 7061  e + f"\n{self.pa
+00013240: 7463 685f 7369 7a65 7d5c 6e7b 7365 6c66  tch_size}\n{self
+00013250: 2e67 6170 5f73 697a 657d 220a 2020 2020  .gap_size}".    
+00013260: 2020 2020 7265 7475 726e 2070 6174 6368      return patch
+00013270: 5f61 6e64 5f67 6170 5f66 6c61 675f 6c69  _and_gap_flag_li
+00013280: 6e65 0a0a 2020 2020 4063 6c61 7373 6d65  ne..    @classme
+00013290: 7468 6f64 0a20 2020 2064 6566 2066 726f  thod.    def fro
+000132a0: 6d5f 6469 6374 2863 6c73 2c20 6461 7461  m_dict(cls, data
+000132b0: 3a20 6469 6374 293a 0a20 2020 2020 2020  : dict):.       
+000132c0: 2069 6620 2269 676e 6974 696f 6e22 2069   if "ignition" i
+000132d0: 6e20 6461 7461 3a0a 2020 2020 2020 2020  n data:.        
+000132e0: 2020 2020 6461 7461 5b22 6967 6e69 7469      data["igniti
+000132f0: 6f6e 225d 203d 2073 6572 6961 6c69 7a65  on"] = serialize
+00013300: 5f69 676e 6974 696f 6e28 6461 7461 5b22  _ignition(data["
+00013310: 6967 6e69 7469 6f6e 225d 290a 2020 2020  ignition"]).    
+00013320: 2020 2020 7265 7475 726e 2063 6c73 282a      return cls(*
+00013330: 2a64 6174 6129 0a0a 2020 2020 4063 6c61  *data)..    @cla
+00013340: 7373 6d65 7468 6f64 0a20 2020 2064 6566  ssmethod.    def
+00013350: 2066 726f 6d5f 6669 6c65 2863 6c73 2c20   from_file(cls, 
+00013360: 6469 7265 6374 6f72 793a 2073 7472 207c  directory: str |
+00013370: 2050 6174 682c 202a 2a6b 7761 7267 7329   Path, **kwargs)
+00013380: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+00013390: 2020 2020 2020 496e 6974 6961 6c69 7a65        Initialize
+000133a0: 7320 6120 5155 4943 5f66 6972 6520 6f62  s a QUIC_fire ob
+000133b0: 6a65 6374 2066 726f 6d20 6120 6469 7265  ject from a dire
+000133c0: 6374 6f72 7920 636f 6e74 6169 6e69 6e67  ctory containing
+000133d0: 2061 0a20 2020 2020 2020 2051 5549 435f   a.        QUIC_
+000133e0: 4669 7265 2e69 6e70 2066 696c 652e 0a20  Fire.inp file.. 
+000133f0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00013400: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00013410: 2864 6972 6563 746f 7279 2c20 7374 7229  (directory, str)
+00013420: 3a0a 2020 2020 2020 2020 2020 2020 6469  :.            di
+00013430: 7265 6374 6f72 7920 3d20 5061 7468 2864  rectory = Path(d
+00013440: 6972 6563 746f 7279 290a 0a20 2020 2020  irectory)..     
+00013450: 2020 2076 6572 7369 6f6e 203d 205f 7661     version = _va
+00013460: 6c69 6461 7465 5f61 6e64 5f72 6574 7572  lidate_and_retur
+00013470: 6e5f 7665 7273 696f 6e28 6b77 6172 6773  n_version(kwargs
+00013480: 2e67 6574 2822 7665 7273 696f 6e22 2c20  .get("version", 
+00013490: 2222 2929 0a0a 2020 2020 2020 2020 7769  ""))..        wi
+000134a0: 7468 206f 7065 6e28 6469 7265 6374 6f72  th open(director
+000134b0: 7920 2f20 2251 5549 435f 6669 7265 2e69  y / "QUIC_fire.i
+000134c0: 6e70 222c 2022 7222 2920 6173 2066 3a0a  np", "r") as f:.
+000134d0: 2020 2020 2020 2020 2020 2020 6c69 6e65              line
+000134e0: 7320 3d20 662e 7265 6164 6c69 6e65 7328  s = f.readlines(
+000134f0: 290a 0a20 2020 2020 2020 2074 7279 3a0a  )..        try:.
+00013500: 2020 2020 2020 2020 2020 2020 2320 5265              # Re
+00013510: 6164 2066 6972 6520 666c 6167 2061 6e64  ad fire flag and
+00013520: 2072 616e 646f 6d20 7365 6564 0a20 2020   random seed.   
+00013530: 2020 2020 2020 2020 2066 6972 655f 666c           fire_fl
+00013540: 6167 203d 2069 6e74 286c 696e 6573 5b30  ag = int(lines[0
+00013550: 5d2e 7374 7269 7028 292e 7370 6c69 7428  ].strip().split(
+00013560: 295b 305d 290a 2020 2020 2020 2020 2020  )[0]).          
+00013570: 2020 7261 6e64 6f6d 5f73 6565 6420 3d20    random_seed = 
+00013580: 696e 7428 6c69 6e65 735b 315d 2e73 7472  int(lines[1].str
+00013590: 6970 2829 2e73 706c 6974 2829 5b30 5d29  ip().split()[0])
+000135a0: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+000135b0: 5265 6164 2066 6972 6520 7469 6d65 730a  Read fire times.
+000135c0: 2020 2020 2020 2020 2020 2020 7469 6d65              time
+000135d0: 5f6e 6f77 203d 2069 6e74 286c 696e 6573  _now = int(lines
+000135e0: 5b33 5d2e 7374 7269 7028 292e 7370 6c69  [3].strip().spli
+000135f0: 7428 295b 305d 290a 2020 2020 2020 2020  t()[0]).        
+00013600: 2020 2020 7369 6d5f 7469 6d65 203d 2069      sim_time = i
+00013610: 6e74 286c 696e 6573 5b34 5d2e 7374 7269  nt(lines[4].stri
+00013620: 7028 292e 7370 6c69 7428 295b 305d 290a  p().split()[0]).
+00013630: 2020 2020 2020 2020 2020 2020 6669 7265              fire
+00013640: 5f74 696d 655f 7374 6570 203d 2069 6e74  _time_step = int
+00013650: 286c 696e 6573 5b35 5d2e 7374 7269 7028  (lines[5].strip(
+00013660: 292e 7370 6c69 7428 295b 305d 290a 2020  ).split()[0]).  
+00013670: 2020 2020 2020 2020 2020 7175 6963 5f74            quic_t
+00013680: 696d 655f 7374 6570 203d 2069 6e74 286c  ime_step = int(l
+00013690: 696e 6573 5b36 5d2e 7374 7269 7028 292e  ines[6].strip().
+000136a0: 7370 6c69 7428 295b 305d 290a 2020 2020  split()[0]).    
+000136b0: 2020 2020 2020 2020 6f75 745f 7469 6d65          out_time
+000136c0: 5f66 6972 6520 3d20 696e 7428 6c69 6e65  _fire = int(line
+000136d0: 735b 375d 2e73 7472 6970 2829 2e73 706c  s[7].strip().spl
+000136e0: 6974 2829 5b30 5d29 0a20 2020 2020 2020  it()[0]).       
+000136f0: 2020 2020 206f 7574 5f74 696d 655f 7769       out_time_wi
+00013700: 6e64 203d 2069 6e74 286c 696e 6573 5b38  nd = int(lines[8
+00013710: 5d2e 7374 7269 7028 292e 7370 6c69 7428  ].strip().split(
+00013720: 295b 305d 290a 2020 2020 2020 2020 2020  )[0]).          
+00013730: 2020 6f75 745f 7469 6d65 5f65 6d69 735f    out_time_emis_
+00013740: 7261 6420 3d20 696e 7428 6c69 6e65 735b  rad = int(lines[
+00013750: 395d 2e73 7472 6970 2829 2e73 706c 6974  9].strip().split
+00013760: 2829 5b30 5d29 0a20 2020 2020 2020 2020  ()[0]).         
+00013770: 2020 206f 7574 5f74 696d 655f 7769 6e64     out_time_wind
+00013780: 5f61 7667 203d 2069 6e74 286c 696e 6573  _avg = int(lines
+00013790: 5b31 305d 2e73 7472 6970 2829 2e73 706c  [10].strip().spl
+000137a0: 6974 2829 5b30 5d29 0a0a 2020 2020 2020  it()[0])..      
+000137b0: 2020 2020 2020 2320 5265 6164 2066 6972        # Read fir
+000137c0: 6520 6772 6964 2070 6172 616d 6574 6572  e grid parameter
+000137d0: 730a 2020 2020 2020 2020 2020 2020 6e7a  s.            nz
+000137e0: 203d 2069 6e74 286c 696e 6573 5b31 325d   = int(lines[12]
+000137f0: 2e73 7472 6970 2829 2e73 706c 6974 2829  .strip().split()
+00013800: 5b30 5d29 0a20 2020 2020 2020 2020 2020  [0]).           
+00013810: 2073 7472 6574 6368 5f67 7269 645f 666c   stretch_grid_fl
+00013820: 6167 203d 2069 6e74 286c 696e 6573 5b31  ag = int(lines[1
+00013830: 335d 2e73 7472 6970 2829 2e73 706c 6974  3].strip().split
+00013840: 2829 5b30 5d29 0a20 2020 2020 2020 2020  ()[0]).         
+00013850: 2020 2064 7a5f 6172 7261 7920 3d20 5b5d     dz_array = []
+00013860: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00013870: 7374 7265 7463 685f 6772 6964 5f66 6c61  stretch_grid_fla
+00013880: 6720 3d3d 2030 3a0a 2020 2020 2020 2020  g == 0:.        
+00013890: 2020 2020 2020 2020 647a 203d 2066 6c6f          dz = flo
+000138a0: 6174 286c 696e 6573 5b31 345d 2e73 7472  at(lines[14].str
+000138b0: 6970 2829 2e73 706c 6974 2829 5b30 5d29  ip().split()[0])
+000138c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000138d0: 2063 7572 7265 6e74 5f6c 696e 6520 3d20   current_line = 
+000138e0: 3135 0a20 2020 2020 2020 2020 2020 2065  15.            e
+000138f0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00013900: 2020 2020 2066 6f72 2069 2069 6e20 7261       for i in ra
+00013910: 6e67 6528 3134 2c20 3134 202b 206c 656e  nge(14, 14 + len
+00013920: 2864 7a5f 6172 7261 7929 293a 0a20 2020  (dz_array)):.   
+00013930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013940: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
+00013950: 2020 2020 2020 2020 2020 2020 2020 666c                fl
+00013960: 6f61 7428 6c69 6e65 735b 695d 2e73 7472  oat(lines[i].str
+00013970: 6970 2829 290a 2020 2020 2020 2020 2020  ip()).          
+00013980: 2020 2020 2020 2020 2020 6578 6365 7074            except
+00013990: 2056 616c 7565 4572 726f 723a 0a20 2020   ValueError:.   
+000139a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000139b0: 2020 2020 2070 7269 6e74 280a 2020 2020       print(.    
+000139c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000139d0: 2020 2020 2020 2020 2251 5549 435f 6669          "QUIC_fi
+000139e0: 7265 2e69 6e70 3a20 647a 2069 6e70 7574  re.inp: dz input
+000139f0: 2076 616c 7565 2069 7320 6e6f 7420 6120   value is not a 
+00013a00: 666c 6f61 742e 2044 6f65 7320 7468 6520  float. Does the 
+00013a10: 6e75 6d62 6572 206f 6620 647a 2064 6174  number of dz dat
+00013a20: 6120 6d61 7463 6820 6e7a 3f22 0a20 2020  a match nz?".   
+00013a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013a40: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00013a50: 2020 2020 2020 2020 2020 2064 7a5f 6172             dz_ar
+00013a60: 7261 792e 6170 7065 6e64 2866 6c6f 6174  ray.append(float
+00013a70: 286c 696e 6573 5b69 5d2e 7374 7269 7028  (lines[i].strip(
+00013a80: 2929 290a 2020 2020 2020 2020 2020 2020  ))).            
+00013a90: 2020 2020 6375 7272 656e 745f 6c69 6e65      current_line
+00013aa0: 203d 2031 3520 2b20 6c65 6e28 647a 5f61   = 15 + len(dz_a
+00013ab0: 7272 6179 290a 0a20 2020 2020 2020 2020  rray)..         
+00013ac0: 2020 2063 7572 7265 6e74 5f6c 696e 6520     current_line 
+00013ad0: 2b3d 2034 2020 2320 736b 6970 2075 6e75  += 4  # skip unu
+00013ae0: 7365 6420 6c69 6e65 730a 0a20 2020 2020  sed lines..     
+00013af0: 2020 2020 2020 2023 2052 6561 6420 6675         # Read fu
+00013b00: 656c 2064 6174 610a 2020 2020 2020 2020  el data.        
+00013b10: 2020 2020 6375 7272 656e 745f 6c69 6e65      current_line
+00013b20: 202b 3d20 3120 2023 2073 6b69 7020 2146   += 1  # skip !F
+00013b30: 5545 4c20 6c69 6e65 0a0a 2020 2020 2020  UEL line..      
+00013b40: 2020 2020 2020 2320 5265 6164 2066 7565        # Read fue
+00013b50: 6c20 6465 6e73 6974 790a 2020 2020 2020  l density.      
+00013b60: 2020 2020 2020 6675 656c 5f64 656e 7369        fuel_densi
+00013b70: 7479 5f66 6c61 6720 3d20 696e 7428 6c69  ty_flag = int(li
+00013b80: 6e65 735b 6375 7272 656e 745f 6c69 6e65  nes[current_line
+00013b90: 5d2e 7374 7269 7028 292e 7370 6c69 7428  ].strip().split(
+00013ba0: 295b 305d 290a 2020 2020 2020 2020 2020  )[0]).          
+00013bb0: 2020 6675 656c 5f64 656e 7369 7479 203d    fuel_density =
+00013bc0: 204e 6f6e 650a 2020 2020 2020 2020 2020   None.          
+00013bd0: 2020 6966 2066 7565 6c5f 6465 6e73 6974    if fuel_densit
+00013be0: 795f 666c 6167 203d 3d20 313a 0a20 2020  y_flag == 1:.   
+00013bf0: 2020 2020 2020 2020 2020 2020 2063 7572               cur
+00013c00: 7265 6e74 5f6c 696e 6520 2b3d 2031 0a20  rent_line += 1. 
+00013c10: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00013c20: 7565 6c5f 6465 6e73 6974 7920 3d20 666c  uel_density = fl
+00013c30: 6f61 7428 6c69 6e65 735b 6375 7272 656e  oat(lines[curren
+00013c40: 745f 6c69 6e65 5d2e 7374 7269 7028 292e  t_line].strip().
+00013c50: 7370 6c69 7428 295b 305d 290a 0a20 2020  split()[0])..   
+00013c60: 2020 2020 2020 2020 2023 2052 6561 6420           # Read 
+00013c70: 6675 656c 206d 6f69 7374 7572 650a 2020  fuel moisture.  
+00013c80: 2020 2020 2020 2020 2020 6375 7272 656e            curren
+00013c90: 745f 6c69 6e65 202b 3d20 310a 2020 2020  t_line += 1.    
+00013ca0: 2020 2020 2020 2020 6675 656c 5f6d 6f69          fuel_moi
+00013cb0: 7374 7572 655f 666c 6167 203d 2069 6e74  sture_flag = int
+00013cc0: 286c 696e 6573 5b63 7572 7265 6e74 5f6c  (lines[current_l
+00013cd0: 696e 655d 2e73 7472 6970 2829 2e73 706c  ine].strip().spl
+00013ce0: 6974 2829 5b30 5d29 0a20 2020 2020 2020  it()[0]).       
+00013cf0: 2020 2020 2066 7565 6c5f 6d6f 6973 7475       fuel_moistu
+00013d00: 7265 203d 204e 6f6e 650a 2020 2020 2020  re = None.      
+00013d10: 2020 2020 2020 6966 2066 7565 6c5f 6d6f        if fuel_mo
+00013d20: 6973 7475 7265 5f66 6c61 6720 3d3d 2031  isture_flag == 1
+00013d30: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00013d40: 2020 6375 7272 656e 745f 6c69 6e65 202b    current_line +
+00013d50: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
+00013d60: 2020 2020 6675 656c 5f6d 6f69 7374 7572      fuel_moistur
+00013d70: 6520 3d20 666c 6f61 7428 6c69 6e65 735b  e = float(lines[
+00013d80: 6375 7272 656e 745f 6c69 6e65 5d2e 7374  current_line].st
+00013d90: 7269 7028 292e 7370 6c69 7428 295b 305d  rip().split()[0]
+00013da0: 290a 0a20 2020 2020 2020 2020 2020 2023  )..            #
+00013db0: 2052 6561 6420 6675 656c 2068 6569 6768   Read fuel heigh
+00013dc0: 740a 2020 2020 2020 2020 2020 2020 6675  t.            fu
+00013dd0: 656c 5f68 6569 6768 745f 666c 6167 203d  el_height_flag =
+00013de0: 2031 0a20 2020 2020 2020 2020 2020 2069   1.            i
+00013df0: 6620 6675 656c 5f64 656e 7369 7479 5f66  f fuel_density_f
+00013e00: 6c61 6720 3d3d 2031 3a0a 2020 2020 2020  lag == 1:.      
+00013e10: 2020 2020 2020 2020 2020 6375 7272 656e            curren
+00013e20: 745f 6c69 6e65 202b 3d20 310a 2020 2020  t_line += 1.    
+00013e30: 2020 2020 2020 2020 2020 2020 6675 656c              fuel
+00013e40: 5f68 6569 6768 745f 666c 6167 203d 2069  _height_flag = i
+00013e50: 6e74 286c 696e 6573 5b63 7572 7265 6e74  nt(lines[current
+00013e60: 5f6c 696e 655d 2e73 7472 6970 2829 2e73  _line].strip().s
+00013e70: 706c 6974 2829 5b30 5d29 0a20 2020 2020  plit()[0]).     
+00013e80: 2020 2020 2020 2066 7565 6c5f 6865 6967         fuel_heig
+00013e90: 6874 203d 204e 6f6e 650a 2020 2020 2020  ht = None.      
+00013ea0: 2020 2020 2020 6966 2066 7565 6c5f 6465        if fuel_de
+00013eb0: 6e73 6974 795f 666c 6167 203d 3d20 3120  nsity_flag == 1 
+00013ec0: 616e 6420 6675 656c 5f6d 6f69 7374 7572  and fuel_moistur
+00013ed0: 655f 666c 6167 203d 3d20 313a 0a20 2020  e_flag == 1:.   
+00013ee0: 2020 2020 2020 2020 2020 2020 2063 7572               cur
+00013ef0: 7265 6e74 5f6c 696e 6520 2b3d 2031 0a20  rent_line += 1. 
+00013f00: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00013f10: 7565 6c5f 6865 6967 6874 203d 2066 6c6f  uel_height = flo
+00013f20: 6174 286c 696e 6573 5b63 7572 7265 6e74  at(lines[current
+00013f30: 5f6c 696e 655d 2e73 7472 6970 2829 2e73  _line].strip().s
+00013f40: 706c 6974 2829 5b30 5d29 0a0a 2020 2020  plit()[0])..    
+00013f50: 2020 2020 2020 2020 2320 5265 6164 2073          # Read s
+00013f60: 697a 6520 7363 616c 6520 616e 6420 7061  ize scale and pa
+00013f70: 7463 682f 6761 7020 2853 7570 706f 7274  tch/gap (Support
+00013f80: 6564 2066 6f72 2076 3620 616e 6420 6162  ed for v6 and ab
+00013f90: 6f76 6529 0a20 2020 2020 2020 2020 2020  ove).           
+00013fa0: 2069 6620 7665 7273 696f 6e20 696e 2028   if version in (
+00013fb0: 2276 3622 293a 0a20 2020 2020 2020 2020  "v6"):.         
+00013fc0: 2020 2020 2020 2023 2043 6865 636b 2069         # Check i
+00013fd0: 6620 7468 6520 6e65 7874 206c 696e 6520  f the next line 
+00013fe0: 6973 2074 6865 2069 676e 6974 696f 6e20  is the ignition 
+00013ff0: 6865 6164 6572 0a20 2020 2020 2020 2020  header.         
+00014000: 2020 2020 2020 206e 6578 745f 6c69 6e65         next_line
+00014010: 203d 206c 696e 6573 5b63 7572 7265 6e74   = lines[current
+00014020: 5f6c 696e 6520 2b20 315d 2e73 7472 6970  _line + 1].strip
+00014030: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
+00014040: 2020 2069 6620 6e65 7874 5f6c 696e 652e     if next_line.
+00014050: 7374 6172 7473 7769 7468 2822 2120 4947  startswith("! IG
+00014060: 4e49 5449 4f4e 204c 4f43 4154 494f 4e53  NITION LOCATIONS
+00014070: 2229 3a0a 2020 2020 2020 2020 2020 2020  "):.            
+00014080: 2020 2020 2020 2020 2320 5472 7969 6e67          # Trying
+00014090: 2074 6f20 7265 6164 2061 2076 3520 6669   to read a v5 fi
+000140a0: 6c65 2077 6974 6820 7636 2072 6561 6465  le with v6 reade
+000140b0: 7220 736f 2074 6872 6f77 2065 7272 6f72  r so throw error
+000140c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000140d0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+000140e0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+000140f0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00014100: 496e 7661 6c69 6420 6669 6c65 2076 6572  Invalid file ver
+00014110: 7369 6f6e 2e20 5365 6c65 6374 6564 2072  sion. Selected r
+00014120: 6561 6465 7220 666f 7220 5155 4943 2d46  eader for QUIC-F
+00014130: 6972 6520 7636 2c20 6275 7420 6669 6c65  ire v6, but file
+00014140: 2069 7320 7635 2e22 0a20 2020 2020 2020   is v5.".       
+00014150: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
+00014160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014170: 2320 5265 6164 2073 697a 6520 7363 616c  # Read size scal
+00014180: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+00014190: 2020 6375 7272 656e 745f 6c69 6e65 202b    current_line +
+000141a0: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
+000141b0: 2020 2020 7369 7a65 5f73 6361 6c65 5f66      size_scale_f
+000141c0: 6c61 6720 3d20 696e 7428 6c69 6e65 735b  lag = int(lines[
+000141d0: 6375 7272 656e 745f 6c69 6e65 5d2e 7374  current_line].st
+000141e0: 7269 7028 292e 7370 6c69 7428 295b 305d  rip().split()[0]
+000141f0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00014200: 2020 7369 7a65 5f73 6361 6c65 203d 2030    size_scale = 0
+00014210: 2e30 3030 350a 2020 2020 2020 2020 2020  .0005.          
+00014220: 2020 2020 2020 6966 2073 697a 655f 7363        if size_sc
+00014230: 616c 655f 666c 6167 203d 3d20 313a 0a20  ale_flag == 1:. 
+00014240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014250: 2020 2063 7572 7265 6e74 5f6c 696e 6520     current_line 
+00014260: 2b3d 2031 0a20 2020 2020 2020 2020 2020  += 1.           
+00014270: 2020 2020 2020 2020 2073 697a 655f 7363           size_sc
+00014280: 616c 6520 3d20 666c 6f61 7428 6c69 6e65  ale = float(line
+00014290: 735b 6375 7272 656e 745f 6c69 6e65 5d2e  s[current_line].
+000142a0: 7374 7269 7028 292e 7370 6c69 7428 295b  strip().split()[
+000142b0: 305d 290a 0a20 2020 2020 2020 2020 2020  0])..           
+000142c0: 2020 2020 2023 2052 6561 6420 7061 7463       # Read patc
+000142d0: 6820 616e 6420 6761 700a 2020 2020 2020  h and gap.      
+000142e0: 2020 2020 2020 2020 2020 6375 7272 656e            curren
+000142f0: 745f 6c69 6e65 202b 3d20 310a 2020 2020  t_line += 1.    
+00014300: 2020 2020 2020 2020 2020 2020 7061 7463              patc
+00014310: 685f 616e 645f 6761 705f 666c 6167 203d  h_and_gap_flag =
+00014320: 2069 6e74 286c 696e 6573 5b63 7572 7265   int(lines[curre
+00014330: 6e74 5f6c 696e 655d 2e73 7472 6970 2829  nt_line].strip()
+00014340: 2e73 706c 6974 2829 5b30 5d29 0a20 2020  .split()[0]).   
+00014350: 2020 2020 2020 2020 2020 2020 2070 6174               pat
+00014360: 6368 5f73 697a 6520 3d20 302e 300a 2020  ch_size = 0.0.  
+00014370: 2020 2020 2020 2020 2020 2020 2020 6761                ga
+00014380: 705f 7369 7a65 203d 2030 2e30 0a20 2020  p_size = 0.0.   
+00014390: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+000143a0: 7061 7463 685f 616e 645f 6761 705f 666c  patch_and_gap_fl
+000143b0: 6167 203d 3d20 313a 0a20 2020 2020 2020  ag == 1:.       
+000143c0: 2020 2020 2020 2020 2020 2020 2063 7572               cur
+000143d0: 7265 6e74 5f6c 696e 6520 2b3d 2031 0a20  rent_line += 1. 
+000143e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000143f0: 2020 2070 6174 6368 5f73 697a 6520 3d20     patch_size = 
+00014400: 666c 6f61 7428 6c69 6e65 735b 6375 7272  float(lines[curr
+00014410: 656e 745f 6c69 6e65 5d2e 7374 7269 7028  ent_line].strip(
+00014420: 292e 7370 6c69 7428 295b 305d 290a 2020  ).split()[0]).  
+00014430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014440: 2020 6375 7272 656e 745f 6c69 6e65 202b    current_line +
+00014450: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
+00014460: 2020 2020 2020 2020 6761 705f 7369 7a65          gap_size
+00014470: 203d 2066 6c6f 6174 286c 696e 6573 5b63   = float(lines[c
+00014480: 7572 7265 6e74 5f6c 696e 655d 2e73 7472  urrent_line].str
+00014490: 6970 2829 2e73 706c 6974 2829 5b30 5d29  ip().split()[0])
+000144a0: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+000144b0: 6620 7665 7273 696f 6e20 3d3d 2022 7635  f version == "v5
+000144c0: 223a 0a20 2020 2020 2020 2020 2020 2020  ":.             
+000144d0: 2020 2023 2054 6865 206e 6578 7420 6c69     # The next li
+000144e0: 6e65 2073 686f 756c 6420 6265 2074 6865  ne should be the
+000144f0: 2069 676e 6974 696f 6e20 6865 6164 6572   ignition header
+00014500: 2e20 4966 2069 7420 6973 206e 6f74 2c20  . If it is not, 
+00014510: 7468 656e 0a20 2020 2020 2020 2020 2020  then.           
+00014520: 2020 2020 2023 2074 6865 2066 696c 6520       # the file 
+00014530: 6973 206e 6f74 2061 2076 3520 6669 6c65  is not a v5 file
+00014540: 2c20 616e 6420 7765 2073 686f 756c 6420  , and we should 
+00014550: 7468 726f 7720 616e 2065 7272 6f72 2e0a  throw an error..
+00014560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014570: 6e65 7874 5f6c 696e 6520 3d20 6c69 6e65  next_line = line
+00014580: 735b 6375 7272 656e 745f 6c69 6e65 202b  s[current_line +
+00014590: 2031 5d2e 7374 7269 7028 290a 2020 2020   1].strip().    
+000145a0: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+000145b0: 6f74 206e 6578 745f 6c69 6e65 2e73 7461  ot next_line.sta
+000145c0: 7274 7377 6974 6828 2221 2049 474e 4954  rtswith("! IGNIT
+000145d0: 494f 4e20 4c4f 4341 5449 4f4e 5322 293a  ION LOCATIONS"):
+000145e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000145f0: 2020 2020 2023 2054 7279 696e 6720 746f       # Trying to
+00014600: 2072 6561 6420 6120 7636 2066 696c 6520   read a v6 file 
+00014610: 7769 7468 2076 3520 7265 6164 6572 2073  with v5 reader s
+00014620: 6f20 7468 726f 7720 6572 726f 720a 2020  o throw error.  
+00014630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014640: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00014650: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+00014660: 2020 2020 2020 2020 2020 2020 2249 6e76              "Inv
+00014670: 616c 6964 2066 696c 6520 7665 7273 696f  alid file versio
+00014680: 6e2e 2053 656c 6563 7465 6420 7265 6164  n. Selected read
+00014690: 6572 2066 6f72 2051 5549 432d 4669 7265  er for QUIC-Fire
+000146a0: 2076 352c 2062 7574 2066 696c 6520 6973   v5, but file is
+000146b0: 2076 362e 220a 2020 2020 2020 2020 2020   v6.".          
+000146c0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+000146d0: 2020 2020 2020 2020 2020 2020 2023 2053               # S
+000146e0: 6574 2073 697a 6520 7363 616c 6520 616e  et size scale an
+000146f0: 6420 7061 7463 6820 616e 6420 6761 7020  d patch and gap 
+00014700: 746f 2064 6566 6175 6c74 730a 2020 2020  to defaults.    
+00014710: 2020 2020 2020 2020 2020 2020 7369 7a65              size
+00014720: 5f73 6361 6c65 5f66 6c61 6720 3d20 300a  _scale_flag = 0.
+00014730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014740: 7369 7a65 5f73 6361 6c65 203d 2030 2e30  size_scale = 0.0
+00014750: 3030 350a 2020 2020 2020 2020 2020 2020  005.            
+00014760: 2020 2020 7061 7463 685f 616e 645f 6761      patch_and_ga
+00014770: 705f 666c 6167 203d 2030 0a20 2020 2020  p_flag = 0.     
+00014780: 2020 2020 2020 2020 2020 2070 6174 6368             patch
+00014790: 5f73 697a 6520 3d20 302e 300a 2020 2020  _size = 0.0.    
+000147a0: 2020 2020 2020 2020 2020 2020 6761 705f              gap_
+000147b0: 7369 7a65 203d 2030 2e30 0a20 2020 2020  size = 0.0.     
+000147c0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+000147d0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+000147e0: 7365 2056 616c 7565 4572 726f 7228 6622  se ValueError(f"
+000147f0: 556e 7375 7070 6f72 7465 6420 7665 7273  Unsupported vers
+00014800: 696f 6e3a 207b 7665 7273 696f 6e7d 2229  ion: {version}")
+00014810: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+00014820: 5265 6164 2069 676e 6974 696f 6e20 6461  Read ignition da
+00014830: 7461 0a20 2020 2020 2020 2020 2020 2063  ta.            c
+00014840: 7572 7265 6e74 5f6c 696e 6520 2b3d 2032  urrent_line += 2
+00014850: 2020 2320 736b 6970 2021 2049 474e 4954    # skip ! IGNIT
+00014860: 494f 4e20 4c4f 4341 5449 4f4e 5320 6865  ION LOCATIONS he
+00014870: 6164 6572 0a20 2020 2020 2020 2020 2020  ader.           
+00014880: 2069 676e 6974 696f 6e5f 666c 6167 203d   ignition_flag =
+00014890: 2069 6e74 286c 696e 6573 5b63 7572 7265   int(lines[curre
+000148a0: 6e74 5f6c 696e 655d 2e73 7472 6970 2829  nt_line].strip()
+000148b0: 2e73 706c 6974 2829 5b30 5d29 0a20 2020  .split()[0]).   
+000148c0: 2020 2020 2020 2020 2061 6464 5f6c 696e           add_lin
+000148d0: 6573 203d 207b 313a 2034 2c20 323a 2036  es = {1: 4, 2: 6
+000148e0: 2c20 333a 2035 2c20 343a 2030 2c20 353a  , 3: 5, 4: 0, 5:
+000148f0: 2030 2c20 363a 2030 2c20 373a 2030 7d0a   0, 6: 0, 7: 0}.
+00014900: 2020 2020 2020 2020 2020 2020 6164 6420              add 
+00014910: 3d20 6164 645f 6c69 6e65 732e 6765 7428  = add_lines.get(
+00014920: 6967 6e69 7469 6f6e 5f66 6c61 6729 0a20  ignition_flag). 
+00014930: 2020 2020 2020 2020 2020 2069 676e 6974             ignit
+00014940: 696f 6e5f 7061 7261 6d73 203d 205b 5d0a  ion_params = [].
+00014950: 2020 2020 2020 2020 2020 2020 6375 7272              curr
+00014960: 656e 745f 6c69 6e65 202b 3d20 310a 2020  ent_line += 1.  
+00014970: 2020 2020 2020 2020 2020 666f 7220 6920            for i 
+00014980: 696e 2072 616e 6765 2863 7572 7265 6e74  in range(current
+00014990: 5f6c 696e 652c 2063 7572 7265 6e74 5f6c  _line, current_l
+000149a0: 696e 6520 2b20 6164 6429 3a0a 2020 2020  ine + add):.    
+000149b0: 2020 2020 2020 2020 2020 2020 6967 6e69              igni
+000149c0: 7469 6f6e 5f6c 696e 6520 3d20 666c 6f61  tion_line = floa
+000149d0: 7428 6c69 6e65 735b 695d 2e73 706c 6974  t(lines[i].split
+000149e0: 2829 5b30 5d2e 7374 7269 7028 2929 0a20  ()[0].strip()). 
+000149f0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00014a00: 676e 6974 696f 6e5f 7061 7261 6d73 2e61  gnition_params.a
+00014a10: 7070 656e 6428 6967 6e69 7469 6f6e 5f6c  ppend(ignition_l
+00014a20: 696e 6529 0a20 2020 2020 2020 2020 2020  ine).           
+00014a30: 2069 6620 6967 6e69 7469 6f6e 5f66 6c61   if ignition_fla
+00014a40: 6720 3d3d 2031 3a0a 2020 2020 2020 2020  g == 1:.        
+00014a50: 2020 2020 2020 2020 785f 6d69 6e2c 2079          x_min, y
+00014a60: 5f6d 696e 2c20 785f 6c65 6e67 7468 2c20  _min, x_length, 
+00014a70: 795f 6c65 6e67 7468 203d 2069 676e 6974  y_length = ignit
+00014a80: 696f 6e5f 7061 7261 6d73 0a20 2020 2020  ion_params.     
+00014a90: 2020 2020 2020 2020 2020 2069 676e 6974             ignit
+00014aa0: 696f 6e20 3d20 5265 6374 616e 676c 6549  ion = RectangleI
+00014ab0: 676e 6974 696f 6e28 0a20 2020 2020 2020  gnition(.       
+00014ac0: 2020 2020 2020 2020 2020 2020 2078 5f6d               x_m
+00014ad0: 696e 3d78 5f6d 696e 2c20 795f 6d69 6e3d  in=x_min, y_min=
+00014ae0: 795f 6d69 6e2c 2078 5f6c 656e 6774 683d  y_min, x_length=
+00014af0: 785f 6c65 6e67 7468 2c20 795f 6c65 6e67  x_length, y_leng
+00014b00: 7468 3d79 5f6c 656e 6774 680a 2020 2020  th=y_length.    
+00014b10: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00014b20: 2020 2020 2020 2020 2020 656c 6966 2069            elif i
+00014b30: 676e 6974 696f 6e5f 666c 6167 203d 3d20  gnition_flag == 
+00014b40: 323a 0a20 2020 2020 2020 2020 2020 2020  2:.             
+00014b50: 2020 2078 5f6d 696e 2c20 795f 6d69 6e2c     x_min, y_min,
+00014b60: 2078 5f6c 656e 6774 682c 2079 5f6c 656e   x_length, y_len
+00014b70: 6774 682c 2078 5f77 6964 7468 2c20 795f  gth, x_width, y_
+00014b80: 7769 6474 6820 3d20 6967 6e69 7469 6f6e  width = ignition
+00014b90: 5f70 6172 616d 730a 2020 2020 2020 2020  _params.        
+00014ba0: 2020 2020 2020 2020 6967 6e69 7469 6f6e          ignition
+00014bb0: 203d 2053 7175 6172 6552 696e 6749 676e   = SquareRingIgn
+00014bc0: 6974 696f 6e28 0a20 2020 2020 2020 2020  ition(.         
+00014bd0: 2020 2020 2020 2020 2020 2078 5f6d 696e             x_min
+00014be0: 3d78 5f6d 696e 2c0a 2020 2020 2020 2020  =x_min,.        
+00014bf0: 2020 2020 2020 2020 2020 2020 795f 6d69              y_mi
+00014c00: 6e3d 795f 6d69 6e2c 0a20 2020 2020 2020  n=y_min,.       
+00014c10: 2020 2020 2020 2020 2020 2020 2078 5f6c               x_l
+00014c20: 656e 6774 683d 785f 6c65 6e67 7468 2c0a  ength=x_length,.
+00014c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014c40: 2020 2020 795f 6c65 6e67 7468 3d79 5f6c      y_length=y_l
+00014c50: 656e 6774 682c 0a20 2020 2020 2020 2020  ength,.         
+00014c60: 2020 2020 2020 2020 2020 2078 5f77 6964             x_wid
+00014c70: 7468 3d78 5f77 6964 7468 2c0a 2020 2020  th=x_width,.    
+00014c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014c90: 795f 7769 6474 683d 795f 7769 6474 682c  y_width=y_width,
+00014ca0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014cb0: 2029 0a20 2020 2020 2020 2020 2020 2065   ).            e
+00014cc0: 6c69 6620 6967 6e69 7469 6f6e 5f66 6c61  lif ignition_fla
+00014cd0: 6720 3d3d 2033 3a0a 2020 2020 2020 2020  g == 3:.        
+00014ce0: 2020 2020 2020 2020 785f 6d69 6e2c 2079          x_min, y
+00014cf0: 5f6d 696e 2c20 785f 6c65 6e67 7468 2c20  _min, x_length, 
+00014d00: 795f 6c65 6e67 7468 2c20 7269 6e67 5f77  y_length, ring_w
+00014d10: 6964 7468 203d 2069 676e 6974 696f 6e5f  idth = ignition_
+00014d20: 7061 7261 6d73 0a20 2020 2020 2020 2020  params.         
+00014d30: 2020 2020 2020 2069 676e 6974 696f 6e20         ignition 
+00014d40: 3d20 4369 7263 756c 6172 5269 6e67 4967  = CircularRingIg
+00014d50: 6e69 7469 6f6e 280a 2020 2020 2020 2020  nition(.        
+00014d60: 2020 2020 2020 2020 2020 2020 785f 6d69              x_mi
+00014d70: 6e3d 785f 6d69 6e2c 0a20 2020 2020 2020  n=x_min,.       
+00014d80: 2020 2020 2020 2020 2020 2020 2079 5f6d               y_m
+00014d90: 696e 3d79 5f6d 696e 2c0a 2020 2020 2020  in=y_min,.      
+00014da0: 2020 2020 2020 2020 2020 2020 2020 785f                x_
+00014db0: 6c65 6e67 7468 3d78 5f6c 656e 6774 682c  length=x_length,
+00014dc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014dd0: 2020 2020 2079 5f6c 656e 6774 683d 795f       y_length=y_
+00014de0: 6c65 6e67 7468 2c0a 2020 2020 2020 2020  length,.        
+00014df0: 2020 2020 2020 2020 2020 2020 7269 6e67              ring
+00014e00: 5f77 6964 7468 3d72 696e 675f 7769 6474  _width=ring_widt
+00014e10: 682c 0a20 2020 2020 2020 2020 2020 2020  h,.             
+00014e20: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00014e30: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00014e40: 2020 2020 2020 2069 676e 6974 696f 6e20         ignition 
+00014e50: 3d20 4967 6e69 7469 6f6e 2869 676e 6974  = Ignition(ignit
+00014e60: 696f 6e5f 666c 6167 3d69 676e 6974 696f  ion_flag=ignitio
+00014e70: 6e5f 666c 6167 290a 0a20 2020 2020 2020  n_flag)..       
+00014e80: 2020 2020 2063 7572 7265 6e74 5f6c 696e       current_lin
+00014e90: 6520 2b3d 2061 6464 0a20 2020 2020 2020  e += add.       
+00014ea0: 2020 2020 2069 676e 6974 696f 6e73 5f70       ignitions_p
+00014eb0: 6572 5f63 656c 6c20 3d20 696e 7428 6c69  er_cell = int(li
+00014ec0: 6e65 735b 6375 7272 656e 745f 6c69 6e65  nes[current_line
+00014ed0: 5d2e 7374 7269 7028 292e 7370 6c69 7428  ].strip().split(
+00014ee0: 295b 305d 290a 2020 2020 2020 2020 2020  )[0]).          
+00014ef0: 2020 6375 7272 656e 745f 6c69 6e65 202b    current_line +
+00014f00: 3d20 310a 0a20 2020 2020 2020 2020 2020  = 1..           
+00014f10: 2023 2052 6561 6420 6669 7265 6272 616e   # Read firebran
+00014f20: 6473 0a20 2020 2020 2020 2020 2020 2023  ds.            #
+00014f30: 2063 7572 7265 6e74 5f6c 696e 6520 3d20   current_line = 
+00014f40: 2120 4649 5245 4252 414e 4453 0a20 2020  ! FIREBRANDS.   
+00014f50: 2020 2020 2020 2020 2063 7572 7265 6e74           current
+00014f60: 5f6c 696e 6520 2b3d 2031 2020 2320 6865  _line += 1  # he
+00014f70: 6164 6572 0a20 2020 2020 2020 2020 2020  ader.           
+00014f80: 2066 6972 6562 7261 6e64 5f66 6c61 6720   firebrand_flag 
+00014f90: 3d20 696e 7428 6c69 6e65 735b 6375 7272  = int(lines[curr
+00014fa0: 656e 745f 6c69 6e65 5d2e 7374 7269 7028  ent_line].strip(
+00014fb0: 292e 7370 6c69 7428 295b 305d 290a 2020  ).split()[0]).  
+00014fc0: 2020 2020 2020 2020 2020 6375 7272 656e            curren
+00014fd0: 745f 6c69 6e65 202b 3d20 310a 0a20 2020  t_line += 1..   
+00014fe0: 2020 2020 2020 2020 2023 2052 6561 6420           # Read 
+00014ff0: 6f75 7470 7574 2066 6c61 6773 0a20 2020  output flags.   
+00015000: 2020 2020 2020 2020 2023 2063 7572 7265           # curre
+00015010: 6e74 5f6c 696e 6520 3d20 214f 5554 5055  nt_line = !OUTPU
+00015020: 545f 4649 4c45 530a 2020 2020 2020 2020  T_FILES.        
+00015030: 2020 2020 656e 675f 746f 5f61 746d 5f6f      eng_to_atm_o
+00015040: 7574 203d 2069 6e74 286c 696e 6573 5b63  ut = int(lines[c
+00015050: 7572 7265 6e74 5f6c 696e 6520 2b20 315d  urrent_line + 1]
+00015060: 2e73 7472 6970 2829 2e73 706c 6974 2829  .strip().split()
+00015070: 5b30 5d29 0a20 2020 2020 2020 2020 2020  [0]).           
+00015080: 2072 6561 6374 5f72 6174 655f 6f75 7420   react_rate_out 
+00015090: 3d20 696e 7428 6c69 6e65 735b 6375 7272  = int(lines[curr
+000150a0: 656e 745f 6c69 6e65 202b 2032 5d2e 7374  ent_line + 2].st
+000150b0: 7269 7028 292e 7370 6c69 7428 295b 305d  rip().split()[0]
+000150c0: 290a 2020 2020 2020 2020 2020 2020 6675  ).            fu
+000150d0: 656c 5f64 656e 735f 6f75 7420 3d20 696e  el_dens_out = in
+000150e0: 7428 6c69 6e65 735b 6375 7272 656e 745f  t(lines[current_
+000150f0: 6c69 6e65 202b 2033 5d2e 7374 7269 7028  line + 3].strip(
+00015100: 292e 7370 6c69 7428 295b 305d 290a 2020  ).split()[0]).  
+00015110: 2020 2020 2020 2020 2020 7166 5f77 696e            qf_win
+00015120: 645f 6f75 7420 3d20 696e 7428 6c69 6e65  d_out = int(line
+00015130: 735b 6375 7272 656e 745f 6c69 6e65 202b  s[current_line +
+00015140: 2034 5d2e 7374 7269 7028 292e 7370 6c69   4].strip().spli
+00015150: 7428 295b 305d 290a 2020 2020 2020 2020  t()[0]).        
+00015160: 2020 2020 7175 5f77 696e 645f 696e 7374      qu_wind_inst
+00015170: 5f6f 7574 203d 2069 6e74 286c 696e 6573  _out = int(lines
+00015180: 5b63 7572 7265 6e74 5f6c 696e 6520 2b20  [current_line + 
+00015190: 355d 2e73 7472 6970 2829 2e73 706c 6974  5].strip().split
+000151a0: 2829 5b30 5d29 0a20 2020 2020 2020 2020  ()[0]).         
+000151b0: 2020 2071 755f 7769 6e64 5f61 7667 5f6f     qu_wind_avg_o
+000151c0: 7574 203d 2069 6e74 286c 696e 6573 5b63  ut = int(lines[c
+000151d0: 7572 7265 6e74 5f6c 696e 6520 2b20 365d  urrent_line + 6]
+000151e0: 2e73 7472 6970 2829 2e73 706c 6974 2829  .strip().split()
+000151f0: 5b30 5d29 0a20 2020 2020 2020 2020 2020  [0]).           
+00015200: 2023 2021 204f 7574 7075 7420 706c 756d   # ! Output plum
+00015210: 6520 7472 616a 6563 746f 7269 6573 0a20  e trajectories. 
+00015220: 2020 2020 2020 2020 2020 2066 7565 6c5f             fuel_
+00015230: 6d6f 6973 745f 6f75 7420 3d20 696e 7428  moist_out = int(
+00015240: 6c69 6e65 735b 6375 7272 656e 745f 6c69  lines[current_li
+00015250: 6e65 202b 2038 5d2e 7374 7269 7028 292e  ne + 8].strip().
+00015260: 7370 6c69 7428 295b 305d 290a 2020 2020  split()[0]).    
+00015270: 2020 2020 2020 2020 6d61 7373 5f62 7572          mass_bur
+00015280: 6e74 5f6f 7574 203d 2069 6e74 286c 696e  nt_out = int(lin
+00015290: 6573 5b63 7572 7265 6e74 5f6c 696e 6520  es[current_line 
+000152a0: 2b20 395d 2e73 7472 6970 2829 2e73 706c  + 9].strip().spl
+000152b0: 6974 2829 5b30 5d29 0a20 2020 2020 2020  it()[0]).       
+000152c0: 2020 2020 2066 6972 6562 7261 6e64 5f6f       firebrand_o
+000152d0: 7574 203d 2069 6e74 286c 696e 6573 5b63  ut = int(lines[c
+000152e0: 7572 7265 6e74 5f6c 696e 6520 2b20 3130  urrent_line + 10
+000152f0: 5d2e 7374 7269 7028 292e 7370 6c69 7428  ].strip().split(
+00015300: 295b 305d 290a 2020 2020 2020 2020 2020  )[0]).          
+00015310: 2020 656d 6973 7369 6f6e 735f 6f75 7420    emissions_out 
+00015320: 3d20 696e 7428 6c69 6e65 735b 6375 7272  = int(lines[curr
+00015330: 656e 745f 6c69 6e65 202b 2031 315d 2e73  ent_line + 11].s
+00015340: 7472 6970 2829 2e73 706c 6974 2829 5b30  trip().split()[0
+00015350: 5d29 0a20 2020 2020 2020 2020 2020 2072  ]).            r
+00015360: 6164 6961 7469 6f6e 5f6f 7574 203d 2069  adiation_out = i
+00015370: 6e74 286c 696e 6573 5b63 7572 7265 6e74  nt(lines[current
+00015380: 5f6c 696e 6520 2b20 3132 5d2e 7374 7269  _line + 12].stri
+00015390: 7028 292e 7370 6c69 7428 295b 305d 290a  p().split()[0]).
+000153a0: 2020 2020 2020 2020 2020 2020 696e 7465              inte
+000153b0: 6e73 6974 795f 6f75 7420 3d20 696e 7428  nsity_out = int(
+000153c0: 6c69 6e65 735b 6375 7272 656e 745f 6c69  lines[current_li
+000153d0: 6e65 202b 2031 335d 2e73 7472 6970 2829  ne + 13].strip()
+000153e0: 2e73 706c 6974 2829 5b30 5d29 0a20 2020  .split()[0]).   
+000153f0: 2020 2020 2020 2020 2023 2021 2041 5554           # ! AUT
+00015400: 4f4b 494c 4c0a 2020 2020 2020 2020 2020  OKILL.          
+00015410: 2020 6175 746f 5f6b 696c 6c20 3d20 696e    auto_kill = in
+00015420: 7428 6c69 6e65 735b 6375 7272 656e 745f  t(lines[current_
+00015430: 6c69 6e65 202b 2031 355d 2e73 7472 6970  line + 15].strip
+00015440: 2829 2e73 706c 6974 2829 5b30 5d29 0a0a  ().split()[0])..
+00015450: 2020 2020 2020 2020 6578 6365 7074 2049          except I
+00015460: 6e64 6578 4572 726f 723a 0a20 2020 2020  ndexError:.     
+00015470: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+00015480: 7565 4572 726f 7228 0a20 2020 2020 2020  ueError(.       
+00015490: 2020 2020 2020 2020 2066 2245 7272 6f72           f"Error
+000154a0: 2070 6172 7369 6e67 207b 636c 732e 5f5f   parsing {cls.__
+000154b0: 6e61 6d65 5f5f 7d20 6672 6f6d 2066 696c  name__} from fil
+000154c0: 653a 2051 5549 435f 6669 7265 2e69 6e70  e: QUIC_fire.inp
+000154d0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+000154e0: 2020 6622 5c6e 506c 6561 7365 2063 6865    f"\nPlease che
+000154f0: 636b 2074 6865 2066 696c 6520 666f 7220  ck the file for 
+00015500: 636f 7272 6563 746e 6573 732e 220a 2020  correctness.".  
+00015510: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+00015520: 2020 2020 2072 6574 7572 6e20 636c 7328       return cls(
+00015530: 0a20 2020 2020 2020 2020 2020 2066 6972  .            fir
+00015540: 655f 666c 6167 3d66 6972 655f 666c 6167  e_flag=fire_flag
+00015550: 2c0a 2020 2020 2020 2020 2020 2020 7261  ,.            ra
+00015560: 6e64 6f6d 5f73 6565 643d 7261 6e64 6f6d  ndom_seed=random
+00015570: 5f73 6565 642c 0a20 2020 2020 2020 2020  _seed,.         
+00015580: 2020 2074 696d 655f 6e6f 773d 7469 6d65     time_now=time
+00015590: 5f6e 6f77 2c0a 2020 2020 2020 2020 2020  _now,.          
+000155a0: 2020 7369 6d5f 7469 6d65 3d73 696d 5f74    sim_time=sim_t
+000155b0: 696d 652c 0a20 2020 2020 2020 2020 2020  ime,.           
+000155c0: 2066 6972 655f 7469 6d65 5f73 7465 703d   fire_time_step=
+000155d0: 6669 7265 5f74 696d 655f 7374 6570 2c0a  fire_time_step,.
+000155e0: 2020 2020 2020 2020 2020 2020 7175 6963              quic
+000155f0: 5f74 696d 655f 7374 6570 3d71 7569 635f  _time_step=quic_
+00015600: 7469 6d65 5f73 7465 702c 0a20 2020 2020  time_step,.     
+00015610: 2020 2020 2020 206f 7574 5f74 696d 655f         out_time_
+00015620: 6669 7265 3d6f 7574 5f74 696d 655f 6669  fire=out_time_fi
+00015630: 7265 2c0a 2020 2020 2020 2020 2020 2020  re,.            
+00015640: 6f75 745f 7469 6d65 5f77 696e 643d 6f75  out_time_wind=ou
+00015650: 745f 7469 6d65 5f77 696e 642c 0a20 2020  t_time_wind,.   
+00015660: 2020 2020 2020 2020 206f 7574 5f74 696d           out_tim
+00015670: 655f 656d 6973 5f72 6164 3d6f 7574 5f74  e_emis_rad=out_t
+00015680: 696d 655f 656d 6973 5f72 6164 2c0a 2020  ime_emis_rad,.  
+00015690: 2020 2020 2020 2020 2020 6f75 745f 7469            out_ti
+000156a0: 6d65 5f77 696e 645f 6176 673d 6f75 745f  me_wind_avg=out_
+000156b0: 7469 6d65 5f77 696e 645f 6176 672c 0a20  time_wind_avg,. 
+000156c0: 2020 2020 2020 2020 2020 206e 7a3d 6e7a             nz=nz
+000156d0: 2c0a 2020 2020 2020 2020 2020 2020 7374  ,.            st
+000156e0: 7265 7463 685f 6772 6964 5f66 6c61 673d  retch_grid_flag=
+000156f0: 7374 7265 7463 685f 6772 6964 5f66 6c61  stretch_grid_fla
+00015700: 672c 0a20 2020 2020 2020 2020 2020 2064  g,.            d
+00015710: 7a3d 647a 2c0a 2020 2020 2020 2020 2020  z=dz,.          
+00015720: 2020 647a 5f61 7272 6179 3d64 7a5f 6172    dz_array=dz_ar
+00015730: 7261 792c 0a20 2020 2020 2020 2020 2020  ray,.           
+00015740: 2066 7565 6c5f 6465 6e73 6974 795f 666c   fuel_density_fl
+00015750: 6167 3d66 7565 6c5f 6465 6e73 6974 795f  ag=fuel_density_
+00015760: 666c 6167 2c0a 2020 2020 2020 2020 2020  flag,.          
+00015770: 2020 6675 656c 5f64 656e 7369 7479 3d66    fuel_density=f
+00015780: 7565 6c5f 6465 6e73 6974 792c 0a20 2020  uel_density,.   
+00015790: 2020 2020 2020 2020 2066 7565 6c5f 6d6f           fuel_mo
+000157a0: 6973 7475 7265 5f66 6c61 673d 6675 656c  isture_flag=fuel
+000157b0: 5f6d 6f69 7374 7572 655f 666c 6167 2c0a  _moisture_flag,.
+000157c0: 2020 2020 2020 2020 2020 2020 6675 656c              fuel
+000157d0: 5f6d 6f69 7374 7572 653d 6675 656c 5f6d  _moisture=fuel_m
+000157e0: 6f69 7374 7572 652c 0a20 2020 2020 2020  oisture,.       
+000157f0: 2020 2020 2066 7565 6c5f 6865 6967 6874       fuel_height
+00015800: 5f66 6c61 673d 6675 656c 5f68 6569 6768  _flag=fuel_heigh
+00015810: 745f 666c 6167 2c0a 2020 2020 2020 2020  t_flag,.        
+00015820: 2020 2020 6675 656c 5f68 6569 6768 743d      fuel_height=
+00015830: 6675 656c 5f68 6569 6768 742c 0a20 2020  fuel_height,.   
+00015840: 2020 2020 2020 2020 2073 697a 655f 7363           size_sc
+00015850: 616c 655f 666c 6167 3d73 697a 655f 7363  ale_flag=size_sc
+00015860: 616c 655f 666c 6167 2c0a 2020 2020 2020  ale_flag,.      
+00015870: 2020 2020 2020 7369 7a65 5f73 6361 6c65        size_scale
+00015880: 3d73 697a 655f 7363 616c 652c 0a20 2020  =size_scale,.   
+00015890: 2020 2020 2020 2020 2070 6174 6368 5f61           patch_a
+000158a0: 6e64 5f67 6170 5f66 6c61 673d 7061 7463  nd_gap_flag=patc
+000158b0: 685f 616e 645f 6761 705f 666c 6167 2c0a  h_and_gap_flag,.
+000158c0: 2020 2020 2020 2020 2020 2020 7061 7463              patc
+000158d0: 685f 7369 7a65 3d70 6174 6368 5f73 697a  h_size=patch_siz
+000158e0: 652c 0a20 2020 2020 2020 2020 2020 2067  e,.            g
+000158f0: 6170 5f73 697a 653d 6761 705f 7369 7a65  ap_size=gap_size
+00015900: 2c0a 2020 2020 2020 2020 2020 2020 6967  ,.            ig
+00015910: 6e69 7469 6f6e 3d69 676e 6974 696f 6e2c  nition=ignition,
+00015920: 0a20 2020 2020 2020 2020 2020 2069 676e  .            ign
+00015930: 6974 696f 6e73 5f70 6572 5f63 656c 6c3d  itions_per_cell=
+00015940: 6967 6e69 7469 6f6e 735f 7065 725f 6365  ignitions_per_ce
+00015950: 6c6c 2c0a 2020 2020 2020 2020 2020 2020  ll,.            
+00015960: 6669 7265 6272 616e 645f 666c 6167 3d66  firebrand_flag=f
+00015970: 6972 6562 7261 6e64 5f66 6c61 672c 0a20  irebrand_flag,. 
+00015980: 2020 2020 2020 2020 2020 2065 6e67 5f74             eng_t
+00015990: 6f5f 6174 6d5f 6f75 743d 656e 675f 746f  o_atm_out=eng_to
+000159a0: 5f61 746d 5f6f 7574 2c0a 2020 2020 2020  _atm_out,.      
+000159b0: 2020 2020 2020 7265 6163 745f 7261 7465        react_rate
+000159c0: 5f6f 7574 3d72 6561 6374 5f72 6174 655f  _out=react_rate_
+000159d0: 6f75 742c 0a20 2020 2020 2020 2020 2020  out,.           
+000159e0: 2066 7565 6c5f 6465 6e73 5f6f 7574 3d66   fuel_dens_out=f
+000159f0: 7565 6c5f 6465 6e73 5f6f 7574 2c0a 2020  uel_dens_out,.  
+00015a00: 2020 2020 2020 2020 2020 7166 5f77 696e            qf_win
+00015a10: 645f 6f75 743d 7166 5f77 696e 645f 6f75  d_out=qf_wind_ou
+00015a20: 742c 0a20 2020 2020 2020 2020 2020 2071  t,.            q
+00015a30: 755f 7769 6e64 5f69 6e73 745f 6f75 743d  u_wind_inst_out=
+00015a40: 7175 5f77 696e 645f 696e 7374 5f6f 7574  qu_wind_inst_out
+00015a50: 2c0a 2020 2020 2020 2020 2020 2020 7175  ,.            qu
+00015a60: 5f77 696e 645f 6176 675f 6f75 743d 7175  _wind_avg_out=qu
+00015a70: 5f77 696e 645f 6176 675f 6f75 742c 0a20  _wind_avg_out,. 
+00015a80: 2020 2020 2020 2020 2020 2066 7565 6c5f             fuel_
+00015a90: 6d6f 6973 745f 6f75 743d 6675 656c 5f6d  moist_out=fuel_m
+00015aa0: 6f69 7374 5f6f 7574 2c0a 2020 2020 2020  oist_out,.      
+00015ab0: 2020 2020 2020 6d61 7373 5f62 7572 6e74        mass_burnt
+00015ac0: 5f6f 7574 3d6d 6173 735f 6275 726e 745f  _out=mass_burnt_
+00015ad0: 6f75 742c 0a20 2020 2020 2020 2020 2020  out,.           
+00015ae0: 2066 6972 6562 7261 6e64 5f6f 7574 3d66   firebrand_out=f
+00015af0: 6972 6562 7261 6e64 5f6f 7574 2c0a 2020  irebrand_out,.  
+00015b00: 2020 2020 2020 2020 2020 656d 6973 7369            emissi
+00015b10: 6f6e 735f 6f75 743d 656d 6973 7369 6f6e  ons_out=emission
+00015b20: 735f 6f75 742c 0a20 2020 2020 2020 2020  s_out,.         
+00015b30: 2020 2072 6164 6961 7469 6f6e 5f6f 7574     radiation_out
+00015b40: 3d72 6164 6961 7469 6f6e 5f6f 7574 2c0a  =radiation_out,.
+00015b50: 2020 2020 2020 2020 2020 2020 696e 7465              inte
+00015b60: 6e73 6974 795f 6f75 743d 696e 7465 6e73  nsity_out=intens
+00015b70: 6974 795f 6f75 742c 0a20 2020 2020 2020  ity_out,.       
+00015b80: 2020 2020 2061 7574 6f5f 6b69 6c6c 3d61       auto_kill=a
+00015b90: 7574 6f5f 6b69 6c6c 2c0a 2020 2020 2020  uto_kill,.      
+00015ba0: 2020 290a 0a0a 636c 6173 7320 5146 6972    )...class QFir
+00015bb0: 655f 426c 6467 5f41 6476 616e 6365 645f  e_Bldg_Advanced_
+00015bc0: 5573 6572 5f49 6e70 7574 7328 496e 7075  User_Inputs(Inpu
+00015bd0: 7446 696c 6529 3a0a 2020 2020 2222 220a  tFile):.    """.
+00015be0: 2020 2020 436c 6173 7320 7265 7072 6573      Class repres
+00015bf0: 656e 7469 6e67 2074 6865 2051 4669 7265  enting the QFire
+00015c00: 5f42 6c64 675f 4164 7661 6e63 6564 5f55  _Bldg_Advanced_U
+00015c10: 7365 725f 496e 7075 7473 2e69 6e70 2069  ser_Inputs.inp i
+00015c20: 6e70 7574 2066 696c 652e 2054 6869 730a  nput file. This.
+00015c30: 2020 2020 6669 6c65 2063 6f6e 7461 696e      file contain
+00015c40: 7320 6164 7661 6e63 6564 2070 6172 616d  s advanced param
+00015c50: 6574 6572 7320 7265 6c61 7465 6420 746f  eters related to
+00015c60: 2062 7569 6c64 696e 6773 2061 6e64 2066   buildings and f
+00015c70: 7565 6c2e 0a0a 2020 2020 4174 7472 6962  uel...    Attrib
+00015c80: 7574 6573 0a20 2020 202d 2d2d 2d2d 2d2d  utes.    -------
+00015c90: 2d2d 2d0a 2020 2020 636f 6e76 6572 745f  ---.    convert_
+00015ca0: 6275 696c 6469 6e67 735f 746f 5f66 7565  buildings_to_fue
+00015cb0: 6c5f 666c 6167 203a 2069 6e74 0a20 2020  l_flag : int.   
+00015cc0: 2020 2020 2046 6c61 6720 746f 2063 6f6e       Flag to con
+00015cd0: 7665 7274 2051 5549 432d 5552 4220 6275  vert QUIC-URB bu
+00015ce0: 696c 6469 6e67 7320 746f 2066 7565 6c2e  ildings to fuel.
+00015cf0: 2030 203d 2064 6f20 6e6f 7420 636f 6e76   0 = do not conv
+00015d00: 6572 742c 0a20 2020 2020 2020 2031 203d  ert,.        1 =
+00015d10: 2063 6f6e 7665 7274 2e20 5265 636f 6d6d   convert. Recomm
+00015d20: 656e 6465 6420 7661 6c75 653a 2030 2e0a  ended value: 0..
+00015d30: 2020 2020 6275 696c 6469 6e67 5f66 7565      building_fue
+00015d40: 6c5f 6465 6e73 6974 7920 3a20 506f 7369  l_density : Posi
+00015d50: 7469 7665 466c 6f61 740a 2020 2020 2020  tiveFloat.      
+00015d60: 2020 5468 696e 2066 7565 6c20 6465 6e73    Thin fuel dens
+00015d70: 6974 7920 7769 7468 696e 2062 7569 6c64  ity within build
+00015d80: 696e 6773 2069 6620 6e6f 2066 7565 6c20  ings if no fuel 
+00015d90: 6973 2073 7065 6369 6669 6564 2061 6e64  is specified and
+00015da0: 2062 7569 6c64 696e 6773 0a20 2020 2020   buildings.     
+00015db0: 2020 2061 7265 2063 6f6e 7665 7274 6564     are converted
+00015dc0: 2074 6f20 6675 656c 2e20 4869 6768 6572   to fuel. Higher
+00015dd0: 2076 616c 7565 203d 206d 6f72 6520 6675   value = more fu
+00015de0: 656c 2e20 5265 636f 6d6d 656e 6465 6420  el. Recommended 
+00015df0: 7661 6c75 653a 2030 2e35 2e0a 2020 2020  value: 0.5..    
+00015e00: 2020 2020 556e 6974 733a 205b 6b67 2f6d      Units: [kg/m
+00015e10: 5e33 5d0a 2020 2020 6275 696c 6469 6e67  ^3].    building
+00015e20: 5f61 7474 656e 7561 7469 6f6e 5f63 6f65  _attenuation_coe
+00015e30: 6666 6963 6965 6e74 203a 2050 6f73 6974  fficient : Posit
+00015e40: 6976 6546 6c6f 6174 0a20 2020 2020 2020  iveFloat.       
+00015e50: 2041 7474 656e 7561 7469 6f6e 2063 6f65   Attenuation coe
+00015e60: 6666 6963 6965 6e74 2077 6974 6869 6e20  fficient within 
+00015e70: 6275 696c 6469 6e67 7320 6966 2062 7569  buildings if bui
+00015e80: 6c64 696e 6773 2061 7265 2063 6f6e 7665  ldings are conve
+00015e90: 7274 6564 2074 6f0a 2020 2020 2020 2020  rted to.        
+00015ea0: 6675 656c 2e20 4869 6768 6572 2076 616c  fuel. Higher val
+00015eb0: 7565 203d 206d 6f72 6520 6472 6167 2e20  ue = more drag. 
+00015ec0: 5265 636f 6d6d 656e 6465 6420 7661 6c75  Recommended valu
+00015ed0: 653a 2032 2e0a 2020 2020 6275 696c 6469  e: 2..    buildi
+00015ee0: 6e67 5f73 7572 6661 6365 5f72 6f75 6768  ng_surface_rough
+00015ef0: 6e65 7373 203a 2050 6f73 6974 6976 6546  ness : PositiveF
+00015f00: 6c6f 6174 0a20 2020 2020 2020 2053 7572  loat.        Sur
+00015f10: 6661 6365 2072 6f75 6768 6e65 7373 2077  face roughness w
+00015f20: 6974 6869 6e20 6275 696c 6469 6e67 7320  ithin buildings 
+00015f30: 6966 2062 7569 6c64 696e 6773 2061 7265  if buildings are
+00015f40: 2063 6f6e 7665 7274 6564 2074 6f20 6675   converted to fu
+00015f50: 656c 2e0a 2020 2020 2020 2020 4869 6768  el..        High
+00015f60: 6572 2076 616c 7565 203d 206c 6f77 6572  er value = lower
+00015f70: 2077 696e 6420 7370 6565 642e 2052 6563   wind speed. Rec
+00015f80: 6f6d 6d65 6e64 6564 2076 616c 7565 3a20  ommended value: 
+00015f90: 302e 3031 206d 2e20 556e 6974 733a 205b  0.01 m. Units: [
+00015fa0: 6d5d 0a20 2020 2063 6f6e 7665 7274 5f66  m].    convert_f
+00015fb0: 7565 6c5f 746f 5f63 616e 6f70 795f 666c  uel_to_canopy_fl
+00015fc0: 6167 203a 2069 6e74 0a20 2020 2020 2020  ag : int.       
+00015fd0: 2046 6c61 6720 746f 2063 6f6e 7665 7274   Flag to convert
+00015fe0: 2066 7565 6c20 746f 2063 616e 6f70 7920   fuel to canopy 
+00015ff0: 666f 7220 7769 6e64 732e 2030 203d 2064  for winds. 0 = d
+00016000: 6f20 6e6f 7420 636f 6e76 6572 742c 0a20  o not convert,. 
+00016010: 2020 2020 2020 2031 203d 2063 6f6e 7665         1 = conve
+00016020: 7274 2e20 5265 636f 6d6d 656e 6465 6420  rt. Recommended 
+00016030: 7661 6c75 653a 2031 2e0a 2020 2020 7570  value: 1..    up
+00016040: 6461 7465 5f63 616e 6f70 795f 7769 6e64  date_canopy_wind
+00016050: 735f 666c 6167 203a 2069 6e74 0a20 2020  s_flag : int.   
+00016060: 2020 2020 2046 6c61 6720 746f 2075 7064       Flag to upd
+00016070: 6174 6520 6361 6e6f 7079 2077 696e 6473  ate canopy winds
+00016080: 2077 6865 6e20 6675 656c 2069 7320 636f   when fuel is co
+00016090: 6e73 756d 6564 2e20 3020 3d20 646f 206e  nsumed. 0 = do n
+000160a0: 6f74 2075 7064 6174 652c 0a20 2020 2020  ot update,.     
+000160b0: 2020 2031 203d 2075 7064 6174 652e 2052     1 = update. R
+000160c0: 6563 6f6d 6d65 6e64 6564 2076 616c 7565  ecommended value
+000160d0: 3a20 312e 0a20 2020 2066 7565 6c5f 6174  : 1..    fuel_at
+000160e0: 7465 6e75 6174 696f 6e5f 636f 6566 6669  tenuation_coeffi
+000160f0: 6369 656e 7420 3a20 506f 7369 7469 7665  cient : Positive
+00016100: 466c 6f61 740a 2020 2020 2020 2020 4174  Float.        At
+00016110: 7465 6e75 6174 696f 6e20 636f 6566 6669  tenuation coeffi
+00016120: 6369 656e 7420 7769 7468 696e 2066 7565  cient within fue
+00016130: 6c20 666f 7220 7468 6520 7769 6e64 2070  l for the wind p
+00016140: 726f 6669 6c65 2e20 4869 6768 6572 0a20  rofile. Higher. 
+00016150: 2020 2020 2020 2076 616c 7565 203d 206d         value = m
+00016160: 6f72 6520 6472 6167 2e20 5265 636f 6d6d  ore drag. Recomm
+00016170: 656e 6465 6420 7661 6c75 653a 2031 2e0a  ended value: 1..
+00016180: 2020 2020 6675 656c 5f73 7572 6661 6365      fuel_surface
+00016190: 5f72 6f75 6768 6e65 7373 203a 2050 6f73  _roughness : Pos
+000161a0: 6974 6976 6546 6c6f 6174 0a20 2020 2020  itiveFloat.     
+000161b0: 2020 2053 7572 6661 6365 2072 6f75 6768     Surface rough
+000161c0: 6e65 7373 2077 6974 6869 6e20 6675 656c  ness within fuel
+000161d0: 2e20 4869 6768 6572 2076 616c 7565 203d  . Higher value =
+000161e0: 206c 6f77 6572 2077 696e 6420 7370 6565   lower wind spee
+000161f0: 642e 0a20 2020 2020 2020 2052 6563 6f6d  d..        Recom
+00016200: 6d65 6e64 6564 2076 616c 7565 3a20 302e  mended value: 0.
+00016210: 3120 6d2e 2055 6e69 7473 3a20 5b6d 5d0a  1 m. Units: [m].
+00016220: 2020 2020 2222 220a 0a20 2020 206e 616d      """..    nam
+00016230: 653a 2073 7472 203d 2046 6965 6c64 2822  e: str = Field("
+00016240: 5146 6972 655f 426c 6467 5f41 6476 616e  QFire_Bldg_Advan
+00016250: 6365 645f 5573 6572 5f49 6e70 7574 7322  ced_User_Inputs"
+00016260: 2c20 6672 6f7a 656e 3d54 7275 6529 0a20  , frozen=True). 
+00016270: 2020 205f 6578 7465 6e73 696f 6e3a 2073     _extension: s
+00016280: 7472 203d 2022 2e69 6e70 220a 2020 2020  tr = ".inp".    
+00016290: 636f 6e76 6572 745f 6275 696c 6469 6e67  convert_building
+000162a0: 735f 746f 5f66 7565 6c5f 666c 6167 3a20  s_to_fuel_flag: 
+000162b0: 4c69 7465 7261 6c5b 302c 2031 5d20 3d20  Literal[0, 1] = 
+000162c0: 300a 2020 2020 6275 696c 6469 6e67 5f66  0.    building_f
+000162d0: 7565 6c5f 6465 6e73 6974 793a 2050 6f73  uel_density: Pos
+000162e0: 6974 6976 6546 6c6f 6174 203d 2046 6965  itiveFloat = Fie
+000162f0: 6c64 2830 2e35 2c20 6765 3d30 290a 2020  ld(0.5, ge=0).  
+00016300: 2020 6275 696c 6469 6e67 5f61 7474 656e    building_atten
+00016310: 7561 7469 6f6e 5f63 6f65 6666 6963 6965  uation_coefficie
+00016320: 6e74 3a20 506f 7369 7469 7665 466c 6f61  nt: PositiveFloa
+00016330: 7420 3d20 4669 656c 6428 322e 302c 2067  t = Field(2.0, g
+00016340: 653d 3029 0a20 2020 2062 7569 6c64 696e  e=0).    buildin
+00016350: 675f 7375 7266 6163 655f 726f 7567 686e  g_surface_roughn
+00016360: 6573 733a 2050 6f73 6974 6976 6546 6c6f  ess: PositiveFlo
+00016370: 6174 203d 2046 6965 6c64 2830 2e30 312c  at = Field(0.01,
+00016380: 2067 653d 3029 0a20 2020 2063 6f6e 7665   ge=0).    conve
+00016390: 7274 5f66 7565 6c5f 746f 5f63 616e 6f70  rt_fuel_to_canop
+000163a0: 795f 666c 6167 3a20 4c69 7465 7261 6c5b  y_flag: Literal[
+000163b0: 302c 2031 5d20 3d20 310a 2020 2020 7570  0, 1] = 1.    up
+000163c0: 6461 7465 5f63 616e 6f70 795f 7769 6e64  date_canopy_wind
+000163d0: 735f 666c 6167 3a20 4c69 7465 7261 6c5b  s_flag: Literal[
+000163e0: 302c 2031 5d20 3d20 310a 2020 2020 6675  0, 1] = 1.    fu
+000163f0: 656c 5f61 7474 656e 7561 7469 6f6e 5f63  el_attenuation_c
+00016400: 6f65 6666 6963 6965 6e74 3a20 506f 7369  oefficient: Posi
+00016410: 7469 7665 466c 6f61 7420 3d20 4669 656c  tiveFloat = Fiel
+00016420: 6428 312e 302c 2067 653d 3029 0a20 2020  d(1.0, ge=0).   
+00016430: 2066 7565 6c5f 7375 7266 6163 655f 726f   fuel_surface_ro
+00016440: 7567 686e 6573 733a 2050 6f73 6974 6976  ughness: Positiv
+00016450: 6546 6c6f 6174 203d 2046 6965 6c64 2830  eFloat = Field(0
+00016460: 2e31 2c20 6765 3d30 290a 0a20 2020 2040  .1, ge=0)..    @
+00016470: 636c 6173 736d 6574 686f 640a 2020 2020  classmethod.    
+00016480: 6465 6620 6672 6f6d 5f66 696c 6528 636c  def from_file(cl
+00016490: 732c 2064 6972 6563 746f 7279 3a20 7374  s, directory: st
+000164a0: 7220 7c20 5061 7468 2c20 2a2a 6b77 6172  r | Path, **kwar
+000164b0: 6773 293a 0a20 2020 2020 2020 2022 2222  gs):.        """
+000164c0: 0a20 2020 2020 2020 2049 6e69 7469 616c  .        Initial
+000164d0: 697a 6573 2061 2051 4669 7265 5f42 6c64  izes a QFire_Bld
+000164e0: 675f 4164 7661 6e63 6564 5f55 7365 725f  g_Advanced_User_
+000164f0: 496e 7075 7473 206f 626a 6563 7420 6672  Inputs object fr
+00016500: 6f6d 2061 2064 6972 6563 746f 7279 0a20  om a directory. 
+00016510: 2020 2020 2020 2063 6f6e 7461 696e 696e         containin
+00016520: 6720 6120 5146 6972 655f 426c 6467 5f41  g a QFire_Bldg_A
+00016530: 6476 616e 6365 645f 5573 6572 5f49 6e70  dvanced_User_Inp
+00016540: 7574 732e 696e 7020 6669 6c65 2e0a 2020  uts.inp file..  
+00016550: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00016560: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+00016570: 6469 7265 6374 6f72 792c 2073 7472 293a  directory, str):
+00016580: 0a20 2020 2020 2020 2020 2020 2064 6972  .            dir
+00016590: 6563 746f 7279 203d 2050 6174 6828 6469  ectory = Path(di
+000165a0: 7265 6374 6f72 7929 0a20 2020 2020 2020  rectory).       
+000165b0: 2077 6974 6820 6f70 656e 2864 6972 6563   with open(direc
+000165c0: 746f 7279 202f 2022 5146 6972 655f 426c  tory / "QFire_Bl
+000165d0: 6467 5f41 6476 616e 6365 645f 5573 6572  dg_Advanced_User
+000165e0: 5f49 6e70 7574 732e 696e 7022 2c20 2272  _Inputs.inp", "r
+000165f0: 2229 2061 7320 663a 0a20 2020 2020 2020  ") as f:.       
+00016600: 2020 2020 206c 696e 6573 203d 2066 2e72       lines = f.r
+00016610: 6561 646c 696e 6573 2829 0a20 2020 2020  eadlines().     
+00016620: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
+00016630: 2020 2020 7265 7475 726e 2063 6c73 280a      return cls(.
+00016640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016650: 636f 6e76 6572 745f 6275 696c 6469 6e67  convert_building
+00016660: 735f 746f 5f66 7565 6c5f 666c 6167 3d69  s_to_fuel_flag=i
+00016670: 6e74 286c 696e 6573 5b30 5d2e 7370 6c69  nt(lines[0].spli
+00016680: 7428 295b 305d 292c 0a20 2020 2020 2020  t()[0]),.       
+00016690: 2020 2020 2020 2020 2062 7569 6c64 696e           buildin
+000166a0: 675f 6675 656c 5f64 656e 7369 7479 3d66  g_fuel_density=f
+000166b0: 6c6f 6174 286c 696e 6573 5b31 5d2e 7370  loat(lines[1].sp
+000166c0: 6c69 7428 295b 305d 292c 0a20 2020 2020  lit()[0]),.     
+000166d0: 2020 2020 2020 2020 2020 2062 7569 6c64             build
+000166e0: 696e 675f 6174 7465 6e75 6174 696f 6e5f  ing_attenuation_
+000166f0: 636f 6566 6669 6369 656e 743d 666c 6f61  coefficient=floa
+00016700: 7428 6c69 6e65 735b 325d 2e73 706c 6974  t(lines[2].split
+00016710: 2829 5b30 5d29 2c0a 2020 2020 2020 2020  ()[0]),.        
+00016720: 2020 2020 2020 2020 6275 696c 6469 6e67          building
+00016730: 5f73 7572 6661 6365 5f72 6f75 6768 6e65  _surface_roughne
+00016740: 7373 3d66 6c6f 6174 286c 696e 6573 5b33  ss=float(lines[3
+00016750: 5d2e 7370 6c69 7428 295b 305d 292c 0a20  ].split()[0]),. 
+00016760: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00016770: 6f6e 7665 7274 5f66 7565 6c5f 746f 5f63  onvert_fuel_to_c
+00016780: 616e 6f70 795f 666c 6167 3d69 6e74 286c  anopy_flag=int(l
+00016790: 696e 6573 5b34 5d2e 7370 6c69 7428 295b  ines[4].split()[
+000167a0: 305d 292c 0a20 2020 2020 2020 2020 2020  0]),.           
+000167b0: 2020 2020 2075 7064 6174 655f 6361 6e6f       update_cano
+000167c0: 7079 5f77 696e 6473 5f66 6c61 673d 696e  py_winds_flag=in
+000167d0: 7428 6c69 6e65 735b 355d 2e73 706c 6974  t(lines[5].split
+000167e0: 2829 5b30 5d29 2c0a 2020 2020 2020 2020  ()[0]),.        
+000167f0: 2020 2020 2020 2020 6675 656c 5f61 7474          fuel_att
+00016800: 656e 7561 7469 6f6e 5f63 6f65 6666 6963  enuation_coeffic
+00016810: 6965 6e74 3d66 6c6f 6174 286c 696e 6573  ient=float(lines
+00016820: 5b36 5d2e 7370 6c69 7428 295b 305d 292c  [6].split()[0]),
+00016830: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016840: 2066 7565 6c5f 7375 7266 6163 655f 726f   fuel_surface_ro
+00016850: 7567 686e 6573 733d 666c 6f61 7428 6c69  ughness=float(li
+00016860: 6e65 735b 375d 2e73 706c 6974 2829 5b30  nes[7].split()[0
+00016870: 5d29 2c0a 2020 2020 2020 2020 2020 2020  ]),.            
+00016880: 290a 2020 2020 2020 2020 6578 6365 7074  ).        except
+00016890: 2049 6e64 6578 4572 726f 723a 0a20 2020   IndexError:.   
+000168a0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+000168b0: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
+000168c0: 2020 2020 2020 2020 2020 2066 2245 7272             f"Err
+000168d0: 6f72 2070 6172 7369 6e67 207b 636c 732e  or parsing {cls.
+000168e0: 5f5f 6e61 6d65 5f5f 7d20 6672 6f6d 2066  __name__} from f
+000168f0: 696c 653a 2051 4669 7265 5f42 6c64 675f  ile: QFire_Bldg_
+00016900: 4164 7661 6e63 6564 5f55 7365 725f 496e  Advanced_User_In
+00016910: 7075 7473 2e69 6e70 220a 2020 2020 2020  puts.inp".      
+00016920: 2020 2020 2020 2020 2020 6622 5c6e 506c            f"\nPl
+00016930: 6561 7365 2063 6865 636b 2074 6865 2066  ease check the f
+00016940: 696c 6520 666f 7220 636f 7272 6563 746e  ile for correctn
+00016950: 6573 732e 220a 2020 2020 2020 2020 2020  ess.".          
+00016960: 2020 290a 0a0a 636c 6173 7320 5146 6972    )...class QFir
+00016970: 655f 506c 756d 655f 4164 7661 6e63 6564  e_Plume_Advanced
+00016980: 5f55 7365 725f 496e 7075 7473 2849 6e70  _User_Inputs(Inp
+00016990: 7574 4669 6c65 293a 0a20 2020 2022 2222  utFile):.    """
+000169a0: 0a20 2020 2043 6c61 7373 2072 6570 7265  .    Class repre
+000169b0: 7365 6e74 696e 6720 7468 6520 5146 6972  senting the QFir
+000169c0: 655f 506c 756d 655f 4164 7661 6e63 6564  e_Plume_Advanced
+000169d0: 5f55 7365 725f 496e 7075 7473 2e69 6e70  _User_Inputs.inp
+000169e0: 2069 6e70 7574 2066 696c 652e 0a20 2020   input file..   
+000169f0: 2054 6869 7320 6669 6c65 2063 6f6e 7461   This file conta
+00016a00: 696e 7320 6164 7661 6e63 6564 2070 6172  ins advanced par
+00016a10: 616d 6574 6572 7320 7265 6c61 7465 6420  ameters related 
+00016a20: 746f 206d 6f64 656c 696e 6720 6275 6f79  to modeling buoy
+00016a30: 616e 7420 706c 756d 6573 2e0a 0a20 2020  ant plumes...   
+00016a40: 2041 7474 7269 6275 7465 730a 2020 2020   Attributes.    
+00016a50: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 206d  ----------.    m
+00016a60: 6178 5f70 6c75 6d65 735f 7065 725f 7469  ax_plumes_per_ti
+00016a70: 6d65 7374 6570 203a 2050 6f73 6974 6976  mestep : Positiv
+00016a80: 6549 6e74 0a20 2020 2020 2020 204d 6178  eInt.        Max
+00016a90: 696d 756d 206e 756d 6265 7220 6f66 2070  imum number of p
+00016aa0: 6c75 6d65 7320 616c 6c6f 7765 6420 6174  lumes allowed at
+00016ab0: 2065 6163 6820 7469 6d65 2073 7465 702e   each time step.
+00016ac0: 2048 6967 6865 7220 7661 6c75 6573 2073   Higher values s
+00016ad0: 6c6f 770a 2020 2020 2020 2020 646f 776e  low.        down
+00016ae0: 2074 6865 2073 696d 756c 6174 696f 6e2e   the simulation.
+00016af0: 2044 6566 6175 6c74 2076 616c 7565 3a20   Default value: 
+00016b00: 3135 302c 3030 302e 2052 6563 6f6d 6d65  150,000. Recomme
+00016b10: 6e64 6564 2072 616e 6765 3a0a 2020 2020  nded range:.    
+00016b20: 2020 2020 3530 2c30 3030 202d 2035 3030      50,000 - 500
+00016b30: 2c30 3030 2e0a 2020 2020 6d69 6e5f 706c  ,000..    min_pl
+00016b40: 756d 655f 7570 6472 6166 745f 7665 6c6f  ume_updraft_velo
+00016b50: 6369 7479 203a 2050 6f73 6974 6976 6546  city : PositiveF
+00016b60: 6c6f 6174 0a20 2020 2020 2020 204d 696e  loat.        Min
+00016b70: 696d 756d 2070 6c75 6d65 2075 7064 7261  imum plume updra
+00016b80: 6674 2076 656c 6f63 6974 7920 5b6d 2f73  ft velocity [m/s
+00016b90: 5d2e 2049 6620 706c 756d 6520 7665 6c6f  ]. If plume velo
+00016ba0: 6369 7479 2064 726f 7073 2062 656c 6f77  city drops below
+00016bb0: 2074 6869 730a 2020 2020 2020 2020 7661   this.        va
+00016bc0: 6c75 652c 2074 6865 2070 6c75 6d65 2069  lue, the plume i
+00016bd0: 7320 7265 6d6f 7665 642e 2048 6967 6865  s removed. Highe
+00016be0: 7220 7661 6c75 6573 2072 6564 7563 6520  r values reduce 
+00016bf0: 6e75 6d62 6572 206f 6620 706c 756d 6573  number of plumes
+00016c00: 2e0a 2020 2020 2020 2020 4465 6661 756c  ..        Defaul
+00016c10: 7420 7661 6c75 653a 2030 2e31 206d 2f73  t value: 0.1 m/s
+00016c20: 2e0a 2020 2020 6d61 785f 706c 756d 655f  ..    max_plume_
+00016c30: 7570 6472 6166 745f 7665 6c6f 6369 7479  updraft_velocity
+00016c40: 203a 2050 6f73 6974 6976 6546 6c6f 6174   : PositiveFloat
+00016c50: 0a20 2020 2020 2020 204d 6178 696d 756d  .        Maximum
+00016c60: 2061 6c6c 6f77 6564 2070 6c75 6d65 2075   allowed plume u
+00016c70: 7064 7261 6674 2076 656c 6f63 6974 7920  pdraft velocity 
+00016c80: 5b6d 2f73 5d2e 2044 6566 6175 6c74 2076  [m/s]. Default v
+00016c90: 616c 7565 3a20 3130 3020 6d2f 732e 0a20  alue: 100 m/s.. 
+00016ca0: 2020 206d 696e 5f76 656c 6f63 6974 795f     min_velocity_
+00016cb0: 7261 7469 6f20 3a20 506f 7369 7469 7665  ratio : Positive
+00016cc0: 466c 6f61 740a 2020 2020 2020 2020 4d69  Float.        Mi
+00016cd0: 6e69 6d75 6d20 7261 7469 6f20 6265 7477  nimum ratio betw
+00016ce0: 6565 6e20 706c 756d 6520 7570 6472 6166  een plume updraf
+00016cf0: 7420 7665 6c6f 6369 7479 2061 6e64 2077  t velocity and w
+00016d00: 696e 6420 7370 6565 642e 2049 6620 7261  ind speed. If ra
+00016d10: 7469 6f0a 2020 2020 2020 2020 6472 6f70  tio.        drop
+00016d20: 7320 6265 6c6f 7720 7468 6973 2076 616c  s below this val
+00016d30: 7565 2c20 706c 756d 6520 6973 2072 656d  ue, plume is rem
+00016d40: 6f76 6564 2e20 4869 6768 6572 2076 616c  oved. Higher val
+00016d50: 7565 7320 7265 6475 6365 2070 6c75 6d65  ues reduce plume
+00016d60: 732e 0a20 2020 2020 2020 2044 6566 6175  s..        Defau
+00016d70: 6c74 2076 616c 7565 3a20 302e 312e 0a20  lt value: 0.1.. 
+00016d80: 2020 2062 7275 6e74 5f76 6169 7361 6c61     brunt_vaisala
+00016d90: 5f66 7265 715f 7371 7561 7265 6420 3a20  _freq_squared : 
+00016da0: 4e6f 6e4e 6567 6174 6976 6546 6c6f 6174  NonNegativeFloat
+00016db0: 0a20 2020 2020 2020 2049 6e76 6572 7365  .        Inverse
+00016dc0: 206f 6620 7468 6520 4272 756e 742d 5661   of the Brunt-Va
+00016dd0: 6973 616c 6120 6672 6571 7565 6e63 7920  isala frequency 
+00016de0: 7371 7561 7265 6420 5b31 2f73 5e32 5d2c  squared [1/s^2],
+00016df0: 2061 206d 6561 7375 7265 206f 660a 2020   a measure of.  
+00016e00: 2020 2020 2020 6174 6d6f 7370 6865 7269        atmospheri
+00016e10: 6320 7374 6162 696c 6974 792e 2044 6566  c stability. Def
+00016e20: 6175 6c74 2076 616c 7565 3a20 3020 312f  ault value: 0 1/
+00016e30: 735e 322e 0a20 2020 2063 7265 6570 696e  s^2..    creepin
+00016e40: 675f 666c 6167 203a 204c 6974 6572 616c  g_flag : Literal
+00016e50: 5b30 2c20 315d 0a20 2020 2020 2020 2046  [0, 1].        F
+00016e60: 6c61 6720 746f 2065 6e61 626c 6520 2831  lag to enable (1
+00016e70: 2920 6f72 2064 6973 6162 6c65 2028 3029  ) or disable (0)
+00016e80: 2066 6972 6520 7370 7265 6164 2062 7920   fire spread by 
+00016e90: 6372 6565 7069 6e67 2e0a 2020 2020 2020  creeping..      
+00016ea0: 2020 4465 6661 756c 7420 7661 6c75 653a    Default value:
+00016eb0: 2031 2e0a 2020 2020 6164 6170 7469 7665   1..    adaptive
+00016ec0: 5f74 696d 6573 7465 705f 666c 6167 203a  _timestep_flag :
+00016ed0: 204c 6974 6572 616c 5b30 2c20 315d 0a20   Literal[0, 1]. 
+00016ee0: 2020 2020 2020 2045 6e61 626c 6520 2831         Enable (1
+00016ef0: 2920 6f72 2064 6973 6162 6c65 2028 3029  ) or disable (0)
+00016f00: 2061 6461 7074 6976 6520 7469 6d65 2073   adaptive time s
+00016f10: 7465 7070 696e 672e 2041 6461 7074 6976  tepping. Adaptiv
+00016f20: 6520 7469 6d65 2073 7465 7070 696e 670a  e time stepping.
+00016f30: 2020 2020 2020 2020 696d 7072 6f76 6573          improves
+00016f40: 2061 6363 7572 6163 7920 6275 7420 696e   accuracy but in
+00016f50: 6372 6561 7365 7320 7369 6d75 6c61 7469  creases simulati
+00016f60: 6f6e 2074 696d 652e 2044 6566 6175 6c74  on time. Default
+00016f70: 2076 616c 7565 3a20 302e 0a20 2020 2070   value: 0..    p
+00016f80: 6c75 6d65 5f74 696d 6573 7465 7020 3a20  lume_timestep : 
+00016f90: 506f 7369 7469 7665 466c 6f61 740a 2020  PositiveFloat.  
+00016fa0: 2020 2020 2020 5469 6d65 2073 7465 7020        Time step 
+00016fb0: 5b73 5d20 7573 6564 2074 6f20 636f 6d70  [s] used to comp
+00016fc0: 7574 6520 6275 6f79 616e 7420 706c 756d  ute buoyant plum
+00016fd0: 6520 7472 616a 6563 746f 7269 6573 2e20  e trajectories. 
+00016fe0: 4869 6768 6572 2076 616c 7565 730a 2020  Higher values.  
+00016ff0: 2020 2020 2020 7265 6475 6365 2061 6363        reduce acc
+00017000: 7572 6163 792e 2044 6566 6175 6c74 2076  uracy. Default v
+00017010: 616c 7565 3a20 3173 2e0a 2020 2020 736f  alue: 1s..    so
+00017020: 725f 6f70 7469 6f6e 5f66 6c61 6720 3a20  r_option_flag : 
+00017030: 4c69 7465 7261 6c5b 302c 2031 5d0a 2020  Literal[0, 1].  
+00017040: 2020 2020 2020 534f 5220 736f 6c76 6572        SOR solver
+00017050: 206f 7074 696f 6e2e 2030 203d 2073 7461   option. 0 = sta
+00017060: 6e64 6172 6420 534f 522c 2031 203d 206d  ndard SOR, 1 = m
+00017070: 656d 6f72 7920 534f 522e 2044 6566 6175  emory SOR. Defau
+00017080: 6c74 2076 616c 7565 3a20 312e 0a20 2020  lt value: 1..   
+00017090: 2073 6f72 5f61 6c70 6861 5f70 6c75 6d65   sor_alpha_plume
+000170a0: 5f63 656e 7465 7220 3a20 506f 7369 7469  _center : Positi
+000170b0: 7665 466c 6f61 740a 2020 2020 2020 2020  veFloat.        
+000170c0: 534f 5220 616c 7068 6120 7661 6c75 6520  SOR alpha value 
+000170d0: 6174 2070 6c75 6d65 2063 656e 7465 726c  at plume centerl
+000170e0: 696e 652e 2048 6967 6865 7220 7661 6c75  ine. Higher valu
+000170f0: 6573 2072 6564 7563 6520 696e 666c 7565  es reduce influe
+00017100: 6e63 6520 6f66 0a20 2020 2020 2020 2070  nce of.        p
+00017110: 6c75 6d65 7320 6f6e 2077 696e 6473 2e20  lumes on winds. 
+00017120: 4465 6661 756c 7420 7661 6c75 653a 2031  Default value: 1
+00017130: 302e 0a20 2020 2073 6f72 5f61 6c70 6861  0..    sor_alpha
+00017140: 5f70 6c75 6d65 5f65 6467 6520 3a20 506f  _plume_edge : Po
+00017150: 7369 7469 7665 466c 6f61 740a 2020 2020  sitiveFloat.    
+00017160: 2020 2020 534f 5220 616c 7068 6120 7661      SOR alpha va
+00017170: 6c75 6520 6174 2070 6c75 6d65 2065 6467  lue at plume edg
+00017180: 652e 2048 6967 6865 7220 7661 6c75 6573  e. Higher values
+00017190: 2072 6564 7563 6520 696e 666c 7565 6e63   reduce influenc
+000171a0: 6520 6f66 2070 6c75 6d65 730a 2020 2020  e of plumes.    
+000171b0: 2020 2020 6f6e 2077 696e 6473 2e20 4465      on winds. De
+000171c0: 6661 756c 7420 7661 6c75 653a 2031 2e0a  fault value: 1..
+000171d0: 2020 2020 2020 2020 6d61 785f 706c 756d          max_plum
+000171e0: 655f 6d65 7267 696e 675f 616e 676c 6520  e_merging_angle 
+000171f0: 3a20 506f 7369 7469 7665 466c 6f61 740a  : PositiveFloat.
+00017200: 2020 2020 2020 2020 4d61 7869 6d75 6d20          Maximum 
+00017210: 616e 676c 6520 5b64 6567 7265 6573 5d20  angle [degrees] 
+00017220: 6265 7477 6565 6e20 706c 756d 6573 2074  between plumes t
+00017230: 6f20 6465 7465 726d 696e 6520 6d65 7267  o determine merg
+00017240: 696e 6720 656c 6967 6962 696c 6974 792e  ing eligibility.
+00017250: 0a20 2020 2020 2020 2048 6967 6865 7220  .        Higher 
+00017260: 7661 6c75 6573 2069 6e63 7265 6173 6520  values increase 
+00017270: 706c 756d 6520 6d65 7267 696e 672e 2044  plume merging. D
+00017280: 6566 6175 6c74 2076 616c 7565 3a20 3330  efault value: 30
+00017290: 2064 6567 7265 6573 2e0a 2020 2020 6d61   degrees..    ma
+000172a0: 785f 706c 756d 655f 6f76 6572 6c61 705f  x_plume_overlap_
+000172b0: 6672 6163 7469 6f6e 203a 2050 6f73 6974  fraction : Posit
+000172c0: 6976 6546 6c6f 6174 0a20 2020 2020 2020  iveFloat.       
+000172d0: 204d 6178 696d 756d 2066 7261 6374 696f   Maximum fractio
+000172e0: 6e20 6f66 2073 6d61 6c6c 6572 2070 6c75  n of smaller plu
+000172f0: 6d65 2074 7261 6a65 6374 6f72 7920 6f76  me trajectory ov
+00017300: 6572 6c61 7070 6564 2062 7920 6c61 7267  erlapped by larg
+00017310: 6572 2070 6c75 6d65 0a20 2020 2020 2020  er plume.       
+00017320: 2074 6f20 6265 2063 6f6e 7369 6465 7265   to be considere
+00017330: 6420 666f 7220 6d65 7267 696e 672e 2048  d for merging. H
+00017340: 6967 6865 7220 7661 6c75 6573 2069 6e63  igher values inc
+00017350: 7265 6173 6520 6d65 7267 696e 672e 0a20  rease merging.. 
+00017360: 2020 2070 6c75 6d65 5f74 6f5f 6772 6964     plume_to_grid
+00017370: 5f75 7064 7261 6674 735f 666c 6167 203a  _updrafts_flag :
+00017380: 204c 6974 6572 616c 5b30 2c20 315d 0a20   Literal[0, 1]. 
+00017390: 2020 2020 2020 204d 6574 686f 6420 746f         Method to
+000173a0: 206d 6170 2070 6c75 6d65 2075 7064 7261   map plume updra
+000173b0: 6674 7320 746f 2067 7269 642e 2030 203d  fts to grid. 0 =
+000173c0: 206e 6577 206d 6574 686f 642c 2031 203d   new method, 1 =
+000173d0: 206f 6c64 206d 6574 686f 642e 0a20 2020   old method..   
+000173e0: 2020 2020 204e 6577 206d 6574 686f 6420       New method 
+000173f0: 696d 7072 6f76 6573 2061 6363 7572 6163  improves accurac
+00017400: 792e 2044 6566 6175 6c74 2076 616c 7565  y. Default value
+00017410: 3a20 312e 204e 6577 206d 6574 686f 6420  : 1. New method 
+00017420: 7461 6b65 7320 6c6f 6e67 6572 2c0a 2020  takes longer,.  
+00017430: 2020 2020 2020 6275 7420 6973 206e 6565        but is nee
+00017440: 6465 6420 6966 2073 6d6f 6b65 2069 7320  ded if smoke is 
+00017450: 7369 6d75 6c61 7465 6420 6166 7465 7277  simulated afterw
+00017460: 6172 6473 2e0a 2020 2020 6d61 785f 706f  ards..    max_po
+00017470: 696e 7473 5f61 6c6f 6e67 5f70 6c75 6d65  ints_along_plume
+00017480: 5f65 6467 6520 3a20 506f 7369 7469 7665  _edge : Positive
+00017490: 496e 740a 2020 2020 2020 2020 4d61 7869  Int.        Maxi
+000174a0: 6d75 6d20 706f 696e 7473 2074 6f20 7361  mum points to sa
+000174b0: 6d70 6c65 2061 6c6f 6e67 2067 7269 6420  mple along grid 
+000174c0: 6365 6c6c 2065 6467 6520 666f 7220 6e65  cell edge for ne
+000174d0: 7720 706c 756d 652d 746f 2d67 7269 640a  w plume-to-grid.
+000174e0: 2020 2020 2020 2020 6d65 7468 6f64 2e20          method. 
+000174f0: 4465 6661 756c 7420 7661 6c75 653a 2031  Default value: 1
+00017500: 302e 0a20 2020 2070 6c75 6d65 5f74 6f5f  0..    plume_to_
+00017510: 6772 6964 5f69 6e74 6572 7365 6374 696f  grid_intersectio
+00017520: 6e5f 666c 6167 203a 204c 6974 6572 616c  n_flag : Literal
+00017530: 5b30 2c20 315d 0a20 2020 2020 2020 2053  [0, 1].        S
+00017540: 6368 656d 6520 746f 2073 756d 2070 6c75  cheme to sum plu
+00017550: 6d65 2d74 6f2d 6772 6964 2075 7064 7261  me-to-grid updra
+00017560: 6674 7320 7768 656e 206d 756c 7469 706c  fts when multipl
+00017570: 6520 706c 756d 6573 2069 6e74 6572 7365  e plumes interse
+00017580: 6374 2061 0a20 2020 2020 2020 2067 7269  ct a.        gri
+00017590: 6420 6365 6c6c 2e20 3020 3d20 6375 6265  d cell. 0 = cube
+000175a0: 206d 6574 686f 642c 2031 203d 206d 6178   method, 1 = max
+000175b0: 2076 616c 7565 206d 6574 686f 642e 2044   value method. D
+000175c0: 6566 6175 6c74 2076 616c 7565 3a20 312e  efault value: 1.
+000175d0: 0a20 2020 2022 2222 0a0a 2020 2020 6e61  .    """..    na
+000175e0: 6d65 3a20 7374 7220 3d20 4669 656c 6428  me: str = Field(
+000175f0: 2251 4669 7265 5f50 6c75 6d65 5f41 6476  "QFire_Plume_Adv
+00017600: 616e 6365 645f 5573 6572 5f49 6e70 7574  anced_User_Input
+00017610: 7322 2c20 6672 6f7a 656e 3d54 7275 6529  s", frozen=True)
+00017620: 0a20 2020 205f 6578 7465 6e73 696f 6e3a  .    _extension:
+00017630: 2073 7472 203d 2022 2e69 6e70 220a 2020   str = ".inp".  
+00017640: 2020 6d61 785f 706c 756d 6573 5f70 6572    max_plumes_per
+00017650: 5f74 696d 6573 7465 703a 2050 6f73 6974  _timestep: Posit
+00017660: 6976 6549 6e74 203d 2046 6965 6c64 2831  iveInt = Field(1
+00017670: 3530 3030 302c 2067 743d 3029 0a20 2020  50000, gt=0).   
+00017680: 206d 696e 5f70 6c75 6d65 5f75 7064 7261   min_plume_updra
+00017690: 6674 5f76 656c 6f63 6974 793a 2050 6f73  ft_velocity: Pos
+000176a0: 6974 6976 6546 6c6f 6174 203d 2046 6965  itiveFloat = Fie
+000176b0: 6c64 2830 2e31 2c20 6774 3d30 290a 2020  ld(0.1, gt=0).  
+000176c0: 2020 6d61 785f 706c 756d 655f 7570 6472    max_plume_updr
+000176d0: 6166 745f 7665 6c6f 6369 7479 3a20 506f  aft_velocity: Po
+000176e0: 7369 7469 7665 466c 6f61 7420 3d20 4669  sitiveFloat = Fi
+000176f0: 656c 6428 3130 302e 302c 2067 743d 3029  eld(100.0, gt=0)
+00017700: 0a20 2020 206d 696e 5f76 656c 6f63 6974  .    min_velocit
+00017710: 795f 7261 7469 6f3a 2050 6f73 6974 6976  y_ratio: Positiv
+00017720: 6546 6c6f 6174 203d 2046 6965 6c64 2830  eFloat = Field(0
+00017730: 2e31 2c20 6774 3d30 290a 2020 2020 6272  .1, gt=0).    br
+00017740: 756e 745f 7661 6973 616c 615f 6672 6571  unt_vaisala_freq
+00017750: 5f73 7175 6172 6564 3a20 4e6f 6e4e 6567  _squared: NonNeg
+00017760: 6174 6976 6546 6c6f 6174 203d 2046 6965  ativeFloat = Fie
+00017770: 6c64 2830 2e30 2c20 6765 3d30 290a 2020  ld(0.0, ge=0).  
+00017780: 2020 6372 6565 7069 6e67 5f66 6c61 673a    creeping_flag:
+00017790: 204c 6974 6572 616c 5b30 2c20 315d 203d   Literal[0, 1] =
+000177a0: 2031 0a20 2020 2061 6461 7074 6976 655f   1.    adaptive_
+000177b0: 7469 6d65 7374 6570 5f66 6c61 673a 204c  timestep_flag: L
+000177c0: 6974 6572 616c 5b30 2c20 315d 203d 2030  iteral[0, 1] = 0
+000177d0: 0a20 2020 2070 6c75 6d65 5f74 696d 6573  .    plume_times
+000177e0: 7465 703a 2050 6f73 6974 6976 6546 6c6f  tep: PositiveFlo
+000177f0: 6174 203d 2046 6965 6c64 2831 2e30 2c20  at = Field(1.0, 
+00017800: 6774 3d30 290a 2020 2020 736f 725f 6f70  gt=0).    sor_op
+00017810: 7469 6f6e 5f66 6c61 673a 204c 6974 6572  tion_flag: Liter
+00017820: 616c 5b30 2c20 315d 203d 2031 0a20 2020  al[0, 1] = 1.   
+00017830: 2073 6f72 5f61 6c70 6861 5f70 6c75 6d65   sor_alpha_plume
+00017840: 5f63 656e 7465 723a 2050 6f73 6974 6976  _center: Positiv
+00017850: 6546 6c6f 6174 203d 2046 6965 6c64 2831  eFloat = Field(1
+00017860: 302e 302c 2067 743d 3029 0a20 2020 2073  0.0, gt=0).    s
+00017870: 6f72 5f61 6c70 6861 5f70 6c75 6d65 5f65  or_alpha_plume_e
+00017880: 6467 653a 2050 6f73 6974 6976 6546 6c6f  dge: PositiveFlo
+00017890: 6174 203d 2046 6965 6c64 2831 2e30 2c20  at = Field(1.0, 
+000178a0: 6774 3d30 290a 2020 2020 6d61 785f 706c  gt=0).    max_pl
+000178b0: 756d 655f 6d65 7267 696e 675f 616e 676c  ume_merging_angl
+000178c0: 653a 2050 6f73 6974 6976 6546 6c6f 6174  e: PositiveFloat
+000178d0: 203d 2046 6965 6c64 2833 302e 302c 2067   = Field(30.0, g
+000178e0: 743d 302c 206c 653d 3138 3029 0a20 2020  t=0, le=180).   
+000178f0: 206d 6178 5f70 6c75 6d65 5f6f 7665 726c   max_plume_overl
+00017900: 6170 5f66 7261 6374 696f 6e3a 2050 6f73  ap_fraction: Pos
+00017910: 6974 6976 6546 6c6f 6174 203d 2046 6965  itiveFloat = Fie
+00017920: 6c64 2830 2e37 2c20 6774 3d30 2c20 6c65  ld(0.7, gt=0, le
+00017930: 3d31 290a 2020 2020 706c 756d 655f 746f  =1).    plume_to
+00017940: 5f67 7269 645f 7570 6472 6166 7473 5f66  _grid_updrafts_f
+00017950: 6c61 673a 204c 6974 6572 616c 5b30 2c20  lag: Literal[0, 
+00017960: 315d 203d 2031 0a20 2020 206d 6178 5f70  1] = 1.    max_p
+00017970: 6f69 6e74 735f 616c 6f6e 675f 706c 756d  oints_along_plum
+00017980: 655f 6564 6765 3a20 506f 7369 7469 7665  e_edge: Positive
+00017990: 496e 7420 3d20 4669 656c 6428 3130 2c20  Int = Field(10, 
+000179a0: 6765 3d31 2c20 6c65 3d31 3030 290a 2020  ge=1, le=100).  
+000179b0: 2020 706c 756d 655f 746f 5f67 7269 645f    plume_to_grid_
+000179c0: 696e 7465 7273 6563 7469 6f6e 5f66 6c61  intersection_fla
+000179d0: 673a 204c 6974 6572 616c 5b30 2c20 315d  g: Literal[0, 1]
+000179e0: 203d 2031 0a0a 2020 2020 4063 6c61 7373   = 1..    @class
+000179f0: 6d65 7468 6f64 0a20 2020 2064 6566 2066  method.    def f
+00017a00: 726f 6d5f 6669 6c65 2863 6c73 2c20 6469  rom_file(cls, di
+00017a10: 7265 6374 6f72 793a 2073 7472 207c 2050  rectory: str | P
+00017a20: 6174 682c 202a 2a6b 7761 7267 7329 3a0a  ath, **kwargs):.
+00017a30: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+00017a40: 7461 6e63 6528 6469 7265 6374 6f72 792c  tance(directory,
+00017a50: 2073 7472 293a 0a20 2020 2020 2020 2020   str):.         
+00017a60: 2020 2064 6972 6563 746f 7279 203d 2050     directory = P
+00017a70: 6174 6828 6469 7265 6374 6f72 7929 0a0a  ath(directory)..
+00017a80: 2020 2020 2020 2020 7769 7468 206f 7065          with ope
+00017a90: 6e28 6469 7265 6374 6f72 7920 2f20 2251  n(directory / "Q
+00017aa0: 4669 7265 5f50 6c75 6d65 5f41 6476 616e  Fire_Plume_Advan
+00017ab0: 6365 645f 5573 6572 5f49 6e70 7574 732e  ced_User_Inputs.
+00017ac0: 696e 7022 2c20 2272 2229 2061 7320 663a  inp", "r") as f:
+00017ad0: 0a20 2020 2020 2020 2020 2020 206c 696e  .            lin
+00017ae0: 6573 203d 2066 2e72 6561 646c 696e 6573  es = f.readlines
+00017af0: 2829 0a20 2020 2020 2020 2074 7279 3a0a  ().        try:.
+00017b00: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00017b10: 726e 2063 6c73 280a 2020 2020 2020 2020  rn cls(.        
+00017b20: 2020 2020 2020 2020 6d61 785f 706c 756d          max_plum
+00017b30: 6573 5f70 6572 5f74 696d 6573 7465 703d  es_per_timestep=
+00017b40: 696e 7428 6c69 6e65 735b 305d 2e73 706c  int(lines[0].spl
+00017b50: 6974 2829 5b30 5d29 2c0a 2020 2020 2020  it()[0]),.      
+00017b60: 2020 2020 2020 2020 2020 6d69 6e5f 706c            min_pl
+00017b70: 756d 655f 7570 6472 6166 745f 7665 6c6f  ume_updraft_velo
+00017b80: 6369 7479 3d66 6c6f 6174 286c 696e 6573  city=float(lines
+00017b90: 5b31 5d2e 7370 6c69 7428 295b 305d 292c  [1].split()[0]),
+00017ba0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017bb0: 206d 6178 5f70 6c75 6d65 5f75 7064 7261   max_plume_updra
+00017bc0: 6674 5f76 656c 6f63 6974 793d 666c 6f61  ft_velocity=floa
+00017bd0: 7428 6c69 6e65 735b 325d 2e73 706c 6974  t(lines[2].split
+00017be0: 2829 5b30 5d29 2c0a 2020 2020 2020 2020  ()[0]),.        
+00017bf0: 2020 2020 2020 2020 6d69 6e5f 7665 6c6f          min_velo
+00017c00: 6369 7479 5f72 6174 696f 3d66 6c6f 6174  city_ratio=float
+00017c10: 286c 696e 6573 5b33 5d2e 7370 6c69 7428  (lines[3].split(
+00017c20: 295b 305d 292c 0a20 2020 2020 2020 2020  )[0]),.         
+00017c30: 2020 2020 2020 2062 7275 6e74 5f76 6169         brunt_vai
+00017c40: 7361 6c61 5f66 7265 715f 7371 7561 7265  sala_freq_square
+00017c50: 643d 666c 6f61 7428 6c69 6e65 735b 345d  d=float(lines[4]
+00017c60: 2e73 706c 6974 2829 5b30 5d29 2c0a 2020  .split()[0]),.  
+00017c70: 2020 2020 2020 2020 2020 2020 2020 6372                cr
+00017c80: 6565 7069 6e67 5f66 6c61 673d 696e 7428  eeping_flag=int(
+00017c90: 6c69 6e65 735b 355d 2e73 706c 6974 2829  lines[5].split()
+00017ca0: 5b30 5d29 2c0a 2020 2020 2020 2020 2020  [0]),.          
+00017cb0: 2020 2020 2020 6164 6170 7469 7665 5f74        adaptive_t
+00017cc0: 696d 6573 7465 705f 666c 6167 3d69 6e74  imestep_flag=int
+00017cd0: 286c 696e 6573 5b36 5d2e 7370 6c69 7428  (lines[6].split(
+00017ce0: 295b 305d 292c 0a20 2020 2020 2020 2020  )[0]),.         
+00017cf0: 2020 2020 2020 2070 6c75 6d65 5f74 696d         plume_tim
+00017d00: 6573 7465 703d 666c 6f61 7428 6c69 6e65  estep=float(line
+00017d10: 735b 375d 2e73 706c 6974 2829 5b30 5d29  s[7].split()[0])
+00017d20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00017d30: 2020 736f 725f 6f70 7469 6f6e 5f66 6c61    sor_option_fla
+00017d40: 673d 696e 7428 6c69 6e65 735b 385d 2e73  g=int(lines[8].s
+00017d50: 706c 6974 2829 5b30 5d29 2c0a 2020 2020  plit()[0]),.    
+00017d60: 2020 2020 2020 2020 2020 2020 736f 725f              sor_
+00017d70: 616c 7068 615f 706c 756d 655f 6365 6e74  alpha_plume_cent
+00017d80: 6572 3d66 6c6f 6174 286c 696e 6573 5b39  er=float(lines[9
+00017d90: 5d2e 7370 6c69 7428 295b 305d 292c 0a20  ].split()[0]),. 
+00017da0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00017db0: 6f72 5f61 6c70 6861 5f70 6c75 6d65 5f65  or_alpha_plume_e
+00017dc0: 6467 653d 666c 6f61 7428 6c69 6e65 735b  dge=float(lines[
+00017dd0: 3130 5d2e 7370 6c69 7428 295b 305d 292c  10].split()[0]),
+00017de0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017df0: 206d 6178 5f70 6c75 6d65 5f6d 6572 6769   max_plume_mergi
+00017e00: 6e67 5f61 6e67 6c65 3d66 6c6f 6174 286c  ng_angle=float(l
+00017e10: 696e 6573 5b31 315d 2e73 706c 6974 2829  ines[11].split()
+00017e20: 5b30 5d29 2c0a 2020 2020 2020 2020 2020  [0]),.          
+00017e30: 2020 2020 2020 6d61 785f 706c 756d 655f        max_plume_
+00017e40: 6f76 6572 6c61 705f 6672 6163 7469 6f6e  overlap_fraction
+00017e50: 3d66 6c6f 6174 286c 696e 6573 5b31 325d  =float(lines[12]
+00017e60: 2e73 706c 6974 2829 5b30 5d29 2c0a 2020  .split()[0]),.  
+00017e70: 2020 2020 2020 2020 2020 2020 2020 706c                pl
+00017e80: 756d 655f 746f 5f67 7269 645f 7570 6472  ume_to_grid_updr
+00017e90: 6166 7473 5f66 6c61 673d 696e 7428 6c69  afts_flag=int(li
+00017ea0: 6e65 735b 3133 5d2e 7370 6c69 7428 295b  nes[13].split()[
+00017eb0: 305d 292c 0a20 2020 2020 2020 2020 2020  0]),.           
+00017ec0: 2020 2020 206d 6178 5f70 6f69 6e74 735f       max_points_
+00017ed0: 616c 6f6e 675f 706c 756d 655f 6564 6765  along_plume_edge
+00017ee0: 3d69 6e74 286c 696e 6573 5b31 345d 2e73  =int(lines[14].s
+00017ef0: 706c 6974 2829 5b30 5d29 2c0a 2020 2020  plit()[0]),.    
+00017f00: 2020 2020 2020 2020 2020 2020 706c 756d              plum
+00017f10: 655f 746f 5f67 7269 645f 696e 7465 7273  e_to_grid_inters
+00017f20: 6563 7469 6f6e 5f66 6c61 673d 696e 7428  ection_flag=int(
+00017f30: 6c69 6e65 735b 3135 5d2e 7370 6c69 7428  lines[15].split(
+00017f40: 295b 305d 292c 0a20 2020 2020 2020 2020  )[0]),.         
+00017f50: 2020 2029 0a20 2020 2020 2020 2065 7863     ).        exc
+00017f60: 6570 7420 496e 6465 7845 7272 6f72 3a0a  ept IndexError:.
+00017f70: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00017f80: 6520 5661 6c75 6545 7272 6f72 280a 2020  e ValueError(.  
+00017f90: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+00017fa0: 4572 726f 7220 7061 7273 696e 6720 7b63  Error parsing {c
+00017fb0: 6c73 2e5f 5f6e 616d 655f 5f7d 2066 726f  ls.__name__} fro
+00017fc0: 6d20 6669 6c65 3a20 5146 6972 655f 506c  m file: QFire_Pl
+00017fd0: 756d 655f 4164 7661 6e63 6564 5f55 7365  ume_Advanced_Use
+00017fe0: 725f 496e 7075 7473 2e69 6e70 220a 2020  r_Inputs.inp".  
+00017ff0: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+00018000: 5c6e 506c 6561 7365 2063 6865 636b 2074  \nPlease check t
+00018010: 6865 2066 696c 6520 666f 7220 636f 7272  he file for corr
+00018020: 6563 746e 6573 732e 220a 2020 2020 2020  ectness.".      
+00018030: 2020 2020 2020 290a 0a0a 636c 6173 7320        )...class 
+00018040: 5155 5f54 6f70 6f49 6e70 7574 7328 496e  QU_TopoInputs(In
+00018050: 7075 7446 696c 6529 3a0a 2020 2020 2222  putFile):.    ""
+00018060: 220a 2020 2020 436c 6173 7320 7265 7072  ".    Class repr
+00018070: 6573 656e 7469 6e67 2074 6865 2051 555f  esenting the QU_
+00018080: 546f 706f 496e 7075 7473 2e69 6e70 2069  TopoInputs.inp i
+00018090: 6e70 7574 2066 696c 652e 2054 6869 7320  nput file. This 
+000180a0: 6669 6c65 0a20 2020 2063 6f6e 7461 696e  file.    contain
+000180b0: 7320 6164 7661 6e63 6564 2064 6174 6120  s advanced data 
+000180c0: 7065 7274 6169 6e69 6e67 2074 6f20 746f  pertaining to to
+000180d0: 706f 6772 6170 6879 2e0a 0a20 2020 2041  pography...    A
+000180e0: 7474 7269 6275 7465 730a 2020 2020 2d2d  ttributes.    --
+000180f0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2066 696c  --------.    fil
+00018100: 656e 616d 6520 3a20 7374 720a 2020 2020  ename : str.    
+00018110: 2020 2020 5061 7468 2074 6f20 7468 6520      Path to the 
+00018120: 6375 7374 6f6d 2074 6f70 6f20 6669 6c65  custom topo file
+00018130: 2028 6f6e 6c79 2075 7365 6420 7769 7468   (only used with
+00018140: 206f 7074 696f 6e20 3529 2e20 4361 6e6e   option 5). Cann
+00018150: 6f74 2062 6520 2e62 696e 2e20 5573 6520  ot be .bin. Use 
+00018160: 2e64 6174 206f 7220 2e69 6e70 0a20 2020  .dat or .inp.   
+00018170: 2074 6f70 6f67 7261 7068 7920 3a20 546f   topography : To
+00018180: 706f 6772 6170 6879 0a20 2020 2020 2020  pography.       
+00018190: 2054 6f70 6f67 7261 7068 7920 7479 7065   Topography type
+000181a0: 2073 7065 6369 6669 6564 2061 7320 6120   specified as a 
+000181b0: 546f 706f 5479 7065 2063 6c61 7373 2066  TopoType class f
+000181c0: 726f 6d20 746f 706f 6772 6170 6879 2e70  rom topography.p
+000181d0: 790a 2020 2020 2020 2020 3020 3d20 6e6f  y.        0 = no
+000181e0: 2074 6572 7261 696e 2066 696c 6520 7072   terrain file pr
+000181f0: 6f76 6964 6564 2c20 5155 4943 2d46 6972  ovided, QUIC-Fir
+00018200: 6520 6973 2072 756e 2077 6974 6820 666c  e is run with fl
+00018210: 6174 2074 6572 7261 696e 0a20 2020 2020  at terrain.     
+00018220: 2020 2031 203d 2047 6175 7373 6961 6e20     1 = Gaussian 
+00018230: 6869 6c6c 0a20 2020 2020 2020 2032 203d  hill.        2 =
+00018240: 2068 696c 6c20 7061 7373 0a20 2020 2020   hill pass.     
+00018250: 2020 2033 203d 2073 6c6f 7065 206d 6573     3 = slope mes
+00018260: 610a 2020 2020 2020 2020 3420 3d20 6361  a.        4 = ca
+00018270: 6e79 6f6e 0a20 2020 2020 2020 2035 203d  nyon.        5 =
+00018280: 2063 7573 746f 6d0a 2020 2020 2020 2020   custom.        
+00018290: 3620 3d20 6861 6c66 2063 6972 636c 650a  6 = half circle.
+000182a0: 2020 2020 2020 2020 3720 3d20 7369 6e75          7 = sinu
+000182b0: 736f 6964 0a20 2020 2020 2020 2038 203d  soid.        8 =
+000182c0: 2063 6f73 2068 696c 6c0a 2020 2020 2020   cos hill.      
+000182d0: 2020 3920 3d20 7465 7272 6169 6e20 6973    9 = terrain is
+000182e0: 2070 726f 7669 6465 6420 7669 6120 5150   provided via QP
+000182f0: 5f65 6c65 7661 7469 6f6e 2e62 696e 2028  _elevation.bin (
+00018300: 7365 6520 5365 6374 696f 6e20 322e 3729  see Section 2.7)
+00018310: 0a20 2020 2020 2020 2031 3020 3d20 7465  .        10 = te
+00018320: 7272 6169 6e20 6973 2070 726f 7669 6465  rrain is provide
+00018330: 6420 7669 6120 7465 7272 6169 6e4f 7574  d via terrainOut
+00018340: 7075 742e 7478 740a 2020 2020 2020 2020  put.txt.        
+00018350: 3131 203d 2074 6572 7261 696e 2e64 6174  11 = terrain.dat
+00018360: 2028 6669 7265 7465 6329 0a20 2020 2073   (firetec).    s
+00018370: 6d6f 6f74 6869 6e67 5f6d 6574 686f 6420  moothing_method 
+00018380: 3a20 4c69 7465 7261 6c5b 302c 2031 2c20  : Literal[0, 1, 
+00018390: 325d 0a20 2020 2020 2020 2030 203d 206e  2].        0 = n
+000183a0: 6f6e 6520 2864 6566 6175 6c74 2066 6f72  one (default for
+000183b0: 2069 6465 616c 697a 6564 2074 6f70 6f29   idealized topo)
+000183c0: 0a20 2020 2020 2020 2031 203d 2042 6c75  .        1 = Blu
+000183d0: 720a 2020 2020 2020 2020 3220 3d20 4461  r.        2 = Da
+000183e0: 7669 6420 526f 6269 6e73 6f6e e280 9973  vid Robinson...s
+000183f0: 206d 6574 686f 6420 6261 7365 6420 6f6e   method based on
+00018400: 2073 6563 6f6e 6420 6465 7269 7661 7469   second derivati
+00018410: 7665 0a20 2020 2073 6d6f 6f74 6869 6e67  ve.    smoothing
+00018420: 5f70 6173 7365 7320 3a20 4e6f 6e4e 6567  _passes : NonNeg
+00018430: 6174 6976 6549 6e74 0a20 2020 2020 2020  ativeInt.       
+00018440: 204e 756d 6265 7220 6f66 2073 6d6f 6f74   Number of smoot
+00018450: 6869 6e67 2070 6173 7365 732e 2052 6561  hing passes. Rea
+00018460: 6c20 7465 7272 6169 6e20 4d55 5354 2062  l terrain MUST b
+00018470: 6520 736d 6f6f 7468 6564 0a20 2020 2073  e smoothed.    s
+00018480: 6f72 5f69 7465 7261 7469 6f6e 7320 3a20  or_iterations : 
+00018490: 506f 7369 7469 7665 496e 740a 2020 2020  PositiveInt.    
+000184a0: 2020 2020 4e75 6d62 6572 206f 6620 534f      Number of SO
+000184b0: 5220 6974 6572 6174 696f 6e20 746f 2064  R iteration to d
+000184c0: 6566 696e 6520 6261 636b 6772 6f75 6e64  efine background
+000184d0: 2077 696e 6473 2062 6566 6f72 6520 7374   winds before st
+000184e0: 6172 7469 6e67 2074 6865 2066 6972 650a  arting the fire.
+000184f0: 2020 2020 736f 725f 6379 636c 6573 203a      sor_cycles :
+00018500: 204c 6974 6572 616c 5b30 2c20 312c 2032   Literal[0, 1, 2
+00018510: 2c20 332c 2034 5d0a 2020 2020 2020 2020  , 3, 4].        
+00018520: 4e75 6d62 6572 206f 6620 7469 6d65 7320  Number of times 
+00018530: 7468 6520 534f 5220 736f 6c76 6572 2069  the SOR solver i
+00018540: 6e69 7469 616c 2066 6965 6c64 7320 6973  nitial fields is
+00018550: 2072 6573 6574 2074 6f20 6465 6669 6e65   reset to define
+00018560: 0a20 2020 2020 2020 2062 6163 6b67 726f  .        backgro
+00018570: 756e 6420 7769 6e64 7320 6265 666f 7265  und winds before
+00018580: 2073 7461 7274 696e 6720 7468 6520 6669   starting the fi
+00018590: 7265 0a20 2020 2073 6f72 5f72 656c 6178  re.    sor_relax
+000185a0: 203a 2050 6f73 6974 6976 6546 6c6f 6174   : PositiveFloat
+000185b0: 0a20 2020 2020 2020 2053 4f52 206f 7665  .        SOR ove
+000185c0: 7272 656c 6178 6174 696f 6e20 636f 6566  rrelaxation coef
+000185d0: 6669 6369 656e 742e 204f 6e6c 7920 7573  ficient. Only us
+000185e0: 6564 2069 6620 7468 6572 6520 6973 2074  ed if there is t
+000185f0: 6f70 6f2e 0a20 2020 2022 2222 0a0a 2020  opo..    """..  
+00018600: 2020 6e61 6d65 3a20 7374 7220 3d20 2251    name: str = "Q
+00018610: 555f 546f 706f 496e 7075 7473 220a 2020  U_TopoInputs".  
+00018620: 2020 5f65 7874 656e 7369 6f6e 3a20 7374    _extension: st
+00018630: 7220 3d20 222e 696e 7022 0a20 2020 2066  r = ".inp".    f
+00018640: 696c 656e 616d 653a 2073 7472 203d 2022  ilename: str = "
+00018650: 746f 706f 2e64 6174 220a 2020 2020 746f  topo.dat".    to
+00018660: 706f 6772 6170 6879 3a20 5365 7269 616c  pography: Serial
+00018670: 697a 6541 7341 6e79 5b54 6f70 6f67 7261  izeAsAny[Topogra
+00018680: 7068 795d 203d 2054 6f70 6f67 7261 7068  phy] = Topograph
+00018690: 7928 746f 706f 5f66 6c61 673d 546f 706f  y(topo_flag=Topo
+000186a0: 466c 6167 7328 3029 290a 2020 2020 736d  Flags(0)).    sm
+000186b0: 6f6f 7468 696e 675f 6d65 7468 6f64 3a20  oothing_method: 
+000186c0: 4c69 7465 7261 6c5b 302c 2031 2c20 325d  Literal[0, 1, 2]
+000186d0: 203d 2032 0a20 2020 2073 6d6f 6f74 6869   = 2.    smoothi
+000186e0: 6e67 5f70 6173 7365 733a 204e 6f6e 4e65  ng_passes: NonNe
+000186f0: 6761 7469 7665 496e 7420 3d20 4669 656c  gativeInt = Fiel
+00018700: 6428 6c65 3d35 3030 2c20 6465 6661 756c  d(le=500, defaul
+00018710: 743d 3530 3029 0a20 2020 2073 6f72 5f69  t=500).    sor_i
+00018720: 7465 7261 7469 6f6e 733a 2050 6f73 6974  terations: Posit
+00018730: 6976 6549 6e74 203d 2046 6965 6c64 286c  iveInt = Field(l
+00018740: 653d 3530 302c 2064 6566 6175 6c74 3d32  e=500, default=2
+00018750: 3030 290a 2020 2020 736f 725f 6379 636c  00).    sor_cycl
+00018760: 6573 3a20 4c69 7465 7261 6c5b 302c 2031  es: Literal[0, 1
+00018770: 2c20 322c 2033 2c20 345d 203d 2034 0a20  , 2, 3, 4] = 4. 
+00018780: 2020 2073 6f72 5f72 656c 6178 3a20 506f     sor_relax: Po
+00018790: 7369 7469 7665 466c 6f61 7420 3d20 4669  sitiveFloat = Fi
+000187a0: 656c 6428 6c65 3d32 2c20 6465 6661 756c  eld(le=2, defaul
+000187b0: 743d 302e 3929 0a0a 2020 2020 4063 6f6d  t=0.9)..    @com
+000187c0: 7075 7465 645f 6669 656c 640a 2020 2020  puted_field.    
+000187d0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+000187e0: 6620 5f74 6f70 6f5f 6c69 6e65 7328 7365  f _topo_lines(se
+000187f0: 6c66 2920 2d3e 2073 7472 3a0a 2020 2020  lf) -> str:.    
+00018800: 2020 2020 7265 7475 726e 2073 7472 2873      return str(s
+00018810: 656c 662e 746f 706f 6772 6170 6879 290a  elf.topography).
+00018820: 0a20 2020 2040 636c 6173 736d 6574 686f  .    @classmetho
+00018830: 640a 2020 2020 6465 6620 6672 6f6d 5f64  d.    def from_d
+00018840: 6963 7428 636c 732c 2064 6174 613a 2064  ict(cls, data: d
+00018850: 6963 7429 3a0a 2020 2020 2020 2020 6966  ict):.        if
+00018860: 2022 746f 706f 6772 6170 6879 2220 696e   "topography" in
+00018870: 2064 6174 613a 0a20 2020 2020 2020 2020   data:.         
+00018880: 2020 2064 6174 615b 2274 6f70 6f67 7261     data["topogra
+00018890: 7068 7922 5d20 3d20 7365 7269 616c 697a  phy"] = serializ
+000188a0: 655f 746f 706f 6772 6170 6879 2864 6174  e_topography(dat
+000188b0: 615b 2274 6f70 6f67 7261 7068 7922 5d29  a["topography"])
+000188c0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000188d0: 636c 7328 2a2a 6461 7461 290a 0a20 2020  cls(**data)..   
+000188e0: 2040 636c 6173 736d 6574 686f 640a 2020   @classmethod.  
+000188f0: 2020 6465 6620 6672 6f6d 5f66 696c 6528    def from_file(
+00018900: 636c 732c 2064 6972 6563 746f 7279 3a20  cls, directory: 
+00018910: 7374 7220 7c20 5061 7468 2c20 2a2a 6b77  str | Path, **kw
+00018920: 6172 6773 293a 0a20 2020 2020 2020 2069  args):.        i
+00018930: 6620 6973 696e 7374 616e 6365 2864 6972  f isinstance(dir
+00018940: 6563 746f 7279 2c20 7374 7229 3a0a 2020  ectory, str):.  
+00018950: 2020 2020 2020 2020 2020 6469 7265 6374            direct
+00018960: 6f72 7920 3d20 5061 7468 2864 6972 6563  ory = Path(direc
+00018970: 746f 7279 290a 2020 2020 2020 2020 7769  tory).        wi
+00018980: 7468 206f 7065 6e28 6469 7265 6374 6f72  th open(director
+00018990: 7920 2f20 2251 555f 546f 706f 496e 7075  y / "QU_TopoInpu
+000189a0: 7473 2e69 6e70 222c 2022 7222 2920 6173  ts.inp", "r") as
+000189b0: 2066 3a0a 2020 2020 2020 2020 2020 2020   f:.            
+000189c0: 6c69 6e65 7320 3d20 662e 7265 6164 6c69  lines = f.readli
+000189d0: 6e65 7328 290a 0a20 2020 2020 2020 2074  nes()..        t
+000189e0: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
+000189f0: 2320 4c69 6e65 2030 2069 7320 4865 6164  # Line 0 is Head
+00018a00: 6572 0a20 2020 2020 2020 2020 2020 2066  er.            f
+00018a10: 696c 656e 616d 6520 3d20 7374 7228 6c69  ilename = str(li
+00018a20: 6e65 735b 315d 2e73 7472 6970 2829 290a  nes[1].strip()).
+00018a30: 2020 2020 2020 2020 2020 2020 2320 4765              # Ge
+00018a40: 7420 746f 706f 206c 696e 6573 0a20 2020  t topo lines.   
+00018a50: 2020 2020 2020 2020 2074 6f70 6f5f 666c           topo_fl
+00018a60: 6167 203d 2069 6e74 286c 696e 6573 5b32  ag = int(lines[2
+00018a70: 5d2e 7374 7269 7028 292e 7370 6c69 7428  ].strip().split(
+00018a80: 295b 305d 290a 2020 2020 2020 2020 2020  )[0]).          
+00018a90: 2020 6164 645f 6469 6374 203d 207b 0a20    add_dict = {. 
+00018aa0: 2020 2020 2020 2020 2020 2020 2020 2030                 0
+00018ab0: 3a20 302c 0a20 2020 2020 2020 2020 2020  : 0,.           
+00018ac0: 2020 2020 2031 3a20 342c 0a20 2020 2020       1: 4,.     
+00018ad0: 2020 2020 2020 2020 2020 2032 3a20 322c             2: 2,
+00018ae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018af0: 2033 3a20 332c 0a20 2020 2020 2020 2020   3: 3,.         
+00018b00: 2020 2020 2020 2034 3a20 352c 0a20 2020         4: 5,.   
+00018b10: 2020 2020 2020 2020 2020 2020 2035 3a20               5: 
+00018b20: 302c 0a20 2020 2020 2020 2020 2020 2020  0,.             
+00018b30: 2020 2036 3a20 332c 0a20 2020 2020 2020     6: 3,.       
+00018b40: 2020 2020 2020 2020 2037 3a20 322c 0a20           7: 2,. 
+00018b50: 2020 2020 2020 2020 2020 2020 2020 2038                 8
+00018b60: 3a20 322c 0a20 2020 2020 2020 2020 2020  : 2,.           
+00018b70: 2020 2020 2039 3a20 302c 0a20 2020 2020       9: 0,.     
+00018b80: 2020 2020 2020 2020 2020 2031 303a 2030             10: 0
+00018b90: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00018ba0: 2020 3131 3a20 302c 0a20 2020 2020 2020    11: 0,.       
+00018bb0: 2020 2020 207d 0a20 2020 2020 2020 2020       }.         
+00018bc0: 2020 2061 6464 203d 2061 6464 5f64 6963     add = add_dic
+00018bd0: 742e 6765 7428 746f 706f 5f66 6c61 6729  t.get(topo_flag)
+00018be0: 0a20 2020 2020 2020 2020 2020 2074 6f70  .            top
+00018bf0: 6f5f 7061 7261 6d73 203d 205b 5d0a 2020  o_params = [].  
+00018c00: 2020 2020 2020 2020 2020 666f 7220 6920            for i 
+00018c10: 696e 2072 616e 6765 2833 2c20 3320 2b20  in range(3, 3 + 
+00018c20: 6164 6429 3a0a 2020 2020 2020 2020 2020  add):.          
+00018c30: 2020 2020 2020 746f 706f 5f70 6172 616d        topo_param
+00018c40: 732e 6170 7065 6e64 2866 6c6f 6174 286c  s.append(float(l
+00018c50: 696e 6573 5b69 5d2e 7374 7269 7028 292e  ines[i].strip().
+00018c60: 7370 6c69 7428 295b 305d 2929 0a20 2020  split()[0])).   
+00018c70: 2020 2020 2020 2020 2069 6620 746f 706f           if topo
+00018c80: 5f66 6c61 6720 3d3d 2031 3a0a 2020 2020  _flag == 1:.    
+00018c90: 2020 2020 2020 2020 2020 2020 785f 6869              x_hi
+00018ca0: 6c6c 746f 702c 2079 5f68 696c 6c74 6f70  lltop, y_hilltop
+00018cb0: 2c20 656c 6576 6174 696f 6e5f 6d61 782c  , elevation_max,
+00018cc0: 2065 6c65 7661 7469 6f6e 5f73 7464 203d   elevation_std =
+00018cd0: 2074 6f70 6f5f 7061 7261 6d73 0a20 2020   topo_params.   
+00018ce0: 2020 2020 2020 2020 2020 2020 2074 6f70               top
+00018cf0: 6f67 7261 7068 7920 3d20 4761 7573 7369  ography = Gaussi
+00018d00: 616e 4869 6c6c 546f 706f 280a 2020 2020  anHillTopo(.    
+00018d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018d20: 785f 6869 6c6c 746f 703d 696e 7428 785f  x_hilltop=int(x_
+00018d30: 6869 6c6c 746f 7029 2c0a 2020 2020 2020  hilltop),.      
+00018d40: 2020 2020 2020 2020 2020 2020 2020 795f                y_
+00018d50: 6869 6c6c 746f 703d 696e 7428 795f 6869  hilltop=int(y_hi
+00018d60: 6c6c 746f 7029 2c0a 2020 2020 2020 2020  lltop),.        
+00018d70: 2020 2020 2020 2020 2020 2020 656c 6576              elev
+00018d80: 6174 696f 6e5f 6d61 783d 696e 7428 656c  ation_max=int(el
+00018d90: 6576 6174 696f 6e5f 6d61 7829 2c0a 2020  evation_max),.  
+00018da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018db0: 2020 656c 6576 6174 696f 6e5f 7374 643d    elevation_std=
+00018dc0: 656c 6576 6174 696f 6e5f 7374 642c 0a20  elevation_std,. 
+00018dd0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00018de0: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+00018df0: 6620 746f 706f 5f66 6c61 6720 3d3d 2032  f topo_flag == 2
+00018e00: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00018e10: 2020 6d61 785f 6865 6967 6874 2c20 6c6f    max_height, lo
+00018e20: 6361 7469 6f6e 5f70 6172 616d 203d 2074  cation_param = t
+00018e30: 6f70 6f5f 7061 7261 6d73 0a20 2020 2020  opo_params.     
+00018e40: 2020 2020 2020 2020 2020 2074 6f70 6f67             topog
+00018e50: 7261 7068 7920 3d20 4869 6c6c 5061 7373  raphy = HillPass
+00018e60: 546f 706f 280a 2020 2020 2020 2020 2020  Topo(.          
+00018e70: 2020 2020 2020 2020 2020 6d61 785f 6865            max_he
+00018e80: 6967 6874 3d69 6e74 286d 6178 5f68 6569  ight=int(max_hei
+00018e90: 6768 7429 2c20 6c6f 6361 7469 6f6e 5f70  ght), location_p
+00018ea0: 6172 616d 3d6c 6f63 6174 696f 6e5f 7061  aram=location_pa
+00018eb0: 7261 6d0a 2020 2020 2020 2020 2020 2020  ram.            
+00018ec0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+00018ed0: 2020 656c 6966 2074 6f70 6f5f 666c 6167    elif topo_flag
+00018ee0: 203d 3d20 333a 0a20 2020 2020 2020 2020   == 3:.         
+00018ef0: 2020 2020 2020 2073 6c6f 7065 5f61 7869         slope_axi
+00018f00: 732c 2073 6c6f 7065 5f76 616c 7565 2c20  s, slope_value, 
+00018f10: 666c 6174 5f66 7261 6374 696f 6e20 3d20  flat_fraction = 
+00018f20: 746f 706f 5f70 6172 616d 730a 2020 2020  topo_params.    
+00018f30: 2020 2020 2020 2020 2020 2020 746f 706f              topo
+00018f40: 6772 6170 6879 203d 2053 6c6f 7065 4d65  graphy = SlopeMe
+00018f50: 7361 546f 706f 280a 2020 2020 2020 2020  saTopo(.        
+00018f60: 2020 2020 2020 2020 2020 2020 736c 6f70              slop
+00018f70: 655f 6178 6973 3d69 6e74 2873 6c6f 7065  e_axis=int(slope
+00018f80: 5f61 7869 7329 2c0a 2020 2020 2020 2020  _axis),.        
+00018f90: 2020 2020 2020 2020 2020 2020 736c 6f70              slop
+00018fa0: 655f 7661 6c75 653d 736c 6f70 655f 7661  e_value=slope_va
+00018fb0: 6c75 652c 0a20 2020 2020 2020 2020 2020  lue,.           
+00018fc0: 2020 2020 2020 2020 2066 6c61 745f 6672           flat_fr
+00018fd0: 6163 7469 6f6e 3d66 6c61 745f 6672 6163  action=flat_frac
+00018fe0: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
+00018ff0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00019000: 2020 2020 656c 6966 2074 6f70 6f5f 666c      elif topo_fl
+00019010: 6167 203d 3d20 343a 0a20 2020 2020 2020  ag == 4:.       
+00019020: 2020 2020 2020 2020 2028 0a20 2020 2020           (.     
+00019030: 2020 2020 2020 2020 2020 2020 2020 2078                 x
+00019040: 5f73 7461 7274 2c0a 2020 2020 2020 2020  _start,.        
+00019050: 2020 2020 2020 2020 2020 2020 795f 6365              y_ce
+00019060: 6e74 6572 2c0a 2020 2020 2020 2020 2020  nter,.          
+00019070: 2020 2020 2020 2020 2020 736c 6f70 655f            slope_
+00019080: 7661 6c75 652c 0a20 2020 2020 2020 2020  value,.         
+00019090: 2020 2020 2020 2020 2020 2063 616e 796f             canyo
+000190a0: 6e5f 7374 642c 0a20 2020 2020 2020 2020  n_std,.         
+000190b0: 2020 2020 2020 2020 2020 2076 6572 7469             verti
+000190c0: 6361 6c5f 6f66 6673 6574 2c0a 2020 2020  cal_offset,.    
+000190d0: 2020 2020 2020 2020 2020 2020 2920 3d20              ) = 
+000190e0: 746f 706f 5f70 6172 616d 730a 2020 2020  topo_params.    
+000190f0: 2020 2020 2020 2020 2020 2020 746f 706f              topo
+00019100: 6772 6170 6879 203d 2043 616e 796f 6e54  graphy = CanyonT
+00019110: 6f70 6f28 0a20 2020 2020 2020 2020 2020  opo(.           
+00019120: 2020 2020 2020 2020 2078 5f6c 6f63 6174           x_locat
+00019130: 696f 6e3d 696e 7428 785f 7374 6172 7429  ion=int(x_start)
+00019140: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00019150: 2020 2020 2020 795f 6c6f 6361 7469 6f6e        y_location
+00019160: 3d69 6e74 2879 5f63 656e 7465 7229 2c0a  =int(y_center),.
+00019170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019180: 2020 2020 736c 6f70 655f 7661 6c75 653d      slope_value=
+00019190: 736c 6f70 655f 7661 6c75 652c 0a20 2020  slope_value,.   
+000191a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000191b0: 2063 616e 796f 6e5f 7374 643d 6361 6e79   canyon_std=cany
+000191c0: 6f6e 5f73 7464 2c0a 2020 2020 2020 2020  on_std,.        
+000191d0: 2020 2020 2020 2020 2020 2020 7665 7274              vert
+000191e0: 6963 616c 5f6f 6666 7365 743d 7665 7274  ical_offset=vert
+000191f0: 6963 616c 5f6f 6666 7365 742c 0a20 2020  ical_offset,.   
+00019200: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+00019210: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+00019220: 746f 706f 5f66 6c61 6720 3d3d 2036 3a0a  topo_flag == 6:.
+00019230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019240: 785f 6c6f 6361 7469 6f6e 2c20 795f 6c6f  x_location, y_lo
+00019250: 6361 7469 6f6e 2c20 7261 6469 7573 203d  cation, radius =
+00019260: 2074 6f70 6f5f 7061 7261 6d73 0a20 2020   topo_params.   
+00019270: 2020 2020 2020 2020 2020 2020 2074 6f70               top
+00019280: 6f67 7261 7068 7920 3d20 4861 6c66 4369  ography = HalfCi
+00019290: 7263 6c65 546f 706f 280a 2020 2020 2020  rcleTopo(.      
+000192a0: 2020 2020 2020 2020 2020 2020 2020 785f                x_
+000192b0: 6c6f 6361 7469 6f6e 3d69 6e74 2878 5f6c  location=int(x_l
+000192c0: 6f63 6174 696f 6e29 2c0a 2020 2020 2020  ocation),.      
+000192d0: 2020 2020 2020 2020 2020 2020 2020 795f                y_
+000192e0: 6c6f 6361 7469 6f6e 3d69 6e74 2879 5f6c  location=int(y_l
+000192f0: 6f63 6174 696f 6e29 2c0a 2020 2020 2020  ocation),.      
+00019300: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+00019310: 6469 7573 3d72 6164 6975 732c 0a20 2020  dius=radius,.   
+00019320: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+00019330: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+00019340: 746f 706f 5f66 6c61 6720 3d3d 2037 3a0a  topo_flag == 7:.
+00019350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019360: 7065 7269 6f64 2c20 616d 706c 6974 7564  period, amplitud
+00019370: 6520 3d20 746f 706f 5f70 6172 616d 730a  e = topo_params.
+00019380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019390: 746f 706f 6772 6170 6879 203d 2053 696e  topography = Sin
+000193a0: 7573 6f69 6454 6f70 6f28 7065 7269 6f64  usoidTopo(period
+000193b0: 3d70 6572 696f 642c 2061 6d70 6c69 7475  =period, amplitu
+000193c0: 6465 3d61 6d70 6c69 7475 6465 290a 2020  de=amplitude).  
+000193d0: 2020 2020 2020 2020 2020 656c 6966 2074            elif t
+000193e0: 6f70 6f5f 666c 6167 203d 3d20 383a 0a20  opo_flag == 8:. 
+000193f0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00019400: 7370 6563 742c 2068 6569 6768 7420 3d20  spect, height = 
+00019410: 746f 706f 5f70 6172 616d 730a 2020 2020  topo_params.    
+00019420: 2020 2020 2020 2020 2020 2020 746f 706f              topo
+00019430: 6772 6170 6879 203d 2043 6f73 4869 6c6c  graphy = CosHill
+00019440: 546f 706f 2861 7370 6563 743d 6173 7065  Topo(aspect=aspe
+00019450: 6374 2c20 6865 6967 6874 3d68 6569 6768  ct, height=heigh
+00019460: 7429 0a20 2020 2020 2020 2020 2020 2065  t).            e
+00019470: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00019480: 2020 2020 2074 6f70 6f67 7261 7068 7920       topography 
+00019490: 3d20 546f 706f 6772 6170 6879 2874 6f70  = Topography(top
+000194a0: 6f5f 666c 6167 3d74 6f70 6f5f 666c 6167  o_flag=topo_flag
+000194b0: 290a 2020 2020 2020 2020 2020 2020 6375  ).            cu
+000194c0: 7272 656e 745f 6c69 6e65 203d 2033 202b  rrent_line = 3 +
+000194d0: 2061 6464 0a20 2020 2020 2020 2020 2020   add.           
+000194e0: 2023 2053 6d6f 6f74 6869 6e67 2061 6e64   # Smoothing and
+000194f0: 2053 4f52 0a20 2020 2020 2020 2020 2020   SOR.           
+00019500: 2073 6d6f 6f74 6869 6e67 5f6d 6574 686f   smoothing_metho
+00019510: 6420 3d20 696e 7428 6c69 6e65 735b 6375  d = int(lines[cu
+00019520: 7272 656e 745f 6c69 6e65 5d2e 7374 7269  rrent_line].stri
+00019530: 7028 292e 7370 6c69 7428 295b 305d 290a  p().split()[0]).
+00019540: 2020 2020 2020 2020 2020 2020 736d 6f6f              smoo
+00019550: 7468 696e 675f 7061 7373 6573 203d 2069  thing_passes = i
+00019560: 6e74 286c 696e 6573 5b63 7572 7265 6e74  nt(lines[current
+00019570: 5f6c 696e 6520 2b20 315d 2e73 7472 6970  _line + 1].strip
+00019580: 2829 2e73 706c 6974 2829 5b30 5d29 0a20  ().split()[0]). 
+00019590: 2020 2020 2020 2020 2020 2073 6f72 5f69             sor_i
+000195a0: 7465 7261 7469 6f6e 7320 3d20 696e 7428  terations = int(
+000195b0: 6c69 6e65 735b 6375 7272 656e 745f 6c69  lines[current_li
+000195c0: 6e65 202b 2032 5d2e 7374 7269 7028 292e  ne + 2].strip().
+000195d0: 7370 6c69 7428 295b 305d 290a 2020 2020  split()[0]).    
+000195e0: 2020 2020 2020 2020 736f 725f 6379 636c          sor_cycl
+000195f0: 6573 203d 2069 6e74 286c 696e 6573 5b63  es = int(lines[c
+00019600: 7572 7265 6e74 5f6c 696e 6520 2b20 335d  urrent_line + 3]
+00019610: 2e73 7472 6970 2829 2e73 706c 6974 2829  .strip().split()
+00019620: 5b30 5d29 0a20 2020 2020 2020 2020 2020  [0]).           
+00019630: 2073 6f72 5f72 656c 6178 203d 2066 6c6f   sor_relax = flo
+00019640: 6174 286c 696e 6573 5b63 7572 7265 6e74  at(lines[current
+00019650: 5f6c 696e 6520 2b20 345d 2e73 7472 6970  _line + 4].strip
+00019660: 2829 2e73 706c 6974 2829 5b30 5d29 0a20  ().split()[0]). 
+00019670: 2020 2020 2020 2065 7863 6570 7420 496e         except In
+00019680: 6465 7845 7272 6f72 3a0a 2020 2020 2020  dexError:.      
+00019690: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+000196a0: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
+000196b0: 2020 2020 2020 2020 6622 4572 726f 7220          f"Error 
+000196c0: 7061 7273 696e 6720 7b63 6c73 2e5f 5f6e  parsing {cls.__n
+000196d0: 616d 655f 5f7d 2066 726f 6d20 6669 6c65  ame__} from file
+000196e0: 3a20 5155 5f54 6f70 6f49 6e70 7574 732e  : QU_TopoInputs.
+000196f0: 696e 7022 0a20 2020 2020 2020 2020 2020  inp".           
+00019700: 2020 2020 2066 225c 6e50 6c65 6173 6520       f"\nPlease 
+00019710: 6368 6563 6b20 7468 6520 6669 6c65 2066  check the file f
+00019720: 6f72 2063 6f72 7265 6374 6e65 7373 2e22  or correctness."
+00019730: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+00019740: 2020 2020 2020 2020 7265 7475 726e 2063          return c
+00019750: 6c73 280a 2020 2020 2020 2020 2020 2020  ls(.            
+00019760: 6669 6c65 6e61 6d65 3d66 696c 656e 616d  filename=filenam
+00019770: 652c 0a20 2020 2020 2020 2020 2020 2074  e,.            t
+00019780: 6f70 6f67 7261 7068 793d 746f 706f 6772  opography=topogr
+00019790: 6170 6879 2c0a 2020 2020 2020 2020 2020  aphy,.          
+000197a0: 2020 736d 6f6f 7468 696e 675f 6d65 7468    smoothing_meth
+000197b0: 6f64 3d73 6d6f 6f74 6869 6e67 5f6d 6574  od=smoothing_met
+000197c0: 686f 642c 0a20 2020 2020 2020 2020 2020  hod,.           
+000197d0: 2073 6d6f 6f74 6869 6e67 5f70 6173 7365   smoothing_passe
+000197e0: 733d 736d 6f6f 7468 696e 675f 7061 7373  s=smoothing_pass
+000197f0: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
+00019800: 736f 725f 6974 6572 6174 696f 6e73 3d73  sor_iterations=s
+00019810: 6f72 5f69 7465 7261 7469 6f6e 732c 0a20  or_iterations,. 
+00019820: 2020 2020 2020 2020 2020 2073 6f72 5f63             sor_c
+00019830: 7963 6c65 733d 736f 725f 6379 636c 6573  ycles=sor_cycles
+00019840: 2c0a 2020 2020 2020 2020 2020 2020 736f  ,.            so
+00019850: 725f 7265 6c61 783d 736f 725f 7265 6c61  r_relax=sor_rela
+00019860: 782c 0a20 2020 2020 2020 2029 0a0a 0a63  x,.        )...c
+00019870: 6c61 7373 2052 756e 7469 6d65 4164 7661  lass RuntimeAdva
+00019880: 6e63 6564 5573 6572 496e 7075 7473 2849  ncedUserInputs(I
+00019890: 6e70 7574 4669 6c65 293a 0a20 2020 2022  nputFile):.    "
+000198a0: 2222 0a20 2020 2043 6c61 7373 2072 6570  "".    Class rep
+000198b0: 7265 7365 6e74 696e 6720 7468 6520 5275  resenting the Ru
+000198c0: 6e74 696d 655f 4164 7661 6e63 6564 5f55  ntime_Advanced_U
+000198d0: 7365 725f 496e 7075 7473 2e69 6e70 2069  ser_Inputs.inp i
+000198e0: 6e70 7574 2066 696c 652e 0a20 2020 2054  nput file..    T
+000198f0: 6869 7320 6669 6c65 2063 6f6e 7461 696e  his file contain
+00019900: 7320 6164 7661 6e63 6564 2070 6172 616d  s advanced param
+00019910: 6574 6572 7320 7265 6c61 7465 6420 746f  eters related to
+00019920: 2063 6f6d 7075 7465 7220 6d65 6d6f 7279   computer memory
+00019930: 2075 7361 6765 2e0a 0a20 2020 2041 7474   usage...    Att
+00019940: 7269 6275 7465 730a 2020 2020 2d2d 2d2d  ributes.    ----
+00019950: 2d2d 2d2d 2d2d 0a20 2020 206e 756d 5f63  ------.    num_c
+00019960: 7075 7320 3a20 506f 7369 7469 7665 496e  pus : PositiveIn
+00019970: 740a 2020 2020 2020 2020 4d61 7869 6d75  t.        Maximu
+00019980: 6d20 6e75 6d62 6572 206f 6620 4350 5520  m number of CPU 
+00019990: 746f 2075 7365 2e20 446f 206e 6f74 2065  to use. Do not e
+000199a0: 7863 6565 6420 382e 2055 7365 2031 2066  xceed 8. Use 1 f
+000199b0: 6f72 2065 6e73 656d 626c 650a 2020 2020  or ensemble.    
+000199c0: 2020 2020 7369 6d75 6c61 7469 6f6e 732e      simulations.
+000199d0: 2044 6566 6175 6c74 7320 746f 2031 2e0a   Defaults to 1..
+000199e0: 2020 2020 7573 655f 6163 7720 3a20 4c69      use_acw : Li
+000199f0: 7465 7261 6c5b 302c 315d 0a20 2020 2020  teral[0,1].     
+00019a00: 2020 2055 7365 2041 6461 7074 6976 6520     Use Adaptive 
+00019a10: 436f 6d70 7574 6174 696f 6e20 5769 6e64  Computation Wind
+00019a20: 6f77 2028 303d 4469 7361 626c 6564 2031  ow (0=Disabled 1
+00019a30: 3d45 6e61 626c 6564 292e 2044 6566 6175  =Enabled). Defau
+00019a40: 6c74 7320 746f 2030 2e0a 2020 2020 2222  lts to 0..    ""
+00019a50: 220a 0a20 2020 206e 616d 653a 2073 7472  "..    name: str
+00019a60: 203d 2022 5275 6e74 696d 655f 4164 7661   = "Runtime_Adva
+00019a70: 6e63 6564 5f55 7365 725f 496e 7075 7473  nced_User_Inputs
+00019a80: 220a 2020 2020 5f65 7874 656e 7369 6f6e  ".    _extension
+00019a90: 3a20 7374 7220 3d20 222e 696e 7022 0a20  : str = ".inp". 
+00019aa0: 2020 206e 756d 5f63 7075 733a 2050 6f73     num_cpus: Pos
+00019ab0: 6974 6976 6549 6e74 203d 2046 6965 6c64  itiveInt = Field
+00019ac0: 286c 653d 382c 2064 6566 6175 6c74 3d31  (le=8, default=1
+00019ad0: 290a 2020 2020 7573 655f 6163 773a 204c  ).    use_acw: L
+00019ae0: 6974 6572 616c 5b30 2c20 315d 203d 2030  iteral[0, 1] = 0
+00019af0: 0a0a 2020 2020 4063 6c61 7373 6d65 7468  ..    @classmeth
+00019b00: 6f64 0a20 2020 2064 6566 2066 726f 6d5f  od.    def from_
+00019b10: 6669 6c65 2863 6c73 2c20 6469 7265 6374  file(cls, direct
+00019b20: 6f72 793a 2073 7472 207c 2050 6174 682c  ory: str | Path,
+00019b30: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
+00019b40: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00019b50: 6528 6469 7265 6374 6f72 792c 2073 7472  e(directory, str
+00019b60: 293a 0a20 2020 2020 2020 2020 2020 2064  ):.            d
+00019b70: 6972 6563 746f 7279 203d 2050 6174 6828  irectory = Path(
+00019b80: 6469 7265 6374 6f72 7929 0a20 2020 2020  directory).     
+00019b90: 2020 2077 6974 6820 6f70 656e 2864 6972     with open(dir
+00019ba0: 6563 746f 7279 202f 2022 5275 6e74 696d  ectory / "Runtim
+00019bb0: 655f 4164 7661 6e63 6564 5f55 7365 725f  e_Advanced_User_
+00019bc0: 496e 7075 7473 2e69 6e70 222c 2022 7222  Inputs.inp", "r"
+00019bd0: 2920 6173 2066 3a0a 2020 2020 2020 2020  ) as f:.        
+00019be0: 2020 2020 6c69 6e65 7320 3d20 662e 7265      lines = f.re
+00019bf0: 6164 6c69 6e65 7328 290a 2020 2020 2020  adlines().      
+00019c00: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
+00019c10: 2020 2072 6574 7572 6e20 636c 7328 0a20     return cls(. 
+00019c20: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00019c30: 756d 5f63 7075 733d 696e 7428 6c69 6e65  um_cpus=int(line
+00019c40: 735b 305d 2e73 7472 6970 2829 2e73 706c  s[0].strip().spl
+00019c50: 6974 2829 5b30 5d29 2c0a 2020 2020 2020  it()[0]),.      
+00019c60: 2020 2020 2020 2020 2020 7573 655f 6163            use_ac
+00019c70: 773d 696e 7428 6c69 6e65 735b 315d 2e73  w=int(lines[1].s
+00019c80: 7472 6970 2829 2e73 706c 6974 2829 5b30  trip().split()[0
+00019c90: 5d29 2c0a 2020 2020 2020 2020 2020 2020  ]),.            
+00019ca0: 290a 2020 2020 2020 2020 6578 6365 7074  ).        except
+00019cb0: 2049 6e64 6578 4572 726f 723a 0a20 2020   IndexError:.   
+00019cc0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+00019cd0: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
+00019ce0: 2020 2020 2020 2020 2020 2066 2245 7272             f"Err
+00019cf0: 6f72 2070 6172 7369 6e67 207b 636c 732e  or parsing {cls.
+00019d00: 5f5f 6e61 6d65 5f5f 7d20 6672 6f6d 2066  __name__} from f
+00019d10: 696c 653a 2052 756e 7469 6d65 5f41 6476  ile: Runtime_Adv
+00019d20: 616e 6365 645f 5573 6572 5f49 6e70 7574  anced_User_Input
+00019d30: 732e 696e 7022 0a20 2020 2020 2020 2020  s.inp".         
+00019d40: 2020 2020 2020 2066 225c 6e50 6c65 6173         f"\nPleas
+00019d50: 6520 6368 6563 6b20 7468 6520 6669 6c65  e check the file
+00019d60: 2066 6f72 2063 6f72 7265 6374 6e65 7373   for correctness
+00019d70: 2e22 0a20 2020 2020 2020 2020 2020 2029  .".            )
+00019d80: 0a0a 0a63 6c61 7373 2051 555f 6d6f 7669  ...class QU_movi
+00019d90: 6e67 636f 6f72 6473 2849 6e70 7574 4669  ngcoords(InputFi
+00019da0: 6c65 293a 0a20 2020 2022 2222 0a20 2020  le):.    """.   
+00019db0: 2043 6c61 7373 2072 6570 7265 7365 6e74   Class represent
+00019dc0: 696e 6720 7468 6520 5155 5f6d 6f76 696e  ing the QU_movin
+00019dd0: 6763 6f6f 7264 732e 696e 7020 696e 7075  gcoords.inp inpu
+00019de0: 7420 6669 6c65 2e0a 2020 2020 5468 6973  t file..    This
+00019df0: 2069 7320 6120 5155 4943 206c 6567 6163   is a QUIC legac
+00019e00: 7920 6669 6c65 2074 6861 7420 6973 206e  y file that is n
+00019e10: 6f74 206d 6f64 6966 6965 6420 666f 7220  ot modified for 
+00019e20: 5155 4943 2d46 6972 6520 7573 652e 0a20  QUIC-Fire use.. 
+00019e30: 2020 2022 2222 0a0a 2020 2020 6e61 6d65     """..    name
+00019e40: 3a20 7374 7220 3d20 2251 555f 6d6f 7669  : str = "QU_movi
+00019e50: 6e67 636f 6f72 6473 220a 2020 2020 5f65  ngcoords".    _e
+00019e60: 7874 656e 7369 6f6e 3a20 7374 7220 3d20  xtension: str = 
+00019e70: 222e 696e 7022 0a0a 0a63 6c61 7373 2051  ".inp"...class Q
+00019e80: 505f 6275 696c 646f 7574 2849 6e70 7574  P_buildout(Input
+00019e90: 4669 6c65 293a 0a20 2020 2022 2222 0a20  File):.    """. 
+00019ea0: 2020 2043 6c61 7373 2072 6570 7265 7365     Class represe
+00019eb0: 6e74 696e 6720 7468 6520 5155 5f62 7569  nting the QU_bui
+00019ec0: 6c64 6f75 742e 696e 7020 696e 7075 7420  ldout.inp input 
+00019ed0: 6669 6c65 2e0a 2020 2020 5468 6973 2069  file..    This i
+00019ee0: 7320 6120 5155 4943 206c 6567 6163 7920  s a QUIC legacy 
+00019ef0: 6669 6c65 2074 6861 7420 6973 206e 6f74  file that is not
+00019f00: 206d 6f64 6966 6965 6420 666f 7220 5155   modified for QU
+00019f10: 4943 2d46 6972 6520 7573 652e 0a20 2020  IC-Fire use..   
+00019f20: 2022 2222 0a0a 2020 2020 6e61 6d65 3a20   """..    name: 
+00019f30: 7374 7220 3d20 2251 505f 6275 696c 646f  str = "QP_buildo
+00019f40: 7574 220a 2020 2020 5f65 7874 656e 7369  ut".    _extensi
+00019f50: 6f6e 3a20 7374 7220 3d20 222e 696e 7022  on: str = ".inp"
+00019f60: 0a0a 0a63 6c61 7373 2051 555f 6d65 7470  ...class QU_metp
+00019f70: 6172 616d 7328 496e 7075 7446 696c 6529  arams(InputFile)
+00019f80: 3a0a 2020 2020 2222 220a 2020 2020 436c  :.    """.    Cl
+00019f90: 6173 7320 7265 7072 6573 656e 7469 6e67  ass representing
+00019fa0: 2074 6865 2051 555f 6d65 7470 6172 616d   the QU_metparam
+00019fb0: 732e 696e 7020 696e 7075 7420 6669 6c65  s.inp input file
+00019fc0: 2e0a 2020 2020 5468 6973 2066 696c 6520  ..    This file 
+00019fd0: 636f 6e74 6169 6e73 2069 6e66 6f72 6d61  contains informa
+00019fe0: 7469 6f6e 2061 626f 7574 2077 696e 6420  tion about wind 
+00019ff0: 7072 6f66 696c 6573 0a0a 2020 2020 4174  profiles..    At
+0001a000: 7472 6962 7574 6573 0a20 2020 202d 2d2d  tributes.    ---
+0001a010: 2d2d 2d2d 2d2d 2d0a 2020 2020 6e75 6d5f  -------.    num_
+0001a020: 7365 6e73 6f72 7320 3a20 696e 740a 2020  sensors : int.  
+0001a030: 2020 2020 2020 4e75 6d62 6572 206f 6620        Number of 
+0001a040: 6d65 6173 7572 696e 6720 7369 7465 732e  measuring sites.
+0001a050: 204d 756c 7469 706c 6520 7769 6e64 2070   Multiple wind p
+0001a060: 726f 6669 6c65 7320 6172 6520 6e6f 7420  rofiles are not 
+0001a070: 7965 7420 7375 7070 6f72 7465 642e 0a20  yet supported.. 
+0001a080: 2020 2073 656e 736f 725f 6e61 6d65 203a     sensor_name :
+0001a090: 2073 7472 0a20 2020 2020 2020 204e 616d   str.        Nam
+0001a0a0: 6520 6f66 2074 6865 2077 696e 6420 7072  e of the wind pr
+0001a0b0: 6f66 696c 652e 2054 6869 7320 7769 6c6c  ofile. This will
+0001a0c0: 2063 6f72 7265 7370 6f6e 6420 746f 2074   correspond to t
+0001a0d0: 6865 2066 696c 656e 616d 6520 6f66 2074  he filename of t
+0001a0e0: 6865 2077 696e 6420 7072 6f66 696c 652c  he wind profile,
+0001a0f0: 2065 2e67 2e20 7365 6e73 6f72 312e 696e   e.g. sensor1.in
+0001a100: 700a 2020 2020 2222 220a 0a20 2020 206e  p.    """..    n
+0001a110: 616d 653a 2073 7472 203d 2022 5155 5f6d  ame: str = "QU_m
+0001a120: 6574 7061 7261 6d73 220a 2020 2020 5f65  etparams".    _e
+0001a130: 7874 656e 7369 6f6e 3a20 7374 7220 3d20  xtension: str = 
+0001a140: 222e 696e 7022 0a20 2020 206e 756d 5f73  ".inp".    num_s
+0001a150: 656e 736f 7273 3a20 506f 7369 7469 7665  ensors: Positive
+0001a160: 496e 7420 3d20 310a 0a20 2020 2040 636f  Int = 1..    @co
+0001a170: 6d70 7574 6564 5f66 6965 6c64 0a20 2020  mputed_field.   
+0001a180: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+0001a190: 6566 205f 7365 6e73 6f72 5f6c 696e 6573  ef _sensor_lines
+0001a1a0: 2873 656c 6629 202d 3e20 7374 723a 0a20  (self) -> str:. 
+0001a1b0: 2020 2020 2020 2073 656e 736f 725f 6c69         sensor_li
+0001a1c0: 6e65 7320 3d20 5b5d 0a20 2020 2020 2020  nes = [].       
+0001a1d0: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
+0001a1e0: 312c 2073 656c 662e 6e75 6d5f 7365 6e73  1, self.num_sens
+0001a1f0: 6f72 7320 2b20 3129 3a0a 2020 2020 2020  ors + 1):.      
+0001a200: 2020 2020 2020 7365 6e73 6f72 5f6c 696e        sensor_lin
+0001a210: 6573 2e61 7070 656e 6428 0a20 2020 2020  es.append(.     
+0001a220: 2020 2020 2020 2020 2020 2066 2273 656e             f"sen
+0001a230: 736f 727b 7374 7228 6929 7d20 2153 6974  sor{str(i)} !Sit
+0001a240: 6520 4e61 6d65 5c6e 2220 6622 2146 696c  e Name\n" f"!Fil
+0001a250: 6520 6e61 6d65 5c6e 2220 6622 7365 6e73  e name\n" f"sens
+0001a260: 6f72 7b73 7472 2869 297d 2e69 6e70 220a  or{str(i)}.inp".
+0001a270: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0001a280: 2020 2020 2020 7265 7475 726e 2022 5c6e        return "\n
+0001a290: 222e 6a6f 696e 2873 656e 736f 725f 6c69  ".join(sensor_li
+0001a2a0: 6e65 7329 0a0a 2020 2020 4063 6c61 7373  nes)..    @class
+0001a2b0: 6d65 7468 6f64 0a20 2020 2064 6566 2066  method.    def f
+0001a2c0: 726f 6d5f 6669 6c65 2863 6c73 2c20 6469  rom_file(cls, di
+0001a2d0: 7265 6374 6f72 793a 2073 7472 207c 2050  rectory: str | P
+0001a2e0: 6174 682c 202a 2a6b 7761 7267 7329 3a0a  ath, **kwargs):.
+0001a2f0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+0001a300: 7461 6e63 6528 6469 7265 6374 6f72 792c  tance(directory,
+0001a310: 2073 7472 293a 0a20 2020 2020 2020 2020   str):.         
+0001a320: 2020 2064 6972 6563 746f 7279 203d 2050     directory = P
+0001a330: 6174 6828 6469 7265 6374 6f72 7929 0a20  ath(directory). 
+0001a340: 2020 2020 2020 2077 6974 6820 6f70 656e         with open
+0001a350: 2864 6972 6563 746f 7279 202f 2022 5155  (directory / "QU
+0001a360: 5f6d 6574 7061 7261 6d73 2e69 6e70 222c  _metparams.inp",
+0001a370: 2022 7222 2920 6173 2066 3a0a 2020 2020   "r") as f:.    
+0001a380: 2020 2020 2020 2020 6c69 6e65 7320 3d20          lines = 
+0001a390: 662e 7265 6164 6c69 6e65 7328 290a 2020  f.readlines().  
+0001a3a0: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
+0001a3b0: 2020 2020 2020 2073 656e 736f 725f 6e61         sensor_na
+0001a3c0: 6d65 203d 2073 7472 286c 696e 6573 5b34  me = str(lines[4
+0001a3d0: 5d2e 7374 7269 7028 292e 7370 6c69 7428  ].strip().split(
+0001a3e0: 295b 305d 2e73 7472 6970 2829 290a 2020  )[0].strip()).  
+0001a3f0: 2020 2020 2020 2020 2020 6966 2073 656e            if sen
+0001a400: 736f 725f 6e61 6d65 2021 3d20 2273 656e  sor_name != "sen
+0001a410: 736f 7231 223a 0a20 2020 2020 2020 2020  sor1":.         
+0001a420: 2020 2020 2020 2070 7269 6e74 280a 2020         print(.  
+0001a430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a440: 2020 6622 5741 524e 494e 473a 2077 696e    f"WARNING: win
+0001a450: 6420 7365 6e73 6f72 2066 696c 6573 206d  d sensor files m
+0001a460: 7573 7420 6265 206e 616d 6564 2027 7365  ust be named 'se
+0001a470: 6e73 6f72 2a2e 696e 7027 5c6e 220a 2020  nsor*.inp'\n".  
+0001a480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a490: 2020 6622 4375 7272 656e 7420 7365 6e73    f"Current sens
+0001a4a0: 6f72 206e 616d 6520 3d20 7b73 656e 736f  or name = {senso
+0001a4b0: 725f 6e61 6d65 7d22 0a20 2020 2020 2020  r_name}".       
+0001a4c0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0001a4d0: 2020 2020 2020 2072 6574 7572 6e20 636c         return cl
+0001a4e0: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
+0001a4f0: 2020 206e 756d 5f73 656e 736f 7273 3d69     num_sensors=i
+0001a500: 6e74 286c 696e 6573 5b32 5d2e 7374 7269  nt(lines[2].stri
+0001a510: 7028 292e 7370 6c69 7428 295b 305d 292c  p().split()[0]),
+0001a520: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+0001a530: 2020 2020 2020 2065 7863 6570 7420 496e         except In
+0001a540: 6465 7845 7272 6f72 3a0a 2020 2020 2020  dexError:.      
+0001a550: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+0001a560: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
+0001a570: 2020 2020 2020 2020 6622 4572 726f 7220          f"Error 
+0001a580: 7061 7273 696e 6720 7b63 6c73 2e5f 5f6e  parsing {cls.__n
+0001a590: 616d 655f 5f7d 2066 726f 6d20 6669 6c65  ame__} from file
+0001a5a0: 3a20 5155 5f6d 6574 7061 7261 6d73 2e69  : QU_metparams.i
+0001a5b0: 6e70 220a 2020 2020 2020 2020 2020 2020  np".            
+0001a5c0: 2020 2020 6622 5c6e 506c 6561 7365 2063      f"\nPlease c
+0001a5d0: 6865 636b 2074 6865 2066 696c 6520 666f  heck the file fo
+0001a5e0: 7220 636f 7272 6563 746e 6573 732e 220a  r correctness.".
+0001a5f0: 2020 2020 2020 2020 2020 2020 290a 0a0a              )...
+0001a600: 636c 6173 7320 5769 6e64 5365 6e73 6f72  class WindSensor
+0001a610: 2842 6173 654d 6f64 656c 2c20 7661 6c69  (BaseModel, vali
+0001a620: 6461 7465 5f61 7373 6967 6e6d 656e 743d  date_assignment=
+0001a630: 5472 7565 293a 0a20 2020 2022 2222 0a20  True):.    """. 
+0001a640: 2020 2043 6c61 7373 2072 6570 7265 7365     Class represe
+0001a650: 6e74 696e 6720 6120 7365 6e73 6f72 2a2e  nting a sensor*.
+0001a660: 696e 7020 696e 7075 7420 6669 6c65 2e0a  inp input file..
+0001a670: 2020 2020 5468 6973 2066 696c 6520 636f      This file co
+0001a680: 6e74 6169 6e73 2069 6e66 6f72 6d61 7469  ntains informati
+0001a690: 6f6e 206f 6e20 7769 6e64 732c 2061 6e64  on on winds, and
+0001a6a0: 2073 6572 7665 7320 6173 2074 6865 0a20   serves as the. 
+0001a6b0: 2020 2070 7269 6d61 7279 2073 6f75 7263     primary sourc
+0001a6c0: 6520 666f 7220 7769 6e64 2073 7065 6564  e for wind speed
+0001a6d0: 2873 2920 616e 6420 6469 7265 6374 696f  (s) and directio
+0001a6e0: 6e28 7329 2e0a 2020 2020 4d75 6c74 6970  n(s)..    Multip
+0001a6f0: 6c65 2073 656e 736f 722a 2e69 6e70 2066  le sensor*.inp f
+0001a700: 696c 6573 206d 6179 2062 6520 6372 6561  iles may be crea
+0001a710: 7465 642e 0a0a 2020 2020 4174 7472 6962  ted...    Attrib
+0001a720: 7574 6573 0a20 2020 202d 2d2d 2d2d 2d2d  utes.    -------
+0001a730: 2d2d 2d0a 2020 2020 7365 6e73 6f72 5f6e  ---.    sensor_n
+0001a740: 756d 6265 7220 3a20 506f 7369 7469 7665  umber : Positive
+0001a750: 496e 740a 2020 2020 2020 2020 4e75 6d62  Int.        Numb
+0001a760: 6572 2072 6570 7265 7365 6e74 696e 6720  er representing 
+0001a770: 7468 6520 7769 6e64 2073 656e 736f 720a  the wind sensor.
+0001a780: 2020 2020 7769 6e64 5f74 696d 6573 203a      wind_times :
+0001a790: 204e 6f6e 4e65 6761 7469 7665 466c 6f61   NonNegativeFloa
+0001a7a0: 7420 7c20 6c69 7374 284e 6f6e 4e65 6761  t | list(NonNega
+0001a7b0: 7469 7665 466c 6f61 7429 0a20 2020 2020  tiveFloat).     
+0001a7c0: 2020 2054 696d 6520 696e 2073 6563 6f6e     Time in secon
+0001a7d0: 6473 2073 696e 6365 2074 6865 2073 7461  ds since the sta
+0001a7e0: 7274 206f 6620 7468 6520 6669 7265 2066  rt of the fire f
+0001a7f0: 6f72 2065 6163 6820 7769 6e64 2073 6869  or each wind shi
+0001a800: 6674 2e0a 2020 2020 2020 2020 4669 7273  ft..        Firs
+0001a810: 7420 7469 6d65 206d 7573 7420 6265 207a  t time must be z
+0001a820: 6572 6f2e 0a20 2020 2077 696e 645f 7370  ero..    wind_sp
+0001a830: 6565 6473 203a 2050 6f73 6974 6976 6546  eeds : PositiveF
+0001a840: 6c6f 6174 207c 206c 6973 7428 506f 7369  loat | list(Posi
+0001a850: 7469 7665 466c 6f61 7429 0a20 2020 2020  tiveFloat).     
+0001a860: 2020 2057 696e 6420 7370 6565 6420 6f72     Wind speed or
+0001a870: 206c 6973 7420 6f66 2077 696e 6420 7370   list of wind sp
+0001a880: 6565 6473 2028 6d2f 7329 0a20 2020 2077  eeds (m/s).    w
+0001a890: 696e 645f 6469 7265 6374 696f 6e73 203a  ind_directions :
+0001a8a0: 204e 6f6e 4e65 6761 7469 7665 496e 7420   NonNegativeInt 
+0001a8b0: 3c20 3336 3020 7c20 6c69 7374 284e 6f6e  < 360 | list(Non
+0001a8c0: 4e65 6761 7469 7665 496e 7420 3c20 3336  NegativeInt < 36
+0001a8d0: 3029 0a20 2020 2020 2020 2057 696e 6420  0).        Wind 
+0001a8e0: 6469 7265 6374 696f 6e20 6f72 206c 6973  direction or lis
+0001a8f0: 7420 6f66 2064 6972 6563 7469 6f6e 7320  t of directions 
+0001a900: 2864 6567 7265 6573 292e 2055 7365 2030  (degrees). Use 0
+0001a910: c2b0 2066 6f72 204e 6f72 7468 0a20 2020  .. for North.   
+0001a920: 2073 656e 736f 725f 6865 6967 6874 203a   sensor_height :
+0001a930: 2050 6f73 6974 6976 6546 6c6f 6174 0a20   PositiveFloat. 
+0001a940: 2020 2020 2020 2057 696e 6420 6d65 6173         Wind meas
+0001a950: 7572 656d 656e 7420 6865 6967 6874 2028  urement height (
+0001a960: 6d29 2e20 4465 6661 756c 7420 6973 2036  m). Default is 6
+0001a970: 2e31 6d20 2832 3066 7429 0a20 2020 2078  .1m (20ft).    x
+0001a980: 5f6c 6f63 6174 696f 6e20 3a20 506f 7369  _location : Posi
+0001a990: 7469 7665 496e 740a 2020 2020 2020 2020  tiveInt.        
+0001a9a0: 4c6f 6361 7469 6f6e 206f 6620 7468 6520  Location of the 
+0001a9b0: 7365 6e73 6f72 2069 6e20 7468 6520 782d  sensor in the x-
+0001a9c0: 6469 7265 6374 696f 6e0a 2020 2020 795f  direction.    y_
+0001a9d0: 6c6f 6361 7469 6f6e 203a 2050 6f73 6974  location : Posit
+0001a9e0: 6976 6549 6e74 0a20 2020 2020 2020 204c  iveInt.        L
+0001a9f0: 6f63 6174 696f 6e20 6f66 2074 6865 2073  ocation of the s
+0001aa00: 656e 736f 7220 696e 2074 6865 2079 2d64  ensor in the y-d
+0001aa10: 6972 6563 7469 6f6e 0a20 2020 2022 2222  irection.    """
+0001aa20: 0a0a 2020 2020 6e61 6d65 3a20 7374 720a  ..    name: str.
+0001aa30: 2020 2020 5f65 7874 656e 7369 6f6e 3a20      _extension: 
+0001aa40: 7374 7220 3d20 222e 696e 7022 0a20 2020  str = ".inp".   
+0001aa50: 2077 696e 645f 7469 6d65 733a 2055 6e69   wind_times: Uni
+0001aa60: 6f6e 5b4e 6f6e 4e65 6761 7469 7665 466c  on[NonNegativeFl
+0001aa70: 6f61 742c 204c 6973 745b 4e6f 6e4e 6567  oat, List[NonNeg
+0001aa80: 6174 6976 6546 6c6f 6174 5d5d 203d 2030  ativeFloat]] = 0
+0001aa90: 0a20 2020 2077 696e 645f 7370 6565 6473  .    wind_speeds
+0001aaa0: 3a20 556e 696f 6e5b 506f 7369 7469 7665  : Union[Positive
+0001aab0: 466c 6f61 742c 204c 6973 745b 506f 7369  Float, List[Posi
+0001aac0: 7469 7665 466c 6f61 745d 5d0a 2020 2020  tiveFloat]].    
+0001aad0: 7769 6e64 5f64 6972 6563 7469 6f6e 733a  wind_directions:
+0001aae0: 2055 6e69 6f6e 5b4e 6f6e 4e65 6761 7469   Union[NonNegati
+0001aaf0: 7665 496e 742c 204c 6973 745b 4e6f 6e4e  veInt, List[NonN
+0001ab00: 6567 6174 6976 6549 6e74 5d5d 0a20 2020  egativeInt]].   
+0001ab10: 2073 656e 736f 725f 6865 6967 6874 3a20   sensor_height: 
+0001ab20: 506f 7369 7469 7665 466c 6f61 7420 3d20  PositiveFloat = 
+0001ab30: 362e 310a 2020 2020 785f 6c6f 6361 7469  6.1.    x_locati
+0001ab40: 6f6e 3a20 506f 7369 7469 7665 496e 7420  on: PositiveInt 
+0001ab50: 3d20 310a 2020 2020 795f 6c6f 6361 7469  = 1.    y_locati
+0001ab60: 6f6e 3a20 506f 7369 7469 7665 496e 7420  on: PositiveInt 
+0001ab70: 3d20 310a 0a20 2020 2040 6669 656c 645f  = 1..    @field_
+0001ab80: 7661 6c69 6461 746f 7228 2277 696e 645f  validator("wind_
+0001ab90: 7469 6d65 7322 2c20 6d6f 6465 3d22 6265  times", mode="be
+0001aba0: 666f 7265 2229 0a20 2020 2040 636c 6173  fore").    @clas
+0001abb0: 736d 6574 686f 640a 2020 2020 6465 6620  smethod.    def 
+0001abc0: 7661 6c69 6461 7465 5f77 696e 645f 7469  validate_wind_ti
+0001abd0: 6d65 7328 636c 732c 2076 3a20 6c69 7374  mes(cls, v: list
+0001abe0: 2c20 7661 6c75 6573 2920 2d3e 206c 6973  , values) -> lis
+0001abf0: 743a 0a20 2020 2020 2020 2069 6620 6973  t:.        if is
+0001ac00: 696e 7374 616e 6365 2876 2c20 2866 6c6f  instance(v, (flo
+0001ac10: 6174 2c20 696e 7429 293a 0a20 2020 2020  at, int)):.     
+0001ac20: 2020 2020 2020 2076 203d 205b 765d 0a20         v = [v]. 
+0001ac30: 2020 2020 2020 2069 6620 765b 305d 2021         if v[0] !
+0001ac40: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
+0001ac50: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+0001ac60: 7228 2277 696e 645f 7469 6d65 733a 2066  r("wind_times: f
+0001ac70: 6972 7374 2065 6c65 6d65 6e74 206f 6620  irst element of 
+0001ac80: 7365 6e73 6f72 2e77 696e 645f 7469 6d65  sensor.wind_time
+0001ac90: 7320 6d75 7374 2062 6520 3022 290a 2020  s must be 0").  
+0001aca0: 2020 2020 2020 7265 7475 726e 2076 0a0a        return v..
+0001acb0: 2020 2020 4066 6965 6c64 5f76 616c 6964      @field_valid
+0001acc0: 6174 6f72 2822 7769 6e64 5f73 7065 6564  ator("wind_speed
+0001acd0: 7322 2c20 2277 696e 645f 6469 7265 6374  s", "wind_direct
+0001ace0: 696f 6e73 2229 0a20 2020 2040 636c 6173  ions").    @clas
+0001acf0: 736d 6574 686f 640a 2020 2020 6465 6620  smethod.    def 
+0001ad00: 7661 6c69 6461 7465 5f77 696e 645f 6c69  validate_wind_li
+0001ad10: 7374 7328 636c 732c 2076 2c20 7661 6c75  sts(cls, v, valu
+0001ad20: 6573 2920 2d3e 206c 6973 743a 0a20 2020  es) -> list:.   
+0001ad30: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+0001ad40: 6365 2876 2c20 2866 6c6f 6174 2c20 696e  ce(v, (float, in
+0001ad50: 7429 293a 0a20 2020 2020 2020 2020 2020  t)):.           
+0001ad60: 2076 203d 205b 765d 0a20 2020 2020 2020   v = [v].       
+0001ad70: 2069 6620 7620 616e 6420 6c65 6e28 7661   if v and len(va
+0001ad80: 6c75 6573 2e64 6174 615b 2277 696e 645f  lues.data["wind_
+0001ad90: 7469 6d65 7322 5d29 2021 3d20 6c65 6e28  times"]) != len(
+0001ada0: 7629 3a0a 2020 2020 2020 2020 2020 2020  v):.            
+0001adb0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+0001adc0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0001add0: 2020 2257 696e 6453 656e 736f 723a 206c    "WindSensor: l
+0001ade0: 6973 7473 206f 6620 7769 6e64 2074 696d  ists of wind tim
+0001adf0: 6573 2c20 7370 6565 6473 2c20 616e 6420  es, speeds, and 
+0001ae00: 6469 7265 6374 696f 6e73 206d 7573 7420  directions must 
+0001ae10: 6265 2074 6865 2073 616d 6520 6c65 6e67  be the same leng
+0001ae20: 7468 2e5c 6e22 0a20 2020 2020 2020 2020  th.\n".         
+0001ae30: 2020 2029 0a20 2020 2020 2020 2072 6574     ).        ret
+0001ae40: 7572 6e20 760a 0a20 2020 2040 7072 6f70  urn v..    @prop
+0001ae50: 6572 7479 0a20 2020 2064 6566 205f 6669  erty.    def _fi
+0001ae60: 6c65 6e61 6d65 2873 656c 6629 3a0a 2020  lename(self):.  
+0001ae70: 2020 2020 2020 7265 7475 726e 2066 227b        return f"{
+0001ae80: 7365 6c66 2e6e 616d 657d 7b73 656c 662e  self.name}{self.
+0001ae90: 5f65 7874 656e 7369 6f6e 7d22 0a0a 2020  _extension}"..  
+0001aea0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+0001aeb0: 6465 6620 646f 6375 6d65 6e74 6174 696f  def documentatio
+0001aec0: 6e5f 6469 6374 2873 656c 6629 202d 3e20  n_dict(self) -> 
+0001aed0: 6469 6374 3a0a 2020 2020 2020 2020 2320  dict:.        # 
+0001aee0: 5265 7475 726e 2074 6865 2064 6f63 756d  Return the docum
+0001aef0: 656e 7461 7469 6f6e 2064 6963 7469 6f6e  entation diction
+0001af00: 6172 790a 2020 2020 2020 2020 7769 7468  ary.        with
+0001af10: 206f 7065 6e28 444f 4353 5f50 4154 4820   open(DOCS_PATH 
+0001af20: 2f20 6622 7b73 656c 662e 5f66 696c 656e  / f"{self._filen
+0001af30: 616d 657d 2e6a 736f 6e22 2c20 2272 2229  ame}.json", "r")
+0001af40: 2061 7320 663a 0a20 2020 2020 2020 2020   as f:.         
+0001af50: 2020 2072 6574 7572 6e20 6a73 6f6e 2e6c     return json.l
+0001af60: 6f61 6428 6629 0a0a 2020 2020 6465 6620  oad(f)..    def 
+0001af70: 5f66 696e 645f 7461 7267 6574 5f74 696d  _find_target_tim
+0001af80: 655f 696e 6465 7828 7365 6c66 2c20 7461  e_index(self, ta
+0001af90: 7267 6574 5f76 616c 7565 293a 0a20 2020  rget_value):.   
+0001afa0: 2020 2020 2069 6e64 6578 203d 2062 6973       index = bis
+0001afb0: 6563 742e 6269 7365 6374 5f6c 6566 7428  ect.bisect_left(
+0001afc0: 7365 6c66 2e77 696e 645f 7469 6d65 732c  self.wind_times,
+0001afd0: 2074 6172 6765 745f 7661 6c75 6529 0a20   target_value). 
+0001afe0: 2020 2020 2020 2069 6620 7461 7267 6574         if target
+0001aff0: 5f76 616c 7565 206e 6f74 2069 6e20 7365  _value not in se
+0001b000: 6c66 2e77 696e 645f 7469 6d65 733a 0a20  lf.wind_times:. 
+0001b010: 2020 2020 2020 2020 2020 2069 6e64 6578             index
+0001b020: 203d 2069 6e64 6578 202d 2031 0a20 2020   = index - 1.   
+0001b030: 2020 2020 2072 6574 7572 6e20 696e 6465       return inde
+0001b040: 780a 0a20 2020 2064 6566 2067 6574 5f77  x..    def get_w
+0001b050: 696e 645f 6c69 6e65 7328 7365 6c66 2c20  ind_lines(self, 
+0001b060: 676c 6f62 616c 5f74 696d 6573 2c20 7469  global_times, ti
+0001b070: 6d65 5f6e 6f77 2920 2d3e 2073 7472 3a0a  me_now) -> str:.
+0001b080: 2020 2020 2020 2020 6c6f 6361 7469 6f6e          location
+0001b090: 5f6c 696e 6573 203d 2028 0a20 2020 2020  _lines = (.     
+0001b0a0: 2020 2020 2020 2066 227b 7365 6c66 2e78         f"{self.x
+0001b0b0: 5f6c 6f63 6174 696f 6e7d 2021 5820 636f  _location} !X co
+0001b0c0: 6f72 6469 6e61 7465 2028 6d65 7465 7273  ordinate (meters
+0001b0d0: 295c 6e22 0a20 2020 2020 2020 2020 2020  )\n".           
+0001b0e0: 2066 227b 7365 6c66 2e79 5f6c 6f63 6174   f"{self.y_locat
+0001b0f0: 696f 6e7d 2021 5920 636f 6f72 6469 6e61  ion} !Y coordina
+0001b100: 7465 2028 6d65 7465 7273 2922 0a20 2020  te (meters)".   
+0001b110: 2020 2020 2029 0a20 2020 2020 2020 2077       ).        w
+0001b120: 696e 6473 6869 6674 7320 3d20 5b5d 0a20  indshifts = []. 
+0001b130: 2020 2020 2020 2066 6f72 2077 696e 645f         for wind_
+0001b140: 7469 6d65 2069 6e20 676c 6f62 616c 5f74  time in global_t
+0001b150: 696d 6573 3a0a 2020 2020 2020 2020 2020  imes:.          
+0001b160: 2020 7469 6d65 5f69 6478 203d 2073 656c    time_idx = sel
+0001b170: 662e 5f66 696e 645f 7461 7267 6574 5f74  f._find_target_t
+0001b180: 696d 655f 696e 6465 7828 7769 6e64 5f74  ime_index(wind_t
+0001b190: 696d 6529 0a20 2020 2020 2020 2020 2020  ime).           
+0001b1a0: 2077 696e 645f 7370 6565 6420 3d20 7365   wind_speed = se
+0001b1b0: 6c66 2e77 696e 645f 7370 6565 6473 5b74  lf.wind_speeds[t
+0001b1c0: 696d 655f 6964 785d 0a20 2020 2020 2020  ime_idx].       
+0001b1d0: 2020 2020 2077 696e 645f 6469 7265 6374       wind_direct
+0001b1e0: 696f 6e20 3d20 7365 6c66 2e77 696e 645f  ion = self.wind_
+0001b1f0: 6469 7265 6374 696f 6e73 5b74 696d 655f  directions[time_
+0001b200: 6964 785d 0a20 2020 2020 2020 2020 2020  idx].           
+0001b210: 2073 6869 6674 203d 2028 0a20 2020 2020   shift = (.     
+0001b220: 2020 2020 2020 2020 2020 2066 225c 6e7b             f"\n{
+0001b230: 7469 6d65 5f6e 6f77 202b 2077 696e 645f  time_now + wind_
+0001b240: 7469 6d65 7d20 2142 6567 696e 696e 6720  time} !Begining 
+0001b250: 6f66 2074 696d 6520 7374 6570 2069 6e20  of time step in 
+0001b260: 556e 6978 2045 706f 6368 2074 696d 6520  Unix Epoch time 
+0001b270: 2869 6e74 6567 6572 2073 6563 6f6e 6473  (integer seconds
+0001b280: 2073 696e 6365 2031 3937 302f 312f 3120   since 1970/1/1 
+0001b290: 3030 3a30 303a 3030 295c 6e22 0a20 2020  00:00:00)\n".   
+0001b2a0: 2020 2020 2020 2020 2020 2020 2066 2231               f"1
+0001b2b0: 2021 7369 7465 2062 6f75 6e64 6172 7920   !site boundary 
+0001b2c0: 6c61 7965 7220 666c 6167 2028 3120 3d20  layer flag (1 = 
+0001b2d0: 6c6f 672c 2032 203d 2065 7870 2c20 3320  log, 2 = exp, 3 
+0001b2e0: 3d20 7572 6261 6e20 6361 6e6f 7079 2c20  = urban canopy, 
+0001b2f0: 3420 3d20 6469 7363 7265 7465 2064 6174  4 = discrete dat
+0001b300: 6120 706f 696e 7473 295c 6e22 0a20 2020  a points)\n".   
+0001b310: 2020 2020 2020 2020 2020 2020 2066 2230               f"0
+0001b320: 2e31 2021 7369 7465 207a 6f5c 6e22 0a20  .1 !site zo\n". 
+0001b330: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0001b340: 2230 2e20 2120 312f 4c20 2864 6566 6175  "0. ! 1/L (defau
+0001b350: 6c74 203d 2030 295c 6e22 0a20 2020 2020  lt = 0)\n".     
+0001b360: 2020 2020 2020 2020 2020 2066 2221 4865             f"!He
+0001b370: 6967 6874 2028 6d29 2c20 5370 6565 6420  ight (m), Speed 
+0001b380: 286d 2f73 292c 2044 6972 6563 7469 6f6e  (m/s), Direction
+0001b390: 2028 6465 6720 7265 6c61 7469 7665 2074   (deg relative t
+0001b3a0: 6f20 7472 7565 204e 295c 6e22 0a20 2020  o true N)\n".   
+0001b3b0: 2020 2020 2020 2020 2020 2020 2066 227b               f"{
+0001b3c0: 7365 6c66 2e73 656e 736f 725f 6865 6967  self.sensor_heig
+0001b3d0: 6874 7d20 7b77 696e 645f 7370 6565 647d  ht} {wind_speed}
+0001b3e0: 207b 7769 6e64 5f64 6972 6563 7469 6f6e   {wind_direction
+0001b3f0: 7d22 0a20 2020 2020 2020 2020 2020 2029  }".            )
+0001b400: 0a20 2020 2020 2020 2020 2020 2077 696e  .            win
+0001b410: 6473 6869 6674 732e 6170 7065 6e64 2873  dshifts.append(s
+0001b420: 6869 6674 290a 2020 2020 2020 2020 7769  hift).        wi
+0001b430: 6e64 5f6c 696e 6573 203d 2022 222e 6a6f  nd_lines = "".jo
+0001b440: 696e 2877 696e 6473 6869 6674 7329 0a0a  in(windshifts)..
+0001b450: 2020 2020 2020 2020 7265 7475 726e 206c          return l
+0001b460: 6f63 6174 696f 6e5f 6c69 6e65 7320 2b20  ocation_lines + 
+0001b470: 7769 6e64 5f6c 696e 6573 0a0a 2020 2020  wind_lines..    
+0001b480: 6465 6620 746f 5f66 696c 6528 0a20 2020  def to_file(.   
+0001b490: 2020 2020 2073 656c 662c 2067 6c6f 6261       self, globa
+0001b4a0: 6c5f 7469 6d65 733a 206c 6973 742c 2074  l_times: list, t
+0001b4b0: 696d 655f 6e6f 773a 2069 6e74 2c20 6469  ime_now: int, di
+0001b4c0: 7265 6374 6f72 793a 2050 6174 6820 7c20  rectory: Path | 
+0001b4d0: 7374 722c 2076 6572 7369 6f6e 3a20 7374  str, version: st
+0001b4e0: 720a 2020 2020 293a 0a20 2020 2020 2020  r.    ):.       
+0001b4f0: 2069 6620 6973 696e 7374 616e 6365 2864   if isinstance(d
+0001b500: 6972 6563 746f 7279 2c20 7374 7229 3a0a  irectory, str):.
+0001b510: 2020 2020 2020 2020 2020 2020 6469 7265              dire
+0001b520: 6374 6f72 7920 3d20 5061 7468 2864 6972  ctory = Path(dir
+0001b530: 6563 746f 7279 290a 0a20 2020 2020 2020  ectory)..       
+0001b540: 2076 6572 7369 6f6e 203d 205f 7661 6c69   version = _vali
+0001b550: 6461 7465 5f61 6e64 5f72 6574 7572 6e5f  date_and_return_
+0001b560: 7665 7273 696f 6e28 7665 7273 696f 6e29  version(version)
+0001b570: 0a20 2020 2020 2020 2074 656d 706c 6174  .        templat
+0001b580: 655f 6669 6c65 5f70 6174 6820 3d20 5445  e_file_path = TE
+0001b590: 4d50 4c41 5445 535f 5041 5448 202f 2076  MPLATES_PATH / v
+0001b5a0: 6572 7369 6f6e 202f 2022 7365 6e73 6f72  ersion / "sensor
+0001b5b0: 2e69 6e70 220a 2020 2020 2020 2020 7769  .inp".        wi
+0001b5c0: 7468 206f 7065 6e28 7465 6d70 6c61 7465  th open(template
+0001b5d0: 5f66 696c 655f 7061 7468 2c20 2272 2229  _file_path, "r")
+0001b5e0: 2061 7320 6674 656d 703a 0a20 2020 2020   as ftemp:.     
+0001b5f0: 2020 2020 2020 2073 7263 203d 2054 656d         src = Tem
+0001b600: 706c 6174 6528 6674 656d 702e 7265 6164  plate(ftemp.read
+0001b610: 2829 290a 0a20 2020 2020 2020 2064 6963  ())..        dic
+0001b620: 745f 7265 7072 6573 656e 7461 7469 6f6e  t_representation
+0001b630: 203d 2073 656c 662e 746f 5f64 6963 7428   = self.to_dict(
+0001b640: 696e 636c 7564 655f 7072 6976 6174 653d  include_private=
+0001b650: 5472 7565 290a 2020 2020 2020 2020 6469  True).        di
+0001b660: 6374 5f72 6570 7265 7365 6e74 6174 696f  ct_representatio
+0001b670: 6e5b 225f 7769 6e64 5f6c 696e 6573 225d  n["_wind_lines"]
+0001b680: 203d 2073 656c 662e 6765 745f 7769 6e64   = self.get_wind
+0001b690: 5f6c 696e 6573 2867 6c6f 6261 6c5f 7469  _lines(global_ti
+0001b6a0: 6d65 732c 2074 696d 655f 6e6f 7729 0a20  mes, time_now). 
+0001b6b0: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
+0001b6c0: 7372 632e 7375 6273 7469 7475 7465 2864  src.substitute(d
+0001b6d0: 6963 745f 7265 7072 6573 656e 7461 7469  ict_representati
+0001b6e0: 6f6e 290a 0a20 2020 2020 2020 206f 7574  on)..        out
+0001b6f0: 7075 745f 6669 6c65 5f70 6174 6820 3d20  put_file_path = 
+0001b700: 6469 7265 6374 6f72 7920 2f20 7365 6c66  directory / self
+0001b710: 2e5f 6669 6c65 6e61 6d65 0a20 2020 2020  ._filename.     
+0001b720: 2020 2077 6974 6820 6f70 656e 286f 7574     with open(out
+0001b730: 7075 745f 6669 6c65 5f70 6174 682c 2022  put_file_path, "
+0001b740: 7722 2920 6173 2066 6f75 743a 0a20 2020  w") as fout:.   
+0001b750: 2020 2020 2020 2020 2066 6f75 742e 7772           fout.wr
+0001b760: 6974 6528 7265 7375 6c74 290a 0a20 2020  ite(result)..   
+0001b770: 2040 636c 6173 736d 6574 686f 640a 2020   @classmethod.  
+0001b780: 2020 6465 6620 6672 6f6d 5f66 696c 6528    def from_file(
+0001b790: 636c 732c 2064 6972 6563 746f 7279 3a20  cls, directory: 
+0001b7a0: 7374 7220 7c20 5061 7468 2c20 7365 6e73  str | Path, sens
+0001b7b0: 6f72 5f6e 616d 653a 2073 7472 293a 0a20  or_name: str):. 
+0001b7c0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+0001b7d0: 616e 6365 2864 6972 6563 746f 7279 2c20  ance(directory, 
+0001b7e0: 7374 7229 3a0a 2020 2020 2020 2020 2020  str):.          
+0001b7f0: 2020 6469 7265 6374 6f72 7920 3d20 5061    directory = Pa
+0001b800: 7468 2864 6972 6563 746f 7279 290a 2020  th(directory).  
+0001b810: 2020 2020 2020 7365 6e73 6f72 5f66 696c        sensor_fil
+0001b820: 6520 3d20 7365 6e73 6f72 5f6e 616d 6520  e = sensor_name 
+0001b830: 2b20 222e 696e 7022 0a20 2020 2020 2020  + ".inp".       
+0001b840: 2077 6974 6820 6f70 656e 2864 6972 6563   with open(direc
+0001b850: 746f 7279 202f 2073 656e 736f 725f 6669  tory / sensor_fi
+0001b860: 6c65 2c20 2272 2229 2061 7320 663a 0a20  le, "r") as f:. 
+0001b870: 2020 2020 2020 2020 2020 206c 696e 6573             lines
+0001b880: 203d 2066 2e72 6561 646c 696e 6573 2829   = f.readlines()
+0001b890: 0a20 2020 2020 2020 2077 696e 645f 7469  .        wind_ti
+0001b8a0: 6d65 7320 3d20 5b30 5d0a 2020 2020 2020  mes = [0].      
+0001b8b0: 2020 7769 6e64 5f73 7065 6564 7320 3d20    wind_speeds = 
+0001b8c0: 5b5d 0a20 2020 2020 2020 2077 696e 645f  [].        wind_
+0001b8d0: 6469 7265 6374 696f 6e73 203d 205b 5d0a  directions = [].
+0001b8e0: 0a20 2020 2020 2020 2074 7279 3a0a 2020  .        try:.  
+0001b8f0: 2020 2020 2020 2020 2020 785f 6c6f 6361            x_loca
+0001b900: 7469 6f6e 203d 2069 6e74 286c 696e 6573  tion = int(lines
+0001b910: 5b34 5d2e 7374 7269 7028 292e 7370 6c69  [4].strip().spli
+0001b920: 7428 295b 305d 290a 2020 2020 2020 2020  t()[0]).        
+0001b930: 2020 2020 795f 6c6f 6361 7469 6f6e 203d      y_location =
+0001b940: 2069 6e74 286c 696e 6573 5b35 5d2e 7374   int(lines[5].st
+0001b950: 7269 7028 292e 7370 6c69 7428 295b 305d  rip().split()[0]
+0001b960: 290a 2020 2020 2020 2020 2020 2020 7469  ).            ti
+0001b970: 6d65 5f6e 6f77 203d 2066 6c6f 6174 286c  me_now = float(l
+0001b980: 696e 6573 5b36 5d2e 7374 7269 7028 292e  ines[6].strip().
+0001b990: 7370 6c69 7428 295b 305d 290a 2020 2020  split()[0]).    
+0001b9a0: 2020 2020 2020 2020 7769 6e64 5f6c 696e          wind_lin
+0001b9b0: 6520 3d20 6c69 6e65 735b 3131 5d2e 7374  e = lines[11].st
+0001b9c0: 7269 7028 290a 2020 2020 2020 2020 2020  rip().          
+0001b9d0: 2020 7365 6e73 6f72 5f68 6569 6768 7420    sensor_height 
+0001b9e0: 3d20 666c 6f61 7428 7769 6e64 5f6c 696e  = float(wind_lin
+0001b9f0: 652e 7370 6c69 7428 295b 305d 290a 2020  e.split()[0]).  
+0001ba00: 2020 2020 2020 2020 2020 7769 6e64 5f73            wind_s
+0001ba10: 7065 6564 203d 2066 6c6f 6174 2877 696e  peed = float(win
+0001ba20: 645f 6c69 6e65 2e73 706c 6974 2829 5b31  d_line.split()[1
+0001ba30: 5d29 0a20 2020 2020 2020 2020 2020 2077  ]).            w
+0001ba40: 696e 645f 7370 6565 6473 2e61 7070 656e  ind_speeds.appen
+0001ba50: 6428 7769 6e64 5f73 7065 6564 290a 2020  d(wind_speed).  
+0001ba60: 2020 2020 2020 2020 2020 7769 6e64 5f64            wind_d
+0001ba70: 6972 6563 7469 6f6e 203d 2069 6e74 2877  irection = int(w
+0001ba80: 696e 645f 6c69 6e65 2e73 706c 6974 2829  ind_line.split()
+0001ba90: 5b32 5d29 0a20 2020 2020 2020 2020 2020  [2]).           
+0001baa0: 2077 696e 645f 6469 7265 6374 696f 6e73   wind_directions
+0001bab0: 2e61 7070 656e 6428 7769 6e64 5f64 6972  .append(wind_dir
+0001bac0: 6563 7469 6f6e 290a 2020 2020 2020 2020  ection).        
+0001bad0: 2020 2020 6e65 7874 5f73 6869 6674 203d      next_shift =
+0001bae0: 2031 320a 2020 2020 2020 2020 2020 2020   12.            
+0001baf0: 7768 696c 6520 286e 6578 745f 7368 6966  while (next_shif
+0001bb00: 7420 2b20 3629 203c 3d20 6c65 6e28 6c69  t + 6) <= len(li
+0001bb10: 6e65 7329 3a0a 2020 2020 2020 2020 2020  nes):.          
+0001bb20: 2020 2020 2020 7769 6e64 5f74 696d 655f        wind_time_
+0001bb30: 6c69 6e65 203d 206c 696e 6573 5b6e 6578  line = lines[nex
+0001bb40: 745f 7368 6966 745d 2e73 7472 6970 2829  t_shift].strip()
+0001bb50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001bb60: 2077 696e 645f 7469 6d65 732e 6170 7065   wind_times.appe
+0001bb70: 6e64 2866 6c6f 6174 2877 696e 645f 7469  nd(float(wind_ti
+0001bb80: 6d65 5f6c 696e 652e 7370 6c69 7428 295b  me_line.split()[
+0001bb90: 305d 2920 2d20 7469 6d65 5f6e 6f77 290a  0]) - time_now).
+0001bba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bbb0: 7769 6e64 5f6c 696e 6520 3d20 6c69 6e65  wind_line = line
+0001bbc0: 735b 6e65 7874 5f73 6869 6674 202b 2035  s[next_shift + 5
+0001bbd0: 5d2e 7374 7269 7028 290a 2020 2020 2020  ].strip().      
+0001bbe0: 2020 2020 2020 2020 2020 7769 6e64 5f73            wind_s
+0001bbf0: 7065 6564 732e 6170 7065 6e64 2866 6c6f  peeds.append(flo
+0001bc00: 6174 2877 696e 645f 6c69 6e65 2e73 706c  at(wind_line.spl
+0001bc10: 6974 2829 5b31 5d29 290a 2020 2020 2020  it()[1])).      
+0001bc20: 2020 2020 2020 2020 2020 7769 6e64 5f64            wind_d
+0001bc30: 6972 6563 7469 6f6e 732e 6170 7065 6e64  irections.append
+0001bc40: 2869 6e74 2877 696e 645f 6c69 6e65 2e73  (int(wind_line.s
+0001bc50: 706c 6974 2829 5b32 5d2e 7374 7269 7028  plit()[2].strip(
+0001bc60: 2929 290a 2020 2020 2020 2020 2020 2020  ))).            
+0001bc70: 2020 2020 6e65 7874 5f73 6869 6674 202b      next_shift +
+0001bc80: 3d20 360a 0a20 2020 2020 2020 2065 7863  = 6..        exc
+0001bc90: 6570 7420 496e 6465 7845 7272 6f72 3a0a  ept IndexError:.
+0001bca0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0001bcb0: 6520 5661 6c75 6545 7272 6f72 280a 2020  e ValueError(.  
+0001bcc0: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+0001bcd0: 4572 726f 7220 7061 7273 696e 6720 7b63  Error parsing {c
+0001bce0: 6c73 2e5f 5f6e 616d 655f 5f7d 2066 726f  ls.__name__} fro
+0001bcf0: 6d20 6669 6c65 3a20 7b73 656e 736f 725f  m file: {sensor_
+0001bd00: 6669 6c65 7d22 0a20 2020 2020 2020 2020  file}".         
+0001bd10: 2020 2020 2020 2066 225c 6e50 6c65 6173         f"\nPleas
+0001bd20: 6520 6368 6563 6b20 7468 6520 6669 6c65  e check the file
+0001bd30: 2066 6f72 2063 6f72 7265 6374 6e65 7373   for correctness
+0001bd40: 2e22 0a20 2020 2020 2020 2020 2020 2029  .".            )
+0001bd50: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0001bd60: 2063 6c73 280a 2020 2020 2020 2020 2020   cls(.          
+0001bd70: 2020 6e61 6d65 3d73 656e 736f 725f 6e61    name=sensor_na
+0001bd80: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
+0001bd90: 7365 6e73 6f72 5f68 6569 6768 743d 7365  sensor_height=se
+0001bda0: 6e73 6f72 5f68 6569 6768 742c 0a20 2020  nsor_height,.   
+0001bdb0: 2020 2020 2020 2020 2077 696e 645f 7469           wind_ti
+0001bdc0: 6d65 733d 7769 6e64 5f74 696d 6573 2c0a  mes=wind_times,.
+0001bdd0: 2020 2020 2020 2020 2020 2020 7769 6e64              wind
+0001bde0: 5f73 7065 6564 733d 7769 6e64 5f73 7065  _speeds=wind_spe
+0001bdf0: 6564 732c 0a20 2020 2020 2020 2020 2020  eds,.           
+0001be00: 2077 696e 645f 6469 7265 6374 696f 6e73   wind_directions
+0001be10: 3d77 696e 645f 6469 7265 6374 696f 6e73  =wind_directions
+0001be20: 2c0a 2020 2020 2020 2020 2020 2020 785f  ,.            x_
+0001be30: 6c6f 6361 7469 6f6e 3d78 5f6c 6f63 6174  location=x_locat
+0001be40: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
+0001be50: 2079 5f6c 6f63 6174 696f 6e3d 795f 6c6f   y_location=y_lo
+0001be60: 6361 7469 6f6e 2c0a 2020 2020 2020 2020  cation,.        
+0001be70: 290a 0a20 2020 2040 636c 6173 736d 6574  )..    @classmet
+0001be80: 686f 640a 2020 2020 6465 6620 6672 6f6d  hod.    def from
+0001be90: 5f64 6963 7428 636c 732c 2064 6174 613a  _dict(cls, data:
+0001bea0: 2064 6963 7429 3a0a 2020 2020 2020 2020   dict):.        
+0001beb0: 7265 7475 726e 2063 6c73 282a 2a64 6174  return cls(**dat
+0001bec0: 6129 0a0a 2020 2020 6465 6620 6c69 7374  a)..    def list
+0001bed0: 5f70 6172 616d 6574 6572 7328 7365 6c66  _parameters(self
+0001bee0: 2920 2d3e 206c 6973 745b 7374 725d 3a0a  ) -> list[str]:.
+0001bef0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0001bf00: 2020 2020 4765 7420 6120 6c69 7374 206f      Get a list o
+0001bf10: 6620 7468 6520 6e61 6d65 7320 6f66 2061  f the names of a
+0001bf20: 6c6c 2070 6172 616d 6574 6572 7320 696e  ll parameters in
+0001bf30: 2074 6865 2069 6e70 7574 2066 696c 652e   the input file.
+0001bf40: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0001bf50: 2020 2020 2072 6574 7572 6e20 6c69 7374       return list
+0001bf60: 2873 656c 662e 646f 6375 6d65 6e74 6174  (self.documentat
+0001bf70: 696f 6e5f 6469 6374 2e6b 6579 7328 2929  ion_dict.keys())
+0001bf80: 0a0a 2020 2020 6465 6620 6765 745f 646f  ..    def get_do
+0001bf90: 6375 6d65 6e74 6174 696f 6e28 7365 6c66  cumentation(self
+0001bfa0: 2c20 7061 7261 6d65 7465 723a 2073 7472  , parameter: str
+0001bfb0: 203d 204e 6f6e 6529 202d 3e20 6469 6374   = None) -> dict
+0001bfc0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+0001bfd0: 2020 2020 2020 5265 7472 6965 7665 2064        Retrieve d
+0001bfe0: 6f63 756d 656e 7461 7469 6f6e 2066 6f72  ocumentation for
+0001bff0: 2061 2070 6172 616d 6574 6572 2e20 4966   a parameter. If
+0001c000: 206e 6f20 7061 7261 6d65 7465 7220 6973   no parameter is
+0001c010: 2073 7065 6369 6669 6564 2c0a 2020 2020   specified,.    
+0001c020: 2020 2020 7265 7475 726e 2064 6f63 756d      return docum
+0001c030: 656e 7461 7469 6f6e 2066 6f72 2061 6c6c  entation for all
+0001c040: 2070 6172 616d 6574 6572 732e 0a20 2020   parameters..   
+0001c050: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0001c060: 2069 6620 7061 7261 6d65 7465 723a 0a20   if parameter:. 
+0001c070: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0001c080: 6e20 7365 6c66 2e64 6f63 756d 656e 7461  n self.documenta
+0001c090: 7469 6f6e 5f64 6963 742e 6765 7428 7061  tion_dict.get(pa
+0001c0a0: 7261 6d65 7465 722c 207b 7d29 0a20 2020  rameter, {}).   
+0001c0b0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0001c0c0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0001c0d0: 6c66 2e64 6f63 756d 656e 7461 7469 6f6e  lf.documentation
+0001c0e0: 5f64 6963 740a 0a20 2020 2064 6566 2070  _dict..    def p
+0001c0f0: 7269 6e74 5f64 6f63 756d 656e 7461 7469  rint_documentati
+0001c100: 6f6e 5f74 6162 6c65 2873 656c 662c 2070  on_table(self, p
+0001c110: 6172 616d 6574 6572 3a20 7374 7220 3d20  arameter: str = 
+0001c120: 4e6f 6e65 2920 2d3e 204e 6f6e 653a 0a20  None) -> None:. 
+0001c130: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0001c140: 2020 2050 7269 6e74 2064 6f63 756d 656e     Print documen
+0001c150: 7461 7469 6f6e 2066 6f72 2061 2070 6172  tation for a par
+0001c160: 616d 6574 6572 2e20 4966 206e 6f20 7061  ameter. If no pa
+0001c170: 7261 6d65 7465 7220 6973 2073 7065 6369  rameter is speci
+0001c180: 6669 6564 2c0a 2020 2020 2020 2020 7072  fied,.        pr
+0001c190: 696e 7420 646f 6375 6d65 6e74 6174 696f  int documentatio
+0001c1a0: 6e20 666f 7220 616c 6c20 7061 7261 6d65  n for all parame
+0001c1b0: 7465 7273 2e0a 2020 2020 2020 2020 2222  ters..        ""
+0001c1c0: 220a 2020 2020 2020 2020 6966 2070 6172  ".        if par
+0001c1d0: 616d 6574 6572 3a0a 2020 2020 2020 2020  ameter:.        
+0001c1e0: 2020 2020 696e 666f 203d 2073 656c 662e      info = self.
+0001c1f0: 6765 745f 646f 6375 6d65 6e74 6174 696f  get_documentatio
+0001c200: 6e28 7061 7261 6d65 7465 7229 0a20 2020  n(parameter).   
+0001c210: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0001c220: 2020 2020 2020 2069 6e66 6f20 3d20 7365         info = se
+0001c230: 6c66 2e67 6574 5f64 6f63 756d 656e 7461  lf.get_documenta
+0001c240: 7469 6f6e 2829 0a20 2020 2020 2020 2066  tion().        f
+0001c250: 6f72 206b 6579 2c20 7661 6c75 6520 696e  or key, value in
+0001c260: 2069 6e66 6f2e 6974 656d 7328 293a 0a20   info.items():. 
+0001c270: 2020 2020 2020 2020 2020 206b 6579 203d             key =
+0001c280: 206b 6579 2e72 6570 6c61 6365 2822 5f22   key.replace("_"
+0001c290: 2c20 2220 2229 2e63 6170 6974 616c 697a  , " ").capitaliz
+0001c2a0: 6528 290a 2020 2020 2020 2020 2020 2020  e().            
+0001c2b0: 7072 696e 7428 6622 2d20 7b6b 6579 7d3a  print(f"- {key}:
+0001c2c0: 207b 7661 6c75 657d 2229 0a0a 2020 2020   {value}")..    
+0001c2d0: 6465 6620 746f 5f64 6963 7428 7365 6c66  def to_dict(self
+0001c2e0: 2c20 696e 636c 7564 655f 7072 6976 6174  , include_privat
+0001c2f0: 653a 2062 6f6f 6c20 3d20 4661 6c73 6529  e: bool = False)
+0001c300: 202d 3e20 6469 6374 3a0a 2020 2020 2020   -> dict:.      
+0001c310: 2020 2222 220a 2020 2020 2020 2020 436f    """.        Co
+0001c320: 6e76 6572 7420 7468 6520 6f62 6a65 6374  nvert the object
+0001c330: 2074 6f20 6120 6469 6374 696f 6e61 7279   to a dictionary
+0001c340: 2c20 6578 636c 7564 696e 6720 6174 7472  , excluding attr
+0001c350: 6962 7574 6573 2074 6861 7420 7374 6172  ibutes that star
+0001c360: 740a 2020 2020 2020 2020 7769 7468 2061  t.        with a
+0001c370: 6e20 756e 6465 7273 636f 7265 2e0a 0a20  n underscore... 
+0001c380: 2020 2020 2020 2052 6574 7572 6e73 0a20         Returns. 
+0001c390: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
+0001c3a0: 2020 2020 2020 2064 6963 740a 2020 2020         dict.    
+0001c3b0: 2020 2020 2020 2020 4469 6374 696f 6e61          Dictiona
+0001c3c0: 7279 2072 6570 7265 7365 6e74 6174 696f  ry representatio
+0001c3d0: 6e20 6f66 2074 6865 206f 626a 6563 742e  n of the object.
+0001c3e0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0001c3f0: 2020 2020 2061 6c6c 5f66 6965 6c64 7320       all_fields 
+0001c400: 3d20 7365 6c66 2e6d 6f64 656c 5f64 756d  = self.model_dum
+0001c410: 7028 0a20 2020 2020 2020 2020 2020 2065  p(.            e
+0001c420: 7863 6c75 6465 3d7b 225f 6578 7465 6e73  xclude={"_extens
+0001c430: 696f 6e22 2c20 225f 6669 6c65 6e61 6d65  ion", "_filename
+0001c440: 222c 2022 646f 6375 6d65 6e74 6174 696f  ", "documentatio
+0001c450: 6e5f 6469 6374 227d 0a20 2020 2020 2020  n_dict"}.       
+0001c460: 2029 0a20 2020 2020 2020 2069 6620 696e   ).        if in
+0001c470: 636c 7564 655f 7072 6976 6174 653a 0a20  clude_private:. 
+0001c480: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0001c490: 6e20 616c 6c5f 6669 656c 6473 0a20 2020  n all_fields.   
+0001c4a0: 2020 2020 2072 6574 7572 6e20 7b0a 2020       return {.  
+0001c4b0: 2020 2020 2020 2020 2020 6b65 793a 2076            key: v
+0001c4c0: 616c 7565 2066 6f72 206b 6579 2c20 7661  alue for key, va
+0001c4d0: 6c75 6520 696e 2061 6c6c 5f66 6965 6c64  lue in all_field
+0001c4e0: 732e 6974 656d 7328 2920 6966 206e 6f74  s.items() if not
+0001c4f0: 206b 6579 2e73 7461 7274 7377 6974 6828   key.startswith(
+0001c500: 225f 2229 0a20 2020 2020 2020 207d 0a0a  "_").        }..
+0001c510: 0a63 6c61 7373 2057 696e 6453 656e 736f  .class WindSenso
+0001c520: 7241 7272 6179 2842 6173 654d 6f64 656c  rArray(BaseModel
+0001c530: 293a 0a20 2020 2022 2222 0a20 2020 2043  ):.    """.    C
+0001c540: 6c61 7373 2063 6f6e 7461 696e 696e 6720  lass containing 
+0001c550: 616c 6c20 5769 6e64 5365 6e73 6f72 2069  all WindSensor i
+0001c560: 6e70 7574 2066 696c 6573 2061 6e64 2073  nput files and s
+0001c570: 6861 7265 6420 6174 7472 6962 7574 6573  hared attributes
+0001c580: 2e0a 0a20 2020 2050 6172 616d 6574 6572  ...    Parameter
+0001c590: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
+0001c5a0: 0a20 2020 2074 696d 655f 6e6f 7720 3a20  .    time_now : 
+0001c5b0: 506f 7369 7469 7665 496e 740a 2020 2020  PositiveInt.    
+0001c5c0: 2020 2020 5768 656e 2074 6865 2066 6972      When the fir
+0001c5d0: 6520 6973 2069 676e 6974 6564 2069 6e20  e is ignited in 
+0001c5e0: 556e 6978 2045 706f 6368 2074 696d 6520  Unix Epoch time 
+0001c5f0: 2869 6e74 6567 6572 2073 6563 6f6e 6473  (integer seconds
+0001c600: 2073 696e 6365 0a20 2020 2020 2020 2031   since.        1
+0001c610: 3937 302f 312f 3120 3030 3a30 303a 3030  970/1/1 00:00:00
+0001c620: 292e 204d 7573 7420 6265 2067 7265 6174  ). Must be great
+0001c630: 6572 206f 7220 6571 7561 6c20 746f 2074  er or equal to t
+0001c640: 6865 2074 696d 6520 6f66 2074 6865 2066  he time of the f
+0001c650: 6972 7374 0a20 2020 2020 2020 2077 696e  irst.        win
+0001c660: 640a 2020 2020 7769 6e64 5f74 696d 6573  d.    wind_times
+0001c670: 203a 204e 6f6e 4e65 6761 7469 7665 466c   : NonNegativeFl
+0001c680: 6f61 7420 7c20 6c69 7374 284e 6f6e 4e65  oat | list(NonNe
+0001c690: 6761 7469 7665 466c 6f61 7429 0a20 2020  gativeFloat).   
+0001c6a0: 2020 2020 2054 696d 6520 696e 2073 6563       Time in sec
+0001c6b0: 6f6e 6473 2073 696e 6365 2074 6865 2073  onds since the s
+0001c6c0: 7461 7274 206f 6620 7468 6520 6669 7265  tart of the fire
+0001c6d0: 2066 6f72 2065 6163 6820 7769 6e64 2073   for each wind s
+0001c6e0: 6869 6674 2e0a 2020 2020 2020 2020 4669  hift..        Fi
+0001c6f0: 7273 7420 7469 6d65 206d 7573 7420 6265  rst time must be
+0001c700: 207a 6572 6f2e 0a20 2020 2073 656e 736f   zero..    senso
+0001c710: 725f 6172 7261 7920 3a20 6c69 7374 2857  r_array : list(W
+0001c720: 696e 6453 656e 736f 7229 0a20 2020 2020  indSensor).     
+0001c730: 2020 204c 6973 7420 6f66 2061 6c6c 2057     List of all W
+0001c740: 696e 6453 656e 736f 7220 696e 7075 7420  indSensor input 
+0001c750: 6669 6c65 7320 6d61 6e61 6765 6420 6279  files managed by
+0001c760: 2074 6865 2057 696e 6453 656e 736f 7241   the WindSensorA
+0001c770: 7272 6179 2e0a 0a20 2020 2022 2222 0a0a  rray...    """..
+0001c780: 2020 2020 7365 6e73 6f72 5f61 7272 6179      sensor_array
+0001c790: 3a20 4c69 7374 5b57 696e 6453 656e 736f  : List[WindSenso
+0001c7a0: 725d 203d 205b 5d0a 0a20 2020 2040 636f  r] = []..    @co
+0001c7b0: 6d70 7574 6564 5f66 6965 6c64 0a20 2020  mputed_field.   
+0001c7c0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+0001c7d0: 6566 2077 696e 645f 7469 6d65 7328 7365  ef wind_times(se
+0001c7e0: 6c66 2920 2d3e 206c 6973 743a 0a20 2020  lf) -> list:.   
+0001c7f0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0001c800: 2043 7265 6174 6573 2061 2067 6c6f 6261   Creates a globa
+0001c810: 6c20 7769 6e64 2074 696d 6573 206c 6973  l wind times lis
+0001c820: 7420 6279 2063 6f6d 6269 6e69 6e67 2074  t by combining t
+0001c830: 6865 2077 696e 6420 7469 6d65 7320 6c69  he wind times li
+0001c840: 7374 7320 6f66 2065 6163 6820 7365 6e73  sts of each sens
+0001c850: 6f72 2e0a 2020 2020 2020 2020 2222 220a  or..        """.
+0001c860: 2020 2020 2020 2020 7469 6d65 735f 6c69          times_li
+0001c870: 7374 7320 3d20 5b5d 0a20 2020 2020 2020  sts = [].       
+0001c880: 2066 6f72 2073 656e 736f 7220 696e 2073   for sensor in s
+0001c890: 656c 662e 7365 6e73 6f72 5f61 7272 6179  elf.sensor_array
+0001c8a0: 3a0a 2020 2020 2020 2020 2020 2020 7469  :.            ti
+0001c8b0: 6d65 735f 6c69 7374 732e 6170 7065 6e64  mes_lists.append
+0001c8c0: 2873 656e 736f 722e 7769 6e64 5f74 696d  (sensor.wind_tim
+0001c8d0: 6573 290a 2020 2020 2020 2020 636f 6d62  es).        comb
+0001c8e0: 696e 6564 5f74 696d 6573 203d 2073 6f72  ined_times = sor
+0001c8f0: 7465 6428 0a20 2020 2020 2020 2020 2020  ted(.           
+0001c900: 2073 6574 2876 616c 7565 2066 6f72 2073   set(value for s
+0001c910: 7562 6c69 7374 2069 6e20 7469 6d65 735f  ublist in times_
+0001c920: 6c69 7374 7320 666f 7220 7661 6c75 6520  lists for value 
+0001c930: 696e 2073 7562 6c69 7374 290a 2020 2020  in sublist).    
+0001c940: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
+0001c950: 7475 726e 2063 6f6d 6269 6e65 645f 7469  turn combined_ti
+0001c960: 6d65 730a 0a20 2020 2064 6566 205f 5f6c  mes..    def __l
+0001c970: 656e 5f5f 2873 656c 6629 3a0a 2020 2020  en__(self):.    
+0001c980: 2020 2020 7265 7475 726e 206c 656e 2873      return len(s
+0001c990: 656c 662e 7365 6e73 6f72 5f61 7272 6179  elf.sensor_array
+0001c9a0: 290a 0a20 2020 2064 6566 205f 5f67 6574  )..    def __get
+0001c9b0: 6174 7472 5f5f 2873 656c 662c 206e 616d  attr__(self, nam
+0001c9c0: 6529 3a0a 2020 2020 2020 2020 666f 7220  e):.        for 
+0001c9d0: 7365 6e73 6f72 2069 6e20 7365 6c66 2e73  sensor in self.s
+0001c9e0: 656e 736f 725f 6172 7261 793a 0a20 2020  ensor_array:.   
+0001c9f0: 2020 2020 2020 2020 2069 6620 6e61 6d65           if name
+0001ca00: 203d 3d20 7365 6e73 6f72 2e6e 616d 653a   == sensor.name:
+0001ca10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001ca20: 2072 6574 7572 6e20 7365 6e73 6f72 0a20   return sensor. 
+0001ca30: 2020 2020 2020 2072 6169 7365 2041 7474         raise Att
+0001ca40: 7269 6275 7465 4572 726f 7228 6622 4174  ributeError(f"At
+0001ca50: 7472 6962 7574 6520 7b6e 616d 657d 206e  tribute {name} n
+0001ca60: 6f74 2066 6f75 6e64 2229 0a0a 2020 2020  ot found")..    
+0001ca70: 2320 544f 444f 3a20 6d61 6b65 2073 7572  # TODO: make sur
+0001ca80: 6520 7769 6e64 2073 656e 736f 7273 2064  e wind sensors d
+0001ca90: 6f6e 2774 2067 6574 2070 7574 2069 6e20  on't get put in 
+0001caa0: 7468 6520 7361 6d65 206c 6f63 6174 696f  the same locatio
+0001cab0: 6e3f 0a20 2020 2023 2040 6669 656c 645f  n?.    # @field_
+0001cac0: 7661 6c69 6461 746f 7228 2273 656e 736f  validator("senso
+0001cad0: 725f 6172 7261 7922 290a 2020 2020 2320  r_array").    # 
+0001cae0: 4063 6c61 7373 6d65 7468 6f64 0a20 2020  @classmethod.   
+0001caf0: 2023 2064 6566 2076 616c 6964 6174 655f   # def validate_
+0001cb00: 7365 6e73 6f72 5f6c 6f63 6174 696f 6e28  sensor_location(
+0001cb10: 636c 732c 2076 2c20 7661 6c75 6573 2920  cls, v, values) 
+0001cb20: 2d3e 206c 6973 743a 0a20 2020 2023 2020  -> list:.    #  
+0001cb30: 2020 2073 656e 736f 725f 6469 6374 203d     sensor_dict =
+0001cb40: 207b 7d0a 2020 2020 2320 2020 2020 666f   {}.    #     fo
+0001cb50: 7220 7365 6e73 6f72 2069 6e20 763a 0a20  r sensor in v:. 
+0001cb60: 2020 2023 2020 2020 2020 2020 2073 656e     #         sen
+0001cb70: 736f 725f 6469 6374 5b73 656e 736f 722e  sor_dict[sensor.
+0001cb80: 6e61 6d65 5d20 3d20 5b0a 2020 2020 2320  name] = [.    # 
+0001cb90: 2020 2020 2020 2020 2020 2020 7365 6e73              sens
+0001cba0: 6f72 2e73 656e 736f 725f 6865 6967 6874  or.sensor_height
+0001cbb0: 2c0a 2020 2020 2320 2020 2020 2020 2020  ,.    #         
+0001cbc0: 2020 2020 7365 6e73 6f72 2e78 5f6c 6f63      sensor.x_loc
+0001cbd0: 6174 696f 6e2c 0a20 2020 2023 2020 2020  ation,.    #    
+0001cbe0: 2020 2020 2020 2020 2073 656e 736f 722e           sensor.
+0001cbf0: 795f 6c6f 6361 7469 6f6e 2c0a 2020 2020  y_location,.    
+0001cc00: 2320 2020 2020 2020 2020 5d0a 2020 2020  #         ].    
+0001cc10: 2320 2020 2020 7361 6d65 5f73 6574 203d  #     same_set =
+0001cc20: 2073 6574 2829 0a20 2020 2023 2020 2020   set().    #    
+0001cc30: 2066 6f72 206b 6579 2c20 7661 6c20 696e   for key, val in
+0001cc40: 2073 656e 736f 725f 6469 6374 2e69 7465   sensor_dict.ite
+0001cc50: 6d73 2829 3a0a 2020 2020 2320 2020 2020  ms():.    #     
+0001cc60: 2020 2020 7475 706c 655f 7661 6c20 3d20      tuple_val = 
+0001cc70: 7475 706c 6528 7661 6c29 0a20 2020 2023  tuple(val).    #
+0001cc80: 2020 2020 2020 2020 2069 6620 7475 706c           if tupl
+0001cc90: 655f 7661 6c20 696e 2073 616d 655f 7365  e_val in same_se
+0001cca0: 743a 0a20 2020 2023 2020 2020 2020 2020  t:.    #        
+0001ccb0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+0001ccc0: 4572 726f 7228 0a20 2020 2023 2020 2020  Error(.    #    
+0001ccd0: 2020 2020 2020 2020 2020 2020 2022 5769               "Wi
+0001cce0: 6e64 2073 656e 736f 7273 206d 7573 7420  nd sensors must 
+0001ccf0: 6e6f 7420 6265 2070 6c61 6365 6420 6174  not be placed at
+0001cd00: 2074 6865 2073 616d 6520 6c6f 6361 7469   the same locati
+0001cd10: 6f6e 2061 6e64 2068 6569 6768 7422 0a20  on and height". 
+0001cd20: 2020 2023 2020 2020 2020 2020 2020 2020     #            
+0001cd30: 2029 0a20 2020 2023 2020 2020 2020 2020   ).    #        
+0001cd40: 2073 616d 655f 7365 742e 6164 6428 7475   same_set.add(tu
+0001cd50: 706c 655f 7661 6c29 0a20 2020 2023 2020  ple_val).    #  
+0001cd60: 2020 2072 6574 7572 6e20 760a 0a20 2020     return v..   
+0001cd70: 2064 6566 205f 6669 6e64 5f73 656e 736f   def _find_senso
+0001cd80: 725f 6279 5f6e 616d 6528 7365 6c66 2c20  r_by_name(self, 
+0001cd90: 7365 6e73 6f72 5f6e 616d 653a 2073 7472  sensor_name: str
+0001cda0: 2920 2d3e 2057 696e 6453 656e 736f 7220  ) -> WindSensor 
+0001cdb0: 7c20 4e6f 6e65 3a0a 2020 2020 2020 2020  | None:.        
+0001cdc0: 2222 220a 2020 2020 2020 2020 4669 6e64  """.        Find
+0001cdd0: 2061 6e64 2072 6574 7572 6e20 7365 6e73   and return sens
+0001cde0: 6f72 2062 7920 6e61 6d65 2e20 5265 7475  or by name. Retu
+0001cdf0: 726e 7320 4e6f 6e65 2069 6620 7468 6572  rns None if ther
+0001ce00: 6520 6973 206e 6f20 6d61 7463 6869 6e67  e is no matching
+0001ce10: 2073 656e 736f 7220 6e61 6d65 2e0a 2020   sensor name..  
+0001ce20: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0001ce30: 2020 666f 7220 7365 6e73 6f72 2069 6e20    for sensor in 
+0001ce40: 7365 6c66 2e73 656e 736f 725f 6172 7261  self.sensor_arra
+0001ce50: 793a 0a20 2020 2020 2020 2020 2020 2069  y:.            i
+0001ce60: 6620 7365 6e73 6f72 2e6e 616d 6520 3d3d  f sensor.name ==
+0001ce70: 2073 656e 736f 725f 6e61 6d65 3a0a 2020   sensor_name:.  
+0001ce80: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0001ce90: 7475 726e 2073 656e 736f 720a 2020 2020  turn sensor.    
+0001cea0: 2020 2020 7265 7475 726e 204e 6f6e 650a      return None.
+0001ceb0: 0a20 2020 2040 636c 6173 736d 6574 686f  .    @classmetho
+0001cec0: 640a 2020 2020 6465 6620 6672 6f6d 5f66  d.    def from_f
+0001ced0: 696c 6528 636c 732c 2064 6972 6563 746f  ile(cls, directo
+0001cee0: 7279 3a20 7374 7220 7c20 5061 7468 293a  ry: str | Path):
+0001cef0: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
+0001cf00: 7374 616e 6365 2864 6972 6563 746f 7279  stance(directory
+0001cf10: 2c20 7374 7229 3a0a 2020 2020 2020 2020  , str):.        
+0001cf20: 2020 2020 6469 7265 6374 6f72 7920 3d20      directory = 
+0001cf30: 5061 7468 2864 6972 6563 746f 7279 290a  Path(directory).
+0001cf40: 2020 2020 2020 2020 7365 6e73 6f72 5f61          sensor_a
+0001cf50: 7272 6179 203d 205b 5d0a 2020 2020 2020  rray = [].      
+0001cf60: 2020 2320 6765 7420 6120 6c69 7374 206f    # get a list o
+0001cf70: 6620 616c 6c20 7468 6520 7365 6e73 6f72  f all the sensor
+0001cf80: 2a2e 696e 7020 6669 6c65 7320 7468 6174  *.inp files that
+0001cf90: 206d 6174 6368 2074 6865 2072 6567 756c   match the regul
+0001cfa0: 6172 2065 7870 7265 7373 696f 6e0a 2020  ar expression.  
+0001cfb0: 2020 2020 2020 7061 7474 6572 6e20 3d20        pattern = 
+0001cfc0: 7265 2e63 6f6d 7069 6c65 2872 2273 656e  re.compile(r"sen
+0001cfd0: 736f 725c 642b 5c2e 696e 7024 2229 0a20  sor\d+\.inp$"). 
+0001cfe0: 2020 2020 2020 2073 656e 736f 725f 6c69         sensor_li
+0001cff0: 7374 203d 205b 0a20 2020 2020 2020 2020  st = [.         
+0001d000: 2020 2066 696c 652e 7374 656d 2066 6f72     file.stem for
+0001d010: 2066 696c 6520 696e 2064 6972 6563 746f   file in directo
+0001d020: 7279 2e69 7465 7264 6972 2829 2069 6620  ry.iterdir() if 
+0001d030: 7061 7474 6572 6e2e 6d61 7463 6828 6669  pattern.match(fi
+0001d040: 6c65 2e6e 616d 6529 0a20 2020 2020 2020  le.name).       
+0001d050: 205d 0a20 2020 2020 2020 2066 6f72 2073   ].        for s
+0001d060: 656e 736f 725f 6e61 6d65 2069 6e20 7365  ensor_name in se
+0001d070: 6e73 6f72 5f6c 6973 743a 0a20 2020 2020  nsor_list:.     
+0001d080: 2020 2020 2020 2073 656e 736f 7220 3d20         sensor = 
+0001d090: 5769 6e64 5365 6e73 6f72 2e66 726f 6d5f  WindSensor.from_
+0001d0a0: 6669 6c65 2864 6972 6563 746f 7279 2c20  file(directory, 
+0001d0b0: 7365 6e73 6f72 5f6e 616d 6529 0a20 2020  sensor_name).   
+0001d0c0: 2020 2020 2020 2020 2073 656e 736f 725f           sensor_
+0001d0d0: 6172 7261 792e 6170 7065 6e64 2873 656e  array.append(sen
+0001d0e0: 736f 7229 0a20 2020 2020 2020 2077 696e  sor).        win
+0001d0f0: 6461 7272 6179 203d 2063 6c73 2873 656e  darray = cls(sen
+0001d100: 736f 725f 6172 7261 793d 7365 6e73 6f72  sor_array=sensor
+0001d110: 5f61 7272 6179 290a 2020 2020 2020 2020  _array).        
+0001d120: 7265 7475 726e 2077 696e 6461 7272 6179  return windarray
+0001d130: 0a0a 2020 2020 4063 6c61 7373 6d65 7468  ..    @classmeth
+0001d140: 6f64 0a20 2020 2064 6566 2066 726f 6d5f  od.    def from_
+0001d150: 6469 6374 2863 6c73 2c20 6461 7461 3a20  dict(cls, data: 
+0001d160: 6469 6374 293a 0a20 2020 2020 2020 2077  dict):.        w
+0001d170: 696e 6461 7272 6179 203d 2063 6c73 282a  indarray = cls(*
+0001d180: 2a64 6174 6129 0a20 2020 2020 2020 2072  *data).        r
+0001d190: 6574 7572 6e20 7769 6e64 6172 7261 790a  eturn windarray.
+0001d1a0: 0a20 2020 2064 6566 2074 6f5f 6469 6374  .    def to_dict
+0001d1b0: 2873 656c 662c 2069 6e63 6c75 6465 5f70  (self, include_p
+0001d1c0: 7269 7661 7465 3a20 626f 6f6c 203d 2046  rivate: bool = F
+0001d1d0: 616c 7365 293a 0a20 2020 2020 2020 2022  alse):.        "
+0001d1e0: 2222 0a20 2020 2020 2020 2043 6f6e 7665  "".        Conve
+0001d1f0: 7274 2074 6865 206f 626a 6563 7420 746f  rt the object to
+0001d200: 2061 2064 6963 7469 6f6e 6172 792c 2065   a dictionary, e
+0001d210: 7863 6c75 6469 6e67 2061 7474 7269 6275  xcluding attribu
+0001d220: 7465 7320 7468 6174 2073 7461 7274 0a20  tes that start. 
+0001d230: 2020 2020 2020 2077 6974 6820 616e 2075         with an u
+0001d240: 6e64 6572 7363 6f72 652e 0a0a 2020 2020  nderscore...    
+0001d250: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
+0001d260: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
+0001d270: 2020 2020 6469 6374 0a20 2020 2020 2020      dict.       
+0001d280: 2020 2020 2044 6963 7469 6f6e 6172 7920       Dictionary 
+0001d290: 7265 7072 6573 656e 7461 7469 6f6e 206f  representation o
+0001d2a0: 6620 7468 6520 6f62 6a65 6374 2e0a 2020  f the object..  
+0001d2b0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0001d2c0: 2020 616c 6c5f 6669 656c 6473 203d 2073    all_fields = s
+0001d2d0: 656c 662e 6d6f 6465 6c5f 6475 6d70 280a  elf.model_dump(.
+0001d2e0: 2020 2020 2020 2020 2020 2020 6578 636c              excl
+0001d2f0: 7564 653d 7b22 6e61 6d65 222c 2022 5f65  ude={"name", "_e
+0001d300: 7874 656e 7369 6f6e 222c 2022 5f66 696c  xtension", "_fil
+0001d310: 656e 616d 6522 2c20 2270 6172 616d 5f69  ename", "param_i
+0001d320: 6e66 6f22 7d0a 2020 2020 2020 2020 290a  nfo"}.        ).
+0001d330: 0a20 2020 2020 2020 2069 6620 696e 636c  .        if incl
+0001d340: 7564 655f 7072 6976 6174 653a 0a20 2020  ude_private:.   
+0001d350: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0001d360: 616c 6c5f 6669 656c 6473 0a20 2020 2020  all_fields.     
+0001d370: 2020 2072 6574 7572 6e20 7b0a 2020 2020     return {.    
+0001d380: 2020 2020 2020 2020 6b65 793a 2076 616c          key: val
+0001d390: 7565 2066 6f72 206b 6579 2c20 7661 6c75  ue for key, valu
+0001d3a0: 6520 696e 2061 6c6c 5f66 6965 6c64 732e  e in all_fields.
+0001d3b0: 6974 656d 7328 2920 6966 206e 6f74 206b  items() if not k
+0001d3c0: 6579 2e73 7461 7274 7377 6974 6828 225f  ey.startswith("_
+0001d3d0: 2229 0a20 2020 2020 2020 207d 0a0a 2020  ").        }..  
+0001d3e0: 2020 6465 6620 746f 5f66 696c 6528 7365    def to_file(se
+0001d3f0: 6c66 2c20 7469 6d65 5f6e 6f77 3a20 696e  lf, time_now: in
+0001d400: 742c 2064 6972 6563 746f 7279 3a20 5061  t, directory: Pa
+0001d410: 7468 207c 2073 7472 2c20 7665 7273 696f  th | str, versio
+0001d420: 6e3a 2073 7472 203d 2022 6c61 7465 7374  n: str = "latest
+0001d430: 2229 3a0a 2020 2020 2020 2020 6966 2069  "):.        if i
+0001d440: 7369 6e73 7461 6e63 6528 6469 7265 6374  sinstance(direct
+0001d450: 6f72 792c 2073 7472 293a 0a20 2020 2020  ory, str):.     
+0001d460: 2020 2020 2020 2064 6972 6563 746f 7279         directory
+0001d470: 203d 2050 6174 6828 6469 7265 6374 6f72   = Path(director
+0001d480: 7929 0a0a 2020 2020 2020 2020 666f 7220  y)..        for 
+0001d490: 7365 6e73 6f72 2069 6e20 7365 6c66 2e73  sensor in self.s
+0001d4a0: 656e 736f 725f 6172 7261 793a 0a20 2020  ensor_array:.   
+0001d4b0: 2020 2020 2020 2020 2073 656e 736f 722e           sensor.
+0001d4c0: 746f 5f66 696c 6528 7365 6c66 2e77 696e  to_file(self.win
+0001d4d0: 645f 7469 6d65 732c 2074 696d 655f 6e6f  d_times, time_no
+0001d4e0: 772c 2064 6972 6563 746f 7279 2c20 7665  w, directory, ve
+0001d4f0: 7273 696f 6e29 0a0a 2020 2020 6465 6620  rsion)..    def 
+0001d500: 6164 645f 7365 6e73 6f72 280a 2020 2020  add_sensor(.    
+0001d510: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+0001d520: 2020 7769 6e64 5f73 7065 6564 733a 2055    wind_speeds: U
+0001d530: 6e69 6f6e 5b50 6f73 6974 6976 6546 6c6f  nion[PositiveFlo
+0001d540: 6174 2c20 6c69 7374 2850 6f73 6974 6976  at, list(Positiv
+0001d550: 6546 6c6f 6174 295d 2c0a 2020 2020 2020  eFloat)],.      
+0001d560: 2020 7769 6e64 5f64 6972 6563 7469 6f6e    wind_direction
+0001d570: 733a 2055 6e69 6f6e 5b4e 6f6e 4e65 6761  s: Union[NonNega
+0001d580: 7469 7665 496e 742c 206c 6973 7428 4e6f  tiveInt, list(No
+0001d590: 6e4e 6567 6174 6976 6549 6e74 295d 2c0a  nNegativeInt)],.
+0001d5a0: 2020 2020 2020 2020 7769 6e64 5f74 696d          wind_tim
+0001d5b0: 6573 3a20 556e 696f 6e5b 4e6f 6e4e 6567  es: Union[NonNeg
+0001d5c0: 6174 6976 6546 6c6f 6174 2c20 6c69 7374  ativeFloat, list
+0001d5d0: 284e 6f6e 4e65 6761 7469 7665 466c 6f61  (NonNegativeFloa
+0001d5e0: 7429 5d2c 0a20 2020 2020 2020 2073 656e  t)],.        sen
+0001d5f0: 736f 725f 6865 6967 6874 3a20 506f 7369  sor_height: Posi
+0001d600: 7469 7665 466c 6f61 742c 0a20 2020 2020  tiveFloat,.     
+0001d610: 2020 2078 5f6c 6f63 6174 696f 6e3a 2050     x_location: P
+0001d620: 6f73 6974 6976 6549 6e74 2c0a 2020 2020  ositiveInt,.    
+0001d630: 2020 2020 795f 6c6f 6361 7469 6f6e 3a20      y_location: 
+0001d640: 506f 7369 7469 7665 496e 742c 0a20 2020  PositiveInt,.   
+0001d650: 2029 3a0a 2020 2020 2020 2020 2222 220a   ):.        """.
+0001d660: 2020 2020 2020 2020 4164 6420 6120 7769          Add a wi
+0001d670: 6e64 2073 656e 736f 7220 746f 2074 6865  nd sensor to the
+0001d680: 2077 696e 6420 7365 6e73 6f72 2061 7272   wind sensor arr
+0001d690: 6179 2e20 4578 6973 7469 6e67 2073 656e  ay. Existing sen
+0001d6a0: 736f 7273 2077 696c 6c20 6265 2075 6e63  sors will be unc
+0001d6b0: 6861 6e67 6564 2e0a 0a20 2020 2020 2020  hanged...       
+0001d6c0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+0001d6d0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+0001d6e0: 2020 2020 2020 2077 696e 645f 7370 6565         wind_spee
+0001d6f0: 6473 203a 2050 6f73 6974 6976 6546 6c6f  ds : PositiveFlo
+0001d700: 6174 207c 206c 6973 7428 506f 7369 7469  at | list(Positi
+0001d710: 7665 466c 6f61 7429 0a20 2020 2020 2020  veFloat).       
+0001d720: 2020 2020 204f 7074 696f 6e61 6c2e 2055       Optional. U
+0001d730: 7064 6174 6564 2077 696e 6420 7370 6565  pdated wind spee
+0001d740: 6420 6f72 206c 6973 7420 6f66 2077 696e  d or list of win
+0001d750: 6420 7370 6565 6473 2069 6e20 6d2f 730a  d speeds in m/s.
+0001d760: 2020 2020 2020 2020 7769 6e64 5f64 6972          wind_dir
+0001d770: 6563 7469 6f6e 733a 2050 6f73 6974 6976  ections: Positiv
+0001d780: 6549 6e74 207c 206c 6973 7428 506f 7369  eInt | list(Posi
+0001d790: 7469 7665 496e 7429 0a20 2020 2020 2020  tiveInt).       
+0001d7a0: 2020 2020 204f 7074 696f 6e61 6c2e 2055       Optional. U
+0001d7b0: 7064 6174 6564 2077 696e 6420 6469 7265  pdated wind dire
+0001d7c0: 6374 696f 6e20 6f72 206c 6973 7420 6f66  ction or list of
+0001d7d0: 2077 696e 6420 6469 7265 6374 696f 6e73   wind directions
+0001d7e0: 2069 6e20 6465 6772 6565 732e 2055 7365   in degrees. Use
+0001d7f0: 2030 2066 6f72 206e 6f72 7468 2e0a 2020   0 for north..  
+0001d800: 2020 2020 2020 7769 6e64 5f74 696d 6573        wind_times
+0001d810: 203a 204e 6f6e 4e65 6761 7469 7665 496e   : NonNegativeIn
+0001d820: 7420 7c20 6c69 7374 284e 6f6e 4e65 6761  t | list(NonNega
+0001d830: 7469 7665 496e 7429 0a20 2020 2020 2020  tiveInt).       
+0001d840: 2020 2020 204f 7074 696f 6e61 6c2e 2055       Optional. U
+0001d850: 7064 6174 6564 206c 6973 7420 6f66 2074  pdated list of t
+0001d860: 696d 6573 2066 6f72 2065 6163 6820 7769  imes for each wi
+0001d870: 6e64 7368 6966 742e 2055 7365 2030 2066  ndshift. Use 0 f
+0001d880: 6f72 2073 696e 676c 6520 7769 6e64 7368  or single windsh
+0001d890: 6966 742e 2046 6972 7374 2076 616c 7565  ift. First value
+0001d8a0: 206d 7573 7420 6265 2030 2e0a 2020 2020   must be 0..    
+0001d8b0: 2020 2020 7365 6e73 6f72 5f68 6569 6768      sensor_heigh
+0001d8c0: 7420 3a20 506f 7369 7469 7665 466c 6f61  t : PositiveFloa
+0001d8d0: 740a 2020 2020 2020 2020 2020 2020 4f70  t.            Op
+0001d8e0: 7469 6f6e 616c 2e20 5570 6461 7465 6420  tional. Updated 
+0001d8f0: 6865 6967 6874 206f 6620 7468 6520 7769  height of the wi
+0001d900: 6e64 2073 656e 736f 7220 696e 206d 6574  nd sensor in met
+0001d910: 6572 730a 2020 2020 2020 2020 785f 6c6f  ers.        x_lo
+0001d920: 6361 7469 6f6e 203a 2050 6f73 6974 6976  cation : Positiv
+0001d930: 6549 6e74 0a20 2020 2020 2020 2020 2020  eInt.           
+0001d940: 204f 7074 696f 6e61 6c2e 2055 7064 6174   Optional. Updat
+0001d950: 6564 206c 6f63 6174 696f 6e20 6f66 2074  ed location of t
+0001d960: 6865 2077 696e 6420 7365 6e73 6f72 2069  he wind sensor i
+0001d970: 6e20 7468 6520 782d 6469 7265 6374 696f  n the x-directio
+0001d980: 6e20 286d 290a 2020 2020 2020 2020 795f  n (m).        y_
+0001d990: 6c6f 6361 7469 6f6e 203a 2050 6f73 6974  location : Posit
+0001d9a0: 6976 6549 6e74 0a20 2020 2020 2020 2020  iveInt.         
+0001d9b0: 2020 204f 7074 696f 6e61 6c2e 2055 7064     Optional. Upd
+0001d9c0: 6174 6564 206c 6f63 6174 696f 6e20 6f66  ated location of
+0001d9d0: 2074 6865 2077 696e 6420 7365 6e73 6f72   the wind sensor
+0001d9e0: 2069 6e20 7468 6520 792d 6469 7265 6374   in the y-direct
+0001d9f0: 696f 6e20 286d 290a 2020 2020 2020 2020  ion (m).        
+0001da00: 2222 220a 2020 2020 2020 2020 7365 6e73  """.        sens
+0001da10: 6f72 5f6e 756d 6265 7220 3d20 6c65 6e28  or_number = len(
+0001da20: 7365 6c66 2e73 656e 736f 725f 6172 7261  self.sensor_arra
+0001da30: 7929 202b 2031 0a20 2020 2020 2020 2073  y) + 1.        s
+0001da40: 656e 736f 725f 6e61 6d65 203d 2022 222e  ensor_name = "".
+0001da50: 6a6f 696e 285b 2273 656e 736f 7222 2c20  join(["sensor", 
+0001da60: 7374 7228 7365 6e73 6f72 5f6e 756d 6265  str(sensor_numbe
+0001da70: 7229 5d29 0a20 2020 2020 2020 2073 656e  r)]).        sen
+0001da80: 736f 7220 3d20 5769 6e64 5365 6e73 6f72  sor = WindSensor
+0001da90: 280a 2020 2020 2020 2020 2020 2020 6e61  (.            na
+0001daa0: 6d65 3d73 656e 736f 725f 6e61 6d65 2c0a  me=sensor_name,.
+0001dab0: 2020 2020 2020 2020 2020 2020 785f 6c6f              x_lo
+0001dac0: 6361 7469 6f6e 3d78 5f6c 6f63 6174 696f  cation=x_locatio
+0001dad0: 6e2c 0a20 2020 2020 2020 2020 2020 2079  n,.            y
+0001dae0: 5f6c 6f63 6174 696f 6e3d 795f 6c6f 6361  _location=y_loca
+0001daf0: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
+0001db00: 2020 7769 6e64 5f74 696d 6573 3d77 696e    wind_times=win
+0001db10: 645f 7469 6d65 732c 0a20 2020 2020 2020  d_times,.       
+0001db20: 2020 2020 2073 656e 736f 725f 6865 6967       sensor_heig
+0001db30: 6874 3d73 656e 736f 725f 6865 6967 6874  ht=sensor_height
+0001db40: 2c0a 2020 2020 2020 2020 2020 2020 7769  ,.            wi
+0001db50: 6e64 5f73 7065 6564 733d 7769 6e64 5f73  nd_speeds=wind_s
+0001db60: 7065 6564 732c 0a20 2020 2020 2020 2020  peeds,.         
+0001db70: 2020 2077 696e 645f 6469 7265 6374 696f     wind_directio
+0001db80: 6e73 3d77 696e 645f 6469 7265 6374 696f  ns=wind_directio
+0001db90: 6e73 2c0a 2020 2020 2020 2020 290a 2020  ns,.        ).  
+0001dba0: 2020 2020 2020 7365 6c66 2e73 656e 736f        self.senso
+0001dbb0: 725f 6172 7261 792e 6170 7065 6e64 2873  r_array.append(s
+0001dbc0: 656e 736f 7229 0a0a 2020 2020 2020 2020  ensor)..        
+0001dbd0: 7265 7475 726e 2073 656e 736f 720a 0a20  return sensor.. 
+0001dbe0: 2020 2064 6566 2075 7064 6174 655f 7365     def update_se
+0001dbf0: 6e73 6f72 280a 2020 2020 2020 2020 7365  nsor(.        se
+0001dc00: 6c66 2c0a 2020 2020 2020 2020 7365 6e73  lf,.        sens
+0001dc10: 6f72 5f6e 616d 653a 2073 7472 2c0a 2020  or_name: str,.  
+0001dc20: 2020 2020 2020 785f 6c6f 6361 7469 6f6e        x_location
+0001dc30: 3a20 4f70 7469 6f6e 616c 5b50 6f73 6974  : Optional[Posit
+0001dc40: 6976 6549 6e74 5d20 3d20 4e6f 6e65 2c0a  iveInt] = None,.
+0001dc50: 2020 2020 2020 2020 795f 6c6f 6361 7469          y_locati
+0001dc60: 6f6e 3a20 4f70 7469 6f6e 616c 5b50 6f73  on: Optional[Pos
+0001dc70: 6974 6976 6549 6e74 5d20 3d20 4e6f 6e65  itiveInt] = None
+0001dc80: 2c0a 2020 2020 2020 2020 7769 6e64 5f73  ,.        wind_s
+0001dc90: 7065 6564 733a 204f 7074 696f 6e61 6c5b  peeds: Optional[
+0001dca0: 556e 696f 6e5b 506f 7369 7469 7665 466c  Union[PositiveFl
+0001dcb0: 6f61 742c 206c 6973 7428 506f 7369 7469  oat, list(Positi
+0001dcc0: 7665 466c 6f61 7429 5d5d 203d 204e 6f6e  veFloat)]] = Non
+0001dcd0: 652c 0a20 2020 2020 2020 2077 696e 645f  e,.        wind_
+0001dce0: 6469 7265 6374 696f 6e73 3a20 4f70 7469  directions: Opti
+0001dcf0: 6f6e 616c 5b55 6e69 6f6e 5b4e 6f6e 4e65  onal[Union[NonNe
+0001dd00: 6761 7469 7665 496e 742c 206c 6973 7428  gativeInt, list(
+0001dd10: 4e6f 6e4e 6567 6174 6976 6549 6e74 295d  NonNegativeInt)]
+0001dd20: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
+0001dd30: 2020 7769 6e64 5f74 696d 6573 3a20 4f70    wind_times: Op
+0001dd40: 7469 6f6e 616c 5b55 6e69 6f6e 5b4e 6f6e  tional[Union[Non
+0001dd50: 4e65 6761 7469 7665 496e 742c 206c 6973  NegativeInt, lis
+0001dd60: 7428 4e6f 6e4e 6567 6174 6976 6549 6e74  t(NonNegativeInt
+0001dd70: 295d 5d20 3d20 4e6f 6e65 2c0a 2020 2020  )]] = None,.    
+0001dd80: 2020 2020 7365 6e73 6f72 5f68 6569 6768      sensor_heigh
+0001dd90: 743a 204f 7074 696f 6e61 6c5b 506f 7369  t: Optional[Posi
+0001dda0: 7469 7665 466c 6f61 745d 203d 204e 6f6e  tiveFloat] = Non
+0001ddb0: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
+0001ddc0: 2020 2222 220a 2020 2020 2020 2020 5570    """.        Up
+0001ddd0: 6461 7465 2070 6172 616d 6574 6572 7320  date parameters 
+0001dde0: 666f 7220 6120 7369 6e67 6c65 2077 696e  for a single win
+0001ddf0: 6420 7365 6e73 6f72 2e20 416e 7920 7061  d sensor. Any pa
+0001de00: 7261 6d65 7465 7273 206e 6f74 2070 726f  rameters not pro
+0001de10: 7669 6465 6420 7769 6c6c 0a20 2020 2020  vided will.     
+0001de20: 2020 2072 656d 6169 6e20 756e 6368 616e     remain unchan
+0001de30: 6765 642e 0a0a 2020 2020 2020 2020 5061  ged...        Pa
+0001de40: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
+0001de50: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+0001de60: 2020 2020 7570 6461 7465 3a20 7374 720a      update: str.
+0001de70: 2020 2020 2020 2020 2020 2020 4e61 6d65              Name
+0001de80: 206f 6620 7468 6520 7769 6e64 2073 656e   of the wind sen
+0001de90: 736f 722c 2065 2e67 2e20 2273 656e 736f  sor, e.g. "senso
+0001dea0: 7231 222e 2053 656e 736f 7220 6d75 7374  r1". Sensor must
+0001deb0: 2061 6c72 6561 6479 2065 7869 7374 2069   already exist i
+0001dec0: 6e20 7769 6e64 7365 6e73 6f72 732e 0a20  n windsensors.. 
+0001ded0: 2020 2020 2020 2078 5f6c 6f63 6174 696f         x_locatio
+0001dee0: 6e20 3a20 506f 7369 7469 7665 496e 740a  n : PositiveInt.
+0001def0: 2020 2020 2020 2020 2020 2020 4f70 7469              Opti
+0001df00: 6f6e 616c 2e20 5570 6461 7465 6420 6c6f  onal. Updated lo
+0001df10: 6361 7469 6f6e 206f 6620 7468 6520 7769  cation of the wi
+0001df20: 6e64 2073 656e 736f 7220 696e 2074 6865  nd sensor in the
+0001df30: 2078 2d64 6972 6563 7469 6f6e 2028 6d29   x-direction (m)
+0001df40: 0a20 2020 2020 2020 2079 5f6c 6f63 6174  .        y_locat
+0001df50: 696f 6e20 3a20 506f 7369 7469 7665 496e  ion : PositiveIn
+0001df60: 740a 2020 2020 2020 2020 2020 2020 4f70  t.            Op
+0001df70: 7469 6f6e 616c 2e20 5570 6461 7465 6420  tional. Updated 
+0001df80: 6c6f 6361 7469 6f6e 206f 6620 7468 6520  location of the 
+0001df90: 7769 6e64 2073 656e 736f 7220 696e 2074  wind sensor in t
+0001dfa0: 6865 2079 2d64 6972 6563 7469 6f6e 2028  he y-direction (
+0001dfb0: 6d29 0a20 2020 2020 2020 2077 696e 645f  m).        wind_
+0001dfc0: 7370 6565 6473 203a 2050 6f73 6974 6976  speeds : Positiv
+0001dfd0: 6546 6c6f 6174 207c 206c 6973 7428 506f  eFloat | list(Po
+0001dfe0: 7369 7469 7665 466c 6f61 7429 0a20 2020  sitiveFloat).   
+0001dff0: 2020 2020 2020 2020 204f 7074 696f 6e61           Optiona
+0001e000: 6c2e 2055 7064 6174 6564 2077 696e 6420  l. Updated wind 
+0001e010: 7370 6565 6420 6f72 206c 6973 7420 6f66  speed or list of
+0001e020: 2077 696e 6420 7370 6565 6473 2069 6e20   wind speeds in 
+0001e030: 6d2f 730a 2020 2020 2020 2020 7769 6e64  m/s.        wind
+0001e040: 5f64 6972 6563 7469 6f6e 733a 2050 6f73  _directions: Pos
+0001e050: 6974 6976 6549 6e74 207c 206c 6973 7428  itiveInt | list(
+0001e060: 506f 7369 7469 7665 496e 7429 0a20 2020  PositiveInt).   
+0001e070: 2020 2020 2020 2020 204f 7074 696f 6e61           Optiona
+0001e080: 6c2e 2055 7064 6174 6564 2077 696e 6420  l. Updated wind 
+0001e090: 6469 7265 6374 696f 6e20 6f72 206c 6973  direction or lis
+0001e0a0: 7420 6f66 2077 696e 6420 6469 7265 6374  t of wind direct
+0001e0b0: 696f 6e73 2069 6e20 6465 6772 6565 732e  ions in degrees.
+0001e0c0: 2055 7365 2030 2066 6f72 206e 6f72 7468   Use 0 for north
+0001e0d0: 2e0a 2020 2020 2020 2020 7769 6e64 5f74  ..        wind_t
+0001e0e0: 696d 6573 203a 204e 6f6e 4e65 6761 7469  imes : NonNegati
+0001e0f0: 7665 496e 7420 7c20 6c69 7374 284e 6f6e  veInt | list(Non
+0001e100: 4e65 6761 7469 7665 496e 7429 0a20 2020  NegativeInt).   
+0001e110: 2020 2020 2020 2020 204f 7074 696f 6e61           Optiona
+0001e120: 6c2e 2055 7064 6174 6564 206c 6973 7420  l. Updated list 
+0001e130: 6f66 2074 696d 6573 2066 6f72 2065 6163  of times for eac
+0001e140: 6820 7769 6e64 7368 6966 742e 2055 7365  h windshift. Use
+0001e150: 2030 2066 6f72 2073 696e 676c 6520 7769   0 for single wi
+0001e160: 6e64 7368 6966 742e 2046 6972 7374 2076  ndshift. First v
+0001e170: 616c 7565 206d 7573 7420 6265 2030 2e0a  alue must be 0..
+0001e180: 2020 2020 2020 2020 7365 6e73 6f72 5f68          sensor_h
+0001e190: 6569 6768 7420 3a20 506f 7369 7469 7665  eight : Positive
+0001e1a0: 466c 6f61 740a 2020 2020 2020 2020 2020  Float.          
+0001e1b0: 2020 4f70 7469 6f6e 616c 2e20 5570 6461    Optional. Upda
+0001e1c0: 7465 6420 6865 6967 6874 206f 6620 7468  ted height of th
+0001e1d0: 6520 7769 6e64 2073 656e 736f 7220 696e  e wind sensor in
+0001e1e0: 206d 6574 6572 730a 2020 2020 2020 2020   meters.        
+0001e1f0: 2222 220a 2020 2020 2020 2020 666f 7220  """.        for 
+0001e200: 6172 6720 696e 205b 7769 6e64 5f74 696d  arg in [wind_tim
+0001e210: 6573 2c20 7769 6e64 5f73 7065 6564 732c  es, wind_speeds,
+0001e220: 2077 696e 645f 6469 7265 6374 696f 6e73   wind_directions
+0001e230: 5d3a 0a20 2020 2020 2020 2020 2020 2069  ]:.            i
+0001e240: 6620 6973 696e 7374 616e 6365 2861 7267  f isinstance(arg
+0001e250: 2c20 2866 6c6f 6174 2c20 696e 7429 293a  , (float, int)):
+0001e260: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001e270: 2061 7267 203d 205b 6172 675d 0a20 2020   arg = [arg].   
+0001e280: 2020 2020 2075 7064 6174 6572 203d 2073       updater = s
+0001e290: 656c 662e 5f66 696e 645f 7365 6e73 6f72  elf._find_sensor
+0001e2a0: 5f62 795f 6e61 6d65 2873 656e 736f 725f  _by_name(sensor_
+0001e2b0: 6e61 6d65 290a 2020 2020 2020 2020 6966  name).        if
+0001e2c0: 206e 6f74 2075 7064 6174 6572 3a0a 2020   not updater:.  
+0001e2d0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0001e2e0: 4174 7472 6962 7574 6545 7272 6f72 2866  AttributeError(f
+0001e2f0: 227b 7365 6e73 6f72 5f6e 616d 657d 206e  "{sensor_name} n
+0001e300: 6f74 2066 6f75 6e64 2229 0a0a 2020 2020  ot found")..    
+0001e310: 2020 2020 7570 6461 7465 722e 7769 6e64      updater.wind
+0001e320: 5f74 696d 6573 203d 2028 0a20 2020 2020  _times = (.     
+0001e330: 2020 2020 2020 2077 696e 645f 7469 6d65         wind_time
+0001e340: 7320 6966 2077 696e 645f 7469 6d65 7320  s if wind_times 
+0001e350: 6973 206e 6f74 204e 6f6e 6520 656c 7365  is not None else
+0001e360: 2075 7064 6174 6572 2e77 696e 645f 7469   updater.wind_ti
+0001e370: 6d65 730a 2020 2020 2020 2020 290a 2020  mes.        ).  
+0001e380: 2020 2020 2020 7570 6461 7465 722e 7769        updater.wi
+0001e390: 6e64 5f73 7065 6564 7320 3d20 280a 2020  nd_speeds = (.  
+0001e3a0: 2020 2020 2020 2020 2020 7769 6e64 5f73            wind_s
+0001e3b0: 7065 6564 7320 6966 2077 696e 645f 7370  peeds if wind_sp
+0001e3c0: 6565 6473 2069 7320 6e6f 7420 4e6f 6e65  eeds is not None
+0001e3d0: 2065 6c73 6520 7570 6461 7465 722e 7769   else updater.wi
+0001e3e0: 6e64 5f73 7065 6564 730a 2020 2020 2020  nd_speeds.      
+0001e3f0: 2020 290a 2020 2020 2020 2020 7570 6461    ).        upda
+0001e400: 7465 722e 7769 6e64 5f64 6972 6563 7469  ter.wind_directi
+0001e410: 6f6e 7320 3d20 280a 2020 2020 2020 2020  ons = (.        
+0001e420: 2020 2020 7769 6e64 5f64 6972 6563 7469      wind_directi
+0001e430: 6f6e 7320 6966 2077 696e 645f 6469 7265  ons if wind_dire
+0001e440: 6374 696f 6e73 2069 7320 6e6f 7420 4e6f  ctions is not No
+0001e450: 6e65 2065 6c73 6520 7570 6461 7465 722e  ne else updater.
+0001e460: 7769 6e64 5f64 6972 6563 7469 6f6e 730a  wind_directions.
+0001e470: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0001e480: 2020 7570 6461 7465 722e 7365 6e73 6f72    updater.sensor
+0001e490: 5f68 6569 6768 7420 3d20 280a 2020 2020  _height = (.    
+0001e4a0: 2020 2020 2020 2020 7365 6e73 6f72 5f68          sensor_h
+0001e4b0: 6569 6768 7420 6966 2073 656e 736f 725f  eight if sensor_
+0001e4c0: 6865 6967 6874 2069 7320 6e6f 7420 4e6f  height is not No
+0001e4d0: 6e65 2065 6c73 6520 7570 6461 7465 722e  ne else updater.
+0001e4e0: 7365 6e73 6f72 5f68 6569 6768 740a 2020  sensor_height.  
+0001e4f0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0001e500: 7570 6461 7465 722e 785f 6c6f 6361 7469  updater.x_locati
+0001e510: 6f6e 203d 2028 0a20 2020 2020 2020 2020  on = (.         
+0001e520: 2020 2078 5f6c 6f63 6174 696f 6e20 6966     x_location if
+0001e530: 2078 5f6c 6f63 6174 696f 6e20 6973 206e   x_location is n
+0001e540: 6f74 204e 6f6e 6520 656c 7365 2075 7064  ot None else upd
+0001e550: 6174 6572 2e78 5f6c 6f63 6174 696f 6e0a  ater.x_location.
+0001e560: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0001e570: 2020 7570 6461 7465 722e 795f 6c6f 6361    updater.y_loca
+0001e580: 7469 6f6e 203d 2028 0a20 2020 2020 2020  tion = (.       
+0001e590: 2020 2020 2079 5f6c 6f63 6174 696f 6e20       y_location 
+0001e5a0: 6966 2079 5f6c 6f63 6174 696f 6e20 6973  if y_location is
+0001e5b0: 206e 6f74 204e 6f6e 6520 656c 7365 2075   not None else u
+0001e5c0: 7064 6174 6572 2e79 5f6c 6f63 6174 696f  pdater.y_locatio
+0001e5d0: 6e0a 2020 2020 2020 2020 290a 0a0a 6465  n.        )...de
+0001e5e0: 6620 5f76 616c 6964 6174 655f 616e 645f  f _validate_and_
+0001e5f0: 7265 7475 726e 5f76 6572 7369 6f6e 2876  return_version(v
+0001e600: 6572 7369 6f6e 3a20 7374 7229 202d 3e20  ersion: str) -> 
+0001e610: 7374 723a 0a20 2020 2069 6620 7665 7273  str:.    if vers
+0001e620: 696f 6e20 6e6f 7420 696e 2028 226c 6174  ion not in ("lat
+0001e630: 6573 7422 2c20 2276 3522 2c20 2276 3622  est", "v5", "v6"
+0001e640: 293a 0a20 2020 2020 2020 2072 6169 7365  ):.        raise
+0001e650: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
+0001e660: 2020 2020 2020 2020 2066 2256 6572 7369           f"Versi
+0001e670: 6f6e 207b 7665 7273 696f 6e7d 2069 7320  on {version} is 
+0001e680: 6e6f 7420 7375 7070 6f72 7465 642e 2053  not supported. S
+0001e690: 7570 706f 7274 6564 2076 6572 7369 6f6e  upported version
+0001e6a0: 733a 2027 6c61 7465 7374 272c 2027 7635  s: 'latest', 'v5
+0001e6b0: 272c 2027 7636 2722 0a20 2020 2020 2020  ', 'v6'".       
+0001e6c0: 2029 0a20 2020 2072 6574 7572 6e20 4c41   ).    return LA
+0001e6d0: 5445 5354 5f56 4552 5349 4f4e 2069 6620  TEST_VERSION if 
+0001e6e0: 7665 7273 696f 6e20 3d3d 2022 6c61 7465  version == "late
+0001e6f0: 7374 2220 656c 7365 2076 6572 7369 6f6e  st" else version
+0001e700: 0a                                       .
```

### Comparing `quicfire-tools-0.6.4/quicfire_tools/outputs.py` & `quicfire-tools-0.7.1/quicfire_tools/outputs.py`

 * *Files 16% similar despite different names*

```diff
@@ -2,170 +2,35 @@
 Module for converting QUIC-Fire output files to duck array data formats.
 """
 
 from __future__ import annotations
 
 # Core imports
 import re
+import json
 from pathlib import Path
+import importlib.resources
+
+# Internal imports
+from quicfire_tools.inputs import SimulationInputs
 
 # External imports
 import zarr
 import numpy as np
+import pyproj as proj
 import dask.array as da
 from numpy import ndarray
-from shutil import rmtree
+from netCDF4 import Dataset
+
 
-FUELS_OUTPUTS = {
-    "fire-energy_to_atmos": {
-        "file_format": "compressed",
-        "dimensions": ["z", "y", "x"],
-        "grid": "fire",
-        "delimiter": "-",
-        "extension": ".bin",
-        "description": "Energy released to the atmosphere that generates "
-        "buoyant plumes",
-        "units": "kW",
-    },
-    "fire-reaction_rate": {
-        "file_format": "compressed",
-        "dimensions": ["z", "y", "x"],
-        "grid": "fire",
-        "delimiter": "-",
-        "extension": ".bin",
-        "description": "Rate of reaction of fuel",
-        "units": "kg/m^3/s",
-    },
-    "fuels-dens": {
-        "file_format": "compressed",
-        "dimensions": ["z", "y", "x"],
-        "grid": "fire",
-        "delimiter": "-",
-        "extension": ".bin",
-        "description": "Fuel density",
-        "units": "kg/m^3",
-    },
-    "fuels-moist": {
-        "file_format": "compressed",
-        "dimensions": ["z", "y", "x"],
-        "grid": "fire",
-        "delimiter": "-",
-        "extension": ".bin",
-        "description": "Fuel moisture content",
-        "units": "g water / g air",
-    },
-    "groundfuelheight": {
-        "file_format": "gridded",
-        "dimensions": ["y", "x"],
-        "grid": "fire",
-        "delimiter": None,
-        "extension": ".bin",
-        "description": "2D array with initial fuel height in the ground layer",
-        "units": "m",
-    },
-    "mburnt_integ": {
-        "file_format": "gridded",
-        "dimensions": ["y", "x"],
-        "grid": "fire",
-        "delimiter": "-",
-        "extension": ".bin",
-        "description": "2D file containing the percentage of mass burnt for each (i,j) "
-        "location on the fire grid (vertically integrated)",
-        "units": "%",
-    },
-    "surfEnergy": {
-        "file_format": "gridded",
-        "dimensions": ["y", "x"],
-        "grid": "fire",
-        "delimiter": None,
-        "extension": ".bin",
-        "description": "Array contains total energy output by each surface cell "
-        "on a per second interval.",
-        "units": "kW/m^2",
-    },
-}
-THERMAL_RADIATION_OUTPUTS = {
-    "thermaldose": {
-        "file_format": "compressed",
-        "dimensions": ["z", "y", "x"],
-        "grid": "fire",
-        "delimiter": "-",
-        "extension": ".bin",
-        "description": "The output shows the thermal flux to skin of a person "
-        "collocated with fuel (for health effects).",
-        "units": "(kW/m^2)^(4/3)s",
-    },
-    "thermalradiation": {
-        "file_format": "compressed",
-        "dimensions": ["z", "y", "x"],
-        "grid": "fire",
-        "delimiter": "-",
-        "extension": ".bin",
-        "description": "The output shows the thermal flux to skin of a person "
-        "collocated with fuel (for health effects).",
-        "units": "kW/m^2",
-    },
-}
-WIND_OUTPUTS = {
-    "windu": {
-        "file_format": "gridded",
-        "dimensions": ["z", "y", "x"],
-        "grid": "fire",
-        "delimiter": "",
-        "extension": ".bin",
-        "description": "Fire u-components, cell centered ",
-        "units": "m/s",
-    },
-    "windv": {
-        "file_format": "gridded",
-        "dimensions": ["z", "y", "x"],
-        "grid": "fire",
-        "delimiter": "",
-        "extension": ".bin",
-        "description": "Fire v-components, cell centered ",
-        "units": "m/s",
-    },
-    "windw": {
-        "file_format": "gridded",
-        "dimensions": ["z", "y", "x"],
-        "grid": "fire",
-        "delimiter": "",
-        "extension": ".bin",
-        "description": "Fire w-components, cell centered ",
-        "units": "m/s",
-    },
-}
-EMISSIONS_OUTPUTS = {
-    "co_emissions": {
-        "file_format": "compressed",
-        "dimensions": ["z", "y", "x"],
-        "grid": "fire",
-        "delimiter": "-",
-        "extension": ".bin",
-        "description": "Mass of CO emitted between two emission file output"
-        "times in grams",
-        "units": "g",
-    },
-    "pm_emissions": {
-        "file_format": "compressed",
-        "dimensions": ["z", "y", "x"],
-        "grid": "fire",
-        "delimiter": "-",
-        "extension": ".bin",
-        "description": "Mass of PM2.5 emitted between two emission file output"
-        "times in grams",
-        "units": "g",
-    },
-}
-OUTPUTS_MAP = {
-    **FUELS_OUTPUTS,
-    **THERMAL_RADIATION_OUTPUTS,
-    **WIND_OUTPUTS,
-    **EMISSIONS_OUTPUTS,
-}
+OUTPUTS_DIR_PATH = (
+    importlib.resources.files("quicfire_tools").joinpath("data").joinpath("outputs")
+)
+with open(OUTPUTS_DIR_PATH.joinpath("outputs.json")) as f:
+    OUTPUTS_MAP = json.load(f)
 
 
 class OutputFile:
     """
     A class representing a single output file. This class provides a common
     interface for processing and retrieving data from output files.
 
@@ -175,65 +40,125 @@
         The name of the output file this object represents.
     file_format: str
         The format of the output file. Valid options are "gridded" and
         "compressed".
     dimensions: list[str]
         The dimensions of the output file as ["z", "y", "x"] or ["y", "x"].
     shape: tuple
-        The shape of the output file array data as (time, nz, ny, nx).
+        The shape of the output file array data as (nz, ny, nx).
     grid: str
         The grid type of the output file. Valid options are "fire" and "quic".
+    x_coords: list[float]
+        The x coordinates of the output file. Coordinates are in the UTM
+        coordinate system with the origin at the southwest corner of the
+        domain.
+    y_coords: list[float]
+        The y coordinates of the output file. Coordinates are in the UTM
+        coordinate system with the origin at the southwest corner of the
+        domain.
+    z_coords: list[float]
+        The z coordinates of the output file. Coordinates are in meters above
+        the ground level.
     delimiter: str
         The delimiter used in the output file name.
     extension: str
         The file extension of the output file.
     description: str
         A description of the output file.
     units: str
         The units of the output file.
+    filepaths: list[Path]
+        A list of file paths for each timestep.
     times: list[int]
         A list of times corresponding to the timesteps.
     """
 
     def __init__(
         self,
         name: str,
         file_format: str,
         dimensions: list[str],
-        shape: tuple,
         grid: str,
+        x_coords: list[float],
+        y_coords: list[float],
+        z_coords: list[float],
         delimiter: str,
         extension: str,
         description: str,
         units: str,
+        times: list[int],
+        filepaths: list[Path],
         index_map=None,
+        crs: str = None,
     ):
         self.name = name
         self.file_format = file_format
         self.dimensions = dimensions
-        self.shape = shape
+        self.x_coords = x_coords
+        self.y_coords = y_coords
+        self.z_coords = z_coords
+        self.crs = crs
+        self.shape = (len(z_coords), len(y_coords), len(x_coords))
         self.grid = grid
         self.delimiter = delimiter
         self.extension = extension
         self.description = description
         self.units = units
-        self.times = []  # List of times corresponding to the timesteps
-        self.filepaths = []  # List of file paths for each timestep
+        self.times = times
+        self.filepaths = filepaths
         function_mappings = {
             "gridded": _process_gridded_bin,
             "compressed": _process_compressed_bin,
         }
         self._output_function = function_mappings.get(self.file_format)
         if self._output_function is None:
             raise ValueError(f"Unknown output format: {self.file_format}")
         self._compressed_index_map = (
             index_map if (self.file_format == "compressed") else None
         )
 
-    def to_numpy(self, timestep: int | list[int] = None) -> np.ndarray:
+    def __eq__(self, other):
+        self_dict = self.__dict__.copy()
+        other_dict = other.__dict__.copy()
+        for key in self_dict.keys():
+            try:
+                if self_dict[key] != other_dict[key]:
+                    return False
+            except KeyError:
+                return False
+            except ValueError:
+                if np.any(self_dict[key] != other_dict[key]):
+                    return False
+        return True
+
+    def _select_files_based_on_timestep(
+        self, timestep: int | list[int] | range | None
+    ) -> list[Path]:
+        """Return files selected based on timestep."""
+        if timestep is None:
+            return self.filepaths
+        if isinstance(timestep, int):
+            timestep = [timestep]
+        try:
+            return [self.filepaths[ts] for ts in timestep]
+        except IndexError:
+            raise ValueError(f"Invalid timestep: {timestep}")
+
+    def _get_single_timestep(self, output_file: Path) -> np.ndarray:
+        """Return a numpy array for the given output file."""
+        return self._output_function(
+            output_file, self.shape, self._compressed_index_map
+        )
+
+    def _get_multiple_timesteps(self, output_files: list[Path]) -> np.ndarray:
+        """Return a numpy array for the given output files."""
+        arrays = [self._get_single_timestep(of) for of in output_files]
+        return arrays[0] if len(arrays) == 1 else np.concatenate(arrays, axis=0)
+
+    def to_numpy(self, timestep: int | list[int] | range = None) -> np.ndarray:
         """
         Return a numpy array for the given output and timestep(s) with shape
         (time, nz, ny, nx). If timestep is None, then all timesteps are
         returned.
 
         Parameters
         ----------
@@ -252,81 +177,394 @@
         >>> outputs = qft.SimulationOutputs("path/to/outputs", 50, 100, 100)
         >>> fire_energy = outputs.get_output("fire-energy_to_atmos")
         >>> # Get all timesteps for the fire-energy_to_atmos output
         >>> fire_energy_all = fire_energy.to_numpy()
         >>> # Get the first timestep for the fire-energy_to_atmos output
         >>> fire_energy_slice = fire_energy.to_numpy(timestep=0)
         """
-        self._validate_timestep(timestep)
         selected_files = self._select_files_based_on_timestep(timestep)
         return self._get_multiple_timesteps(selected_files)
 
-    def _validate_timestep(self, timestep: int | list[int] | None) -> None:
-        """Validate the timestep input."""
+    def to_netcdf(self, directory: str | Path, timestep: int | list[int] = None):
+        """
+        Write a netCDF file for the given output and timestep(s) with dimensions
+        (time, nz, ny, nx). If timestep is None, then all timesteps are
+        returned.
+
+        Parameters
+        ----------
+        directory: str | Path
+            The path to the folder where netCDF file will be written.
+        timestep: int | list[int] | None
+            The timestep(s) to write. If None, then all timesteps are written.
+
+        Builds
+        -------
+        netCDF file to disk
+
+        Examples
+        --------
+        >>> import quicfire_tools as qft
+        >>> outputs = qft.SimulationOutputs("path/to/outputs", 50, 100, 100)
+        >>> fire_energy = outputs.get_output("fire-energy_to_atmos")
+        >>> out_dir = Path(path/to/output/dir)
+        >>> # Get all timesteps for the fire-energy_to_atmos output
+        >>> fire_energy_all = fire_energy.to_netcdf(directory = out_dir)
+        >>> # Get the first timestep for the fire-energy_to_atmos output
+        >>> fire_energy_slice = fire_energy.to_netcdf(directory = out_dir, timestep=0)
+        """
+        if isinstance(directory, str):
+            directory = Path(directory)
+
+        if not directory.exists():
+            directory.mkdir(parents=True)
+
         if timestep is None:
-            return
-        if isinstance(timestep, int):
-            if timestep not in range(len(self.times)):
-                raise ValueError(f"Invalid timestep: {timestep}")
-        elif all(isinstance(ts, int) for ts in timestep):
-            if any(ts not in range(len(self.times)) for ts in timestep):
-                raise ValueError(f"Invalid timestep: {timestep}")
+            times = self.times
+        elif isinstance(timestep, int):
+            times = [self.times[timestep]]
         else:
-            raise TypeError(f"Invalid timestep type: {type(timestep)}")
+            times = [self.times[i] for i in timestep]
 
-    def _select_files_based_on_timestep(
-        self, timestep: int | list[int] | None
-    ) -> list[Path]:
-        """Return files selected based on timestep."""
-        if timestep is None:
-            return self.filepaths
-        if isinstance(timestep, int):
-            return [self.filepaths[timestep]]
-        return [self.filepaths[ts] for ts in timestep]
+        dataset = Dataset(directory / f"{self.name}.nc", "w", format="NETCDF4")
+        dataset.title = self.name
+        dataset.subtitle = self.description
+
+        # Time dimension
+        dataset.createDimension("time", None)
+        dataset_time = dataset.createVariable("time", np.int64, ("time",))
+        dataset_time.long_name = "Time since start of simulation"
+        dataset_time.units = "s"
+        dataset_time[:] = np.array(times)
+
+        # Z dimension
+        dataset.createDimension("z", None)
+        dataset_z = dataset.createVariable("z", np.int64, ("z",))
+        dataset_z.long_name = "Cell height: bottom of cell from ground"
+        dataset_z.units = "m"
+        dataset_z[:] = self.z_coords
+
+        # Y dimension
+        dataset.createDimension("y", None)
+        dataset_y = dataset.createVariable("y", np.int64, ("y",))
+        dataset_y.long_name = "Northing: y-coordinate of bottom edge of the cell"
+        dataset_y.units = "m"
+        dataset_y[:] = self.y_coords
+
+        # X dimension
+        dataset.createDimension("x", None)
+        dataset_x = dataset.createVariable("x", np.int64, ("x",))
+        dataset_x.long_name = "Easting: x-coordinate of left edge of the cell"
+        dataset_x.units = "m"
+        dataset_x[:] = self.x_coords
+
+        # Output variable
+        output = dataset.createVariable(self.name, np.float32, ("time", "z", "y", "x"))
+        output.long_name = self.description
+        output.units = self.units
 
-    def _get_single_timestep(self, output_file: Path) -> np.ndarray:
-        """Return a numpy array for the given output file."""
-        return self._output_function(
-            output_file, self.shape, self._compressed_index_map
+        selected_files = self._select_files_based_on_timestep(timestep)
+        output[:, :, :, :] = self._get_multiple_timesteps(selected_files)
+
+        dataset.close()
+        return
+
+    def to_zarr(
+        self,
+        fpath: str | Path,
+        chunk_size: dict[str, int] = None,
+        **kwargs,
+    ) -> zarr.Group:
+        """
+        Write the outputs to a zarr file.
+
+        Parameters
+        ----------
+        fpath: str | Path
+            The path to the folder where zarr files are written to be written.
+        chunk_size: dict[str, int]
+            The chunk size for the zarr array. The dictionary may contain
+            keys "time", "z", "y", and "x" with integer values for the chunk
+            size in each dimension. The default chunk size is (1, nz, ny, nx).
+            If a key is not present, then the chunk size defaults to the size
+            of the dimension.
+        **kwargs
+            Additional keyword arguments to pass to the zarr array creation
+            function.
+
+        Returns
+        -------
+        zarr.Group
+            The zarr group containing the output data.
+
+        Examples
+        --------
+        >>> import quicfire_tools as qft
+        >>> outputs = qft.SimulationOutputs("path/to/outputs", 50, 100, 100)
+        >>> fire_energy = outputs.get_output("fire-energy_to_atmos")
+        >>> # Write fire-energy_to_atmos output to zarr
+        >>> zarr_group = fire_energy.to_zarr("path/to/zarr")
+        >>> zarr_group["fuels-dens"]
+        <zarr.core.Array '/fuels-dens' (2, 1, 200, 200) float64 read-only>
+        >>> # Write multiple timesteps to each zarr chunk to improve I/O
+        >>> zarr_group = fire_energy.to_zarr("path/to/zarr", chunk_size={"time": 100})
+        >>> zarr_group["fuels-dens"].chunks
+        (100, 1, 200, 200)
+        """
+        if isinstance(fpath, str):
+            fpath = Path(fpath)
+
+        if not fpath.exists():
+            fpath.mkdir(parents=True)
+
+        # Build the zarr file with directory storage
+        zarr_path = fpath / (self.name + ".zarr")
+        zroot = zarr.open(str(zarr_path), mode="w")
+        zroot.attrs["crs"] = self.crs
+
+        # Build the output data array. By default, the array has shape
+        # (time, nz, ny, nx) and chunks of size (1, nz, ny, nx).
+        shape = (len(self.times), *self.shape)
+        if chunk_size is None:
+            chunk_size = {}
+        chunks = [
+            chunk_size.get("time", 1),
+            chunk_size.get("z", self.shape[0]),
+            chunk_size.get("y", self.shape[1]),
+            chunk_size.get("x", self.shape[2]),
+        ]
+        output_array = zroot.create_dataset(
+            self.name, shape=shape, chunks=chunks, dtype=float, **kwargs
         )
+        output_array.attrs["_ARRAY_DIMENSIONS"] = ["time", "z", "y", "x"]
+        output_array.attrs["long_name"] = self.description
+        output_array.attrs["units"] = self.units
+
+        # Write each timestep to the output array
+        for time_step in range(len(self.times)):
+            data = self.to_numpy(time_step)
+            output_array[time_step, ...] = data[0, ...]
+
+        # Time dimension
+        time_array = zroot.create_dataset("time", shape=len(self.times), dtype=int)
+        time_array.attrs["long_name"] = "Time since start of simulation"
+        time_array.attrs["units"] = "s"
+        time_array[...] = self.times
+
+        # Z dimension
+        z_array = zroot.create_dataset("z", shape=self.shape[0], dtype=float)
+        z_array.attrs["long_name"] = "Cell height: bottom of cell from ground"
+        z_array.attrs["units"] = "m"
+        z_array[...] = self.z_coords
+
+        # Y dimension
+        y_array = zroot.create_dataset("y", shape=self.shape[1], dtype=float)
+        y_array.attrs[
+            "long_name"
+        ] = "Northing: cell distance north from southern edge of domain"
+        y_array.attrs["units"] = "m"
+        y_array[...] = self.y_coords
+
+        # X dimension
+        x_array = zroot.create_dataset("x", shape=self.shape[2], dtype=float)
+        x_array.attrs[
+            "long_name"
+        ] = "Easting: cell distance east from western edge of domain"
+        x_array.attrs["units"] = "m"
+        x_array[...] = self.x_coords
 
-    def _get_multiple_timesteps(self, output_files: list[Path]) -> np.ndarray:
-        """Return a numpy array for the given output files."""
-        arrays = [self._get_single_timestep(of) for of in output_files]
-        return arrays[0] if len(arrays) == 1 else np.concatenate(arrays, axis=0)
+        zarr.consolidate_metadata(zarr_path)
+
+        return zroot
 
 
 class SimulationOutputs:
     """
     A class responsible for managing and processing simulation outputs,
     including validation, extraction, and organization of data from output
     files. This class facilitates the retrieval of data in various formats
     and can return a numpy array for a specific output, or write the data to a
     zarr file.
-    """
 
-    def __init__(self, output_directory: Path | str, nz: int, ny: int, nx: int):
-        # Convert to Path and resolve
-        output_directory = Path(output_directory).resolve()
+    Attributes
+    ----------
+    output_directory: Path
+        The path to the directory containing the simulation outputs. QUIC-Fire
+        defaults this to the "Output" directory in the same directory as the
+        simulation input files, but that does not have to be the case for
+        quicfire-tools. The directory must contain the "fire_indexes.bin" and
+        "grid.bin" files.
+    fire_nz: int
+        The number of vertical cells in the fire grid.
+    ny: int
+        The number of cells in the y-direction.
+    nx: int
+        The number of cells in the x-direction.
+    dy: float
+        The grid spacing in the y-direction (m).
+    dx: float
+        The grid spacing in the x-direction (m).
+    utm_x: float
+        UTM-x coordinates of the south-west corner of domain [m]. Default is 0.
+    utm_y: float
+        UTM-y coordinates of the south-west corner of domain [m]. Default is 0.
+    utm_zone: int
+        UTM zone of the domain. Default is None. If None, the coordinates are
+        considered not to be georeferenced.
+    crs: str
+        EPSG code for the coordinate reference system. If the UTM zone is
+        provided, the crs is set to the UTM zone. If the UTM zone is not
+        provided, the crs is set to None.
+    """
 
-        # Validate outputs directory
+    def __init__(
+        self,
+        output_directory: Path | str,
+        fire_nz: int,
+        ny: int,
+        nx: int,
+        dy: float,
+        dx: float,
+        utm_x: float = 0,
+        utm_y: float = 0,
+        utm_zone: int = 1,
+    ):
+        if isinstance(output_directory, str):
+            output_directory = Path(output_directory)
         self._validate_output_dir(output_directory)
 
         # Assign attributes
         self.output_directory = output_directory
-        self.nz = nz
         self.ny = ny
         self.nx = nx
+        self.dy = dy
+        self.dx = dx
+        self.fire_nz = fire_nz
+        self.utm_x = utm_x
+        self.utm_y = utm_y
+        self.utm_zone = utm_zone
+
+        # TODO: fire_nz can be optional
+        # TODO: Throw warning if fire_nz not provided and qf_wind outputs are present
+        # TODO: raise error if fire_nz is not provided and qf_qind is output
+
+        # Compute the x and y coordinate grids
+        self.x_coords = np.linspace(utm_x, utm_x + dx * (nx - 1), nx)
+        self.y_coords = np.linspace(utm_y, utm_y + dy * (ny - 1), ny)
+
+        # Set the crs if the UTM zone is provided. The if statement here is
+        # looking for the default QUIC-Fire values of 1, 0, 0. If the UTM
+        # zone is not 1 or the x and y coordinates are not 0, then the crs
+        # is set to the UTM zone.
+        if utm_zone != 1 or (utm_x != 0 and utm_y != 0):
+            crs = proj.CRS.from_proj4(f"+proj=utm +zone={utm_zone} +ellps=WGS84")
+            self.crs = f"EPSG:{crs.to_epsg()}"
+        else:
+            self.crs = None
 
-        # Get indexing information from the fire grid
-        self._fire_indexes = self._process_fire_indexes()
+        # Get grid information from grid.bin and fire_indexes.bin
+        self._fire_indexes = _process_fire_indexes(
+            output_directory / "fire_indexes.bin"
+        )
+        (
+            self.quic_nz,
+            self.quic_z_coords,
+            self.en2atmos_nz,
+            self.en2atmos_z_coords,
+        ) = _process_grid_info(output_directory / "grid.bin", ny, nx)
+        self.quic_z_coords = self.quic_z_coords[: self.quic_nz]
+        self.en2atmos_z_coords = self.en2atmos_z_coords[: self.en2atmos_nz]
+        self.fire_z_coords = self.en2atmos_z_coords[:fire_nz]
+        self.quic_dz = _get_resolution_from_coords(self.quic_z_coords)
+        self.fire_dz = _get_resolution_from_coords(self.en2atmos_z_coords)
 
         # Build a list of present output files and their times
         self.outputs = {}
         self._build_output_files_map()
+        self._output_names = list(self.outputs.keys())
+
+    def __iter__(self):
+        """Return an iterator for the object."""
+        self._index = 0
+        return self
+
+    def __next__(self):
+        """Return the next item in the iterator."""
+        if self._index < len(self._output_names):
+            output = self.outputs[self._output_names[self._index]]
+            self._index += 1
+            return output
+        else:
+            raise StopIteration
+
+    def __eq__(self, other):
+        self_dict = self.__dict__.copy()
+        other_dict = other.__dict__.copy()
+        self_dict.pop("outputs")
+        other_dict.pop("outputs")
+        for key in self_dict.keys():
+            self_value = self_dict[key]
+            other_value = other_dict[key]
+            try:
+                if self_value != other_value:
+                    return False
+            except KeyError:
+                return False
+            except ValueError:
+                if np.any(self_value != other_value):
+                    return False
+        for key in self.outputs.keys():
+            try:
+                if self.outputs[key] != other.outputs[key]:
+                    return False
+            except KeyError:
+                return False
+        return True
+
+    @classmethod
+    def from_simulation_inputs(
+        cls, output_directory: Path | str, simulation_inputs: SimulationInputs
+    ) -> SimulationOutputs:
+        """
+        Create a SimulationOutputs object from a path to a QUIC-Fire "Output"
+        directory and a SimulationInputs object.
+
+        Parameters
+        ----------
+        output_directory: Path | str
+            The path to the directory containing the simulation outputs. The
+            directory must contain the "fire_indexes.bin" and "grid.bin" files.
+            This is typically the "Output" directory in the same directory as
+            the simulation input files, but that does not have to be the case
+            for quicfire-tools.
+        simulation_inputs: SimulationInputs
+            The SimulationInputs object containing the simulation input data.
+
+        Returns
+        -------
+        SimulationOutputs
+            A SimulationOutputs object.
+
+        Examples
+        --------
+        >>> import quicfire_tools as qft
+        >>> inputs = qft.SimulationInputs.from_directory("path/to/inputs")
+        >>> outputs = qft.SimulationOutputs.from_simulation_inputs("path/to/outputs", inputs)
+        """
+        return cls(
+            output_directory,
+            simulation_inputs.quic_fire.nz,
+            simulation_inputs.qu_simparams.ny,
+            simulation_inputs.qu_simparams.nx,
+            simulation_inputs.qu_simparams.dy,
+            simulation_inputs.qu_simparams.dx,
+            simulation_inputs.qu_simparams.utm_x,
+            simulation_inputs.qu_simparams.utm_y,
+            simulation_inputs.qu_simparams.utm_zone_number,
+        )
 
     @staticmethod
     def _validate_output_dir(outputs_directory):
         """
         Validate the outputs directory by checking for the existence of the
         Output directory and the required files.
         """
@@ -337,15 +575,15 @@
             )
         elif not outputs_directory.is_dir():
             raise NotADirectoryError(
                 f"The path {outputs_directory} is not a directory."
             )
 
         # Check for required files
-        required_files = ["fire_indexes.bin"]
+        required_files = ["fire_indexes.bin", "grid.bin"]
         for f in required_files:
             if not (outputs_directory / f).exists():
                 raise FileNotFoundError(f"Required file {f} not in outputs directory")
 
     def _build_output_files_map(self):
         """
         Build a key-value map of output files, where the key is the name of
@@ -354,51 +592,63 @@
         for key, attributes in OUTPUTS_MAP.items():
             output_files_list = self._get_list_output_paths(
                 key, attributes["extension"]
             )
 
             # Check if any output files of the given type exist in the directory
             if output_files_list:
-                shape = self._get_output_shape(attributes)
+                z_coords = self._get_z_coords(attributes)
+                times = []
+                for file in output_files_list:
+                    time = self._get_output_file_time(key, file)
+                    times.append(time)
+
                 self.outputs[key] = OutputFile(
                     name=key,
                     file_format=attributes["file_format"],
                     dimensions=attributes["dimensions"],
-                    shape=shape,
                     grid=attributes["grid"],
+                    x_coords=self.x_coords,
+                    y_coords=self.y_coords,
+                    z_coords=z_coords,
                     delimiter=attributes["delimiter"],
                     extension=attributes["extension"],
                     description=attributes["description"],
                     units=attributes["units"],
+                    times=times,
+                    filepaths=output_files_list,
                     index_map=self._fire_indexes,
+                    crs=self.crs,
                 )
 
-                # Populate the output file with timesteps and filepaths
-                for filepath in output_files_list:
-                    time = self._get_output_file_time(key, filepath)
-                    self.outputs[key].times.append(time)
-                    self.outputs[key].filepaths.append(filepath)
-
     def _get_list_output_paths(self, name, ext) -> list[Path]:
         """
         Get a sorted list of output files in the Output/ directory for the
         given output name.
         """
         paths = list(self.output_directory.glob(f"{name}*{ext}"))
         paths.sort()
         return paths
 
-    def _get_output_shape(self, attrs) -> tuple:
+    def _get_z_coords(self, attrs) -> tuple:
         number_dimensions = len(attrs["dimensions"])
+        grid = attrs["grid"]
+
         if number_dimensions == 2:
-            return 1, self.ny, self.nx
-        elif number_dimensions == 3 and attrs["grid"] == "fire":
-            return self.nz + 1, self.ny, self.nx
+            return [0.0]
+        elif number_dimensions == 3 and grid == "fire":
+            return self.fire_z_coords
+        elif number_dimensions == 3 and grid == "en2atmos":
+            return self.en2atmos_z_coords
+        elif number_dimensions == 3 and grid == "quic":
+            return self.quic_z_coords
         else:
-            return self.nz, self.ny, self.nx
+            raise ValueError(
+                f"Invalid number of dimensions ({number_dimensions}) for {grid} grid"
+            )
 
     @staticmethod
     def _get_output_file_time(output, fpath) -> int:
         """Get the time of the output file."""
         delimiter = OUTPUTS_MAP[output]["delimiter"]
         extension = OUTPUTS_MAP[output]["extension"]
 
@@ -411,77 +661,42 @@
                 file_time = fpath.name.split(delimiter)[-1].split(extension)[0]
 
             return int(file_time)
 
         except ValueError:  # No numeric component
             return 0
 
-    def _process_fire_indexes(self) -> ndarray:
-        """
-        Process the `fire_indexes.bin` file to extract the necessary
-        information to rebuild the 3D fields of fire and fuel related variables.
-
-        - Data 1 (INT): Header
-        - Data 2 (INT): Number of cells with fuel (firegrid%num_fuel_cells = nfuel below)
-        - Data 3 (INT): Max index of the cells with fuel in the vertical direction
-        - Data 4-(nfuel+3) (INT): Unique cell identifiers (firegrid%num_fuel_cells)
-        - Data (nfuel+4)-(2*nfuel+4) (INT): i,j,k cell indexes
-        - Data (INT): Header
-
-        Function returns a 2D ndarray of shape (num_cells, 3) representing the
-        i, j, k indexes of each cell.
-        """
-        with open(self.output_directory / "fire_indexes.bin", "rb") as fid:
-            # Read in the number of cells and skip the header
-            num_cells = np.fromfile(fid, dtype=np.int32, offset=4, count=1)[0]
-
-            # Skip the max index of the cells with fuel in the vertical
-            # direction and unique cell identifiers
-            np.fromfile(fid, dtype=np.int32, count=7 + num_cells)
-
-            # Initialize an array to hold the indices
-            ijk = np.zeros((num_cells, 3), dtype=np.int32)
-
-            # Loop over each dimension's indices (Like a sparse meshgrid)
-            for i in range(0, 3):
-                ijk[:, i] = np.fromfile(fid, dtype=np.int32, count=num_cells)
-
-            # Convert to indices (numbered from 0)
-            ijk -= 1
-
-            return ijk
-
     def _validate_output(self, output: str) -> OutputFile:
         """Validate output."""
         try:
             output = self.outputs[output]
         except KeyError:
             raise ValueError(
                 f"{output} is not a valid output. Valid "
-                f"outputs are: {self.list_available_outputs()}"
+                f"outputs are: {self.list_outputs()}"
             )
         return output
 
-    def list_available_outputs(self) -> list[str]:
+    def list_outputs(self) -> list[str]:
         """
         Return a list of available output names.
 
         Returns
         -------
         list[str]
             A list of available output names.
 
         Examples
         --------
         >>> import quicfire_tools as qft
         >>> outputs = qft.SimulationOutputs("path/to/outputs")
-        >>> outputs.list_available_outputs()
+        >>> outputs.list_outputs()
         ['fire-energy_to_atmos', 'fuels-dens', 'groundfuelheight', 'mburnt_integ']
         """
-        return list(self.outputs.keys())
+        return self._output_names
 
     def get_output(self, key) -> OutputFile:
         """
         Return the OutputFile object for the given output name.
 
         Parameters
         ----------
@@ -504,15 +719,17 @@
         >>> outputs = qft.SimulationOutputs("path/to/outputs")
         >>> fire_energy = outputs.get_output("fire-energy_to_atmos")
         >>> fire_energy
         <quicfire_tools.outputs.OutputFile object at 0x7f8b1c2b6d90>
         """
         return self._validate_output(key)
 
-    def to_numpy(self, key: str, timestep: None | int | list[int] = None) -> np.ndarray:
+    def to_numpy(
+        self, key: str, timestep: None | int | list[int] | range = None
+    ) -> np.ndarray:
         """
         Returns a 4D numpy array for the given output and timestep(s) with shape
         (time, nz, ny, nx). If timestep is None, then all timesteps are
         returned.
 
         Parameters
         ----------
@@ -576,207 +793,130 @@
         # Write each timestep to the dask array
         for time_step in range(len(output.times)):
             data = self.to_numpy(output.name, time_step)
             dask_array[time_step, ...] = data
 
         return dask_array
 
-    # ZCC Changes
-    def to_zarr(
-        self,
-        fpath: str | Path,
-        outputs: str | list[str] = None,
-        over_write: bool = False,
-    ):
-        """
-        Write the outputs to a zarr file.
 
-        Parameters
-        ----------
-        fpath: str | Path
-            The path to the folder where zarr files are written to be written.
-        outputs: str | list[str]
-            The name of the output(s) to write to the zarr file. If None, then
-            all outputs are written to the zarr file.
-        over_write: bool
-            Whether or not to over_write zarr if it already exists
+def _get_resolution_from_coords(coords: list[float]) -> float | list[float]:
+    """
+    Get the resolution from a list of coordinates. If the resolution is
+    constant, then a single float is returned. If the resolution is not
+    constant, then a list of floats is returned.
+    """
+    resolution = np.diff(coords)
+    if np.all(resolution == resolution[0]):
+        return resolution[0]
+    else:
+        return resolution
 
-        Builds
-        -------
-        zarr files to disk
-        """
-        # Hard coding dimentions. Will want to add dimensions to one of the classes.
-        dz = 1
-        dy = 2
-        dx = 2
 
-        if isinstance(fpath, str):
-            fpath = Path(fpath)
+def _process_grid_info(path_to_grid_bin: str | Path, ny: int, nx: int):
+    """
+    Reads grid information from the grid.bin file and populates attributes
+    for fire and quic grid sizes, as well as dx, dy, and dz.
+    """
+    if isinstance(path_to_grid_bin, str):
+        path_to_grid_bin = Path(path_to_grid_bin)
 
-        if not fpath.exists():
-            fpath.mkdir(parents=True)
+    with open(path_to_grid_bin, "rb") as fid:
+        # Read the number of bytes in the vertical QUIC grid
+        num_bytes_quic_grid = np.fromfile(fid, dtype=np.int32, count=1)[0]
+
+        # Get the number of cells in the vertical direction
+        # num_cells * 32 bits = num_bytes * (8 bits / byte)
+        quic_nz = int(num_bytes_quic_grid / 4) - 2
+
+        # QUIC-URB grid bottom values
+        quic_grid_bottom = np.fromfile(fid, dtype=np.float32, count=quic_nz + 2)
+
+        np.fromfile(fid, dtype=np.int32, count=2)  # Header
+        np.fromfile(fid, dtype=np.float32, count=quic_nz + 2)  # quic grid mid values
+        np.fromfile(fid, dtype=np.int32, count=1)  # Header
+
+        # Try and read a topo or a fire header
+        test_header = np.fromfile(fid, dtype=np.int32, count=1)
+        if len(test_header) == 0:
+            raise ValueError("No fire or topo grids found in grid.bin file")
+
+        # Check if topo grid information is present
+        if test_header[0] == num_bytes_quic_grid:
+            np.fromfile(
+                fid, dtype=np.float32, count=quic_nz + 2
+            )  # Read sigma_bottom (same as quic_grid_bottom)
+            np.fromfile(fid, dtype=np.int32, count=2)  # Header
+            np.fromfile(
+                fid, dtype=np.float32, count=quic_nz + 2
+            )  # Read sigma_mid (same as quic_grid_mid)
+            np.fromfile(fid, dtype=np.int32, count=2)  # Header
+            np.fromfile(
+                fid, dtype=np.float32, count=ny * nx * (quic_nz + 2)
+            )  # quic grid bottom terrain following
+            np.fromfile(fid, dtype=np.int32, count=2)  # Header
+            np.fromfile(
+                fid, dtype=np.float32, count=ny * nx * (quic_nz + 2)
+            )  # quic grid mid terrain following
+            np.fromfile(fid, dtype=np.int32, count=2)  # Header
+            np.fromfile(
+                fid, dtype=np.float32, count=ny * nx
+            )  # quic grid volume correction
+            np.fromfile(fid, dtype=np.int32, count=1)  # Header
+            _ = np.fromfile(fid, dtype=np.int32, count=1)[0]  # fire header
+        else:
+            _ = test_header[0]  # fire header
 
-        self.zarr_folder_path = fpath  # store folder location of zarrs to object
+        num_eng_to_atmos_cells = np.fromfile(fid, dtype=np.int32, count=1)[0]
+        np.fromfile(fid, dtype=np.int32, count=2)  # Header
+        eng_to_amos_grid_bottom = np.fromfile(
+            fid, dtype=np.float32, count=num_eng_to_atmos_cells + 1
+        )
 
-        # Get a list of outputs to write to the zarr file
-        if outputs is None:
-            outputs = self.list_available_outputs()
-        elif isinstance(outputs, str):
-            outputs = [outputs]
-
-        # Write each output to the zarr file
-        for output_name in outputs:
-            # Get the output object and verify it exists
-            output = self.get_output(output_name)
-
-            # Build zarr path and store to output object
-            zarr_path = fpath / (output_name + ".zarr")
-            output.zarr_path = zarr_path  # store zarr_path to output object
-
-            write_zarr_to_disk = True
-            if zarr_path.exists():
-                if not over_write:
-                    write_zarr_to_disk = False
-                    print(
-                        "A dataset for {} already exists in the zarr file.\n".format(
-                            output_name
-                        ),
-                        "Set over_write flag to True if you would like to rebuild the zarr.",
-                    )
-                else:
-                    rmtree(zarr_path)
-
-            if write_zarr_to_disk:
-                # Create the zarr file
-                zarr_file = zarr.open(str(zarr_path), mode="w")
-
-                # Create a zarr dataset for the output
-                shape = (len(output.times), *output.shape)
-                chunks = [1 if i == 0 else shape[i] for i in range(len(shape))]
-
-                # Output to zarr dataset
-                DATA_NAME = "data"
-                zarr_dataset = zarr_file.create_dataset(
-                    DATA_NAME, shape=shape, chunks=chunks, dtype=float
-                )
+        np.fromfile(fid, dtype=np.int32, count=1)  # ending header
+        np.fromfile(fid, dtype=np.int32, count=4)  # Header
 
-                # Metadata
-                zarr_dataset.attrs["_ARRAY_DIMENSIONS"] = ["time", "z", "y", "x"]
-                zarr_dataset.attrs["long_name"] = output_name
-                zarr_dataset.attrs["units"] = output.units
-                # Write each timestep to the output's zarr dataset
-                for time_step in range(len(output.times)):
-                    data = self.to_numpy(output_name, time_step)
-                    zarr_dataset[time_step, ...] = data[0, ...]
-
-                # Build datasets for coordinates
-                # Build time coordinate
-                zarr_dataset = zarr_file.create_dataset(
-                    "time", shape=len(output.times), dtype=int
-                )
-                # Metadata
-                zarr_dataset.attrs["_ARRAY_DIMENSIONS"] = ["time"]
-                zarr_dataset.attrs["long_name"] = "Time since start of simulation"
-                zarr_dataset.attrs["units"] = "s"
-                # Store Values
-                zarr_dataset[...] = np.array(output.times)
-
-                # Build z coordinate
-                zarr_dataset = zarr_file.create_dataset(
-                    "z", shape=output.shape[0], dtype=int
-                )
-                # Metadata
-                zarr_dataset.attrs["_ARRAY_DIMENSIONS"] = ["z"]
-                zarr_dataset.attrs[
-                    "long_name"
-                ] = "cell height: bottom of cell from ground"
-                zarr_dataset.attrs["units"] = "m"
-                # Store Values
-                zarr_dataset[...] = np.array(range(output.shape[0])) * dz
-
-                # Build y coordinate
-                zarr_dataset = zarr_file.create_dataset(
-                    "y", shape=output.shape[1], dtype=int
-                )
-                # Metadata
-                zarr_dataset.attrs["_ARRAY_DIMENSIONS"] = ["y"]
-                zarr_dataset.attrs[
-                    "long_name"
-                ] = "Latitude: cell dist north from southern edge of domain"
-                zarr_dataset.attrs["units"] = "m"
-                # Store Values
-                zarr_dataset[...] = np.array(range(output.shape[1])) * dy
-
-                # Build x coordinate
-                zarr_dataset = zarr_file.create_dataset(
-                    "x", shape=output.shape[2], dtype=int
-                )
-                # Metadata
-                zarr_dataset.attrs["_ARRAY_DIMENSIONS"] = ["x"]
-                zarr_dataset.attrs[
-                    "long_name"
-                ] = "Longitude: cell dist east from western edge of domain"
-                zarr_dataset.attrs["units"] = "m"
-                # Store Values
-                zarr_dataset[...] = np.array(range(0, output.shape[2])) * dx
+        return (
+            quic_nz,
+            quic_grid_bottom[:],
+            num_eng_to_atmos_cells,
+            eng_to_amos_grid_bottom[:],
+        )
 
-                zarr.convenience.consolidate_metadata(zarr_path)
-        return
 
-    # #Anthony's method
-    # def to_zarr(
-    #     self, fpath: str | Path, outputs: str | list[str] = None
-    # ) -> zarr.hierarchy.Group:
-    #     """
-    #     Write the outputs to a zarr file.
-
-    #     Parameters
-    #     ----------
-    #     fpath: str | Path
-    #         The path to the zarr file to be written.
-    #     outputs: str | list[str]
-    #         The name of the output(s) to write to the zarr file. If None, then
-    #         all outputs are written to the zarr file.
-
-    #     Returns
-    #     -------
-    #     zarr.hierarchy.Group
-    #         The zarr file object.
-    #     """
-    #     if isinstance(fpath, str):
-    #         fpath = Path(fpath)
-
-    #     # Create the zarr file
-    #     zarr_file = zarr.open(str(fpath), mode="w")
-
-    #     # Get a list of outputs to write to the zarr file
-    #     if outputs is None:
-    #         outputs = self.list_available_outputs()
-    #     elif isinstance(outputs, str):
-    #         outputs = [outputs]
-
-    #     # Write each output to the zarr file
-    #     for output_name in outputs:
-    #         # Get the output object and verify it exists
-    #         output = self.get_output(output_name)
-
-    #         # Create a zarr dataset for the output
-    #         shape = (len(output.times), *output.shape)
-    #         chunks = [1 if i == 0 else shape[i] for i in range(len(shape))]
-    #         zarr_dataset = zarr_file.create_dataset(
-    #             output_name, shape=shape, chunks=chunks, dtype=float
-    #         )
-    #         zarr_dataset.attrs["_ARRAY_DIMENSIONS"] = ["time", "z", "y", "x"]
-
-    #         # Write each timestep to the output's zarr dataset
-    #         for time_step in range(len(output.times)):
-    #             data = self.to_numpy(output_name, time_step)
-    #             zarr_dataset[time_step, ...] = data[0, ...]
+def _process_fire_indexes(path_to_fire_indexes_bin: str | Path) -> ndarray:
+    """
+    Process the `fire_indexes.bin` file to extract the necessary
+    information to rebuild the 3D fields of fire and fuel related variables.
+    Function returns a 2D ndarray of shape (num_cells, 3) representing the
+    i, j, k indexes of each cell that contains data in the sparse (compressed)
+    format.
+    """
+    if isinstance(path_to_fire_indexes_bin, str):
+        path_to_fire_indexes_bin = Path(path_to_fire_indexes_bin)
+
+    with open(path_to_fire_indexes_bin, "rb") as fid:
+        np.fromfile(fid, dtype=np.int32, count=1)  # Header
+        num_cells = np.fromfile(fid, dtype=np.int32, count=1)[0]
+        np.fromfile(fid, dtype=np.int32, count=2)  # Header
+        np.fromfile(fid, dtype=np.int32, count=1)  # max k index
+        np.fromfile(fid, dtype=np.int32, count=2)  # Header
+        np.fromfile(fid, dtype=np.int32, count=num_cells)  # unique cell IDs
+        np.fromfile(fid, dtype=np.int32, count=2)  # Header
+
+        # Initialize an array to hold the indices
+        ijk = np.zeros((num_cells, 3), dtype=np.int32)
+
+        # Loop over each dimension's indices (Like a sparse meshgrid)
+        for i in range(0, 3):
+            ijk[:, i] = np.fromfile(fid, dtype=np.int32, count=num_cells)
+
+        # Convert to indices (numbered from 0)
+        ijk -= 1
 
-    #     return zarr_file
+        return ijk
 
 
 def _process_compressed_bin(filename, dim_zyx, *args) -> ndarray:
     """
     Converts the contents of a sparse .bin file to a dense array with shape
     (1, nz, ny, nx).
 
@@ -837,15 +977,15 @@
             fire_indexes[:, 0],  # i indices (x)
         )
 
         # Update the full array with the sparse indices
         array_3d[indices] = sparse_values
 
     full_array[0, ...] = array_3d
-    return full_array.astype(float)
+    return full_array
 
 
 def _process_gridded_bin(filename, dims_zyx, *args) -> ndarray:
     """
     Converts the data stored in a gridded .bin file to an np array. The
     function takes in a 3D array of dimensions (nz, ny, nx) and returns an
     array of shape (1, nz, ny, nx).
```

### Comparing `quicfire-tools-0.6.4/quicfire_tools/topography.py` & `quicfire-tools-0.7.1/quicfire_tools/topography.py`

 * *Files 12% similar despite different names*

```diff
@@ -1,22 +1,22 @@
 """
 QUIC-Fire Tools Topography Model
 """
+
 from __future__ import annotations
 
 # Core Imports
 from enum import Enum
 
 # External Imports
 from typing import Literal
-
 from pydantic import BaseModel, Field, PositiveFloat, SerializeAsAny
 
 
-class TopoSources(int, Enum):
+class TopoFlags(int, Enum):
     """
     Enum class for all valid topography source options in QUIC-Fire.
     """
 
     flat = 0
     gaussian_hill = 1
     hill_pass = 2
@@ -27,35 +27,35 @@
     sinusoid = 7
     cos_hill = 8
     QP_elevation_bin = 9
     terrainOutput_txt = 10
     terrain_dat = 11
 
 
-class TopoType(BaseModel):
+class Topography(BaseModel):
     """
     Base class for all topography types in QUIC-Fire. This class is used to
     provide a common string representation for all topography types.
     """
 
-    topo_flag: SerializeAsAny[TopoSources]
+    topo_flag: SerializeAsAny[TopoFlags]
 
     def __str__(self):
         return (
             f"{self.topo_flag.value}\t\t! N/A, "
             f"topo flag: 0 = flat, 1 = Gaussian hill, "
             f"2 = hill pass, 3 = slope mesa, 4 = canyon, "
             f"5 = custom, 6 = half circle, 7 = sinusoid, "
             f"8 = cos hill, 9 = QP_elevation.inp, "
             f"10 = terrainOutput.txt (ARA), "
             f"11 = terrain.dat (firetec)"
         )
 
 
-class GaussianHillTopo(TopoType):
+class GaussianHillTopo(Topography):
     """
     Creates a Gaussian hill topography in QUIC-Fire.
 
     Attributes
     ----------
     x_hilltop : PositiveFloat
         Gaussian hill top location x-direction [m]
@@ -63,15 +63,15 @@
         Gaussian hill top location y-direction [m]
     elevation_max : PositiveFloat
         Maximum elevation of the Gaussian hill [m]
     elevation_std : PositiveFloat
         Standard deviation of the Gaussian hill [m]
     """
 
-    topo_flag: SerializeAsAny[TopoSources] = TopoSources(1)
+    topo_flag: SerializeAsAny[TopoFlags] = TopoFlags(1)
     x_hilltop: PositiveFloat
     y_hilltop: PositiveFloat
     elevation_max: PositiveFloat
     elevation_std: PositiveFloat
 
     def __str__(self):
         flag_line = super().__str__()
@@ -80,67 +80,67 @@
             f"{self.y_hilltop}\t! m, y-center\n"
             f"{self.elevation_max}\t! m, max height\n"
             f"{self.elevation_std}\t! m, std"
         )
         return flag_line + params
 
 
-class HillPassTopo(TopoType):
+class HillPassTopo(Topography):
     """
     Creates a hill pass topography in QUIC-Fire.
 
     Attributes
     ----------
     max_height : PositiveFloat
         Maximum elevation of the hill pass [m]
     location_param : PositiveFloat
         Location parameter of the hill pass [m]
     """
 
-    topo_flag: SerializeAsAny[TopoSources] = TopoSources(2)
+    topo_flag: SerializeAsAny[TopoFlags] = TopoFlags(2)
     max_height: PositiveFloat
     location_param: PositiveFloat
 
     def __str__(self):
         flag_line = super().__str__()
         params = (
             f"\n{self.max_height}\t! m, max height\n"
             f"{self.location_param}\t! m, location parameter"
         )
         return flag_line + params
 
 
-class SlopeMesaTopo(TopoType):
+class SlopeMesaTopo(Topography):
     """
     Creates a slope mesa topography in QUIC-Fire.
 
     Attributes
     ----------
     slope_axis : Literal[0, 1]
         Slope axis (0 = x, 1 = y)
     slope_value : float
         Slope in dh/dx or dh/dy
     """
 
-    topo_flag: SerializeAsAny[TopoSources] = TopoSources(3)
+    topo_flag: SerializeAsAny[TopoFlags] = TopoFlags(3)
     slope_axis: Literal[0, 1]
     slope_value: PositiveFloat
     flat_fraction: float = Field(ge=0, le=1)
 
     def __str__(self):
         flag_line = super().__str__()
         params = (
             f"\n{self.slope_axis}\t! N/A, slope axis (0 = x, 1 = y)\n"
             f"{self.slope_value}\t! N/A, slope val (dh/dx)\n"
             f"{self.flat_fraction}\t! N/A, fraction of domain that is flat"
         )
         return flag_line + params
 
 
-class CanyonTopo(TopoType):
+class CanyonTopo(Topography):
     """
     Creates a canyon topography in QUIC-Fire.
 
     Attributes
     ----------
     x_location: PositiveFloat
         Canyon location in x-dir [m].
@@ -150,15 +150,15 @@
         Slope in dh/dx or dy/dy [-].
     canyon_std: PositiveFloat
         Canyon function standard deviation [m].
     vertical_offset: PositiveFloat
         Canyon vertical offset [m].
     """
 
-    topo_flag: SerializeAsAny[TopoSources] = TopoSources(4)
+    topo_flag: SerializeAsAny[TopoFlags] = TopoFlags(4)
     x_location: PositiveFloat
     y_location: PositiveFloat
     slope_value: PositiveFloat
     canyon_std: PositiveFloat
     vertical_offset: PositiveFloat
 
     def __str__(self):
@@ -169,78 +169,98 @@
             f"{self.slope_value}\t! N/A, slope\n"
             f"{self.canyon_std}\t! m, std\n"
             f"{self.vertical_offset}\t! m, height offset of the bottom of the canyon"
         )
         return flag_line + params
 
 
-class HalfCircleTopo(TopoType):
+class HalfCircleTopo(Topography):
     """
     Creates a half-circle topography in QUIC-Fire.
 
     Attributes
     ----------
     x_location: PositiveFloat
         The x-coordinate of the center of the half-circle topography [m].
     y_location: PositiveFloat
         The y-coordinate of the center of the half-circle topography [m].
     radius: PositiveFloat
         The radius of the half-circle topography [m].
     """
 
-    topo_flag: SerializeAsAny[TopoSources] = TopoSources(6)
+    topo_flag: SerializeAsAny[TopoFlags] = TopoFlags(6)
     x_location: PositiveFloat
     y_location: PositiveFloat
     radius: PositiveFloat
 
     def __str__(self):
         flag_line = super().__str__()
         params = (
             f"\n{self.x_location}\t! m, x-location\n"
             f"{self.y_location}\t! m, y-location\n"
             f"{self.radius}\t! m, radius of half circle"
         )
         return flag_line + params
 
 
-class SinusoidTopo(TopoType):
+class SinusoidTopo(Topography):
     """
     Creates a sinusoidal topography in QUIC-Fire.
 
     Attributes
     ----------
     period: PositiveFloat
         The period of the sinusoidal wave [m].
     amplitude: PositiveFloat
         The amplitude of the sinusoidal wave [m].
     """
 
-    topo_flag: SerializeAsAny[TopoSources] = TopoSources(7)
+    topo_flag: SerializeAsAny[TopoFlags] = TopoFlags(7)
     period: PositiveFloat
     amplitude: PositiveFloat
 
     def __str__(self):
         flag_line = super().__str__()
         params = f"\n{self.period}\t! m, period\n" f"{self.amplitude}\t! m, amplitude"
         return flag_line + params
 
 
-class CosHillTopo(TopoType):
+class CosHillTopo(Topography):
     """
     Creates a cosine-shaped hill topography in QUIC-Fire.
 
     Attributes
     ----------
     aspect: PositiveFloat
         The aspect (or orientation) of the hill [-].
     height: PositiveFloat
         The height of the hill [m].
     """
 
-    topo_flag: SerializeAsAny[TopoSources] = TopoSources(8)
+    topo_flag: SerializeAsAny[TopoFlags] = TopoFlags(8)
     aspect: PositiveFloat
     height: PositiveFloat
 
     def __str__(self):
         flag_line = super().__str__()
         params = f"\n{self.aspect}\t! [0], aspect\n" f"{self.height}\t! m, height"
         return flag_line + params
+
+
+def serialize_topography(topo_data: dict):
+    topo_flag = topo_data.get("topo_flag")
+    if topo_flag == TopoFlags(1):
+        return GaussianHillTopo(**topo_data)
+    elif topo_flag == TopoFlags(2):
+        return HillPassTopo(**topo_data)
+    elif topo_flag == TopoFlags(3):
+        return SlopeMesaTopo(**topo_data)
+    elif topo_flag == TopoFlags(4):
+        return CanyonTopo(**topo_data)
+    elif topo_flag == TopoFlags(6):
+        return HalfCircleTopo(**topo_data)
+    elif topo_flag == TopoFlags(7):
+        return SinusoidTopo(**topo_data)
+    elif topo_flag == TopoFlags(8):
+        return CosHillTopo(**topo_data)
+    else:
+        return Topography(**topo_data)
```

### Comparing `quicfire-tools-0.6.4/quicfire_tools.egg-info/PKG-INFO` & `quicfire-tools-0.7.1/quicfire_tools.egg-info/PKG-INFO`

 * *Files 12% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: quicfire-tools
-Version: 0.6.4
+Version: 0.7.1
 Summary: Input and output management tools for the QUIC-Fire fire model
 Home-page: https://github.com/silvxlabs/quicfire-tools
 License: MIT
 Project-URL: Bug Tracker, https://github.com/silvxlabs/quicfire-tools/issues
 Classifier: Intended Audience :: Developers
 Classifier: Intended Audience :: Science/Research
 Classifier: License :: OSI Approved :: MIT License
@@ -15,17 +15,20 @@
 Classifier: Programming Language :: Python :: 3.11
 Classifier: Programming Language :: Python :: 3.12
 Classifier: Topic :: Scientific/Engineering
 Requires-Python: >=3.8
 Description-Content-Type: text/markdown
 License-File: LICENSE
 Requires-Dist: dask
+Requires-Dist: dask-expr
+Requires-Dist: netCDF4
 Requires-Dist: numpy<2
 Requires-Dist: pandera
 Requires-Dist: pydantic>=2
+Requires-Dist: pyproj
 Requires-Dist: zarr>=2
 
 # quicfire-tools
 
 ## Quick-Links
 
 [Documentation](https://silvxlabs.github.io/quicfire-tools/) - [PyPi Package](https://pypi.org/project/quicfire-tools/)
```

### Comparing `quicfire-tools-0.6.4/quicfire_tools.egg-info/SOURCES.txt` & `quicfire-tools-0.7.1/quicfire_tools.egg-info/SOURCES.txt`

 * *Files 1% similar despite different names*

```diff
@@ -1,12 +1,11 @@
 LICENSE
 README.md
 setup.py
 ./quicfire_tools/__init__.py
-./quicfire_tools/examples.py
 ./quicfire_tools/ignitions.py
 ./quicfire_tools/inputs.py
 ./quicfire_tools/outputs.py
 ./quicfire_tools/topography.py
 ./quicfire_tools/utils.py
 ./quicfire_tools/data/documentation/IgnitionType.json
 ./quicfire_tools/data/documentation/QFire_Advanced_User_Inputs.inp.json
@@ -58,8 +57,9 @@
 ./quicfire_tools/data/templates/v6/rasterorigin.txt
 ./quicfire_tools/data/templates/v6/sensor.inp
 quicfire_tools.egg-info/PKG-INFO
 quicfire_tools.egg-info/SOURCES.txt
 quicfire_tools.egg-info/dependency_links.txt
 quicfire_tools.egg-info/requires.txt
 quicfire_tools.egg-info/top_level.txt
-tests/test_input_module.py
+tests/test_inputs.py
+tests/test_outputs.py
```

### Comparing `quicfire-tools-0.6.4/setup.py` & `quicfire-tools-0.7.1/setup.py`

 * *Files identical despite different names*

### Comparing `quicfire-tools-0.6.4/tests/test_input_module.py` & `quicfire-tools-0.7.1/tests/test_inputs.py`

 * *Files 5% similar despite different names*

```diff
@@ -1,12 +1,14 @@
 """
 Test module for the data module of the quicfire_tools package.
 """
+
 from __future__ import annotations
 
+import shutil
 import pytest
 from pydantic import ValidationError
 from pandera.errors import SchemaError
 from pathlib import Path
 import pandas as pd
 
 from quicfire_tools.inputs import (
@@ -26,25 +28,37 @@
     QP_buildout,
     QU_metparams,
     SimulationInputs,
     WindSensorArray,
     WindSensor,
 )
 from quicfire_tools.ignitions import (
-    IgnitionType,
-    IgnitionSources,
+    Ignition,
+    IgnitionFlags,
     RectangleIgnition,
+    SquareRingIgnition,
+)
+from quicfire_tools.topography import (
+    Topography,
+    TopoFlags,
+    GaussianHillTopo,
+    CanyonTopo,
+    CosHillTopo,
+    HillPassTopo,
+    SinusoidTopo,
+    SlopeMesaTopo,
 )
-from quicfire_tools.topography import TopoType, TopoSources, GaussianHillTopo
 
 TEST_DIR = Path(__file__).parent
+TEST_DATA_DIR = TEST_DIR / "data" / "test-inputs"
+SAMPLES_DIR = TEST_DIR / "data" / "samples"
 TMP_DIR = TEST_DIR / "tmp"
+if TMP_DIR.exists():
+    shutil.rmtree(TMP_DIR)
 TMP_DIR.mkdir(exist_ok=True)
-TEST_DATA_DIR = TEST_DIR / "data" / "test-inputs"
-TEST_DATA_DIR.mkdir(exist_ok=True)
 
 
 class TestInputFile:
     def test_to_file_v5(self):
         input_file = InputFile(name="QP_buildout")
         input_file._extension = ".inp"
         input_file.to_file(TMP_DIR, version="v5")
@@ -447,15 +461,15 @@
         qu_simparams.nz = 30
         assert qu_simparams.nz == 30
         assert len(qu_simparams._dz_array) == 30
         assert len(qu_simparams._vertical_grid_lines.split("\n")) == 33
 
         # Test data type casting
         qu_simparams = QU_Simparams(
-            nx="100", ny=100, nz=26, dx=2, dy=2, quic_domain_height=5, wind_times=["0."]
+            nx="100", ny=100, nz=26, dx=2, dy=2, quic_domain_height=5, wind_times=[0.0]
         )
         assert qu_simparams.nx == 100
         assert qu_simparams.wind_times == [0]
 
         # Test invalid stretch_grid_flags
         for invalid_flag in [-1, 4, "1", 1.0, 1.5, 2]:
             with pytest.raises(ValidationError):
@@ -738,15 +752,17 @@
         Test initializing a class from a QU_simparams.inp file.
         """
         # Test stretch grid flag = 3
         qu_simparams = self.get_test_object()
         qu_simparams.to_file(TMP_DIR)
         test_object = QU_Simparams.from_file(TMP_DIR)
         assert isinstance(test_object, QU_Simparams)
-        assert qu_simparams == test_object
+        test_object_dict = test_object.to_dict()
+        qu_simparams_dict = qu_simparams.to_dict()
+        assert test_object_dict == qu_simparams_dict
 
         # # Test stretch grid flag = 0
         # qu_simparams = self.get_test_object()
         # qu_simparams.stretch_grid_flag = 0
         # qu_simparams.to_file(TMP_DIR)
         # test_object = QU_Simparams.from_file(TMP_DIR)
         # assert isinstance(test_object, QU_Simparams)
@@ -960,17 +976,15 @@
 class TestQUIC_fire:
     @staticmethod
     def get_basic_test_object():
         return QUIC_fire(
             nz=26,
             sim_time=60,
             time_now=1695311421,
-            ignition_type=RectangleIgnition(
-                x_min=20, y_min=20, x_length=10, y_length=160
-            ),
+            ignition=RectangleIgnition(x_min=20, y_min=20, x_length=10, y_length=160),
         )
 
     def test_init(self):
         # Test default initialization
         quic_fire = self.get_basic_test_object()
         assert quic_fire.nz == 26
         assert quic_fire.sim_time == 60
@@ -1065,25 +1079,20 @@
         assert result_dict["fuel_height"] == quic_fire.fuel_height
         assert result_dict["size_scale_flag"] == quic_fire.size_scale_flag
         assert result_dict["size_scale"] == quic_fire.size_scale
         assert result_dict["patch_and_gap_flag"] == quic_fire.patch_and_gap_flag
         assert result_dict["patch_size"] == quic_fire.patch_size
         assert result_dict["gap_size"] == quic_fire.gap_size
         assert (
-            result_dict["ignition_type"]["ignition_flag"]
-            == quic_fire.ignition_type.ignition_flag
-        )
-        assert result_dict["ignition_type"]["x_min"] == quic_fire.ignition_type.x_min
-        assert result_dict["ignition_type"]["y_min"] == quic_fire.ignition_type.y_min
-        assert (
-            result_dict["ignition_type"]["x_length"] == quic_fire.ignition_type.x_length
-        )
-        assert (
-            result_dict["ignition_type"]["y_length"] == quic_fire.ignition_type.y_length
+            result_dict["ignition"]["ignition_flag"] == quic_fire.ignition.ignition_flag
         )
+        assert result_dict["ignition"]["x_min"] == quic_fire.ignition.x_min
+        assert result_dict["ignition"]["y_min"] == quic_fire.ignition.y_min
+        assert result_dict["ignition"]["x_length"] == quic_fire.ignition.x_length
+        assert result_dict["ignition"]["y_length"] == quic_fire.ignition.y_length
         assert result_dict["ignitions_per_cell"] == quic_fire.ignitions_per_cell
         assert result_dict["firebrand_flag"] == quic_fire.firebrand_flag
         assert result_dict["auto_kill"] == quic_fire.auto_kill
         assert result_dict["eng_to_atm_out"] == quic_fire.eng_to_atm_out
         assert result_dict["react_rate_out"] == quic_fire.react_rate_out
         assert result_dict["fuel_dens_out"] == quic_fire.fuel_dens_out
         assert result_dict["qf_wind_out"] == quic_fire.qf_wind_out
@@ -1154,15 +1163,15 @@
             current_line += 1  # header
             ignition_flag = int(lines[current_line].strip().split("!")[0])
             ignition_params = []
             current_line += 1
             for i in range(current_line, current_line + 4):
                 ignition_params.append(float(lines[i].strip().split("!")[0]))
             x_min, y_min, x_length, y_length = ignition_params
-            assert quic_fire.ignition_type == RectangleIgnition(
+            assert quic_fire.ignition == RectangleIgnition(
                 ignition_flag=ignition_flag,
                 x_min=x_min,
                 y_min=y_min,
                 x_length=x_length,
                 y_length=y_length,
             )
             current_line += 4
@@ -1577,34 +1586,34 @@
         test_object = QFire_Plume_Advanced_User_Inputs.from_file(TMP_DIR)
         assert isinstance(test_object, QFire_Plume_Advanced_User_Inputs)
         assert plume_inputs == test_object
 
 
 class TestQUTopoInputs:
     def get_default_test_object(self):
-        return QU_TopoInputs(topo_type=TopoType(topo_flag=0))
+        return QU_TopoInputs(topography=Topography(topo_flag=0))
 
     def get_complex_test_object(self):
         return QU_TopoInputs(
-            topo_type=GaussianHillTopo(
+            topography=GaussianHillTopo(
                 x_hilltop=100, y_hilltop=150, elevation_max=500, elevation_std=20
             ),
             smoothing_method=1,
             sor_relax=1.78,
         )
 
     def test_default_inputs(self):
         topoinputs = self.get_default_test_object()
         assert topoinputs.filename == "topo.dat"
-        assert isinstance(topoinputs.topo_type, TopoType)
+        assert isinstance(topoinputs.topography, Topography)
         assert topoinputs.smoothing_passes == 500
 
     def test_complex_inputs(self):
         topoinputs = self.get_complex_test_object()
-        assert topoinputs.topo_type.topo_flag.value == 1
+        assert topoinputs.topography.topo_flag.value == 1
         assert topoinputs._topo_lines == (
             "1\t\t! N/A, "
             "topo flag: 0 = flat, 1 = Gaussian hill, "
             "2 = hill pass, 3 = slope mesa, 4 = canyon, "
             "5 = custom, 6 = half circle, 7 = sinusoid, "
             "8 = cos hill, 9 = QP_elevation.inp, "
             "10 = terrainOutput.txt (ARA), "
@@ -1624,23 +1633,23 @@
         assert test_dict["smoothing_passes"] == topoinputs.smoothing_passes
         assert test_dict["sor_iterations"] == topoinputs.sor_iterations
         assert test_dict["sor_cycles"] == topoinputs.sor_cycles
         assert test_dict["sor_relax"] == topoinputs.sor_relax
 
         topoinputs = self.get_complex_test_object()
         test_dict = topoinputs.to_dict()
-        assert test_dict["topo_type"]["x_hilltop"] == topoinputs.topo_type.x_hilltop
-        assert test_dict["topo_type"]["y_hilltop"] == topoinputs.topo_type.y_hilltop
+        assert test_dict["topography"]["x_hilltop"] == topoinputs.topography.x_hilltop
+        assert test_dict["topography"]["y_hilltop"] == topoinputs.topography.y_hilltop
         assert (
-            test_dict["topo_type"]["elevation_max"]
-            == topoinputs.topo_type.elevation_max
+            test_dict["topography"]["elevation_max"]
+            == topoinputs.topography.elevation_max
         )
         assert (
-            test_dict["topo_type"]["elevation_std"]
-            == topoinputs.topo_type.elevation_std
+            test_dict["topography"]["elevation_std"]
+            == topoinputs.topography.elevation_std
         )
         assert test_dict["smoothing_method"] == topoinputs.smoothing_method
         assert test_dict["smoothing_passes"] == topoinputs.smoothing_passes
         assert test_dict["sor_iterations"] == topoinputs.sor_iterations
         assert test_dict["sor_cycles"] == topoinputs.sor_cycles
         assert test_dict["sor_relax"] == topoinputs.sor_relax
 
@@ -1652,15 +1661,15 @@
 
     def test_to_file(self):
         topoinputs = self.get_default_test_object()
         topoinputs.to_file(TMP_DIR)
         with open(TMP_DIR / "QU_TopoInputs.inp", "r") as file:
             lines = file.readlines()
         topo_flag = int(lines[2].strip().split("!")[0])
-        assert topo_flag == topoinputs.topo_type.topo_flag.value
+        assert topo_flag == topoinputs.topography.topo_flag.value
         add_dict = {
             0: 0,
             1: 4,
             2: 2,
             3: 3,
             4: 5,
             5: 0,
@@ -1693,15 +1702,15 @@
         )
 
         topoinputs = self.get_complex_test_object()
         topoinputs.to_file(TMP_DIR)
         with open(TMP_DIR / "QU_TopoInputs.inp", "r") as file:
             lines = file.readlines()
         topo_flag = int(lines[2].strip().split("!")[0])
-        assert topo_flag == topoinputs.topo_type.topo_flag.value
+        assert topo_flag == topoinputs.topography.topo_flag.value
         add_dict = {
             0: 0,
             1: 4,
             2: 2,
             3: 3,
             4: 5,
             5: 0,
@@ -1709,21 +1718,21 @@
             7: 2,
             8: 2,
             9: 0,
             10: 0,
             11: 0,
         }
         add = add_dict.get(topo_flag)
-        assert float(lines[3].strip().split("!")[0]) == topoinputs.topo_type.x_hilltop
-        assert float(lines[4].strip().split("!")[0]) == topoinputs.topo_type.y_hilltop
+        assert float(lines[3].strip().split("!")[0]) == topoinputs.topography.x_hilltop
+        assert float(lines[4].strip().split("!")[0]) == topoinputs.topography.y_hilltop
         assert (
-            float(lines[5].strip().split("!")[0]) == topoinputs.topo_type.elevation_max
+            float(lines[5].strip().split("!")[0]) == topoinputs.topography.elevation_max
         )
         assert (
-            float(lines[6].strip().split("!")[0]) == topoinputs.topo_type.elevation_std
+            float(lines[6].strip().split("!")[0]) == topoinputs.topography.elevation_std
         )
         current_line = current_line = 3 + add
         assert (
             int(lines[current_line].strip().split("!")[0])
             == topoinputs.smoothing_method
         )
         assert (
@@ -1776,35 +1785,23 @@
     def get_test_object(self):
         return QU_movingcoords()
 
     def test_init(self):
         qu_moving = self.get_test_object()
         assert isinstance(qu_moving, QU_movingcoords)
 
-    def test_from_file(self):
-        qu_moving = self.get_test_object()
-        qu_moving.to_file(TMP_DIR)
-        test_object = QU_movingcoords.from_file(TMP_DIR)
-        assert qu_moving == test_object
-
 
 class TestQUbuildout:
     def get_test_object(self):
         return QP_buildout()
 
     def test_init(self):
         qp_buildout = self.get_test_object()
         assert isinstance(qp_buildout, QP_buildout)
 
-    def test_from_file(self):
-        qp_buildout = self.get_test_object()
-        qp_buildout.to_file(TMP_DIR)
-        test_object = QP_buildout.from_file(TMP_DIR)
-        assert qp_buildout == test_object
-
 
 class Test_QU_metparams:
     def get_test_object(self):
         return QU_metparams()
 
     def test_init(self):
         qu_metparams = self.get_test_object()
@@ -2174,21 +2171,14 @@
             ny=150,
             fire_nz=1,
             wind_speed=5.0,
             wind_direction=90,
             simulation_time=65,
         )
 
-    @staticmethod
-    def compare_simulation_inputs(a: SimulationInputs, b: SimulationInputs):
-        for a_input_file, b_input_file in zip(
-            a._input_files_dict.values(), b._input_files_dict.values()
-        ):
-            assert a_input_file == b_input_file
-
     def test_basic_inputs(self):
         sim_inputs = self.get_test_object()
         assert isinstance(sim_inputs, SimulationInputs)
 
     def test_input_files(self):
         sim_inputs = self.get_test_object()
         assert isinstance(sim_inputs.gridlist, Gridlist)
@@ -2259,15 +2249,15 @@
         sim_inputs = self.get_test_object()
         sim_inputs.set_rectangle_ignition(
             x_min=20,
             y_min=20,
             x_length=10,
             y_length=110,
         )
-        assert sim_inputs.quic_fire.ignition_type == RectangleIgnition(
+        assert sim_inputs.quic_fire.ignition == RectangleIgnition(
             x_min=20,
             y_min=20,
             x_length=10,
             y_length=110,
         )
 
     def test_set_output_files(self):
@@ -2281,38 +2271,52 @@
         assert sim_inputs.quic_fire.qu_wind_avg_out == 0
         assert sim_inputs.quic_fire.fuel_moist_out == 0
         assert sim_inputs.quic_fire.mass_burnt_out == 1
         assert sim_inputs.quic_fire.radiation_out == 0
         assert sim_inputs.quic_fire.surf_eng_out == 0
         assert sim_inputs.quic_fire.emissions_out == 2
 
+    def test_set_output_times(self):
+        sim_inputs = self.get_test_object()
+        sim_inputs.set_output_interval(60)
+        assert sim_inputs.quic_fire.out_time_fire == 60
+        assert sim_inputs.quic_fire.out_time_wind == 60
+        assert sim_inputs.quic_fire.out_time_wind_avg == 60
+        assert sim_inputs.quic_fire.out_time_emis_rad == 60
+
+        # Test with invalid intervals
+        with pytest.raises(ValueError):
+            sim_inputs.set_output_interval(-1)
+        with pytest.raises(ValueError):
+            sim_inputs.set_output_interval(0)
+        with pytest.raises(ValueError):
+            sim_inputs.set_output_interval("a")
+
     def test_set_custom_simulation(self):
         # Test default set custom simulation (no arguments)
         sim_inputs = self.get_test_object()
         sim_inputs.set_custom_simulation()
         assert sim_inputs.quic_fire.fuel_density_flag == 3
         assert sim_inputs.quic_fire.fuel_moisture_flag == 3
         assert sim_inputs.quic_fire.fuel_height_flag == 3
         assert sim_inputs.quic_fire.size_scale_flag == 0  # Default
         assert sim_inputs.quic_fire.patch_and_gap_flag == 0  # Default
-        assert sim_inputs.quic_fire.ignition_type == IgnitionType(
-            ignition_flag=IgnitionSources(7)
-        )
-        assert sim_inputs.qu_topoinputs.topo_type == TopoType(topo_flag=TopoSources(5))
+        assert sim_inputs.quic_fire.ignition == Ignition(ignition_flag=IgnitionFlags(7))
+        assert sim_inputs.qu_topoinputs.topography == Topography(topo_flag=TopoFlags(5))
 
         # Test including size scale and patch/gap from set custom simulation
         sim_inputs = self.get_test_object()
         sim_inputs.set_custom_simulation(size_scale=True, patch_and_gap=True)
         assert sim_inputs.quic_fire.size_scale_flag == 3
         assert sim_inputs.quic_fire.patch_and_gap_flag == 2
 
         # Test excluding topo flag from set custom simulation
         sim_inputs = self.get_test_object()
         sim_inputs.set_custom_simulation(topo=False)
-        assert sim_inputs.qu_topoinputs.topo_type == TopoType(topo_flag=TopoSources(0))
+        assert sim_inputs.qu_topoinputs.topography == Topography(topo_flag=TopoFlags(0))
 
     def test_write_inputs_v5(self):
         sim_inputs = self.get_test_object()
         sim_inputs.write_inputs(TMP_DIR, version="v5")
 
     def test_write_inputs_v6(self):
         sim_inputs = self.get_test_object()
@@ -2496,34 +2500,248 @@
         for file in [sensor2, sensor3]:
             if file.exists():
                 file.unlink()
         test_object = SimulationInputs.from_directory(TMP_DIR)
         assert isinstance(test_object, SimulationInputs)
 
         # Check that the inputs are the same
-        self.compare_simulation_inputs(sim_inputs, test_object)
+        compare_simulation_inputs(sim_inputs, test_object)
+
+    def test_from_directory_optional_files(self):
+        sim_inputs = self.get_test_object()
+        sim_inputs.write_inputs(TMP_DIR)
+
+        # Remove optional files
+        gridlist_path = TMP_DIR / "gridlist"
+        gridlist_path.unlink()
+        raster_origin_path = TMP_DIR / "rasterorigin.txt"
+        raster_origin_path.unlink()
+
+        test_object = SimulationInputs.from_directory(TMP_DIR)
+        assert isinstance(test_object, SimulationInputs)
+        compare_simulation_inputs(sim_inputs, test_object)
+
+    def test_from_directory_missing_files(self):
+        sim_inputs = self.get_test_object()
+        sim_inputs.write_inputs(TMP_DIR)
+        quic_fire_path = TMP_DIR / "QUIC_fire.inp"
+        quic_fire_path.unlink()
+
+        with pytest.raises(FileNotFoundError):
+            SimulationInputs.from_directory(TMP_DIR)
 
     def test_to_dict(self):
         sim_inputs = self.get_test_object()
         sim_inputs.to_dict()
 
     def test_from_dict(self):
         sim_inputs = self.get_test_object()
         sim_dict = sim_inputs.to_dict()
         test_obj = SimulationInputs.from_dict(sim_dict)
         assert isinstance(test_obj, SimulationInputs)
 
         # Check that the inputs are the same
-        self.compare_simulation_inputs(sim_inputs, test_obj)
+        compare_simulation_inputs(sim_inputs, test_obj)
 
     def test_to_json(self):
         sim_inputs = self.get_test_object()
         sim_inputs.to_json(TMP_DIR / "test.json")
 
     def test_from_json(self):
         sim_inputs = self.get_test_object()
         sim_inputs.to_json(TMP_DIR / "test.json")
         test_obj = SimulationInputs.from_json(TMP_DIR / "test.json")
         assert isinstance(test_obj, SimulationInputs)
 
         # Check that the inputs are the same
-        self.compare_simulation_inputs(sim_inputs, test_obj)
+        compare_simulation_inputs(sim_inputs, test_obj)
+
+
+class TestSamples:
+    def test_canyon(self):
+        canyon_sim = SimulationInputs.from_directory(SAMPLES_DIR / "Canyon")
+
+        # Check topography
+        assert isinstance(canyon_sim.qu_topoinputs.topography, CanyonTopo)
+        assert canyon_sim.qu_topoinputs.topography.topo_flag == 4
+        assert canyon_sim.qu_topoinputs.topography.x_location == 300
+        assert canyon_sim.qu_topoinputs.topography.y_location == 150
+        assert canyon_sim.qu_topoinputs.topography.canyon_std == 100
+        assert canyon_sim.qu_topoinputs.topography.vertical_offset == 20
+
+        # Check ignition
+        assert isinstance(canyon_sim.quic_fire.ignition, RectangleIgnition)
+        assert canyon_sim.quic_fire.ignition.ignition_flag == 1
+        assert canyon_sim.quic_fire.ignition.x_min == 250
+        assert canyon_sim.quic_fire.ignition.y_min == 225
+        assert canyon_sim.quic_fire.ignition.x_length == 10
+        assert canyon_sim.quic_fire.ignition.y_length == 100
+
+        # Check I/O
+        canyon_sim.write_inputs(TMP_DIR)
+        canyon_sim.to_json(TMP_DIR / "sim.json")
+        canyon_sim_from_json = SimulationInputs.from_json(TMP_DIR / "sim.json")
+        compare_simulation_inputs(canyon_sim, canyon_sim_from_json)
+
+    def test_cos_hill(self):
+        cos_hill = SimulationInputs.from_directory(SAMPLES_DIR / "CosHill")
+
+        # Check topography
+        assert isinstance(cos_hill.qu_topoinputs.topography, CosHillTopo)
+        assert cos_hill.qu_topoinputs.topography.topo_flag == 8
+        assert cos_hill.qu_topoinputs.topography.aspect == 100
+        assert cos_hill.qu_topoinputs.topography.height == 10
+
+        # Check I/O
+        cos_hill.write_inputs(TMP_DIR)
+        cos_hill.to_json(TMP_DIR / "sim.json")
+        cos_hill_from_json = SimulationInputs.from_json(TMP_DIR / "sim.json")
+        compare_simulation_inputs(cos_hill, cos_hill_from_json)
+
+    def test_eglin_canopy(self):
+        eglin_canopy = SimulationInputs.from_directory(SAMPLES_DIR / "EglinCanopyTest")
+
+        # Check topography
+        assert isinstance(eglin_canopy.qu_topoinputs.topography, Topography)
+        assert eglin_canopy.qu_topoinputs.topography.topo_flag == 0
+
+        # Check fuel flags
+        assert eglin_canopy.quic_fire.fuel_density_flag == 5
+        assert eglin_canopy.quic_fire.fuel_moisture_flag == 5
+
+        # Check ignition
+        assert isinstance(eglin_canopy.quic_fire.ignition, Ignition)
+        assert eglin_canopy.quic_fire.ignition.ignition_flag == 7
+
+        # Check I/O
+        eglin_canopy.write_inputs(TMP_DIR)
+        eglin_canopy.to_json(TMP_DIR / "sim.json")
+        eglin_canopy_from_json = SimulationInputs.from_json(TMP_DIR / "sim.json")
+        compare_simulation_inputs(eglin_canopy, eglin_canopy_from_json)
+
+    def test_gauss_hill(self):
+        gauss_hill = SimulationInputs.from_directory(SAMPLES_DIR / "GaussHill")
+
+        # Check topography
+        assert isinstance(gauss_hill.qu_topoinputs.topography, GaussianHillTopo)
+        assert gauss_hill.qu_topoinputs.topography.topo_flag == 1
+        assert gauss_hill.qu_topoinputs.topography.x_hilltop == 400
+        assert gauss_hill.qu_topoinputs.topography.y_hilltop == 300
+        assert gauss_hill.qu_topoinputs.topography.elevation_max == 100
+        assert gauss_hill.qu_topoinputs.topography.elevation_std == 150
+
+        # Check I/O
+        gauss_hill.write_inputs(TMP_DIR)
+        gauss_hill.to_json(TMP_DIR / "sim.json")
+        gauss_hill_from_json = SimulationInputs.from_json(TMP_DIR / "sim.json")
+        compare_simulation_inputs(gauss_hill, gauss_hill_from_json)
+
+    def test_hill_pass(self):
+        hill_pass = SimulationInputs.from_directory(SAMPLES_DIR / "HillPass")
+
+        # Check topography
+        assert isinstance(hill_pass.qu_topoinputs.topography, HillPassTopo)
+        assert hill_pass.qu_topoinputs.topography.topo_flag == 2
+        assert hill_pass.qu_topoinputs.topography.max_height == 70
+        assert hill_pass.qu_topoinputs.topography.location_param == 5
+
+        # Check I/O
+        hill_pass.write_inputs(TMP_DIR)
+        hill_pass.to_json(TMP_DIR / "sim.json")
+        hill_pass_from_json = SimulationInputs.from_json(TMP_DIR / "sim.json")
+        compare_simulation_inputs(hill_pass, hill_pass_from_json)
+
+    def test_line_fire(self):
+        line_fire = SimulationInputs.from_directory(SAMPLES_DIR / "LineFire")
+
+        # Check parabolic quic grid
+        assert line_fire.qu_simparams.stretch_grid_flag == 3
+        assert line_fire.qu_simparams._dz_array[0] == 1
+        assert line_fire.qu_simparams._dz_array[4] == 1
+        assert line_fire.qu_simparams._dz_array[5] == 1.078399
+        assert line_fire.qu_simparams._dz_array[6] == 1.313596
+        assert line_fire.qu_simparams._dz_array[23] == 29.302056
+        assert line_fire.qu_simparams._dz_array[24] == 32.354352
+
+        # Check topography
+        assert isinstance(line_fire.qu_topoinputs.topography, Topography)
+        assert line_fire.qu_topoinputs.topography.topo_flag == 0
+
+        # Check ignition
+        assert isinstance(line_fire.quic_fire.ignition, SquareRingIgnition)
+        assert line_fire.quic_fire.ignition.ignition_flag == 2
+        assert line_fire.quic_fire.ignition.x_min == 50
+        assert line_fire.quic_fire.ignition.y_min == 50
+        assert line_fire.quic_fire.ignition.x_length == 200
+        assert line_fire.quic_fire.ignition.y_length == 200
+        assert line_fire.quic_fire.ignition.x_width == 10
+        assert line_fire.quic_fire.ignition.y_width == 10
+
+        # Check I/O
+        line_fire.write_inputs(TMP_DIR)
+        line_fire.to_json(TMP_DIR / "sim.json")
+        line_fire_from_json = SimulationInputs.from_json(TMP_DIR / "sim.json")
+        compare_simulation_inputs(line_fire, line_fire_from_json)
+
+    def test_sinusoid(self):
+        sinusoid = SimulationInputs.from_directory(SAMPLES_DIR / "Sinusoid")
+
+        # Check topography
+        assert isinstance(sinusoid.qu_topoinputs.topography, SinusoidTopo)
+        assert sinusoid.qu_topoinputs.topography.topo_flag == 7
+        assert sinusoid.qu_topoinputs.topography.period == 20
+        assert sinusoid.qu_topoinputs.topography.amplitude == 80
+
+        # Check I/O
+        sinusoid.write_inputs(TMP_DIR)
+        sinusoid.to_json(TMP_DIR / "sim.json")
+        sinusoid_from_json = SimulationInputs.from_json(TMP_DIR / "sim.json")
+        compare_simulation_inputs(sinusoid, sinusoid_from_json)
+
+    def test_slope_mesa(self):
+        slope_mesa = SimulationInputs.from_directory(SAMPLES_DIR / "SlopeMesa")
+
+        # Check topography
+        assert isinstance(slope_mesa.qu_topoinputs.topography, SlopeMesaTopo)
+        assert slope_mesa.qu_topoinputs.topography.topo_flag == 3
+        assert slope_mesa.qu_topoinputs.topography.slope_axis == 0
+        assert slope_mesa.qu_topoinputs.topography.slope_value == 0.2
+        assert slope_mesa.qu_topoinputs.topography.flat_fraction == 0.5
+
+        # Check I/O
+        slope_mesa.write_inputs(TMP_DIR)
+        slope_mesa.to_json(TMP_DIR / "sim.json")
+        slope_mesa_from_json = SimulationInputs.from_json(TMP_DIR / "sim.json")
+        compare_simulation_inputs(slope_mesa, slope_mesa_from_json)
+
+    def test_transient_winds(self):
+        transient_winds = SimulationInputs.from_directory(
+            SAMPLES_DIR / "TransientWinds"
+        )
+
+        # Check wind sensors
+        assert transient_winds.qu_simparams.wind_times == [1653321600, 1653321700]
+        assert transient_winds.qu_metparams.num_sensors == 1
+        assert len(transient_winds.windsensors) == 1
+        assert isinstance(transient_winds.windsensors.sensor1, WindSensor)
+        assert transient_winds.windsensors.sensor1.wind_times == [0, 100]
+        assert transient_winds.windsensors.sensor1.wind_speeds == [6, 6]
+        assert transient_winds.windsensors.sensor1.wind_directions == [270, 180]
+        assert transient_winds.windsensors.sensor1.sensor_height == 10.0
+
+        # Check I/O
+        transient_winds.write_inputs(TMP_DIR)
+        transient_winds.to_json(TMP_DIR / "sim.json")
+        transient_winds_from_json = SimulationInputs.from_json(TMP_DIR / "sim.json")
+        compare_simulation_inputs(transient_winds, transient_winds_from_json)
+
+
+def compare_simulation_inputs(a: SimulationInputs, b: SimulationInputs):
+    for a_input_file, b_input_file in zip(
+        a._input_files_dict.values(), b._input_files_dict.values()
+    ):
+        if isinstance(a_input_file, QU_Simparams) or isinstance(
+            b_input_file, QU_Simparams
+        ):
+            a_input_file._from_file_dz_array = None
+            b_input_file._from_file_dz_array = None
+        assert a_input_file == b_input_file
```

